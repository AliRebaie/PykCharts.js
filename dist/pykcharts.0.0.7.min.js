var PykCharts={};Array.prototype.groupBy=function(){var a,b=[],c=_.groupBy(this,function(a){return a.name});console.log(c);for(a in c)b.push({name:a,weight:d3.sum(c[a],function(a){return a.weight})});return b},PykCharts.boolean=function(a){var b=["0","f","false","n","no",""],c=[void 0,null,0/0];return _.contains(c,a)?!1:(value=a.toLocaleString(),value=value.toLowerCase(),b.indexOf(value)>-1?!1:!0)},PykCharts.Configuration=function(a){var b=this,c={liveData:function(b){var c=a.realTimeCharts.refreshFrequency;return PykCharts.boolean(c)&&setInterval(b.refresh,1e3*c),this},scaleIdentification:function(a,b,c,d){var e;return"ordinal"===a?e=d3.scale.ordinal().domain(b).rangeRoundBands(c,d):"linear"===a?e=d3.scale.linear().domain(b).range(c):"time"===a?e=d3.time.scale().domain(b).range(c):void 0},appendUnits:function(b){var c,d,e;return a.units?(d=a.units.prefix,e=a.units.suffix,d&&""!==d?(c=d+b,e&&(c+=" "+e)):c=e&&""!==e?b+" "+e:b):c=b,c},title:function(){return PykCharts.boolean(a.title.text)&&(b.titleDiv=d3.select(a.selector).append("div").attr("id","title").style("width",a.width+"px").style("text-align","left").html("<span style='pointer-events:none;font-size:"+a.title.size+";color:"+a.title.color+";font-weight:"+a.title.weight+";font-family:"+a.title.family+"'>"+a.title.text+"</span>")),this},subtitle:function(){return PykCharts.boolean(a.subtitle.text)&&(b.subtitleDiv=d3.select(a.selector).append("div").attr("id","sub-title").style("width",a.width+"px").style("text-align","left").html("</span><br><span style='pointer-events:none;font-size:"+a.subtitle.size+";color:"+a.subtitle.color+";font-family:"+a.subtitle.family+"'>"+a.subtitle.text+"</span>")),this},credits:function(){if(PykCharts.boolean(a.creditMySite.mySiteName)||PykCharts.boolean(a.creditMySite.mySiteUrl)){var b=a.creditMySite,c=!0;""===b.mySiteName&&(b.mySiteName=b.mySiteUrl),""===b.mySiteUrl&&(c=!1),d3.select(a.selector).append("div").attr("id","footer").style("width",a.width+"px"),d3.select(a.selector+" #footer").append("div").attr("id","credits").style("width",a.width/2-30+"px").style("background",a.bg).style("float","left").attr("class","PykCharts-credits").html("<span style='pointer-events:none;'>Credits: </span><a href='"+b.mySiteUrl+"' target='_blank' onclick='return "+c+"'>"+b.mySiteName+"</a>")}return this},dataSource:function(){if(PykCharts.boolean(a.dataSource)&&(PykCharts.boolean(a.dataSource.text)||PykCharts.boolean(a.dataSource.url))){var b=!0,c=a.dataSource;""===c.text&&(c.text=c.url),""===c.url&&(b=!1),d3.select(a.selector+" #footer").append("div").attr("id","data-source").style("width",a.width/2-30+"px").attr("class","PykCharts-credits PykCharts-data-src").style("background",a.bg).style("float","right").html("<span style='pointer-events:none;'>Source: </span><a href='"+c.url+"' target='_blank' onclick='return "+b+"'>"+c.text+"</a>")}return this},makeMainDiv:function(a,b){return d3.select(a).append("div").attr("id","tooltip-svg-container-"+b).style("float","left"),this},tooltip:function(b,c,d){return PykCharts.boolean(a.enableTooltip)&&"default"===a.mode&&(void 0!==c?(d3.select(a.selector+" #tooltip-svg-container-"+d).append("div").attr("id","tooltip-container").style("position","relative").style("height","35px").style("margin-top","10px"),PykCharts.Configuration.tooltipp=d3.select(a.selector+" #tooltip-container").append("div").attr("id","pyk-tooltip").attr("class","pyk-line-tooltip")):PykCharts.Configuration.tooltipp=PykCharts.boolean(a.tooltip)&&"fixed"===a.tooltip.mode?d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#eeeeee").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("border","1px solid #CCCCCC").style("min-width","30px").style("z-index","10").style("visibility","hidden"):d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#eeeeee").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("border","1px solid #CCCCCC").style("min-width","30px").style("z-index","10").style("visibility","hidden")),this},crossHair:function(b){return PykCharts.boolean(a.enableCrossHair)&&"default"===a.mode&&(PykCharts.Configuration.cross_hair_v=b.append("g").attr("class","line-cursor").style("display","none"),PykCharts.Configuration.cross_hair_v.append("line").attr("id","cross-hair-v"),PykCharts.Configuration.focus_circle=b.append("g").attr("class",function(){return"areaChart"===a.type?"focus-area":"focus"}).style("display","none"),PykCharts.Configuration.focus_circle.append("circle").attr("id","focus-circle").attr("r",6).style("fill",function(){return"areaChart"===a.type?"none":a.chartColor})),this},fullScreen:function(c){return PykCharts.boolean(a.fullScreen)&&(b.fullScreenButton=d3.select(a.selector).append("input").attr("type","image").attr("id","btn-zoom").attr("src","../../PykCharts/img/apple_fullscreen.jpg").style("font-size","30px").style("left","800px").style("top","0px").style("position","absolute").style("height","4%").on("click",c.fullScreen)),this},loading:function(){return PykCharts.boolean(a.loading)&&($(a.selector).html("<div id='chart-loader'><img src="+a.loading+"></div>"),$(a.selector+" #chart-loader").css({visibility:"visible","padding-left":a.width/2+"px","padding-top":a.height/2+"px"})),this},positionContainers:function(b,c){return PykCharts.boolean(a.legends)&&!PykCharts.boolean(a.size.enable)?(("top"==b||"left"==b)&&c.optionalFeatures().legendsContainer().svgContainer(),("bottom"==b||"right"==b)&&c.optionalFeatures().svgContainer().legendsContainer()):c.optionalFeatures().svgContainer(),this},yGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid.yEnabled)){var e=PykCharts.Configuration.makeYGrid(a,d);c.selectAll(a.selector+" g.y.grid-line").style("stroke",function(){return a.grid.color}).call(e)}return this},xGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid.xEnabled)){var e=PykCharts.Configuration.makeXGrid(a,d);c.selectAll(a.selector+" g.x.grid-line").style("stroke",function(){return a.grid.color}).call(e)}return this},xAxis:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.axis.x.enable)){d3.selectAll(a.selector+" .x.axis").attr("fill",function(){return a.axis.x.labelColor});var e=PykCharts.Configuration.makeXAxis(a,d);0!=a.axis.x.tickValues.length&&e.tickValues(a.axis.x.tickValues),c.style("stroke",function(){return a.axis.x.axisColor}).call(e),c.selectAll(a.selector+" g.x.axis text").attr("pointer-events","none")}return this},yAxis:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.axis.y.enable)){d3.selectAll(a.selector+" .y.axis").attr("fill",function(){return a.axis.y.labelColor});var e=PykCharts.Configuration.makeYAxis(a,d);c.style("stroke",function(){return a.axis.y.axisColor}).call(e),c.selectAll(a.selector+" g.y.axis text").attr("pointer-events","none")}return this},isOrdinal:function(b,c,d){return".x.axis"===c?b.select(c).call(PykCharts.Configuration.makeXAxis(a,d)):".x.grid"===c?b.select(c).call(PykCharts.Configuration.makeXGrid(a,d)):".y.axis"===c?b.select(c).call(PykCharts.Configuration.makeYAxis(a,d)):".y.grid"===c&&b.select(c).call(PykCharts.Configuration.makeYGrid(a,d)),this},totalColors:function(a){var c=parseInt(a,10);return c>2&&10>c?(b.total_colors=c,this):(b.total_colors=9,this)},colorType:function(a){return"colors"===a&&(b.legends="no"),this},__proto__:{_domainBandwidth:function(a,b){return padding=.1*(a[1]-a[0]),0===b?a[0]-=padding:1===b?a[1]+=padding:2===b&&(a[0]-=padding,a[1]+=padding),a},_radiusCalculation:function(b){var c=d3.min([a.width,a.height]);return c*b/200}}};return c};var configuration=PykCharts.Configuration;configuration.mouseEvent=function(a){var b=this;b.tooltip=configuration.tooltipp,b.cross_hair_v=configuration.cross_hair_v,b.focus_circle=configuration.focus_circle;var c={tooltipPosition:function(c,d,e,f,g){return PykCharts.boolean(a.enableTooltip)&&"default"===a.mode?void 0!==d?b.tooltip.style("visibility","visible").style("top",e+g+"px").style("left",d+f+"px"):b.tooltip.style("visibility","visible").style("top",d3.event.pageY-20+"px").style("left",d3.event.pageX+30+"px"):void 0},toolTextShow:function(c){return PykCharts.boolean(a.enableTooltip)&&"default"===a.mode&&b.tooltip.html(c),this},tooltipHide:function(){return PykCharts.boolean(a.enableTooltip)&&"default"===a.mode?b.tooltip.style("visibility","hidden"):void 0},crossHairPosition:function(b,c,d,e){if((PykCharts.boolean(a.enableCrossHair)||PykCharts.boolean(a.enableTooltip)||PykCharts.boolean(a.onHoverHighlightenable))&&"default"===a.mode){for(var f,g,h=$(a.selector+" #"+d.attr("id")).offset().left,i=($(a.selector+" #"+d.attr("id")).offset().right,a.margin.left),j=(a.margin.right,a.margin.top),k=a.margin.bottom,l=(a.width,a.height),m=d3.event.pageX-h,n=d.node(),o=n.getTotalLength(),p=m,q=o,r=(c.range(),c.rangeBand()),s="",t=0,u=0,v=0;;){if(f=Math.floor((p+q)/2),pos=n.getPointAtLength(f),(f===q||f===p)&&pos.x!==m)break;if(pos.x>m)q=f;else{if(!(pos.x<m))break;p=f}}for(g=0;m>c.range()[g]+r-e;g++);tooltipText=b[g].tooltip,s=b[g].x,t=m+e+i,u=pos.y+j,v=d.node().getBBox().width,t>=e+i+1&&v+e+i+2>=t&&u>=j&&l-k>=u?(this.tooltipPosition(tooltipText,t,j,-30,-3),this.toolTextShow(tooltipText),a.enableCrossHair?this.crossHairShow(t,j,t,l-k,t,u):null,this.axisHighlightShow(s,a.selector+" .x.axis")):(this.tooltipHide(),a.enableCrossHair?this.crossHairHide():null,this.axisHighlightHide(a.selector+" .x.axis"))}},crossHairShow:function(c,d,e,f,g,h){return PykCharts.boolean(a.enableCrossHair)&&"default"===a.mode&&void 0!==c&&(b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c).attr("y1",d).attr("x2",e).attr("y2",f),b.focus_circle.style("display","block").attr("transform","translate("+g+","+h+")")),this},crossHairHide:function(){return PykCharts.boolean(a.enableCrossHair)&&"default"===a.mode&&(b.cross_hair_v.style("display","none"),b.focus_circle.style("display","none")),this},axisHighlightShow:function(b,c,d){var e,f,g,h;if(PykCharts.boolean(a.axis.onHoverHighlightenable)&&"default"===a.mode){for(c===a.selector+" .y.axis"?(h=c+" .tick text",g=a.axis.y.labelColor):c===a.selector+" .x.axis"?(h=c+" .tick text",g=a.axis.x.labelColor):c===a.selector+" .axis-text"&&"column"===d?(h=c,g=a.axis.x.labelColor):c===a.selector+" .axis-text"&&"bar"===d&&(h=c,g=a.axis.y.labelColor),void 0!==f&&d3.select(d3.selectAll(h)[0][f]).style("fill",g).style("font-weight","normal"),e=0;d3.selectAll(h)[0][e].innerHTML!==b;e++);f=e,d3.selectAll(h).style("fill","#bbb").style("font-size","12px").style("font-weight","normal"),d3.select(d3.selectAll(h)[0][e]).style("fill",g).style("font-size","13px").style("font-weight","bold")}return this},axisHighlightHide:function(b,c){var d,e;return PykCharts.boolean(a.axis.onHoverHighlightenable)&&"default"===a.mode&&(b===a.selector+" .y.axis"?(e=b+" .tick text",d=a.axis.y.labelColor):b===a.selector+" .x.axis"?(e=b+" .tick text",d=a.axis.x.labelColor):b===a.selector+" .axis-text"&&"column"===c?(e=b,d=a.axis.x.labelColor):b===a.selector+" .axis-text"&&"bar"===c&&(e=b,d=a.axis.y.labelColor),d3.selectAll(e).style("fill",d).style("font-size","12px").style("font-weight","normal")),this}};return c},configuration.fillChart=function(a,b,c){var d={color:function(a){return a.color},saturation:function(){return"steelblue"},selectColor:function(b){return b.highlight===!0?a.highlightColor:a.chartColor},colorChart:function(a){return a.highlight===!0?b.stylesheet.colors.highlightColor:b.stylesheet.colors.chartColor},colorPieW:function(b){return PykCharts.boolean(a.size.enable)?PykCharts.boolean(a.size.enable)?b.color?b.color:a.chartColor:void 0:a.saturationColor},colorPieMS:function(b){return PykCharts.boolean(b.highlight)?a.highlightColor:c.optional&&c.optional.colors&&c.optional.colors.chartColor?a.chartColor:c.optional&&c.optional.colors&&b.color?b.color:a.chartColor}};return d},configuration.border=function(a){var b={width:function(){return a.borderBetweenChartElements.width},color:function(){return a.borderBetweenChartElements.color}};return b},configuration.makeXAxis=function(a,b){var c=d3.svg.axis().scale(b).ticks(a.axis.x.no_of_ticks).tickSize(a.axis.x.tickSize).outerTickSize(0).tickFormat(function(b){return b+a.axis.x.tickFormat}).tickPadding(a.axis.x.ticksPadding).orient(a.axis.x.orient);return c},configuration.makeYAxis=function(a,b){var c=d3.svg.axis().scale(b).orient(a.axis.y.orient).ticks(a.axis.y.no_of_ticks).tickSize(a.axis.y.tickSize).outerTickSize(0).tickPadding(a.axis.y.ticksPadding).tickFormat(function(b){return b+a.axis.y.tickFormat});return c},configuration.makeXGrid=function(a,b){var c=d3.svg.axis().scale(b).orient("bottom").ticks(a.axis.x.no_of_ticks).tickFormat("").tickSize(a.height-a.margin.top-a.margin.bottom).outerTickSize(0);return c},configuration.makeYGrid=function(a,b){var c=d3.svg.axis().scale(b).orient("left").ticks(a.axis.x.no_of_ticks).tickSize(-(a.width-a.margin.left-a.margin.right)).tickFormat("").outerTickSize(0);return c},configuration.transition=function(a){var b={duration:function(){return"default"===a.mode&&PykCharts.boolean(a.transition.duration)?a.transition.duration:0}};return b},configuration.Theme=function(){var a=this;return a.stylesheet={chart:{height:400,width:600,margin:{top:0,right:0,bottom:0,left:0},grid:{xEnabled:"yes",yEnabled:"yes",color:"#ddd"}},mode:"default",selector:"body",title:{size:"15px",color:"#1D1D1D",weight:"bold",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},subtitle:{size:"12px",color:"black",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},loading:{animationGifUrl:"https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/img/loader.gif"},buttons:{enableFullScreen:"no"},enableTooltip:"yes",creditMySite:{mySiteName:"Pykih",mySiteUrl:"http://www.pykih.com"},colors:{backgroundColor:"transparent",chartColor:"steelblue",highlightColor:"#013F73",saturationColor:"green"},borderBetweenChartElements:{width:1,color:"white",style:"solid"},legends:{size:"13",color:"white",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},label:{size:"13",color:"white",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},ticks:{strokeWidth:1,size:13,color:"#1D1D1D",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"}},a.functionality={realTimeCharts:{refreshFrequency:0,enableLastUpdatedAt:"yes"},transition:{duration:0}},a.oneDimensionalCharts={donut:{radiusPercent:70,innerRadiusPercent:40,showTotalAtTheCenter:"yes"},pie:{radiusPercent:70},clubData:{enable:"yes",text:"Others",maximumNodes:5},pictograph:{showActive:"yes",enableLabel:"yes",labelText:"yes",imagePerLine:3,imageWidth:79,imageHeight:66,activeText:{size:64,color:"steelblue",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},inactiveText:{size:64,color:"grey",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"}},funnel:{rect_width:100,rect_height:100}},a.multiDimensionalCharts={axis:{onHoverHighlightenable:"no",x:{enable:"yes",orient:"bottom",axisColor:"#1D1D1D",labelColor:"#1D1D1D",no_of_ticks:10,tickSize:5,tickFormat:"",ticksPadding:6,tickValues:[]},y:{enable:"yes",orient:"left",axisColor:"#1D1D1D",labelColor:"#1D1D1D",no_of_ticks:10,tickSize:5,tickFormat:"",ticksPadding:6}},yAxisDataFormat:"number",xAxisDataFormat:"string",curvy_lines:"no",enableCrossHair:"yes",zoom:{enable:"no"},size:{enable:"yes"},spiderweb:{outer_radius:200,radius:5,axisTitle:"yes",enableTicks:"yes"},multiple_containers:{enable:"no"},legends:{enable:"no",display:"horizontal"},scatterplot:{radius:9}},a.treeCharts={zoom:{enable:"no"},nodeRadius:4.5},a.mapsTheme={mapCode:"india-topo",axis:{onHoverHighlightenable:"no",x:{enable:"yes",orient:"bottom",axisColor:"#1D1D1D",labelColor:"#1D1D1D",no_of_ticks:10,tickSize:5,tickFormat:"",ticksPadding:6,tickValues:[]}}},a},PykCharts.oneD={},PykCharts.oneD.fillChart=function(a){var b={chartColor:function(b){return b.highlight===!0?a.highlightColor:a.chartColor}};return b},PykCharts.oneD.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.oneD.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.oneDimensionalCharts,g=b.optional;return a.selector=b.selector?b.selector:d.selector,a.width=b.chart&&_.isNumber(b.chart.width)?b.chart.width:d.chart.width,a.height=b.chart&&_.isNumber(b.chart.height)?b.chart.height:d.chart.height,a.mode=b.mode?b.mode:d.mode,g&&g.title?(a.title=g.title,a.title.size=g.title.size?g.title.size:d.title.size,a.title.color=g.title.color?g.title.color:d.title.color,a.title.weight=g.title.weight?g.title.weight:d.title.weight,a.title.family=g.title.family?g.title.family:d.title.family):a.title=d.title,g&&g.subtitle?(a.subtitle=g.subtitle,a.subtitle.size=g.subtitle.size?g.subtitle.size:d.subtitle.size,a.subtitle.color=g.subtitle.color?g.subtitle.color:d.subtitle.color,a.subtitle.weight=g.subtitle.weight?g.subtitle.weight:d.subtitle.weight,a.subtitle.family=g.subtitle.family?g.subtitle.family:d.subtitle.family):a.subtitle=d.subtitle,a.realTimeCharts=g&&g.realTimeCharts?g.realTimeCharts:e.realTimeCharts,a.transition=g&&g.transition&&g.transition.duration?g.transition:e.transition,a.creditMySite=g&&g.creditMySite?g.creditMySite:d.creditMySite,a.dataSource=g&&g.dataSource?g.dataSource:"no",g&&g.clubData?(a.clubData=g.clubData,a.clubData.text=PykCharts.boolean(g.clubData.enable)&&g.clubData.text?g.clubData.text:f.clubData.text,a.clubData.maximumNodes=PykCharts.boolean(g.clubData.maximumNodes)&&g.clubData.maximumNodes?g.clubData.maximumNodes:f.clubData.maximumNodes,a.clubData.alwaysIncludeDataPoints=PykCharts.boolean(g.clubData.enable)&&g.clubData.alwaysIncludeDataPoints?g.clubData.alwaysIncludeDataPoints:[]):(a.clubData=f.clubData,a.clubData.alwaysIncludeDataPoints=[]),a.bg=g&&g.colors&&g.colors.backgroundColor?g.colors.backgroundColor:d.colors.backgroundColor,a.chartColor=g&&g.colors&&g.colors.chartColor?g.colors.chartColor:d.colors.chartColor,a.highlightColor=g&&g.colors&&g.colors.highlightColor?g.colors.highlightColor:d.colors.highlightColor,a.fullscreen=g&&g.buttons&&g.buttons.enableFullScreen?g.buttons.enableFullScreen:d.buttons.enableFullScreen,a.loading=g&&g.loading&&g.loading.animationGifUrl?g.loading.animationGifUrl:d.loading.animationGifUrl,a.enableTooltip=g&&g.enableTooltip?g.enableTooltip:d.enableTooltip,g&&g.borderBetweenChartElements?(a.borderBetweenChartElements=g.borderBetweenChartElements,a.borderBetweenChartElements.width="width"in g.borderBetweenChartElements?g.borderBetweenChartElements.width:d.borderBetweenChartElements.width,a.borderBetweenChartElements.color=g.borderBetweenChartElements.color?g.borderBetweenChartElements.color:d.borderBetweenChartElements.color,a.borderBetweenChartElements.style=g.borderBetweenChartElements.style?g.borderBetweenChartElements.style:d.borderBetweenChartElements.style):a.borderBetweenChartElements=d.borderBetweenChartElements,g&&g.label?(a.label=g.label,a.label.size=g.label.size?g.label.size:d.label.size,a.label.color=g.label.color?g.label.color:d.label.color,a.label.weight=g.label.weight?g.label.weight:d.label.weight,a.label.family=g.label.family?g.label.family:d.label.family):a.label=d.label,g&&g.ticks?(a.ticks=g.ticks,a.ticks.strokeWidth=g.ticks.strokeWidth?g.ticks.strokeWidth:d.ticks.strokeWidth,a.ticks.size=g.ticks.size?g.ticks.size:d.ticks.size,a.ticks.color=g.ticks.color?g.ticks.color:d.ticks.color,a.ticks.family=g.ticks.family?g.ticks.family:d.ticks.family):a.ticks=d.ticks,a.showTotalAtTheCenter=g&&g.donut&&g.donut.showTotalAtTheCenter?g.donut.showTotalAtTheCenter:f.donut.showTotalAtTheCenter,a.units=g&&g.units?g.units:!1,a.k=new PykCharts.Configuration(a),a},PykCharts.oneD.bubble=function(a){var b=this;this.execute=function(){b=PykCharts.oneD.processInputs(b,a),"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy(),$(a.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c,b.optionalFeatures().createBubble()})},this.render=function(){if(b.fillChart=new PykCharts.oneD.fillChart(b),b.mouseEvent1=new PykCharts.oneD.mouseEvent(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode){b.k.title(),b.k.subtitle();{b.optionalFeatures().svgContainer().createBubble().label()}b.k.credits().dataSource().liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)}else"infographics"===b.mode&&(b.optionalFeatures().svgContainer().createBubble().label(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b))},this.optionalFeatures=function(){var c={svgContainer:function(){return $(b.selector).css("background-color",b.bg),b.svgContainer=d3.select(b.selector).append("svg").attr("class","svgcontainer").attr("id","svgcontainer").attr("width",b.width).attr("height",b.height),b.group=b.svgContainer.append("g").attr("id","bubgrp"),this},createBubble:function(){b.b=b.optionalFeatures().clubData(),b.bubble=d3.layout.pack().sort(function(a,b){return b.weight-a.weight}).size([b.width,b.height]).value(function(a){return a.weight}).padding(20);var c=d3.sum(b.b.children,function(a){return a.weight}),d=b.b.children.length;return b.max=b.b.children[d-1].weight,b.node=b.bubble.nodes(b.b),b.bub_node=b.group.selectAll(".node").data(b.node),b.bub_node.enter().append("g").attr("class","bubble-node").append("circle"),b.bub_node.attr("class","bubble-node").select("circle").attr("class","bubble").attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("r",0).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("fill",function(a){return a.children?b.bg:b.fillChart.chartColor(a)}).on("mouseover",function(d){d.children||(b.mouseEvent1.highlight(a.selector+" .bubble",this),d.tooltip=d.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+d.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(d.weight)+"  <td class='tooltip-right-content'>(&nbsp;"+(100*d.weight/c).toFixed(2)+"%&nbsp;)</tr></table>",b.mouseEvent.tooltipPosition(d),b.mouseEvent.toolTextShow(d.tooltip))}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.mouseEvent1.highlightHide(a.selector+" .bubble")}).on("mousemove",function(a){a.children||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("r",function(a){return a.r}),this},label:function(){return b.bub_text=b.group.selectAll("text").data(b.node),b.bub_text.enter().append("text").style("pointer-events","none"),b.bub_text.attr("text-anchor","middle").attr("transform",function(a){return"translate("+a.x+","+(a.y+5)+")"}).text("").transition().delay(b.transitions.duration()),b.bub_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<2*a.r&&this.getBBox().height<2*a.r?a.children?" ":a.name:""}).style("font-weight",b.label.weight).style("font-size",function(a){return a.r>24?b.label.size:"10px"}).attr("fill",b.label.color).style("font-family",b.label.family),this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){var a,c,d=[],e=0;if(b.data.length<=b.clubData.maximumNodes)return b.new_data1={children:b.data},this;if(0!==b.clubData.alwaysIncludeDataPoints.length){var f=b.clubData.alwaysIncludeDataPoints.length;for(c=0;f>c;c++)d[c]=b.clubData.alwaysIncludeDataPoints[c]}var g=[];for(c=0;c<d.length;c++)for(a=0;a<b.data.length;a++)d[c].toUpperCase()===b.data[a].name.toUpperCase()&&g.push(b.data[c]);for(b.data.sort(function(a,b){return b.weight-a.weight});g.length<b.clubData.maximumNodes-1;){for(c=0;c<d.length;c++)b.data[e].name.toUpperCase()===d[c].toUpperCase()&&e++;g.push(b.data[e]),e++}var h=0;for(a=e;a<b.data.length;a++){for(c=0;c<g.length&&c<b.data.length;c++)b.data[a].name.toUpperCase()===g[c].name.toUpperCase()&&(h+=0,a++,c=-1);a<b.data.length&&(h+=b.data[a].weight)}for(var i=function(a,b){return b.weight-a.weight};g.length>b.clubData.maximumNodes;){g.sort(i);{g.pop()}}var j={name:b.clubData.text,weight:h,color:b.clubData.color,tooltip:b.clubData.tooltipText,highlight:!1};g.length<b.clubData.maximumNodes&&g.push(j),g.sort(function(a,b){return a.weight-b.weight}),b.new_data1={children:g},b.map1=b.new_data1.children.map(function(a){return a.weight})}else b.data.sort(function(a,b){return a.weight-b.weight}),b.new_data1={children:b.data};return b.new_data1}};return c}},PykCharts.oneD.funnel=function(a){var b=this,c=new PykCharts.Configuration.Theme({});b.creditMySite=c.stylesheet.creditMySite,this.execute=function(){b=new PykCharts.oneD.processInputs(b,a);var d=a.funnel,e=c.oneDimensionalCharts.funnel;b.rect_width=d&&_.isNumber(d.rect_width)&&d.rect_width?d.rect_width:e.rect_width,b.rect_height=d&&_.isNumber(d.rect_height)&&d.rect_height?d.rect_height:e.rect_height,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy(),$(a.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c,b.optionalFeatures().clubData().createFunnel().label().ticks()})},this.render=function(){var a=this;if(a.fillChart=new PykCharts.oneD.fillChart(a),a.mouseEvent1=new PykCharts.oneD.mouseEvent(a),a.transitions=new PykCharts.Configuration.transition(a),a.border=new PykCharts.Configuration.border(a),"default"===a.mode&&a.k.title().subtitle(),a.k.tooltip(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a),"infographics"===a.mode&&(a.newData1=a.data),"default"===a.mode){a.optionalFeatures().clubData()}a.optionalFeatures().svgContainer().createFunnel().label(),"default"===a.mode&&(a.optionalFeatures().ticks(),a.k.liveData(a).credits().dataSource())},this.funnelLayout=function(){var a,b,c,d=this,e={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},mouth:function(a){return 2!==a.length||(c=a),this},coordinates:function(){function e(a){return d3.sum(q,function(b,c){return c>=a?b:void 0})}for(var f=b[0],g=b[1],h=c[0],i=c[1],j=(f-h)/2,k=g-i,l=0,m=0,n=0,o=0,p=[],q=d.percentageValues(a),r=j/k,s=(f+h)/2*k,t=h*i,u=s+t,v=t/u*100,w=a.length-1;w>=0;w--){var x=e(w);if(v>=x)n=x/v*i,l=g-n,p[w]=w===a.length-1?{values:[{x:(f-h)/2,y:l},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:l}]}:{values:[{x:(f-h)/2,y:l},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:l}]};else{var y;y=0===o?(x-v)/100*s:x/100*s;var z=2*r,A=2*h,B=2*y;m=(-A+Math.sqrt(Math.pow(A,2)-4*z*-B))/(2*z),l=g-m-i;var C=2*r*m+h,D=(f-C)/2;if(0===o)p[w]=w===a.length-1?{values:[{x:D,y:l},{x:(f-h)/2,y:k},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:k},{x:C+D,y:l}]}:{values:[{x:D,y:l},{x:(f-h)/2,y:k},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:k},{x:C+D,y:l}]};else{var E;E=6===p[w+1].values.length?5:3,p[w]={values:[{x:D,y:l},p[w+1].values[0],p[w+1].values[E],{x:C+D,y:l}]}}o=1}}return p}};return e},this.percentageValues=function(a){var b=d3.sum(a,function(a){return a.weight}),c=a.map(function(a){return a.weight/b*100});return c.sort(function(a,b){return b-a}),c},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(a.selector).append("svg").attr("width",b.width+100).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svg.append("g").attr("id","funnel"),this},createFunnel:function(){b.pervalue=b.percentageValues(b.newData1);var c=b.funnelLayout().data(b.newData1).size([b.width,b.height]).mouth([b.rect_width,b.rect_height]);b.coordinates=c.coordinates();var d=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});b.path=b.group.selectAll(".fun-path").data(b.coordinates);var e=[{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0}];return b.path.enter().append("path").attr("class","fun-path"),b.path.attr("class","fun-path").attr("d",function(){return d(e)}).attr("fill",function(a,c){return b.fillChart.chartColor(b.newData1[c])}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-opacity",1).on("mouseover",function(c,d){b.mouseEvent1.highlight(a.selector+" .fun-path",this),tooltip=b.newData1[d].tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.newData1[d].name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(b.newData1[d].weight)+"<td class='tooltip-right-content'>(&nbsp; "+b.pervalue[d].toFixed(2)+"%&nbsp) </tr></table>",b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(tooltip)}).on("mouseout",function(c){b.mouseEvent1.highlightHide(a.selector+" .fun-path"),b.mouseEvent.tooltipHide(c)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("d",function(a){return d(a.values)}),b.path.exit().remove(),this},label:function(){var a=b.group.selectAll("text").data(b.coordinates);return a.enter().append("text"),a.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+5:(a.values[0].y-a.values[2].y)/2+a.values[2].y+5}).attr("x",function(){return b.width/2}),a.text(function(a,c){return b.k.appendUnits(b.newData1[c].weight)}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text(function(a,c){return this.getBBox().width<a.values[3].x-a.values[1].x&&this.getBBox().height<a.values[2].y-a.values[0].y?b.k.appendUnits(b.newData1[c].weight):""}),a.exit().remove(),this},ticks:function(){var a=b.group.selectAll("funnel-ticks").data(b.coordinates);a.enter().append("line").attr("class","funnel-ticks"),a.attr("x1",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:(a.values[4].x+a.values[5].x+a.values[3].x)/3-5}).attr("y1",function(a){return(a.values[0].y+a.values[2].y)/2}).attr("x2",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:(a.values[4].x+a.values[5].x+a.values[3].x)/3-5}).attr("y2",function(a){return(a.values[0].y+a.values[2].y)/2}).attr("stroke-width",b.ticks.strokeWidth).attr("stroke",b.ticks.color).transition().duration(b.transitions.duration()).attr("x2",function(a){return a.values[2].y-a.values[0].y>15?4===a.values.length?(a.values[3].x+a.values[2].x)/2+5:(a.values[4].x+a.values[5].x+a.values[3].x)/3:4===a.values.length?(a.values[3].x+a.values[2].x)/2:(a.values[4].x+a.values[5].x+a.values[3].x)/3-5}),a.exit().remove();var c=b.group.selectAll(".ticks_label").data(b.coordinates);c.attr("class","ticks_label"),c.enter().append("text").attr("x",0).attr("y",0);var d,e;return c.attr("transform",function(a){return d=4===a.values.length?(a.values[3].x+a.values[2].x)/2+10:(a.values[4].x+a.values[5].x+a.values[3].x)/3+5,e=(a.values[0].y+a.values[2].y)/2+5,"translate("+d+","+e+")"}),c.text("").transition().delay(b.transitions.duration()).text(function(a,c){return b.newData1[c].name}).text(function(a,c){return this.getBBox().height<a.values[2].y-a.values[0].y-15?b.newData1[c].name:""}).attr("font-size",b.ticks.size).attr("text-anchor","start").attr("fill",b.ticks.color).attr("pointer-events","none").attr("font-family",b.ticks.family),c.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){var a=[];if(0!==b.clubData.alwaysIncludeDataPoints.length){var c=b.clubData.alwaysIncludeDataPoints.length;for(i=0;c>i;i++)a[i]=b.clubData.alwaysIncludeDataPoints[i]}for(b.newData=[],i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&b.newData.push(b.data[j]);
b.data.sort(function(a,b){return b.weight-a.weight});for(var d=0;b.newData.length<b.clubData.maximumNodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;b.newData.push(b.data[d]),d++}var e=0;for(j=d;j<b.data.length;j++){for(i=0;i<b.newData.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===b.newData[i].name.toUpperCase()&&(e+=0,j++,i=-1);j<b.data.length&&(e+=b.data[j].weight)}for(var f=function(a,b){return b.weight-a.weight};b.newData.length>b.clubData.maximumNodes;){b.newData.sort(f);{b.newData.pop()}}var g={name:b.clubData.text,weight:e,color:b.clubData.color,tooltip:b.clubData.tooltip};b.newData.length<b.clubData.maximumNodes&&b.newData.push(g),b.newData1=b.newData}else b.data.sort(function(a,b){return b.weight-a.weight}),b.newData1=b.data;return this}};return c}},PykCharts.oneD.percentageColumn=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){var b=this;b=new PykCharts.oneD.processInputs(b,a,"percentageColumn"),"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy(),$(a.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c,b.optionalFeatures().clubData().createChart().label().ticks()})},this.render=function(){var b=this;b.fillChart=new PykCharts.oneD.fillChart(b),b.mouseEvent1=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&b.k.title().subtitle(),"infographics"===b.mode&&(b.newData1=b.data),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"default"===b.mode&&(percent_column=b.optionalFeatures().clubData()),b.optionalFeatures().svgContainer().createChart().label(),"default"===b.mode&&(b.optionalFeatures().ticks(),b.k.liveData(b).credits().dataSource())},this.optionalFeatures=function(){var c={createChart:function(){var a=b.newData1.map(function(a){return a.weight});a.sum=function(){for(var a=0,b=0;b<this.length;++b)a+=this[b];return a};var c=a.sum();return b.newData1.forEach(function(a,b){this[b].percentValue=100*a.weight/c},b.newData1),b.newData1.sort(function(a,b){return b.weight-a.weight}),b.map1=_.map(b.newData1,function(a){return a.percentValue}),b.perColumn=b.group.selectAll(".per-rect").data(b.newData1),b.perColumn.enter().append("rect").attr("class","per-rect"),b.perColumn.attr("x",b.width/3).attr("y",function(a,c){if(0===c)return 0;var d=0,e=b.newData1.slice(0,c);return e.forEach(function(a,b){d+=this[b].percentValue},e),d*b.height/100}).attr("width",b.width/4).attr("height",0).attr("fill",function(a){return b.fillChart.chartColor(a)}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).on("mouseover",function(a){a.tooltip=a.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+a.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(a.weight)+"<td class='tooltip-right-content'>(&nbsp;"+a.percentValue.toFixed(2)+"%&nbsp)</tr></table>",b.mouseEvent1.highlight(".per-rect",this),b.mouseEvent.tooltipPosition(a),b.mouseEvent.toolTextShow(a.tooltip)}).on("mouseout",function(a){b.mouseEvent1.highlightHide(".per-rect"),b.mouseEvent.tooltipHide(a)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.percentValue*b.height/100}),b.perColumn.exit().remove(),this},svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svg.append("g").attr("id","funnel"),this},label:function(){b.per_text=b.group.selectAll(".text").data(b.newData1);var a=0;return b.per_text.enter().append("text").attr("class","per-text"),b.per_text.attr("class","per-text").attr("x",b.width/3+b.width/8).attr("y",function(c,d){return a+=c.percentValue,0===d?(0+a*b.height/100)/2+5:((a-c.percentValue)*b.height/100+a*b.height/100)/2+5}),a=0,b.per_text.text("").transition().delay(b.transitions.duration()),b.per_text.text(function(a){return b.k.appendUnits(a.weight)}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text(function(a){return this.getBBox().width<b.width/4&&this.getBBox().height<a.percentValue*b.height/100?b.k.appendUnits(a.weight):""}),b.per_text.exit().remove(),this},ticks:function(){var a=0,c=0,d=b.group.selectAll(".per-ticks").data(b.newData1);d.enter().append("line").attr("class","per-ticks"),d.attr("x1",function(){return b.width/3+b.width/4}).attr("y1",function(c,d){return a+=c.percentValue,0===d?(0+a*b.height/100)/2:((a-c.percentValue)*b.height/100+a*b.height/100)/2}).attr("x2",function(){return b.width/3+b.width/4}).attr("y2",function(a,d){return c+=a.percentValue,0===d?(0+c*b.height/100)/2:((c-a.percentValue)*b.height/100+c*b.height/100)/2}).attr("stroke-width",b.ticks.strokeWidth).attr("stroke",b.ticks.color).transition().duration(b.transitions.duration()).attr("x2",function(a){return a.percentValue*b.height/100>15?b.width/3+b.width/4+5:b.width/3+b.width/4}),d.exit().remove();var e,f;a=0;var g=b.group.selectAll(".ticks_label").data(b.newData1);return g.enter().append("text").attr("class","ticks_label"),g.attr("class","ticks_label").attr("transform",function(c){return a+=c.percentValue,e=b.width/3+b.width/4+10,f=((a-c.percentValue)*b.height/100+a*b.height/100)/2+5,"translate("+e+","+f+")"}),g.text("").transition().delay(b.transitions.duration()).text(function(a){return this.getBBox().height<a.percentValue*b.height/100-15?a.name:""}).attr("font-size",b.ticks.size).attr("text-anchor","start").attr("fill",b.ticks.color).attr("font-family",b.ticks.family).attr("pointer-events","none"),g.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){var a=[];if(0!==b.clubData.alwaysIncludeDataPoints.length){var c=b.clubData.alwaysIncludeDataPoints.length;for(i=0;c>i;i++)a[i]=b.clubData.alwaysIncludeDataPoints[i]}for(b.newData=[],i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&b.newData.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var d=0;b.newData.length<b.clubData.maximumNodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;b.newData.push(b.data[d]),d++}var e=0;for(j=d;j<b.data.length;j++){for(i=0;i<b.newData.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===b.newData[i].name.toUpperCase()&&(e+=0,j++,i=-1);j<b.data.length&&(e+=b.data[j].weight)}for(var f=function(a,b){return b.weight-a.weight};b.newData.length>b.clubData.maximumNodes;){b.newData.sort(f);{b.newData.pop()}}var g={name:b.clubData.text,weight:e,color:b.clubData.color,tooltip:b.clubData.tooltip};b.newData.length<b.clubData.maximumNodes&&b.newData.push(g),b.newData1=b.newData}else b.data.sort(function(a,b){return b.weight-a.weight}),b.newData1=b.data;return this}};return c}},PykCharts.oneD.pictograph=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a);var d=a.optional,e=c.oneDimensionalCharts;b.showActive=d&&d.pictograph&&d.pictograph.showActive?d.pictograph.showActive:e.pictograph.showActive,b.enableLabel=d&&d.pictograph&&d.pictograph.enableLabel?d.pictograph.enableLabel:e.pictograph.enableLabel,b.labeltext=d&&d.pictograph&&d.pictograph.labelText?d.pictograph.labelText:e.pictograph.labelText,b.imgperline=d&&d.pictograph&&d.pictograph.imagePerLine?d.pictograph.imagePerLine:e.pictograph.imagePerLine,d&&d.pictograph&&d.pictograph.activeText?(b.activeText=d.pictograph.activeText,b.activeText.size=d.pictograph.activeText.size?d.pictograph.activeText.size:e.pictograph.activeText.size,b.activeText.color=d.pictograph.activeText.color?d.pictograph.activeText.color:e.pictograph.activeText.color,b.activeText.weight=d.pictograph.activeText.weight?d.pictograph.activeText.weight:e.pictograph.activeText.weight,b.activeText.family=d.pictograph.activeText.family?d.pictograph.activeText.family:e.pictograph.activeText.family):b.activeText=e.pictograph.activeText,d&&d.pictograph&&d.pictograph.inactiveText?(b.inactiveText=d.pictograph.inactiveText,b.inactiveText.size=d.pictograph.inactiveText.size?d.pictograph.inactiveText.size:e.pictograph.inactiveText.size,b.inactiveText.color=d.pictograph.inactiveText.color?d.pictograph.inactiveText.color:e.pictograph.inactiveText.color,b.inactiveText.weight=d.pictograph.inactiveText.weight?d.pictograph.inactiveText.weight:e.pictograph.inactiveText.weight,b.inactiveText.family=d.pictograph.inactiveText.family?d.pictograph.inactiveText.family:e.pictograph.inactiveText.family):b.inactiveText=e.pictograph.inactiveText,b.imageWidth=d&&d.pictograph&&d.pictograph.imageWidth?d.pictograph.imageWidth:e.pictograph.imageWidth,b.imageHeight=d&&d.pictograph&&d.pictograph.imageHeight?d.pictograph.imageHeight:e.pictograph.imageHeight,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d,$(a.selector+" #chart-loader").remove(),b.render()})},this.render=function(){b.transitions=new PykCharts.Configuration.transition(b),b.k.title(),b.k.subtitle();b.optionalFeatures().svgContainer().createPictograph().labelText().enableLabel();b.k.credits().dataSource()},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height),b.group=b.svg.append("g").attr("transform","translate("+b.imageWidth+",0)"),b.group1=b.svg.append("g").attr("transform","translate(0,"+b.imageHeight+")"),this},createPictograph:function(){var a=1,c=1;b.optionalFeatures().showActive();for(var d=0,e=1;e<=b.size;e++)e<=b.data[1].size?b.group.append("image").attr("xlink:href",b.data[1].img).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"):b.group.append("image").attr("xlink:href",b.data[0].img).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"),d++,c++,d>=b.imgperline&&(a++,c=1,d=0,b.group.append("text").html("<br><br>"));return this},showActive:function(){return b.size=PykCharts.boolean(b.showActive)?b.data[0].size:b.data[1].size,this},enableLabel:function(){if(PykCharts.boolean(b.enableLabel)){var a;this.labelText(),b.group1.append("text").attr("font-family",b.inactiveText.family).attr("font-size",b.inactiveText.size).attr("fill",b.inactiveText.color).text("/"+b.data[0].size).text(function(){return a=this.getBBox().height,"/"+b.data[0].size}).attr("x",b.textWidth+5).attr("y",b.height/2-a)}return this},labelText:function(){if(PykCharts.boolean(b.labeltext)){var a;b.group1.append("text").attr("x",0).attr("font-family",b.activeText.family).attr("font-size",b.activeText.size).attr("fill",b.activeText.color).text(b.data[1].size).text(function(){return a=this.getBBox().height,b.textWidth=this.getBBox().width,b.data[1].size}).attr("y",b.height/2-a)}return this}};return c}},PykCharts.oneD.pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.pie&&_.isNumber(a.pie.radiusPercent)?a.pie.radiusPercent:c.oneDimensionalCharts.pie.radiusPercent,b.innerRadiusPercent=0,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy(),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"pie");e.render()})}},PykCharts.oneD.donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.donut&&_.isNumber(a.donut.radiusPercent)?a.donut.radiusPercent:c.oneDimensionalCharts.donut.radiusPercent,b.innerRadiusPercent=a.donut&&_.isNumber(a.donut.innerRadiusPercent)&&a.donut.innerRadiusPercent?a.donut.innerRadiusPercent:c.oneDimensionalCharts.donut.innerRadiusPercent,d3.json(a.data,function(c,d){b.data=d,$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"donut");e.render()})}},PykCharts.oneD.election_pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.pie&&_.isNumber(a.pie.radiusPercent)?a.pie.radiusPercent:c.oneDimensionalCharts.pie.radiusPercent,b.innerRadiusPercent=0,d3.json(a.data,function(c,d){b.data=d,$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election pie");e.render()})}},PykCharts.oneD.election_donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.donut&&_.isNumber(a.donut.radiusPercent)?a.donut.radiusPercent:c.oneDimensionalCharts.donut.radiusPercent,b.innerRadiusPercent=a.donut&&_.isNumber(a.donut.innerRadiusPercent)&&a.donut.innerRadiusPercent?a.donut.innerRadiusPercent:c.oneDimensionalCharts.donut.innerRadiusPercent,d3.json(a.data,function(c,d){b.data=d,$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election donut");e.render()})}},PykCharts.oneD.pieFunctions=function(a,b,c){var d=b;d.refresh=function(){d3.json(a.data,function(a,b){d.data=b,d.optionalFeatures().createPie().label().ticks().centerLabel()})},this.render=function(){if(d.count=1,d.fillChart=new PykCharts.oneD.fillChart(d),d.onHoverEffect=new PykCharts.oneD.mouseEvent(a),d.border=new PykCharts.Configuration.border(d),d.transitions=new PykCharts.Configuration.transition(d),"default"==d.mode.toLowerCase()){d.k.title().subtitle(),d.optionalFeatures().svgContainer(),d.k.credits().dataSource().tooltip(),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d);{d.optionalFeatures().set_start_end_angle().createPie().label().ticks().centerLabel()}d.k.liveData(d)}else"infographics"==d.mode.toLowerCase()&&(d.optionalFeatures().svgContainer().set_start_end_angle().createPie().label(),d.k.tooltip(),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d))},d.optionalFeatures=function(){var b={svgContainer:function(){return $(a.selector).css("background-color",d.bg),d.svgContainer=d3.select(d.selector).append("svg").attr("width",d.width).attr("height",d.height).attr("id","container").attr("class","svgcontainer"),d.group=d.svgContainer.append("g").attr("transform","translate("+d.width/2+","+(d.k._radiusCalculation(d.radiusPercent)+40)+")").attr("id","pieGroup"),this},createPie:function(){if(d3.select(a.selector+" #pieGroup").node().innerHTML="",d.chartData=d.optionalFeatures().clubData(),"pie"==c.toLowerCase()||"donut"==c.toLowerCase()){d.chartData.sort(function(a,b){return a.weight-b.weight});var b=d.chartData.pop();d.chartData.unshift(b)}else("election pie"==c.toLowerCase()||"election donut"==c.toLowerCase())&&d.chartData.sort(function(a,b){return b.weight-a.weight});d.sum=_.reduce(d.data,function(a,b){return a+b.weight},0),d.sorted_weight=_.map(d.chartData,function(a){return 100*a.weight/d.sum}),d.sorted_weight.sort(function(a,b){return a-b});_.map(d.chartData,function(a){return 100*a.weight/d.sum});d.innerRadius=d.k._radiusCalculation(d.innerRadiusPercent),d.radius=d.k._radiusCalculation(d.radiusPercent),d.arc=d3.svg.arc().innerRadius(d.innerRadius).outerRadius(d.radius),d.pie=d3.layout.pie().value(function(a){return a.weight}).sort(null).startAngle(d.startAngle).endAngle(d.endAngle);var e=d.group.selectAll("path").data(d.pie(d.chartData));return e.enter().append("path"),e.attr("class","pie"),e.attr("fill",function(a){return d.fillChart.chartColor(a.data)}).on("mouseover",function(b){b.data.tooltip=b.data.tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.data.name+"</tr><tr><td class='tooltip-left-content'>"+d.k.appendUnits(b.data.weight)+"<td class='tooltip-right-content'>( "+(100*b.data.weight/d.sum).toFixed(2)+"% ) </tr></table>",d.onHoverEffect.highlight(a.selector+" .pie",this),d.mouseEvent.tooltipPosition(b),d.mouseEvent.toolTextShow(b.data.tooltip)}).on("mouseout",function(b){d.onHoverEffect.highlightHide(a.selector+" .pie"),d.mouseEvent.tooltipHide(b)}).on("mousemove",function(a){d.mouseEvent.tooltipPosition(a)}).attr("stroke",d.border.color()).attr("stroke-width",d.border.width()),e.transition().delay(function(a,b){return d.transition.duration&&"default"==d.mode?b*d.transition.duration/d.chartData.length:0}).duration(d.transitions.duration()/d.chartData.length).attrTween("d",function(a){var b=d3.interpolate(a.startAngle,a.endAngle);return function(c){return a.endAngle=b(c),d.arc(a)}}),e.exit().remove(),this},label:function(){var a=d.group.selectAll("text").data(d.pie(d.chartData));return a.enter().append("text").attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),a.attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),a.text("").transition().delay(function(a,b){return PykCharts.boolean(d.transition.duration)?b*d.transition.duration/d.chartData.length:0}),a.text(function(a){return d.k.appendUnits(a.data.weight)}).attr("text-anchor","middle").attr("pointer-events","none").text(function(a){return"pie"===c.toLowerCase()||"election pie"===c.toLowerCase()?this.getBBox().width<(a.endAngle-a.startAngle)*(d.radius/2)*.9?d.k.appendUnits(a.data.weight):"":this.getBBox().width<Math.abs(a.endAngle-a.startAngle)*d.radius*.9&&this.getBBox().height<.75*(d.radius-d.innerRadius)?d.k.appendUnits(a.data.weight):""}).attr("dy",5).style("font-weight",d.label.weight).style("font-size",d.label.size).attr("fill",d.label.color).style("font-family",d.label.family),a.exit().remove(),this},clubData:function(){if(PykCharts.boolean(d.clubData.enable)){d.displayData=[],d.maximum_weight=_.map(d.data,function(a){return a.weight}),d.maximum_weight.sort(function(a,b){return b-a}),d.checkDuplicate=[];var a,b,c={name:d.clubData.text,color:d.clubData.color,tooltip:d.clubData.tooltipText,highlight:!1};d.getIndexByName=function(a){for(b=0;b<d.data.length;b++)if(d.data[b].name==a)return b};var e=function(a){var b=_.reject(d.maximum_weight,function(b){return b==d.data[a].weight});return b};if(0!==d.clubData.alwaysIncludeDataPoints.length)for(var f=0;f<d.clubData.alwaysIncludeDataPoints.length;f++)a=d.getIndexByName(d.clubData.alwaysIncludeDataPoints[f]),void 0!=a&&(d.displayData.push(d.data[a]),d.maximum_weight=e(a));d.getIndexByWeight=function(a){for(var b=0;b<d.data.length;b++)if(d.data[b].weight!=a);else if(_.contains(d.checkDuplicate,b)===!1)return d.checkDuplicate.push(b),b};var g=d.clubData.maximumNodes-d.displayData.length;if(g>0)for(d.displayData.push(c),b=0;g-1>b;b++)a=d.getIndexByWeight(d.maximum_weight[b]),d.displayData.push(d.data[a]);var h=d3.sum(d.maximum_weight,function(a,b){return b>=g?a:void 0});c.weight=h}else d.displayData=d.data;return d.displayData},ticks:function(){var a=d.group.selectAll("line").data(d.pie(d.chartData));a.enter().append("line").attr("class","ticks"),a.attr("x1",function(a){return 1*d.radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y1",function(a){return 1*d.radius*Math.sin((a.endAngle+a.startAngle)/2)}).attr("x2",function(a){return 1*d.radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*d.radius*Math.sin((a.endAngle+a.startAngle)/2)}).transition().delay(function(a,b){return PykCharts.boolean(d.transition.duration)?b*d.transition.duration/d.chartData.length:0}).duration(d.transitions.duration()/d.chartData.length).attr("x2",function(a){return 1*(d.radius/1+12)*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*(d.radius/1+12)*Math.sin((a.endAngle+a.startAngle)/2)}).attr("transform","rotate(-90)").attr("stroke-width",d.ticks.strokeWidth).attr("stroke",d.ticks.color),a.exit().remove();var b=d.group.selectAll(".ticks_label").data(d.pie(d.chartData));b.attr("class","ticks_label"),b.enter().append("text").attr("x",0).attr("y",0);var c,e;return b.attr("transform",function(a){return a.endAngle-a.startAngle<.2?(c=1*(d.radius+30)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),e=1*(d.radius/1+20)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)):(c=1*(d.radius+22)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),e=1*(d.radius/1+24)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)),"translate("+c+","+e+")"}),b.text("").transition().delay(function(a,b){return PykCharts.boolean(d.transition.duration)?(b+1)*d.transition.duration/d.chartData.length:0}).text(function(a){return a.data.name}).attr("text-anchor",function(a){var b=(a.endAngle-a.startAngle)/2+a.startAngle;return b>0&&1.5>b?"start":b>=1.5&&3.5>b?"middle":b>=3.5&&6>b?"end":b>=6?"middle":0>b?"middle":void 0}).attr("dy",5).attr("pointer-events","none").style("fill",d.ticks.color).style("font-size",d.ticks.size).style("font-family",d.ticks.family),b.exit().remove(),this},centerLabel:function(){if(PykCharts.boolean(d.showTotalAtTheCenter)&&("donut"==c||"election donut"==c)){var b=d.group.selectAll(a.selector+" .centerLabel").data([d.sum]);b.enter().append("text"),b.attr("class","centerLabel").text("").transition().delay(function(){return PykCharts.boolean(d.transition.duration)?d.transition.duration:void 0}),b.text(function(){return d.k.appendUnits(d.sum)}).attr("pointer-events","none").attr("text-anchor","middle").attr("y",function(){return"donut"==c?.2*d.innerRadius:-.25*d.innerRadius}).attr("font-size",function(){return"donut"==c?.4*d.innerRadius:.2*d.innerRadius}).style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("fill","#484848"),b.exit().remove()}return this},set_start_end_angle:function(){return d.startAngle,d.endAngle,"pie"==c||"donut"==c?(d.startAngle=0*(Math.PI/180),d.endAngle=360*(Math.PI/180)):("election pie"==c||"election donut"==c)&&(d.startAngle=-90*(Math.PI/180),d.endAngle=90*(Math.PI/180)),this}};return b}},PykCharts.oneD.pyramid=function(a){{var c=this;new PykCharts.Configuration.Theme({})}this.execute=function(){c=new PykCharts.oneD.processInputs(c,a,"pyramid"),"default"===c.mode&&c.k.loading(),d3.json(a.data,function(b,d){c.data=d.groupBy(),$(a.selector+" #chart-loader").remove(),c.render()})},this.refresh=function(){d3.json(a.data,function(a,b){c.data=b,c.optionalFeatures().createChart().label().ticks()})},this.render=function(){if(c.fillChart=new PykCharts.oneD.fillChart(c),c.mouseEvent1=new PykCharts.oneD.mouseEvent(a),c.transitions=new PykCharts.Configuration.transition(c),c.border=new PykCharts.Configuration.border(c),"default"===c.mode){c.k.title(),c.k.subtitle();{c.optionalFeatures().svgContainer().createChart().label().ticks()}c.k.credits().dataSource().tooltip().liveData(c),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c)}else"infographics"===c.mode&&(c.optionalFeatures().svgContainer().createChart().label(),c.k.tooltip(),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c))},this.percentageValues=function(a){var b=d3.sum(a,function(a){return a.weight}),c=a.map(function(a){return a.weight/b*100});return c.sort(function(a,b){return b-a}),c},this.pyramidLayout=function(){var a,b,d={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},coordinates:function(){function d(a){return d3.sum(h,function(b,c){return c>=a?b:void 0})}for(var e=b[0],f=b[1],g=e/2/f,h=c.percentageValues(a),i=[],j=e*f/2,k=0;k<a.length;k++){var l=d(k),m=l/100*j,n=Math.sqrt(m/g),o=2*g*n,p=(e-o)/2;i[k]=0===k?{values:[{x:e/2,y:0},{x:p,y:n},{x:o+p,y:n}]}:{values:[i[k-1].values[1],{x:p,y:n},{x:o+p,y:n},i[k-1].values[2]]}}return i}};return d},this.optionalFeatures=function(){var d={svgContainer:function(){return $(a.selector).css("background-color",c.bg),c.svg=d3.select(a.selector).append("svg").attr("width",c.width+200).attr("height",c.height).attr("id","svgcontainer").attr("class","svgcontainer"),c.group=c.svg.append("g").attr("id","pyrgrp"),this},createChart:function(){c.chartData=c.optionalFeatures().clubData(),c.perValues=c.percentageValues(c.chartData);var d=c.pyramidLayout().data(c.chartData).size([c.width,c.height]),e=d3.sum(c.chartData,function(a){return a.weight});c.coordinates=d.coordinates(),c.coordinates[0].values[1]=c.coordinates[c.coordinates.length-1].values[1],c.coordinates[0].values[2]=c.coordinates[c.coordinates.length-1].values[2];var f=c.chartData.length-1,g=(c.chartData.length-1,[]);for(i=0;i<c.chartData.length;i++)0==i?g[i]=c.chartData[i].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.chartData[i].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.chartData[i].weight)+"<td class='tooltip-right-content'>( "+(100*c.chartData[i].weight/e).toFixed(2)+"% ) </tr></table>":(g[i]=c.chartData[f].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.chartData[f].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.chartData[f].weight)+"<td class='tooltip-right-content'>( "+(100*c.chartData[f].weight/e).toFixed(2)+"% ) </tr></table>",f--);c.line=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});var h=[{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height}],f=c.chartData.length,j=c.group.selectAll(".pyr-path").data(c.coordinates);return j.enter().append("path"),j.attr("class","pyr-path").attr("d",function(){return c.line(h)}).attr("stroke",c.border.color()).attr("stroke-width",c.border.width()).attr("fill",function(a,d){return 0===d?b=c.chartData[d]:(f--,b=c.chartData[f]),c.fillChart.chartColor(b)}).on("mouseover",function(b,d){c.mouseEvent1.highlight(a.selector+" .pyr-path",this),c.mouseEvent.tooltipPosition(b),c.mouseEvent.toolTextShow(g[d])}).on("mouseout",function(b){c.mouseEvent1.highlightHide(a.selector+" .pyr-path"),c.mouseEvent.tooltipHide(b)}).on("mousemove",function(a){c.mouseEvent.tooltipPosition(a)}).transition().duration(c.transitions.duration()).attr("d",function(a){return c.line(a.values)}),j.exit().remove(),this},label:function(){var a=c.chartData.length,b=c.chartData.length,d=c.group.selectAll("text").data(c.coordinates);return d.enter().append("text"),d.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2+10}).attr("x",function(){return c.width/2}).text("").transition().delay(c.transitions.duration()),d.text(function(b,d){return 0===d?c.k.appendUnits(c.chartData[d].weight):(a--,c.k.appendUnits(c.chartData[a].weight))}).text(function(a,d){return this.getBBox().width<a.values[2].x-a.values[1].x||this.getBBox().height<a.values[1].y-a.values[0].y?0===d?c.k.appendUnits(c.chartData[d].weight):(b--,c.k.appendUnits(c.chartData[b].weight)):""}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",c.label.weight).style("font-size",c.label.size).attr("fill",c.label.color).style("font-family",c.label.family),d.exit().remove(),this},ticks:function(){var a=c.group.selectAll("pyr-ticks").data(c.coordinates),b=c.chartData.length;a.enter().append("line").attr("class","pyr-ticks"),a.attr("x1",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y1",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("x2",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y2",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("stroke-width",c.ticks.strokeWidth).attr("stroke",c.ticks.color).transition().duration(c.transitions.duration()).attr("x2",function(a){return Math.abs(a.values[0].y-a.values[1].y)>15?3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+20:(a.values[2].x+a.values[3].x)/2+20:3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}),a.exit().remove();var d=c.group.selectAll(".ticks_label").data(c.coordinates);d.enter().append("text").attr("x",0).attr("y",0).attr("class","ticks_label");var e,f,g=c.chartData.length;return d.attr("transform",function(a){return e=3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+30:(a.values[2].x+a.values[3].x)/2+30,f=4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2,"translate("+e+","+(f+5)+")"}),d.text("").transition().delay(c.transitions.duration()),d.text(function(a,d){return 0===d?c.chartData[d].name:(b--,c.chartData[b].name)}).text(function(a,b){return 0===b?this.getBBox().height<a.values[1].y-a.values[0].y?c.chartData[b].name:"":this.getBBox().height<a.values[0].y-a.values[1].y?(g--,c.chartData[g].name):""}).style("fill",c.ticks.color).style("font-size",c.ticks.size).style("font-family",c.ticks.family).attr("text-anchor","start"),d.exit().remove(),this},clubData:function(){if(PykCharts.boolean(c.clubData.enable)){c.displayData=[],c.maximum_weight=_.map(c.data,function(a){return a.weight}),c.maximum_weight.sort(function(a,b){return b-a}),c.checkDuplicate=[];var a,b,d={name:c.clubData.text,color:c.clubData.color,tooltip:c.clubData.tooltipText,highlight:!1};c.getIndexByName=function(a){for(b=0;b<c.data.length;b++)if(c.data[b].name==a)return b};var e=function(a){var b=_.reject(c.maximum_weight,function(b){return b==c.data[a].weight});return b};if(0!==c.clubData.alwaysIncludeDataPoints.length)for(b=0;b<c.clubData.alwaysIncludeDataPoints.length;b++)a=c.getIndexByName(c.clubData.alwaysIncludeDataPoints[b]),c.displayData.push(c.data[a]),c.maximum_weight=e(a);c.getIndexByWeight=function(a){for(var b=0;b<c.data.length;b++)if(c.data[b].weight!=a);else if(_.contains(c.checkDuplicate,b)===!1)return c.checkDuplicate.push(b),b};var f=c.clubData.maximumNodes-c.displayData.length;if(f>0)for(c.displayData.push(d),b=0;f-1>b;b++)a=c.getIndexByWeight(c.maximum_weight[b]),c.displayData.push(c.data[a]);var g=d3.sum(c.maximum_weight,function(a,b){return b>=f?a:void 0});d.weight=g}else c.displayData=c.data;return c.displayData.sort(function(a,b){return a.weight-b.weight}),c.displayData}};return d}},PykCharts.oneD.treemap=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=new PykCharts.oneD.processInputs(b,a),optional=a.optional,b.selector=a.selector,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=Array.groupBy(d),$(a.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c,b.optionalFeatures().clubData().createChart().label()})},this.render=function(){if(b.fillChart=new PykCharts.oneD.fillChart(b),b.mouseEvent1=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&(b.k.title(),b.k.subtitle()),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"infographics"===b.mode&&(b.new_data1=b.data),"default"===b.mode){b.optionalFeatures().clubData()}b.optionalFeatures().svgContainer().createChart().label(),"default"===b.mode&&b.k.liveData(b).credits().dataSource()},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(b.selector).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svg.append("g").attr("id","treemap"),this},createChart:function(){b.treemap=d3.layout.treemap().sort(function(a,b){return a.weight-b.weight
}).size([b.width,b.height]).value(function(a){return a.weight}).sticky(!1);var c,d,e=d3.sum(b.new_data1.children,function(a){return a.weight});return b.node=b.treemap.nodes(b.new_data1),c=b.new_data1.children.length,b.max=b.new_data1.children[c-1].weight,b.map1=b.new_data1.children.map(function(a){return a.weight}),b.map1=jQuery.unique(b.map1),b.treemap_data=b.group.selectAll(".cell").data(b.node),d=b.treemap_data.enter().append("svg:g").attr("class","cell").append("svg:rect").attr("class","treemap-rect"),b.treemap_data.attr("class","cell").select("rect").attr("class","treemap-rect").attr("id",function(a,b){return b}).attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("width",function(a){return a.dx-1}).attr("height",0).attr("fill",function(a){return a.children?"white":b.fillChart.chartColor(a)}).on("mouseover",function(c){c.children||(c.tooltip=c.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+c.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"<td class='tooltip-right-content'>(&nbsp;"+(100*c.weight/e).toFixed(2)+"%&nbsp;)</tr></table>",b.mouseEvent1.highlight(a.selector+" .treemap-rect",this),b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip))}).on("mouseout",function(c){c.weight/b.max;b.mouseEvent.tooltipHide(c),b.mouseEvent1.highlightHide(a.selector+" .treemap-rect")}).on("mousemove",function(a){a.children||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.dy-1}),b.treemap_data.exit().remove(),this},label:function(){return b.treemap_text=b.group.selectAll(".name").data(b.node),b.treemap_text1=b.group.selectAll(".weight").data(b.node),b.treemap_text.enter().append("svg:text").attr("class","name"),b.treemap_text1.enter().append("svg:text").attr("class","weight"),b.treemap_text.attr("class","name").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2}),b.treemap_text1.attr("class","weight").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2+15}),b.treemap_text.attr("text-anchor","middle").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text("").transition().delay(b.transitions.duration()),b.treemap_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":a.name:""}),b.treemap_text1.attr("text-anchor","middle").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text("").attr("pointer-events","none").transition().delay(b.transitions.duration()),b.treemap_text1.text(function(a){return a.children?" ":b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":b.k.appendUnits(a.weight):""}),b.treemap_text.exit().remove(),b.treemap_text1.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){console.log("club data");var a=[],c=0,d=0;if(b.data.length<=b.clubData.maximumNodes)return b.new_data1={children:b.data},this;if(0!==b.clubData.alwaysIncludeDataPoints.length){var e=b.clubData.alwaysIncludeDataPoints.length;for(i=0;e>i;i++)a[i]=b.clubData.alwaysIncludeDataPoints[i]}for(b.new_data=[],i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&b.new_data.push(b.data[j]);for(b.data.sort(function(a,b){return b.weight-a.weight});b.new_data.length<b.clubData.maximumNodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;b.new_data.push(b.data[d]),d++}for(j=d;j<b.data.length;j++){for(i=0;i<b.new_data.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===b.new_data[i].name.toUpperCase()&&(c+=0,j++,i=-1);j<b.data.length&&(c+=b.data[j].weight)}for(var f=function(a,b){return b.weight-a.weight};b.new_data.length>b.clubData.maximumNodes;){b.new_data.sort(f);{b.new_data.pop()}}var g={name:b.clubData.text,weight:c,color:b.clubData.color,tooltip:b.clubData.tooltip};b.new_data.length<b.clubData.maximumNodes&&b.new_data.push(g),b.new_data1={children:b.new_data}}else b.new_data1={children:b.data};return this}};return c}},PykCharts.maps={},PykCharts.maps.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.maps.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.mapsTheme,g=b.optional;return a.selector=b.selector?b.selector:d.selector,a.width=b.map&&_.isNumber(parseInt(b.map.width,10))?b.map.width:d.map.width,a.height=b.map&&_.isNumber(parseInt(b.map.height,10))?b.map.height:d.map.height,a.mapCode=b.mapCode?b.mapCode:f.mapCode,a.defaultColor=g&&g.colors&&g.colors.defaultColor?g.colors.defaultColor:d.colors.defaultColor,a.colorType=g&&g.colors&&g.colors.type?g.colors.type:d.colors.type,a.totalColors=g&&g.colors&&_.isNumber(parseInt(g.colors.total,10))?parseInt(g.colors.total,10):d.colors.total,a.colorPalette=g&&g.colors&&g.colors.palette?g.colors.palette:d.colors.palette,a.bg=g&&g.colors&&g.colors.backgroundColor?g.colors.backgroundColor:d.colors.backgroundColor,g&&g.tooltip?(a.tooltip=g.tooltip,a.tooltip.enable=g.tooltip.enable?g.tooltip.enable:d.tooltip.enable,a.enableTooltip=a.tooltip.enable,a.tooltip.mode=g.tooltip.mode?g.tooltip.mode:d.tooltip.mode,a.tooltip.positionTop=g.tooltip.positionTop?g.tooltip.positionTop:d.tooltip.positionTop,a.tooltip.positionLeft=g.tooltip.positionLeft?g.tooltip.positionLeft:d.tooltip.positionLeft,a.tooltipTopCorrection=d3.select(a.selector).style("top"),a.tooltipLeftCorrection=d3.select(a.selector).style("left")):a.tooltip=d.tooltip,g&&g.axis?(a.axis=g.axis,a.axis.onHoverHighlightenable=g.axis.onHoverHighlightenable?g.axis.onHoverHighlightenable:f.axis.onHoverHighlightenable,a.axis.x=g.axis.x,a.axis.x.orient=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.orient?g.axis.x.orient:f.axis.x.orient,a.axis.x.axisColor=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.axisColor?g.axis.x.axisColor:f.axis.x.axisColor,a.axis.x.labelColor=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.labelColor?g.axis.x.labelColor:f.axis.x.labelColor,a.axis.x.no_of_ticks=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.no_of_ticks?g.axis.x.no_of_ticks:f.axis.x.no_of_ticks,a.axis.x.ticksPadding=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.ticksPadding?g.axis.x.ticksPadding:f.axis.x.ticksPadding,a.axis.x.tickSize=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.tickSize?g.axis.x.tickSize:f.axis.x.tickSize,a.axis.x.tickFormat=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.tickFormat?g.axis.x.tickFormat:f.axis.x.tickFormat,a.axis.x.tickValues=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.tickValues?g.axis.x.tickValues:f.axis.x.tickValues,a.axis.y=g.axis.y,a.axis.y.orient=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.orient?g.axis.y.orient:f.axis.y.orient,a.axis.y.axisColor=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.axisColor?g.axis.y.axisColor:f.axis.y.axisColor,a.axis.y.labelColor=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.labelColor?g.axis.y.labelColor:f.axis.y.labelColor,a.axis.y.no_of_ticks=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.no_of_ticks?g.axis.y.no_of_ticks:f.axis.y.no_of_ticks,a.axis.y.ticksPadding=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.ticksPadding?g.axis.y.ticksPadding:f.axis.y.ticksPadding,a.axis.y.tickSize=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.tickSize?g.axis.y.tickSize:f.axis.y.tickSize,a.axis.y.tickFormat=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.tickFormat?g.axis.y.tickFormat:f.axis.y.tickFormat):a.axis=f.axis,g&&g.label?(a.label=g.label,a.label.size=g.label.size?g.label.size:d.label.size,a.label.color=g.label.color?g.label.color:d.label.color,a.label.weight=g.label.weight?g.label.weight:d.label.weight,a.label.family=g.label.family?g.label.family:d.label.family):a.label=d.label,g&&g.legends?(a.legends=g.legends,a.legends.strokeWidth=g.legends.strokeWidth?g.legends.strokeWidth:d.legends.strokeWidth,a.legends.size=g.legends.size?g.legends.size:d.legends.size,a.legends.color=g.legends.color?g.legends.color:d.legends.color,a.legends.family=g.legends.family?g.legends.family:d.legends.family):a.legends=d.legends,g&&g.border?(a.border=g.border,a.border.color=g.border.color?g.border.color:d.border.color,a.border.thickness=g.border.thickness?g.border.thickness:d.border.thickness):a.legends=d.legends,a.enableClick=g&&g.enableClick?g.enableClick:d.enableClick,a.onhover=g&&g.onhover?g.onhover:d.onhover,a.defaultZoomLevel=g&&g.defaultZoomLevel?g.defaultZoomLevel:80,a.loading=g&&g.loading&&g.loading.animationGifUrl?g.loading.animationGifUrl:d.loading.animationGifUrl,a.highlightArea=g&&g.highlightArea?g.highlightArea:d.highlightArea,g&&g.title?(a.title=g.title,a.title.size=g.title.size?g.title.size:d.title.size,a.title.color=g.title.color?g.title.color:d.title.color,a.title.weight=g.title.weight?g.title.weight:d.title.weight,a.title.family=g.title.family?g.title.family:d.title.family):a.title=d.title,g&&g.subtitle?(a.subtitle=g.subtitle,a.subtitle.size=g.subtitle.size?g.subtitle.size:d.subtitle.size,a.subtitle.color=g.subtitle.color?g.subtitle.color:d.subtitle.color,a.subtitle.weight=g.subtitle.weight?g.subtitle.weight:d.subtitle.weight,a.subtitle.family=g.subtitle.family?g.subtitle.family:d.subtitle.family):a.subtitle=d.subtitle,a.realTimeCharts=g&&g.realTimeCharts?g.realTimeCharts:e.realTimeCharts,a.transition=g&&g.transition?g.transition:e.transition,a.creditMySite=g&&g.creditMySite?g.creditMySite:d.creditMySite,a.dataSource=g&&g.dataSource?g.dataSource:"no",a.k=new PykCharts.Configuration(a),a},PykCharts.maps.oneLayer=function(a){var b=this;this.execute=function(){b=PykCharts.maps.processInputs(b,a),b.data=a.data,b.k.totalColors(b.totalColors).colorType(b.colorType).loading(b.loading).tooltip(b.tooltip),d3.json("../data/maps/"+b.mapCode+".json",function(a){b.map_data=a,d3.json("../data/maps/colorPalette.json",function(a){b.colorPalette_data=a,$(b.selector).html(""),b.render(),b.simulateLiveData(b.data)})}),b.max_size=d3.max(b.data,function(a){return parseInt(a.size,10)}),b.min_size=d3.min(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.max_size-b.min_size},this.optionalFeatures=function(){var a={enableLegend:function(a){return PykCharts.boolean(a)&&b.renderLegend(),this},enableLabel:function(a){return PykCharts.boolean(a)&&b.renderLabel(),this},enableClick:function(a){return PykCharts.boolean(a)&&(areas.on("click",b.clicked),b.onhover="color_saturation"),this}};return a},this.render=function(){var a=this,a=this,b=150,c=[a.width/2,a.height/2];a.current_palette=_.where(a.colorPalette_data,{name:a.colorPalette,number:a.totalColors})[0],a.optionalFeatures().enableLegend(a.legends),a.canvas=d3.select(a.selector).append("svg").attr("width",a.width).attr("height",a.height).attr("style","border:1px solid lightgrey").style("border-radius","5px");var d=a.canvas.append("g").attr("id","map_group"),e=d.append("defs"),f=e.append("filter").attr("id","dropshadow");f.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1).attr("result","blur"),f.append("feOffset").attr("in","blur").attr("dx",1).attr("dy",1).attr("result","offsetBlur");var g=f.append("feMerge");g.append("feMergeNode").attr('in", "offsetBlur'),g.append("feMergeNode").attr("in","SourceGraphic"),a.group=d.selectAll("g").data(topojson.feature(a.map_data,a.map_data.objects).features).enter().append("g");var h=d3.geo.centroid(topojson.feature(a.map_data,a.map_data.objects)),i=d3.geo.mercator().center(h).scale(b).translate(c);a.path=d3.geo.path().projection(i);var j=a.path.bounds(topojson.feature(a.map_data,a.map_data.objects)),k=b*a.width/(j[1][0]-j[0][0]),l=b*a.height/(j[1][1]-j[0][1]),b=l>k?k:l,c=[a.width-(j[0][0]+j[1][0])/2,a.height-(j[0][1]+j[1][1])/2];i=d3.geo.mercator().center(h).scale(a.defaultZoomLevel/100*b).translate(c),a.path=a.path.projection(i);{var m=d3.select("#pyk-tooltip");a.group.append("path").attr("d",a.path).attr("class","area").attr("state_name",function(a){return a.properties.NAME_1}).attr("fill",a.renderColor).attr("opacity",a.renderOpacity).attr("stroke",a.boder_color).attr("stroke-width",a.boder_thickness+"px").on("mouseover",function(b){console.log(_.where(a.data,{iso2:b.properties.iso_a2})[0].tooltip),PykCharts.boolean(a.tooltip)&&(m.style("visibility","visible"),m.html(_.where(a.data,{iso2:b.properties.iso_a2})[0].tooltip)),a.bodColor(b)}).on("mousemove",function(){PykCharts.boolean(a.tooltip)&&("moving"===a.tooltip.mode?m.style("top",function(){return d3.event.clientY+10+"px"}).style("left",function(){return d3.event.clientX+10+"px"}):"fixed"===a.tooltip.mode&&m.style("top",a.tooltip.positionTop+"px").style("left",a.tooltip.positionLeft+"px"))}).on("mouseout",function(b){PykCharts.boolean(a.tooltip)&&m.style("visibility","hidden"),a.bodUncolor(b)})}this.optionalFeatures().enableLabel(a.label).enableClick(a.enable_click),a.k.dataSource(a.dataSource).credits(a.creditMySite)},this.renderColor=function(a,c){var d,e;if(e=_.where(b.data,{iso2:a.properties.iso_a2}),_.where(b.data,{iso2:a.properties.iso_a2}).length>0){if("colors"===b.colorType)return e.length>0&&""!==e[0].color?e[0].color:b.defaultColor;if("saturation"===b.colorType){if("yes"===b.highlightArea&&"true"==e[0].highlight)return e[0].highlight_color;if(""!==b.colorPalette)for(d=_.where(b.data,{iso2:a.properties.iso_a2})[0].size,c=0;c<b.current_palette.colors.length;c++)if(d>=b.min_size+c*(b.difference/b.current_palette.colors.length)&&d<=b.min_size+(c+1)*(b.difference/b.current_palette.colors.length))return b.current_palette.colors[c];return b.defaultColor}return b.defaultColor}return b.defaultColor},this.renderOpacity=function(a){return""===b.colorPalette&&"saturation"===b.colorType?(b.oneninth=+d3.format(".2f")(b.difference/10),b.opacity=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth)/b.difference,b.opacity):1},this.renderLegend=function(){var a,b,c=this;if("saturation"===c.colorType)if(c.legs=d3.select(c.selector).append("svg").attr("id","legend-container").attr("width",c.width).attr("height",50),""===c.colorPalette)for(a=1;9>=a;a++)b=d3.format(".1f")(c.max_size/9),c.leg=d3.round(b*a),c.legs.append("rect").attr("x",a*(c.width/11)).attr("y",20).attr("width",c.width/11).attr("height",5).attr("fill",c.defaultColor).attr("opacity",a/9),c.legs.append("text").attr("x",(a+1)*(c.width/11)-5).attr("y",34).style("font-size",10).style("font","Arial").text("< "+c.leg);else for(a=1;a<=c.current_palette.number;a++)c.leg=d3.round(c.min_size+a*(c.difference/c.current_palette.number)),c.legs.append("rect").attr("x",a*c.width/(c.current_palette.number+2)).attr("y",20).attr("width",c.width/(c.current_palette.number+2)).attr("height",5).attr("fill",c.current_palette.colors[a-1]),c.legs.append("text").attr("x",(a+1)*c.width/(c.current_palette.number+2)-5).attr("y",34).style("font-size",10).style("font","Arial").text("< "+c.leg);else $("#legend-container").remove()},this.renderLabel=function(){b.group.append("text").attr("x",function(a){return b.path.centroid(a)[0]}).attr("y",function(a){return b.path.centroid(a)[1]}).attr("text-anchor","middle").attr("font-size","10").attr("pointer-events","none").text(function(a){return a.properties.NAME_1})},this.bodColor=function(a){"none"!==b.onhover?"highlight_border"===b.onhover?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",b.border.color).attr("stroke-width",b.border.thickness+.5):"shadow"===b.onhover?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("filter","url(#dropshadow)").attr("opacity",function(){return""===b.colorPalette&&"saturation"===b.colorType?(b.oneninth_dim=+d3.format(".2f")(b.difference/10),b.opacity_dim=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth_dim)/b.difference,b.opacity_dim/2):.5}):"color_saturation"===b.onhover&&d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("opacity",function(){return""===b.colorPalette&&"saturation"===b.colorType?(b.oneninth_dim=+d3.format(".2f")(b.difference/10),b.opacity_dim=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth_dim)/b.difference,b.opacity_dim/2):.5}):b.bodUncolor(a)},this.bodUncolor=function(a){d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",b.border.color).attr("stroke-width",b.border.thickness).attr("filter",null).attr("opacity",function(){return""===b.colorPalette&&"saturation"===b.colorType?(b.oneninth_high=+d3.format(".2f")(b.difference/10),b.opacity_high=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth_high)/b.difference,b.opacity_high):1})},this.clicked=function(a){var c={};c.container=d3.event.target.ownerSVGElement.parentNode.id,c.area=a.properties,c.data=_.where(b.data,{iso2:a.properties.iso_a2})[0];try{customFunction(c)}catch(d){}},this.simulateLiveData=function(){var a=$("#live-data").val();batSplit=a.split("\n");var c=[];b.live_json=[];for(var d=0;d<batSplit.length-1;d++)c[d]=batSplit[d].split(",");for(var d=1;d<batSplit.length-1;d++){for(var e={},f=0;f<c[d].length;f++)e[c[0][f]]=c[d][f];b.live_json.push(e)}b.data=b.live_json,d3.selectAll("path").attr("fill",b.renderColor).attr("opacity",b.renderOpacity)}},function(){function a(a){var c=document.createElement("script");c.type="text/javascript",c.async=!0,c.onload=c.onreadystatechange=function(){b++,3===b&&window.PykChartsInit()},c.src=a;var d=document.getElementsByTagName("link")[0];d.parentNode.insertBefore(c,d)}var b=0;a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/underscore-min.js"),a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/d3.min.js"),a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/jquery-1.11.1.min.js")}();