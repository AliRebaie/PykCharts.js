var PykCharts={};Array.prototype.groupBy=function(a){for(var b,c,d=[],e={oned:["name"],line:["x","name"],area:["x","name"],bar:["y","group"],column:["x","group"],scatterplot:["x","y","name","group"],pulse:["x","y","name","group"],spiderweb:["x","y","name"]},f={oned:{dimension:"name",fact:"weight"},line:{dimension:"x",fact:"y",name:"name"},area:{dimension:"x",fact:"y",name:"name"},bar:{dimension:"y",fact:"x",name:"group"},column:{dimension:"x",fact:"y",name:"group"},scatterplot:{dimension:"x",fact:"y",weight:"weight",name:"name",group:"group"},pulse:{dimension:"y",fact:"x",weight:"weight",name:"name",group:"group"},spiderweb:{dimension:"x",fact:"y",name:"name",weight:"weight"}},g=e[a],h=this,i=[],b=0,j=h.length;j>b;b+=1){var c=h[b];if(0==i.length)i.push([c]);else{for(var k=!1,l=0,m=i.length;m>l;l+=1){var n=i[l],o=!0,p=n[0];g.forEach(function(a){p[a]!==c[a]&&(o=!1)}),o&&(k=n)}k?k.push(c):i.push([c])}}for(b in i)if($.isArray(i[b])){c={};var q=i[b],r=f[a];c[r.dimension]=q[0][r.dimension],r.name&&(c[r.name]=q[0][r.name]),r.weight?(c[r.weight]=d3.sum(q,function(b){return b[f[a].weight]}),c[r.fact]=q[0][r.fact]):c[r.fact]=d3.sum(q,function(b){return b[f[a].fact]}),r.group&&(c[r.group]=q[0][r.group]);var s=_.extend(c,_.omit(q[0],_.values(f[a])));d.push(s)}return d},PykCharts.boolean=function(a){var b=["0","f","false","n","no",""],c=[void 0,null,0/0];return _.contains(c,a)?!1:(value=a.toLocaleString(),value=value.toLowerCase(),b.indexOf(value)>-1?!1:!0)},PykCharts.Configuration=function(a){var b=this,c={liveData:function(b){var c=a.realTimeCharts_refreshFrequency;return PykCharts.boolean(c)&&setInterval(b.refresh,1e3*c),this},emptyDiv:function(){d3.select(a.selector).append("div").style("clear","both")},scaleIdentification:function(a,b,c,d){var e;return"ordinal"===a?e=d3.scale.ordinal().domain(b).rangeRoundBands(c,d):"linear"===a?e=d3.scale.linear().domain(b).range(c):"time"===a?e=d3.time.scale().domain(b).range(c):void 0},appendUnits:function(b){var c,d,e;return d=a.units_prefix,e=a.units_suffix,d&&""!==d?(c=d+" "+b,e&&(c+=" "+e)):c=e&&""!==e?b+" "+e:b,c},title:function(){return PykCharts.boolean(a.title_text)&&a.title_size&&(b.titleDiv=d3.select(a.selector).append("div").attr("id","title").style("width",a.width+"px").style("text-align","left").html("<span style='pointer-events:none;font-size:"+a.title_size+";color:"+a.title_color+";font-weight:"+a.title_weight+";font-family:"+a.title_family+"'>"+a.title_text+"</span>")),this},subtitle:function(){return PykCharts.boolean(a.subtitle_text)&&a.subtitle_size&&(b.subtitleDiv=d3.select(a.selector).append("div").attr("id","sub-title").style("width",a.width+"px").style("text-align","left").html("</span><br><span style='pointer-events:none;font-size:"+a.subtitle_size+";color:"+a.subtitle_color+";font-weight:"+a.subtitle_weight+";font-family:"+a.subtitle_family+"'>"+a.subtitle_text+"</span>")),this},createFooter:function(){return d3.select(a.selector).append("table").attr("id","footer").style("background",a.bg).attr("width",a.width+"px"),this},lastUpdatedAt:function(b){if(PykCharts.boolean(a.realTimeCharts_refreshFrequency)&&PykCharts.boolean(a.realTimeCharts_enableLastUpdatedAt))if("liveData"===b){var c=new Date,d=c.getDate()+"/"+(c.getMonth()+1)+"/"+c.getFullYear()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();$(a.selector+" #lastUpdatedAt").html("<span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+d+"</span>")}else{var c=new Date,d=c.getDate()+"/"+(c.getMonth()+1)+"/"+c.getFullYear()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();d3.select(a.selector+" #footer").append("tr").attr("class","PykCharts-credits").html("<td colspan=2 style='text-align:right' id='lastUpdatedAt'><span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+d+"</span></tr>")}return this},checkChangeInData:function(a,c){var d=Object.keys(c[0]),e=Object.keys(a[0]),f=!1;if(d.length===e.length&&c.length===a.length){for(i=0;i<a.length;i++)for(j=0;j<d.length;j++)if(a[i][e[j]]!==c[i][d[j]]||d[j]!==e[j]){f=!0;break}}else f=!0;return b.compare_data=a,[b.compare_data,f]},credits:function(){if(PykCharts.boolean(a.creditMySite_name)||PykCharts.boolean(a.creditMySite_url)){var b=!0;""===a.creditMySite_name&&(a.creditMySite_name=a.creditMySite_url),""===a.creditMySite_url&&(b=!1),d3.select(a.selector+" #footer").append("tr").attr("class","PykCharts-credits").append("td").style("text-align","left").html("<span style='pointer-events:none;'>Credits: </span><a href='"+a.creditMySite_url+"' target='_blank' onclick='return "+b+"'>"+a.creditMySite_name+"</a>")}return this},dataSource:function(){if(PykCharts.boolean(a.dataSource_text)&&PykCharts.boolean(a.dataSource_url)){var b=!0;""===a.dataSource_text&&(a.dataSource_text=a.dataSource_url),""===a.dataSource_url&&(b=!1),$(a.selector+" #footer").length?d3.select(a.selector+" table tr").style("background",a.bg).append("td").style("text-align","right").html("<span style='pointer-events:none;'>Source: </span><a href='"+a.dataSource_url+"' target='_blank' onclick='return "+b+"'>"+a.dataSource_text+"</a></tr>"):d3.select(a.selector).append("table").attr("id","footer").style("background",a.bg).attr("width",a.width+"px").append("tr").attr("class","PykCharts-credits").append("td").style("text-align","right").html("<span style='pointer-events:none;'>Source: </span><a href='"+a.dataSource_url+"' target='_blank' onclick='return "+b+"'>"+a.dataSource_text+"</a></tr>")}return this},makeMainDiv:function(b,c){var d=d3.select(b).append("div").attr("id","tooltip-svg-container-"+c).style("width",a.width);return PykCharts.boolean(a.multiple_containers_enable)&&d.style("float","left").style("width","auto"),this},tooltip:function(b,c){return PykCharts.boolean(a.tooltip_enable)&&"default"===a.mode?PykCharts.Configuration.tooltipp=void 0!==c?d3.select(c).append("div").attr("id","pyk-tooltip").attr("class","pyk-line-tooltip"):d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("border","1px solid #CCCCCC").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("min-width","30px").style("z-index","10").style("visibility","hidden").style("box-shadow","0 5px 10px rgba(0,0,0,.2)"):PykCharts.boolean(a.tooltip_enable)&&(PykCharts.Configuration.tooltipp="fixed"===a.tooltip_mode?d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("min-width","30px").style("z-index","10").style("visibility","hidden"):d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("min-width","30px").style("z-index","10").style("visibility","hidden")),this},crossHair:function(b){return PykCharts.boolean(a.enableCrossHair)&&"default"===a.mode&&(PykCharts.Configuration.cross_hair_v=b.append("g").attr("class","line-cursor").style("display","none"),PykCharts.Configuration.cross_hair_v.append("line").attr("class","cross-hair-v").attr("id","cross-hair-v"),PykCharts.Configuration.cross_hair_h=b.append("g").attr("class","line-cursor").style("display","none"),PykCharts.Configuration.cross_hair_h.append("line").attr("class","cross-hair-h").attr("id","cross-hair-h"),PykCharts.Configuration.focus_circle=b.append("g").attr("class","focus").style("display","none"),PykCharts.Configuration.focus_circle.append("circle").attr("id","focus-circle").attr("r",6)),this},fullScreen:function(c){return PykCharts.boolean(a.fullScreen)&&(b.fullScreenButton=d3.select(a.selector).append("input").attr("type","image").attr("id","btn-zoom").attr("src","../../PykCharts/img/apple_fullscreen.jpg").style("font-size","30px").style("left","800px").style("top","0px").style("position","absolute").style("height","4%").on("click",c.fullScreen)),this},loading:function(){return PykCharts.boolean(a.loading)&&($(a.selector).html("<div id='chart-loader'><img src="+a.loading+"></div>"),$(a.selector+" #chart-loader").css({visibility:"visible","padding-left":a.width/2+"px","padding-top":a.height/2+"px"})),this},positionContainers:function(b,c){return PykCharts.boolean(a.legends_enable)&&!PykCharts.boolean(a.size_enable)?(("top"==b||"left"==b)&&c.optionalFeatures().legendsContainer().svgContainer(),("bottom"==b||"right"==b)&&c.optionalFeatures().svgContainer().legendsContainer()):c.optionalFeatures().svgContainer(),this},yGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid_yEnabled)){var e=PykCharts.Configuration.makeYGrid(a,d);c.selectAll(a.selector+" g.y.grid-line").style("stroke",function(){return a.grid_color}).call(e)}return this},xGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid_xEnabled)){var e=PykCharts.Configuration.makeXGrid(a,d);c.selectAll(a.selector+" g.x.grid-line").style("stroke",function(){return a.grid_color}).call(e)}return this},xAxis:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.axis_x_enable)){d3.selectAll(a.selector+" .x.axis").attr("fill",function(){return a.axis_x_labelColor}),"bottom"===a.axis_x_position&&c.attr("transform","translate(0,"+(a.height-a.margin_top-a.margin_bottom)+")");var e=PykCharts.Configuration.makeXAxis(a,d);0!=a.axis_x_tickValues.length&&e.tickValues(a.axis_x_tickValues),c.style("stroke",function(){return a.axis_x_axisColor}).call(e),c.selectAll(a.selector+" g.x.axis text").attr("pointer-events","none")}return this},yAxis:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.axis_y_enable)){"right"===a.axis_y_position&&c.attr("transform","translate("+(a.width-a.margin_left-a.margin_right)+",0)"),d3.selectAll(a.selector+" .y.axis").attr("fill",function(){return a.axis_y_labelColor});var e=PykCharts.Configuration.makeYAxis(a,d);c.style("stroke",function(){return a.axis_y_axisColor}).call(e),c.selectAll(a.selector+" g.y.axis text").attr("pointer-events","none")}return this},isOrdinal:function(b,c,d){return".x.axis"===c?b.select(c).call(PykCharts.Configuration.makeXAxis(a,d)):".x.grid"===c?b.select(c).call(PykCharts.Configuration.makeXGrid(a,d)):".y.axis"===c?b.select(c).call(PykCharts.Configuration.makeYAxis(a,d)):".y.grid"===c&&b.select(c).call(PykCharts.Configuration.makeYGrid(a,d)),this},totalColors:function(a){var c=parseInt(a,10);return c>2&&10>c?(b.total_colors=c,this):(b.total_colors=9,this)},colorType:function(a){return"colors"===a&&(b.legends="no"),this},__proto__:{_domainBandwidth:function(a,b,c){return addFactor=0,padding=.1*(a[1]-a[0]),0===b?a[0]-=padding+addFactor:1===b?a[1]=parseInt(a[1],10)+(padding+addFactor):2===b&&(a[0]-=padding+addFactor,a[1]=parseInt(a[1],10)+(padding+addFactor)),a},_radiusCalculation:function(b){var c=d3.min([a.width,a.height]);return c*b/200}}};return c};var configuration=PykCharts.Configuration;configuration.mouseEvent=function(a){var b=this;b.tooltip=configuration.tooltipp,b.cross_hair_v=configuration.cross_hair_v,b.cross_hair_h=configuration.cross_hair_h,b.focus_circle=configuration.focus_circle;var c={tooltipPosition:function(c,d,e,f,g,h){if(PykCharts.boolean(a.tooltip_enable)){if(void 0!==d){var i=parseFloat($(a.selector+" #tooltip-svg-container-"+h).next("#pyk-tooltip").css("width"));$(a.selector+" #tooltip-svg-container-"+h).next("#pyk-tooltip").css("visibility","visible").css("top",e+g+"px").css("left",d+a.margin_left+f-i+"px")}else b.tooltip.style("visibility","visible").style("top",d3.event.pageY-20+"px").style("left",d3.event.pageX+30+"px");return b.tooltip}},toolTextShow:function(c,d,e,f){return PykCharts.boolean(a.tooltip_enable)&&("yes"===d&&"multilineChart"===e?$(a.selector+" #tooltip-svg-container-"+f).next("#pyk-tooltip").html(c):b.tooltip.html(c)),this},tooltipHide:function(c,d,e){return PykCharts.boolean(a.tooltip_enable)?"yes"===d&&"multilineChart"===e?d3.selectAll(a.selector+" .pyk-line-tooltip").style("visibility","hidden"):b.tooltip.style("visibility","hidden"):void 0},crossHairPosition:function(b,c,d,e,f,g,h,i,j,k){if((PykCharts.boolean(a.enableCrossHair)||PykCharts.boolean(a.tooltip_enable)||PykCharts.boolean(a.onHoverHighlightenable))&&"default"===a.mode){console.log(f[0],"heyyyyyy");var l=$(a.selector+" #"+f[0].attr("id")).offset().left,m=$(a.selector+" #"+f[0].attr("id")).offset().top,n=c.length,o=a.margin_left,p=(a.margin_right,a.margin_top),q=a.margin_bottom,r=(a.width,a.height);console.log(d3.event.target.id,"saveeeeeee me");var s=parseInt(d3.event.target.id.substr(d3.event.target.id.length-1,1));console.log(s,"group_index");var t,u,v,w,x,y,z,A,B=d3.event.pageX-l,C=d3.event.pageY-m,D=d.range(),E=(e.range(),[]),F=[],G=D.length;for(t=0;G>t;t++){if(t+1>=G)return console.log("false",t),!1;if(y===D[t]&&z===D[t+1])return!1;if(B>=D[t]&&B<=D[t+1])if(z=D[t],y=D[t+1],v=z-B,w=B-y,v>=w?(u=b[t].x,E.push(b[t].y),tooltipText=b[t].tooltip||b[t].y,x=d(u)+g+o,F=e(b[t].y)+p):(u=b[t+1].x,E.push(b[t+1].y),tooltipText=b[t+1].tooltip||b[t+1].y,x=d(u)+g+o,F=e(b[t+1].y)+p),"multilineChart"===h){if("no"===k){d3.selectAll(a.selector+" #pyk-tooltip").classed({"pyk-line-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var H=c[0].data.length,I="";E=[];for(var J=0;n>J;J++)for(var K=0;H>K;K++)c[J].data[K].x===u&&(E.push(c[J].data[K].y),PykCharts.boolean(j)?PykCharts.boolean(j)&&(I+="<tr><td><div style='padding:2px;width:5px;height:5px;background-color:"+c[J].color+"'></div></td><td>"+c[J].name+"</td><td><b>"+c[J].data[K].tooltip+"</b></td></tr>",A=3):(I+="<tr><td>"+c[J].name+"</td><td><b>"+c[J].data[K].tooltip+"</b></td></tr>",A=2));x+=6,tooltipText="<table><thead><th colspan='"+A+"'>"+u+"</th></thead><tbody>"+I+"</tbody></table>",this.tooltipPosition(tooltipText,x,C,60,-15,s),this.toolTextShow(tooltipText),a.enableCrossHair?this.crossHairShow(x,p,x,r-q,x,F,h,E.length,k):null,this.axisHighlightShow(E,a.selector+" .y.axis"),this.axisHighlightShow(u,a.selector+" .x.axis")}else if("yes"===k){var L=$(a.selector+" #svg-0 #xaxis").offset().left,M=$(a.selector+" #svg-1 #xaxis").offset().left,N=M-L;x+=5;for(var H=c[0].data.length,J=0;n>J;J++)for(var K=0;H>K;K++)c[J].data[K].x===u&&(E.push(c[J].data[K].y),tooltipText=c[J].data[K].tooltip,F=e(c[J].data[K].y)+p,this.tooltipPosition(tooltipText,x+J*N,F,-15,-15,J),this.toolTextShow(tooltipText,k,h,J),a.enableCrossHair?this.crossHairShow(x,p,x,r-q,x,F,h,E.length,k,J):null)}}else("lineChart"===h||"areaChart"===h)&&(console.log("inside"),"fixed"===a.tooltip_mode.toLowerCase()?this.tooltipPosition(tooltipText,0,F,-14,-15,s):"moving"===a.tooltip_mode.toLowerCase()&&this.tooltipPosition(tooltipText,x,F,5,-45,s),this.toolTextShow(tooltipText),a.enableCrossHair?this.crossHairShow(x,p,x,r-q,x,F,h,E.length,k):null,this.axisHighlightShow(E,a.selector+" .y.axis"),this.axisHighlightShow(u,a.selector+" .x.axis"))}}},crossHairShow:function(c,d,e,f,g,h,i,j,k,l){return PykCharts.boolean(a.enableCrossHair)&&void 0!==c&&("lineChart"===i||"areaChart"===i?(b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c).attr("y1",d).attr("x2",e).attr("y2",f),b.cross_hair_h.style("display","block"),b.cross_hair_h.select(a.selector+" #cross-hair-h").attr("x1",a.margin_left).attr("y1",h).attr("x2",a.width-a.margin_right).attr("y2",h),b.focus_circle.style("display","block").attr("transform","translate("+g+","+h+")")):"multilineChart"===i&&("no"===k?(b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c-5).attr("y1",d).attr("x2",e-5).attr("y2",f)):"yes"===k&&(d3.selectAll(a.selector+" .line-cursor").style("display","block"),d3.selectAll(a.selector+" .cross-hair-v").attr("x1",c-5).attr("y1",d).attr("x2",e-5).attr("y2",f),d3.select(a.selector+" #svg-"+l+" .cross-hair-h").attr("x1",a.margin_left).attr("y1",h).attr("x2",a.width-a.margin_right).attr("y2",h),d3.select(a.selector+" #svg-"+l+" .focus").style("display","block").attr("transform","translate("+(g-5)+","+h+")")))),this},crossHairHide:function(c){return PykCharts.boolean(a.enableCrossHair)&&(b.cross_hair_v.style("display","none"),"lineChart"===c||"areaChart"===c?(b.cross_hair_h.style("display","none"),b.focus_circle.style("display","none")):"multilineChart"===c&&(d3.selectAll(a.selector+" .line-cursor").style("display","none"),d3.selectAll(a.selector+" .focus").style("display","none"))),this},axisHighlightShow:function(b,c,d){var e,f,g,h,i;if(PykCharts.boolean(a.axis_onHoverHighlightenable))if(c===a.selector+" .y.axis"){h=c+" .tick text",g=a.axis_y_labelColor,i=d3.selectAll(h)[0].length,d3.selectAll(h).style("fill","#bbb").style("font-size","12px").style("font-weight","normal");for(var j=0;i>j;j++)for(var d=0;d<b.length;d++)d3.selectAll(h)[0][j].innerHTML==b[d]&&d3.select(d3.selectAll(h)[0][j]).style("fill",g).style("font-size","13px").style("font-weight","bold")}else{for(c===a.selector+" .x.axis"?(h=c+" .tick text",g=a.axis_x_labelColor):c===a.selector+" .axis-text"&&"column"===d?(h=c,g=a.axis_x_labelColor):c===a.selector+" .axis-text"&&"bar"===d&&(h=c,g=a.axis_y_labelColor),void 0!==f&&d3.select(d3.selectAll(h)[0][f]).style("fill",g).style("font-weight","normal"),e=0;d3.selectAll(h)[0][e].innerHTML!==b;e++);f=e,d3.selectAll(h).style("fill","#bbb").style("font-size","12px").style("font-weight","normal"),d3.select(d3.selectAll(h)[0][e]).style("fill",g).style("font-size","13px").style("font-weight","bold")}return this},axisHighlightHide:function(b,c){var d,e;return PykCharts.boolean(a.axis_onHoverHighlightenable)&&(b===a.selector+" .y.axis"?(e=b+" .tick text",d=a.axis_y_labelColor):b===a.selector+" .x.axis"?(e=b+" .tick text",d=a.axis_x_labelColor):b===a.selector+" .axis-text"&&"column"===c?(e=b,d=a.axis_x_labelColor):b===a.selector+" .axis-text"&&"bar"===c&&(e=b,d=a.axis_y_labelColor),d3.selectAll(e).style("fill",d).style("font-size","12px").style("font-weight","normal")),this}};return c},configuration.fillChart=function(a,b,c){var d={color:function(a){return a.color},saturation:function(){return"steelblue"},selectColor:function(b){return b.highlight===!0?a.highlightColor:a.chartColor},colorChart:function(a){return a.highlight===!0?b.stylesheet.colors_highlightColor:b.stylesheet.colors_chartColor},colorPieW:function(b){return PykCharts.boolean(a.size_enable)?PykCharts.boolean(a.size_enable)?b.color?b.color:a.chartColor:void 0:a.saturationColor},colorPieMS:function(b){return PykCharts.boolean(b.highlight)?a.highlightColor:PykCharts.boolean(a.saturationEnable)?a.saturationColor:c.options&&c.options.colors_chartColor?a.chartColor:c.options&&b.color?b.color:a.chartColor}};return d},configuration.border=function(a){var b={width:function(){return a.borderBetweenChartElements_width},color:function(){return a.borderBetweenChartElements_color},style:function(){return a.borderBetweenChartElements_style}};return b},configuration.makeXAxis=function(a,b){var c=PykCharts.Configuration(a),d=d3.svg.axis().scale(b).ticks(a.axis_x_no_of_ticks).tickSize(a.axis_x_tickSize).outerTickSize(a.axis_x_outer_tick_size).tickFormat(function(b){return"yes"===a.multiple_containers_enable&&"string"===a.xAxisDataFormat?b.substr(0,2):c.appendUnits(b)}).tickPadding(a.axis_x_tickPadding).orient(a.axis_x_orient);return d},configuration.makeYAxis=function(a,b){var c=PykCharts.Configuration(a),d=d3.svg.axis().scale(b).orient(a.axis_y_orient).ticks(a.axis_y_no_of_ticks).tickSize(a.axis_y_tickSize).outerTickSize(a.axis_y_outer_tick_size).tickPadding(a.axis_y_tickPadding).tickFormat(function(a){return c.appendUnits(a)}).tickFormat(d3.format(",.0f"));return d},configuration.makeXGrid=function(a,b){var c=d3.svg.axis().scale(b).orient("bottom").ticks(a.axis_x_no_of_ticks).tickFormat("").tickSize(a.height-a.margin_top-a.margin_bottom).outerTickSize(0);return c},configuration.makeYGrid=function(a,b){var c=d3.svg.axis().scale(b).orient("left").ticks(a.axis_x_no_of_ticks).tickSize(-(a.width-a.margin_left-a.margin_right)).tickFormat("").outerTickSize(0);return c},configuration.transition=function(a){var b={duration:function(){return"default"===a.mode&&PykCharts.boolean(a.transition_duration)?a.transition_duration:0}};return b},configuration.Theme=function(){var a=this;return a.stylesheet={chart_height:400,chart_width:600,chart_margin_top:20,chart_margin_right:20,chart_margin_bottom:20,chart_margin_left:20,chart_grid_xEnabled:"yes",chart_grid_yEnabled:"yes",chart_grid_color:"#ddd",mode:"default",selector:"body",title_size:"15px",title_color:"#1D1D1D",title_weight:"bold",title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",overflowTicks:"no",subtitle_size:"12px",subtitle_color:"black",subtitle_weight:"thin",subtitle_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",loading_animationGifUrl:"https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/img/loader.gif",buttons_enableFullScreen:"no",tooltip_enable:"yes",creditMySite_name:"Pykih",creditMySite_url:"http://www.pykih.com",backgroundColor:"transparent",chartColor:"steelblue",highlightColor:"#013F73",saturationColor:"steelblue",borderBetweenChartElements_width:1,borderBetweenChartElements_color:"white",borderBetweenChartElements_style:"solid",legendsText_size:13,legendsText_color:"white",legendsText_weight:"thin",legendsText_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",label_size:13,label_color:"white",label_weight:"thin",label_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",ticks_thickness:1,ticks_size:13,ticks_color:"#1D1D1D",ticks_family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},a.functionality={realTimeCharts_refreshFrequency:0,realTimeCharts_enableLastUpdatedAt:"yes",transition_duration:0},a.oneDimensionalCharts={clubData_enable:"yes",clubData_text:"others",clubData_maximumNodes:5,donut_radiusPercent:70,donut_innerRadiusPercent:40,donut_showTotalAtTheCenter:"yes",pie_radiusPercent:70,pictograph_showTotal:"yes",pictograph_enableTotal:"yes",pictograph_enableCurrent:"yes",pictograph_imagePerLine:3,pictograph_imageWidth:79,pictograph_imageHeight:66,pictograph_activeText_size:64,pictograph_activeText_color:"steelblue",pictograph_activeText_weight:"thin",pictograph_activeText_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pictograph_inactiveText_size:64,pictograph_inactiveText_color:"grey",pictograph_inactiveText_weight:"thin",pictograph_inactiveText_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",funnel_rectWidth:100,funnel_rectHeight:100},a.multiDimensionalCharts={axis_onHoverHighlightenable:"no",axis_x_enable:"yes",axis_x_position:"bottom",axis_x_orient:"bottom",axis_x_axisColor:"1D1D1D",axis_x_labelColor:"1D1D1D",axis_x_no_of_ticks:5,axis_x_tickSize:5,axis_x_tickFormat:"",axis_x_tickPadding:6,axis_x_tickValues:[],axis_x_outer_tick_size:0,axis_y_enable:"yes",axis_y_position:"left",axis_y_orient:"left",axis_y_axisColor:"1D1D1D",axis_y_labelColor:"1D1D1D",axis_y_no_of_ticks:5,axis_y_tickSize:5,axis_y_tickFormat:"",axis_y_tickPadding:6,axis_y_tickValues:[],axis_y_outer_tick_size:0,yAxisDataFormat:"number",xAxisDataFormat:"string",enableCrossHair:"yes",zoom_enable:"no",size_enable:"yes",spiderweb_outerRadiusPercent:80,spiderweb_radius:5,spiderweb_axisTitle:"yes",spiderweb_enableTicks:"yes",multiple_containers_enable:"no",legends_enable:"yes",legends_display:"horizontal",tooltip_enable:"yes",tooltip_mode:"fixed",scatterplot_radius:40,scatterplot_ticks:"no",line_color_from_data:"yes",line_curvy_lines:"no"},a.treeCharts={zoom_enable:"no",nodeRadius:4.5},a.mapsTheme={chart_width:1e3,chart_height:1e3,colors_defaultColor:"#4682B4",colors_total:3,colors_type:"satuartion",colors_palette:"Blue",colors_backgroundColor:"white",tooltip_enable:"yes",tooltip_mode:"moving",tooltip_positionTop:0,tooltip_positionLeft:0,timeline_duration:1e3,timeline_margin_top:5,timeline_margin_right:25,timeline_margin_bottom:25,timeline_margin_left:45,legends_enable:"yes",legends_display:"horizontal",label_enable:"no",enableClick:"yes",onhover:"shadow",highlightArea:"no",axis_onHoverHighlightenable:"no",axis_x_enable:"yes",axis_x_orient:"top",axis_x_axisColor:"1D1D1D",axis_x_labelColor:"1D1D1D",axis_x_no_of_ticks:5,axis_x_tickSize:5,axis_x_tickFormat:"",axis_x_tickPadding:6,axis_x_tickValues:[],axis_x_outer_tick_size:0},a},PykCharts.oneD={},PykCharts.oneD.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.oneD.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.oneDimensionalCharts,g=b.optional;switch(a.selector=b.selector?b.selector:d.selector,a.width=_.isNumber(b.chart_width)?b.chart_width:d.chart_width,a.height=_.isNumber(b.chart_height)?b.chart_height:d.chart_height,a.mode=b.mode?b.mode:d.mode,b&&PykCharts.boolean(b.title_text)?(a.title_size="size"in b?b.title_size:d.title_size,a.title_color=b.title_color?b.title_color:d.title_color,a.title_weight=b.title_weight?b.title_weight:d.title_weight,a.title_family=b.title_family?g.title_family:d.title_family):(a.title_size=d.title_size,a.title_color=d.title_color,a.title_weight=d.title_weight,a.title_family=d.title_family),b&&PykCharts.boolean(b.subtitle_text)?(a.subtitle_size="subtitle_size"in b?b.subtitle_size:d.subtitle_size,a.subtitle_color=b.subtitle_color?b.subtitle_color:d.subtitle_color,a.subtitle_weight=b.subtitle_weight?b.subtitle_weight:d.subtitle_weight,a.subtitle_family=b.subtitle_family?b.subtitle_family:d.subtitle_family):(a.subtitle_size=d.subtitle_size,a.subtitle_color=d.subtitle_color,a.subtitle_weight=d.subtitle_weight,a.subtitle_family=d.subtitle_family),a.realTimeCharts_refreshFrequency=b.realTimeCharts_refreshFrequency?b.realTimeCharts_refreshFrequency:e.realTimeCharts_refreshFrequency,a.realTimeCharts_enableLastUpdatedAt=b.realTimeCharts_enableLastUpdatedAt?b.realTimeCharts_enableLastUpdatedAt:e.realTimeCharts_enableLastUpdatedAt,a.creditMySite_name=b.creditMySite_name?b.creditMySite_name:d.creditMySite_name,a.creditMySite_url=b.creditMySite_url?b.creditMySite_url:d.creditMySite_url,a.dataSource=b.dataSource?b.dataSource:"no",a.clubData_enable=b.clubData_enable?b.clubData_enable:f.clubData_enable,a.clubData_text=PykCharts.boolean(b.clubData_enable)&&b.clubData_text?b.clubData_text:f.clubData_text,a.clubData_maximumNodes=PykCharts.boolean(b.clubData_maximumNodes)&&b.clubData_maximumNodes?b.clubData_maximumNodes:f.clubData_maximumNodes,a.clubData_alwaysIncludeDataPoints=PykCharts.boolean(b.clubData_enable)&&b.clubData_alwaysIncludeDataPoints?b.clubData_alwaysIncludeDataPoints:[],a.transition_duration=b.transition_duration?b.transition_duration:e.transition_duration,a.overflowTicks=b.overflowTicks?b.overflowTicks:d.overflowTicks,a.bg=b.backgroundColor?b.backgroundColor:d.backgroundColor,a.chartColor=b.chartColor?b.chartColor:d.chartColor,a.highlightColor=b.highlightColor?b.highlightColor:d.highlightColor,a.fullscreen=b.buttons_enableFullScreen?b.buttons_enableFullScreen:d.buttons_enableFullScreen,a.loading=b.loading_animationGifUrl?b.loading_animationGifUrl:d.loading_animationGifUrl,a.tooltip_enable=b.tooltip_enable?b.tooltip_enable:d.tooltip_enable,a.borderBetweenChartElements_width="borderBetweenChartElements_width"in b?b.borderBetweenChartElements_width:d.borderBetweenChartElements_width,a.borderBetweenChartElements_color=b.borderBetweenChartElements_color?b.borderBetweenChartElements_color:d.borderBetweenChartElements_color,a.borderBetweenChartElements_style=b.borderBetweenChartElements_style?b.borderBetweenChartElements_style:d.borderBetweenChartElements_style,a.borderBetweenChartElements_style){case"dotted":a.borderBetweenChartElements_style="1,3";break;case"dashed":a.borderBetweenChartElements_style="5,5";break;default:a.borderBetweenChartElements_style="0"}return a.label_size="label_size"in b?b.label_size:d.label_size,a.label_color=b.label_color?b.label_color:d.label_color,a.label_weight=b.label_weight?b.label_weight:d.label_weight,a.label_family=b.label_family?b.label_family:d.label_family,a.ticks_thickness="ticks_thickness"in b?b.ticks_thickness:d.ticks_thickness,a.ticks_size="ticks_size"in b?b.ticks_size:d.ticks_size,a.ticks_color=b.ticks_color?b.ticks_color:d.ticks_color,a.ticks_family=b.ticks_family?b.ticks_family:d.ticks_family,a.showTotalAtTheCenter=b.donut_showTotalAtTheCenter?b.donut_showTotalAtTheCenter:f.donut_showTotalAtTheCenter,a.units=b.units?b.units:!1,a.k=new PykCharts.Configuration(a),a},PykCharts.oneD.bubble=function(a){var b=this;this.execute=function(){b=PykCharts.oneD.processInputs(b,a),"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.new_data=b.optionalFeatures().clubData(),b.optionalFeatures().createChart().label()})},this.render=function(){b.fillChart=new PykCharts.Configuration.fillChart(b),b.onHoverEffect=new PykCharts.oneD.mouseEvent(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode?(b.k.title(),b.k.subtitle(),b.new_data=b.optionalFeatures().clubData(),b.optionalFeatures().svgContainer().createChart().label(),b.k.createFooter().lastUpdatedAt().credits().dataSource().liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)):"infographics"===b.mode&&(b.new_data={children:b.data},b.optionalFeatures().svgContainer().createChart().label(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b))},this.optionalFeatures=function(){var c={svgContainer:function(){return $(b.selector).css("background-color",b.bg),b.svgContainer=d3.select(b.selector).append("svg").attr("class","svgcontainer").attr("id","svgcontainer").attr("width",b.width).attr("height",b.height),b.group=b.svgContainer.append("g").attr("id","bubgrp"),this},createChart:function(){b.bubble=d3.layout.pack().sort(function(a,b){return b.weight-a.weight}).size([b.width,b.height]).value(function(a){return a.weight}).padding(20),b.sum=d3.sum(b.new_data.children,function(a){return a.weight});b.new_data.children.length;return b.node=b.bubble.nodes(b.new_data),b.chart_data=b.group.selectAll(".bubble-node").data(b.node),b.chart_data.enter().append("g").attr("class","bubble-node").append("circle"),b.chart_data.attr("class","bubble-node").select("circle").attr("class","bubble").attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("r",0).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("fill",function(a){return a.children?b.bg:b.fillChart.selectColor(a)}).on("mouseover",function(c){c.children||(b.onHoverEffect.highlight(a.selector+" .bubble",this),c.tooltip=c.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+c.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"  <td class='tooltip-right-content'>(&nbsp;"+(100*c.weight/b.sum).toFixed(2)+"%&nbsp;)</tr></table>",b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip))}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.onHoverEffect.highlightHide(a.selector+" .bubble")}).on("mousemove",function(a){a.children||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("r",function(a){return a.r
}),b.chart_data.exit().remove(),this},label:function(){return b.chart_text=b.group.selectAll("text").data(b.node),b.chart_text.enter().append("text").style("pointer-events","none"),b.chart_text.attr("text-anchor","middle").attr("transform",function(a){return"translate("+a.x+","+(a.y+5)+")"}).text(""),setTimeout(function(){b.chart_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<2*a.r&&this.getBBox().height<2*a.r?a.children?" ":a.name:""}).style("font-weight",b.label_weight).style("font-size",function(a){return a.r>24?b.label_size:"10px"}).attr("fill",b.label_color).style("font-family",b.label_family)},b.transitions.duration()),b.chart_text.exit().remove,this},clubData:function(){var a;if(PykCharts.boolean(b.clubData_enable)){var c,d,e=[],f=0,g=[];if(b.data.length<=b.clubData_maximumNodes)return a={children:b.data};if(0!==b.clubData_alwaysIncludeDataPoints.length){var h=b.clubData_alwaysIncludeDataPoints.length;for(d=0;h>d;d++)e[d]=b.clubData_alwaysIncludeDataPoints[d]}for(d=0;d<e.length;d++)for(c=0;c<b.data.length;c++)e[d].toUpperCase()===b.data[c].name.toUpperCase()&&g.push(b.data[d]);for(b.data.sort(function(a,b){return b.weight-a.weight});g.length<b.clubData_maximumNodes-1;){for(d=0;d<e.length;d++)b.data[f].name.toUpperCase()===e[d].toUpperCase()&&f++;g.push(b.data[f]),f++}var i=0;for(c=f;c<b.data.length;c++){for(d=0;d<g.length&&d<b.data.length;d++)b.data[c].name.toUpperCase()===g[d].name.toUpperCase()&&(i+=0,c++,d=-1);c<b.data.length&&(i+=b.data[c].weight)}for(var j=function(a,b){return b.weight-a.weight};g.length>b.clubData_maximumNodes;){g.sort(j);{g.pop()}}var k={name:b.clubData_text,weight:i,color:b.clubData_color,tooltip:b.clubData_tooltipText,highlight:!1};g.length<b.clubData_maximumNodes&&g.push(k),g.sort(function(a,b){return a.weight-b.weight}),a={children:g},b.map1=a.children.map(function(a){return a.weight})}else b.data.sort(function(a,b){return a.weight-b.weight}),a={children:b.data};return a}};return c}},PykCharts.oneD.funnel=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a);var d=(a.optional,c.oneDimensionalCharts);b.rect_width=a.funnel_rectWidth&&_.isNumber(a.funnel_rectWidth)?a.funnel_rectWidth:d.funnel_rectWidth,b.rect_height=a.funnel_rectHeight&&_.isNumber(a.funnel_rectHeight)?a.funnel_rectHeight:d.funnel_rectHeight,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData().createChart().label().ticks()})},this.render=function(){var a=this;a.fillChart=new PykCharts.Configuration.fillChart(a),a.onHoverEffect=new PykCharts.oneD.mouseEvent(a),a.transitions=new PykCharts.Configuration.transition(a),a.border=new PykCharts.Configuration.border(a),"default"===a.mode&&a.k.title().subtitle(),a.k.tooltip(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a),"infographics"===a.mode&&(a.new_data=a.data),"default"===a.mode&&a.optionalFeatures().clubData(),a.optionalFeatures().svgContainer().createChart().label(),"default"===a.mode&&(a.optionalFeatures().ticks(),a.k.liveData(a).createFooter().lastUpdatedAt().credits().dataSource())},this.funnelLayout=function(){var a,b,c,d=this,e={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},mouth:function(a){return 2!==a.length||(c=a),this},coordinates:function(){function e(a){return d3.sum(q,function(b,c){return c>=a?b:void 0})}for(var f=b[0],g=b[1],h=c[0],i=c[1],j=(f-h)/2,k=g-i,l=0,m=0,n=0,o=0,p=[],q=d.percentageValues(a),r=j/k,s=(f+h)/2*k,t=h*i,u=s+t,v=t/u*100,w=a.length-1;w>=0;w--){var x=e(w);if(v>=x)n=x/v*i,l=g-n,p[w]=w===a.length-1?{values:[{x:(f-h)/2,y:l},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:l}]}:{values:[{x:(f-h)/2,y:l},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:l}]};else{var y;y=0===o?(x-v)/100*s:x/100*s;var z=2*r,A=2*h,B=2*y;m=(-A+Math.sqrt(Math.pow(A,2)-4*z*-B))/(2*z),l=g-m-i;var C=2*r*m+h,D=(f-C)/2;if(0===o)p[w]=w===a.length-1?{values:[{x:D,y:l},{x:(f-h)/2,y:k},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:k},{x:C+D,y:l}]}:{values:[{x:D,y:l},{x:(f-h)/2,y:k},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:k},{x:C+D,y:l}]};else{var E;E=6===p[w+1].values.length?5:3,p[w]={values:[{x:D,y:l},p[w+1].values[0],p[w+1].values[E],{x:C+D,y:l}]}}o=1}}return p}};return e},this.percentageValues=function(a){var b=this;b.sum=d3.sum(a,function(a){return a.weight});var c=a.map(function(a){return a.weight/b.sum*100});return c.sort(function(a,b){return b-a}),c},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svgContainer=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svgContainer.append("g").attr("id","funnel"),this},createChart:function(){b.per_values=b.percentageValues(b.new_data),b.funnel=b.funnelLayout().data(b.new_data).size([b.width,b.height]).mouth([b.rect_width,b.rect_height]),b.coordinates=b.funnel.coordinates();var c=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});b.chart_data=b.group.selectAll(".fun-path").data(b.coordinates);var d=[{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0}];return b.chart_data.enter().append("path").attr("class","fun-path"),b.chart_data.attr("class","fun-path").attr("d",function(){return c(d)}).attr("fill",function(a,c){return b.fillChart.selectColor(b.new_data[c])}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).attr("stroke-opacity",1).on("mouseover",function(c,d){b.onHoverEffect.highlight(a.selector+" .fun-path",this),tooltip=b.new_data[d].tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.new_data[d].name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(b.new_data[d].weight)+"<td class='tooltip-right-content'>(&nbsp; "+b.per_values[d].toFixed(2)+"%&nbsp) </tr></table>",b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(tooltip)}).on("mouseout",function(c){b.onHoverEffect.highlightHide(a.selector+" .fun-path"),b.mouseEvent.tooltipHide(c)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("d",function(a){return c(a.values)}),b.chart_data.exit().remove(),this},label:function(){return b.chart_text=b.group.selectAll("text").data(b.coordinates),b.chart_text.enter().append("text"),b.chart_text.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+5:(a.values[0].y-a.values[2].y)/2+a.values[2].y+5}).attr("x",function(){return b.width/2}),b.chart_text.text(""),setTimeout(function(){b.chart_text.text(function(a,c){return b.k.appendUnits(b.new_data[c].weight)}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text(function(a,c){return this.getBBox().width<a.values[3].x-a.values[1].x&&this.getBBox().height<a.values[2].y-a.values[0].y?b.k.appendUnits(b.new_data[c].weight):""})},b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){PykCharts.boolean(b.overflowTicks)&&b.svgContainer.style("overflow","visible");var a=[],c=b.group.selectAll(".ticks_label").data(b.coordinates);c.attr("class","ticks_label"),c.enter().append("text").attr("x",0).attr("y",0);var d,e;c.attr("transform",function(a){return 4===a.values.length?(d=(a.values[3].x+a.values[2].x)/2+10,e=(a.values[0].y+a.values[2].y)/2+5):(d=a.values[4].x+10,e=a.values[4].y+5),"translate("+d+","+e+")"}),c.text(""),setTimeout(function(){c.text(function(a,c){return b.new_data[c].name}).text(function(c,d){return a[d]=this.getBBox().height,this.getBBox().height<c.values[2].y-c.values[0].y?b.new_data[d].name:""}).attr("font-size",b.ticks_size).attr("text-anchor","start").attr("fill",b.ticks_color).attr("pointer-events","none").attr("font-family",b.ticks_family)},b.transitions.duration()),c.exit().remove();var f=b.group.selectAll(".funnel-ticks").data(b.coordinates);return f.enter().append("line").attr("class","funnel-ticks"),f.attr("x1",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:a.values[4].x}).attr("y1",function(a){return 4===a.values.length?(a.values[0].y+a.values[2].y)/2:a.values[4].y}).attr("x2",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:a.values[4].x}).attr("y2",function(a){return 4===a.values.length?(a.values[0].y+a.values[2].y)/2:a.values[4].y}).attr("stroke-width",b.ticks_thickness).attr("stroke",b.ticks_color),setTimeout(function(){f.attr("x2",function(b,c){return b.values[2].y-b.values[0].y>a[c]?4===b.values.length?(b.values[3].x+b.values[2].x)/2+5:b.values[4].x+5:4===b.values.length?(b.values[3].x+b.values[2].x)/2:b.values[4].x})},b.transitions.duration()),f.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData_enable)){var a=[];if(0!==b.clubData_alwaysIncludeDataPoints.length){var c=b.clubData_alwaysIncludeDataPoints.length;for(i=0;c>i;i++)a[i]=b.clubData_alwaysIncludeDataPoints[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubData_maximumNodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubData_maximumNodes;){d.sort(g);{d.pop()}}var h={name:b.clubData_text,weight:f,color:b.clubData_color,tooltip:b.clubData_tooltip};d.length<b.clubData_maximumNodes&&d.push(h),d.sort(function(a,b){return b.weight-a.weight}),b.new_data=d}else b.data.sort(function(a,b){return b.weight-a.weight}),b.new_data=b.data;return this}};return c}},PykCharts.oneD.percentageColumn=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){var b=this;b=new PykCharts.oneD.processInputs(b,a,"percentageColumn"),"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData().createChart().label().ticks()})},this.render=function(){var b=this;b.fillChart=new PykCharts.Configuration.fillChart(b),b.onHoverEffect=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&b.k.title().subtitle(),"infographics"===b.mode&&(b.new_data=b.data),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"default"===b.mode&&(percent_column=b.optionalFeatures().clubData()),b.optionalFeatures().svgContainer().createChart().label(),"default"===b.mode&&(b.optionalFeatures().ticks(),b.k.liveData(b).createFooter().lastUpdatedAt().credits().dataSource())},this.optionalFeatures=function(){var c={createChart:function(){var a=b.new_data.map(function(a){return a.weight});a.sum=function(){for(var a=0,b=0;b<this.length;++b)a+=this[b];return a};var c=a.sum();return b.new_data.forEach(function(a,b){this[b].percentValue=100*a.weight/c},b.new_data),b.new_data.sort(function(a,b){return b.weight-a.weight}),b.chart_data=b.group.selectAll(".per-rect").data(b.new_data),b.chart_data.enter().append("rect").attr("class","per-rect"),b.chart_data.attr("x",b.width/3).attr("y",function(a,c){if(0===c)return 0;var d=0,e=b.new_data.slice(0,c);return e.forEach(function(a,b){d+=this[b].percentValue},e),d*b.height/100}).attr("width",b.width/4).attr("height",0).attr("fill",function(a){return b.fillChart.selectColor(a)}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).on("mouseover",function(a){a.tooltip=a.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+a.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(a.weight)+"<td class='tooltip-right-content'>(&nbsp;"+a.percentValue.toFixed(2)+"%&nbsp)</tr></table>",b.onHoverEffect.highlight(".per-rect",this),b.mouseEvent.tooltipPosition(a),b.mouseEvent.toolTextShow(a.tooltip)}).on("mouseout",function(a){b.onHoverEffect.highlightHide(".per-rect"),b.mouseEvent.tooltipHide(a)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.percentValue*b.height/100}),b.chart_data.exit().remove(),this},svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svgContainer=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svgContainer.append("g").attr("id","funnel"),this},label:function(){b.chart_text=b.group.selectAll(".per-text").data(b.new_data);var a=0;return b.chart_text.enter().append("text").attr("class","per-text"),b.chart_text.attr("class","per-text").attr("x",b.width/3+b.width/8).attr("y",function(c,d){return a+=c.percentValue,0===d?(0+a*b.height/100)/2+5:((a-c.percentValue)*b.height/100+a*b.height/100)/2+5}),a=0,b.chart_text.text("").attr("fill",b.label_color).style("font-size",b.label_size).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label_weight).style("font-family",b.label_family),setTimeout(function(){b.chart_text.text(function(a){return b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<b.width/4&&this.getBBox().height<a.percentValue*b.height/100?b.k.appendUnits(a.weight):""})},b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){PykCharts.boolean(b.overflowTicks)&&b.svgContainer.style("overflow","visible");var a,c,d=0,e=0,f=[];d=0;var g=b.group.selectAll(".per-ticks").data(b.new_data);g.enter().append("line").attr("class","per-ticks");var h=b.group.selectAll(".ticks_label").data(b.new_data);return h.enter().append("text").attr("class","ticks_label"),h.attr("class","ticks_label").attr("transform",function(e){return d+=e.percentValue,a=b.width/3+b.width/4+10,c=((d-e.percentValue)*b.height/100+d*b.height/100)/2+5,"translate("+a+","+c+")"}),h.text(function(){return""}).attr("font-size",b.ticks_size).attr("text-anchor","start").attr("fill",b.ticks_color).attr("font-family",b.ticks_family).attr("pointer-events","none"),setTimeout(function(){h.text(function(a){return a.name}).text(function(a,c){return f[c]=this.getBBox().height,this.getBBox().height<a.percentValue*b.height/100?a.name:""}),d=0,g.attr("x1",function(){return b.width/3+b.width/4}).attr("y1",function(a,c){return d+=a.percentValue,0===c?(0+d*b.height/100)/2:((d-a.percentValue)*b.height/100+d*b.height/100)/2}).attr("x2",function(){return b.width/3+b.width/4}).attr("y2",function(a,c){return e+=a.percentValue,0===c?(0+e*b.height/100)/2:((e-a.percentValue)*b.height/100+e*b.height/100)/2}).attr("stroke-width",b.ticks_thickness).attr("stroke",b.ticks_color).attr("x2",function(a,c){return a.percentValue*b.height/100>f[c]?b.width/3+b.width/4+5:b.width/3+b.width/4})},b.transitions.duration()),h.exit().remove(),g.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData_enable)){var a=[];if(0!==b.clubData_alwaysIncludeDataPoints.length){var c=b.clubData_alwaysIncludeDataPoints.length;for(i=0;c>i;i++)a[i]=b.clubData_alwaysIncludeDataPoints[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubData_maximumNodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubData_maximumNodes;){d.sort(g);{d.pop()}}var h={name:b.clubData_text,weight:f,color:b.clubData_color,tooltip:b.clubData_tooltip};d.length<b.clubData_maximumNodes&&d.push(h),b.new_data=d}else b.data.sort(function(a,b){return b.weight-a.weight}),b.new_data=b.data;return this}};return c}},PykCharts.oneD.pictograph=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a);var d=(a.optional,c.oneDimensionalCharts);b.showTotal=a.pictograph_showTotal?a.pictograph_showTotal:d.pictograph_showTotal,b.enableTotal=a.pictograph_enableTotal?a.pictograph_enableTotal:d.pictograph_enableTotal,b.enableCurrent=a.pictograph_enableCurrent?a.pictograph_enableCurrent:d.pictograph_enableCurrent,b.imgperline=a.pictograph_imagePerLine?a.pictograph_imagePerLine:d.pictograph_imagePerLine,b.activeText_size=a.pictograph_activeText_size?a.pictograph_activeText_size:d.pictograph_activeText_size,b.activeText_color=a.pictograph_activeText_color?a.pictograph_activeText_color:d.pictograph_activeText_color,b.activeText_weight=a.pictograph_activeText_weight?a.pictograph_activeText_weight:d.pictograph_activeText_weight,b.activeText_family=a.pictograph_activeText_family?a.pictograph_activeText_family:d.pictograph_activeText_family,b.inactiveText_size=a.pictograph_inactiveText_size?a.pictograph_inactiveText_size:d.pictograph_inactiveText_size,b.inactiveText_color=a.pictograph_inactiveText_color?a.pictograph_inactiveText_color:d.pictograph_inactiveText_color,b.inactiveText_weight=a.pictograph_inactiveText_weight?a.pictograph_inactiveText_weight:d.pictograph_inactiveText_weight,b.inactiveText_family=a.pictograph_inactiveText_family?a.pictograph_inactiveText_family:d.pictograph_inactiveText_family,b.imageWidth=a.pictograph_imageWidth?a.pictograph_imageWidth:d.pictograph_imageWidth,b.imageHeight=a.pictograph_imageHeight?a.pictograph_imageHeight:d.pictograph_imageHeight,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.sort(function(a,b){return b.weight-a.weight}),$(a.selector+" #chart-loader").remove(),b.render()})},this.render=function(){b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode&&(b.k.title(),b.k.subtitle()),b.optionalFeatures().svgContainer().createChart().labelText().enableLabel(),"default"===b.mode&&b.k.createFooter().credits().dataSource()},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svgContainer=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height),b.group=b.svgContainer.append("g").attr("transform","translate("+b.imageWidth+",0)"),b.group1=b.svgContainer.append("g").attr("transform","translate(0,"+b.imageHeight+")"),this},createChart:function(){var a=1,c=1;b.optionalFeatures().showTotal();for(var d=0,e=1;e<=b.weight;e++)e<=b.data[1].weight?b.group.append("image").attr("xlink:href",b.data[1].image).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"):b.group.append("image").attr("xlink:href",b.data[0].image).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"),d++,c++,d>=b.imgperline&&(a++,c=1,d=0,b.group.append("text").html("<br><br>"));return this},showTotal:function(){return b.weight=PykCharts.boolean(b.showTotal)?b.data[0].weight:b.data[1].weight,this},enableLabel:function(){if(PykCharts.boolean(b.enableTotal)){var a;this.labelText(),b.group1.append("text").attr("font-family",b.inactiveText_family).attr("font-size",b.inactiveText_size).attr("fill",b.inactiveText_color).text("/"+b.data[0].weight).text(function(){return a=this.getBBox().height,"/"+b.data[0].weight}).attr("x",b.textWidth+5).attr("y",b.height/2-a)}return this},labelText:function(){if(PykCharts.boolean(b.enableCurrent)){var a;b.group1.append("text").attr("x",0).attr("font-family",b.activeText_family).attr("font-size",b.activeText_size).attr("fill",b.activeText_color).text(b.data[1].weight).text(function(){return a=this.getBBox().height,b.textWidth=this.getBBox().width,b.data[1].weight}).attr("y",b.height/2-a)}return this}};return c}},PykCharts.oneD.pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.pie_radiusPercent&&_.isNumber(a.pie_radiusPercent)?a.pie_radiusPercent:c.oneDimensionalCharts.pie_radiusPercent,b.innerRadiusPercent=0,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"pie");b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",e.render()})}},PykCharts.oneD.donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.donut_radiusPercent&&_.isNumber(a.donut_radiusPercent)?a.donut_radiusPercent:c.oneDimensionalCharts.donut_radiusPercent,b.innerRadiusPercent=a.donut_innerRadiusPercent&&_.isNumber(a.donut_innerRadiusPercent)?a.donut_innerRadiusPercent:c.oneDimensionalCharts.donut_innerRadiusPercent,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"donut");b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",e.render()})}},PykCharts.oneD.election_pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.pie_radiusPercent&&_.isNumber(a.pie_radiusPercent)?a.pie_radiusPercent:c.oneDimensionalCharts.pie_radiusPercent,b.innerRadiusPercent=0,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election pie");b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",e.render()})}},PykCharts.oneD.election_donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.donut_radiusPercent&&_.isNumber(a.donut_radiusPercent)?a.donut_radiusPercent:c.oneDimensionalCharts.donut_radiusPercent,b.innerRadiusPercent=a.donut_innerRadiusPercent&&_.isNumber(a.donut_innerRadiusPercent)&&a.donut_innerRadiusPercent?a.donut_innerRadiusPercent:c.oneDimensionalCharts.donut_innerRadiusPercent,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election donut");b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",e.render()})}},PykCharts.oneD.pieFunctions=function(a,b,c){var d=b;d.refresh=function(){d3.json(a.data,function(a,b){d.data=b.groupBy("oned"),d.refresh_data=b.groupBy("oned");var c=d.k.checkChangeInData(d.refresh_data,d.compare_data);d.compare_data=c[0];var e=c[1];e&&d.k.lastUpdatedAt("liveData"),d.new_data=d.optionalFeatures().clubData(),d.optionalFeatures().createChart().label().ticks().centerLabel()})},this.render=function(){d.count=1,d.fillChart=new PykCharts.Configuration.fillChart(d),d.onHoverEffect=new PykCharts.oneD.mouseEvent(a),d.border=new PykCharts.Configuration.border(d),d.transitions=new PykCharts.Configuration.transition(d),"default"==d.mode.toLowerCase()?(d.k.title().subtitle(),d.optionalFeatures().svgContainer(),d.new_data=d.optionalFeatures().clubData(),d.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip(),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d),d.optionalFeatures().set_start_end_angle().createChart().label().ticks().centerLabel(),d.k.liveData(d)):"infographics"==d.mode.toLowerCase()&&(d.new_data=d.data,d.optionalFeatures().svgContainer().set_start_end_angle().createChart().label(),d.k.tooltip(),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d))},d.optionalFeatures=function(){var b={svgContainer:function(){return $(a.selector).css("background-color",d.bg),d.svgContainer=d3.select(d.selector).append("svg").attr("width",d.width).attr("height",d.height).attr("id","container").attr("class","svgcontainer"),d.group=d.svgContainer.append("g").attr("transform","translate("+d.width/2+","+(d.k._radiusCalculation(d.radiusPercent)+20)+")").attr("id","pieGroup"),this},createChart:function(){if(d3.select(d.selector+" #pieGroup").node().innerHTML="","pie"==c.toLowerCase()||"donut"==c.toLowerCase()){d.new_data.sort(function(a,b){return a.weight-b.weight});var b=d.new_data.pop();d.new_data.unshift(b)}else("election pie"==c.toLowerCase()||"election donut"==c.toLowerCase())&&d.new_data.sort(function(a,b){return b.weight-a.weight});return d.sum=_.reduce(d.data,function(a,b){return a+b.weight},0),d.inner_radius=d.k._radiusCalculation(d.innerRadiusPercent),d.outer_radius=d.k._radiusCalculation(d.radiusPercent),d.arc=d3.svg.arc().innerRadius(d.inner_radius).outerRadius(d.outer_radius),d.pie=d3.layout.pie().value(function(a){return a.weight}).sort(null).startAngle(d.start_angle).endAngle(d.end_angle),d.chart_data=d.group.selectAll("path").data(d.pie(d.new_data)),d.chart_data.enter().append("path"),d.chart_data.attr("class","pie"),d.chart_data.attr("fill",function(a){return d.fillChart.selectColor(a.data)}).on("mouseover",function(b){b.data.tooltip=b.data.tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.data.name+"</tr><tr><td class='tooltip-left-content'>"+d.k.appendUnits(b.data.weight)+"<td class='tooltip-right-content'>( "+(100*b.data.weight/d.sum).toFixed(2)+"% ) </tr></table>",d.onHoverEffect.highlight(a.selector+" .pie",this),d.mouseEvent.tooltipPosition(b),d.mouseEvent.toolTextShow(b.data.tooltip)}).on("mouseout",function(b){d.onHoverEffect.highlightHide(a.selector+" .pie"),d.mouseEvent.tooltipHide(b)}).on("mousemove",function(a){d.mouseEvent.tooltipPosition(a)}).attr("stroke",d.border.color()).attr("stroke-width",d.border.width()).attr("stroke-dasharray",d.border.style()),d.chart_data.transition().delay(function(a,b){return d.transition_duration&&"default"==d.mode?b*d.transition_duration/d.new_data.length:0}).duration(d.transitions.duration()/d.new_data.length).attrTween("d",function(a){var b=d3.interpolate(a.startAngle,a.endAngle);return function(c){return a.endAngle=b(c),d.arc(a)}}),d.chart_data.exit().remove(),this},label:function(){return d.chart_text=d.group.selectAll("text").data(d.pie(d.new_data)),d.chart_text.enter().append("text").attr("class","pie-label").attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),d.chart_text.attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),d.chart_text.text("").attr("fill","red"),setTimeout(function(){d.chart_text.text(function(a){return d.k.appendUnits(a.data.weight)}).attr("text-anchor","middle").attr("pointer-events","none").text(function(a){return"pie"===c.toLowerCase()||"election pie"===c.toLowerCase()?this.getBBox().width<(a.endAngle-a.startAngle)*(d.outer_radius/2)*.9?d.k.appendUnits(a.data.weight):"":this.getBBox().width<Math.abs(a.endAngle-a.startAngle)*d.outer_radius*.9&&this.getBBox().height<.75*(d.outer_radius-d.inner_radius)?d.k.appendUnits(a.data.weight):""}).attr("dy",5).style("font-weight",d.label_weight).style("font-size",d.label_size).attr("fill",d.label_color).style("font-family",d.label_family),d.chart_text.exit().remove()},d.transitions.duration()),this},clubData:function(){if(PykCharts.boolean(d.clubData_enable)){d.displayData=[],d.sorted_weight=_.map(d.data,function(a){return a.weight}),d.sorted_weight.sort(function(a,b){return b-a}),d.checkDuplicate=[];var a,b,c={name:d.clubData_text,color:d.clubData_color,tooltip:d.clubData_tooltipText,highlight:!1};d.getIndexByName=function(a){for(b=0;b<d.data.length;b++)if(d.data[b].name==a)return b};var e=function(a){var b=_.reject(d.sorted_weight,function(b){return b==d.data[a].weight});return b};if(0!==d.clubData_alwaysIncludeDataPoints.length)for(var f=0;f<d.clubData_alwaysIncludeDataPoints.length;f++)a=d.getIndexByName(d.clubData_alwaysIncludeDataPoints[f]),void 0!=a&&(d.displayData.push(d.data[a]),d.sorted_weight=e(a));d.getIndexByWeight=function(a){for(var b=0;b<d.data.length;b++)if(d.data[b].weight!=a);else if(_.contains(d.checkDuplicate,b)===!1)return d.checkDuplicate.push(b),b};var g=d.clubData_maximumNodes-d.displayData.length,h=d3.sum(d.sorted_weight,function(a,b){return b>=g-1?a:void 0});if(c.weight=h,g>0)for(d.displayData.push(c),b=0;g-1>b;b++)a=d.getIndexByWeight(d.sorted_weight[b]),d.displayData.push(d.data[a])}else d.displayData=d.data;return d.displayData},ticks:function(){PykCharts.boolean(d.overflowTicks)&&d.svgContainer.style("overflow","visible");var a=d.group.selectAll(".ticks_label").data(d.pie(d.new_data));a.attr("class","ticks_label"),a.enter().append("text").attr("x",0).attr("y",0);var b,c;a.attr("transform",function(a){return a.endAngle-a.startAngle<.2?(b=1*(d.outer_radius+30)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),c=1*(d.outer_radius/1+20)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)):(b=1*(d.outer_radius+22)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),c=1*(d.outer_radius/1+24)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)),"translate("+b+","+c+")"}),a.text(""),setTimeout(function(){a.text(function(a){return a.data.name}).attr("text-anchor",function(a){var b=(a.endAngle-a.startAngle)/2+a.startAngle;return b>0&&1.5>b?"start":b>=1.5&&3.5>b?"middle":b>=3.5&&6>b?"end":b>=6?"middle":0>b?"middle":void 0}).attr("dy",5).attr("pointer-events","none").style("fill",d.ticks_color).style("font-size",d.ticks_size).style("font-family",d.ticks_family),a.exit().remove()},d.transitions.duration());var e=d.group.selectAll("line").data(d.pie(d.new_data));return e.enter().append("line").attr("class","ticks"),e.attr("x1",function(a){return 1*d.outer_radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y1",function(a){return 1*d.outer_radius*Math.sin((a.endAngle+a.startAngle)/2)}).attr("x2",function(a){return 1*d.outer_radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*d.outer_radius*Math.sin((a.endAngle+a.startAngle)/2)}),setTimeout(function(){e.attr("x2",function(a){return 1*(d.outer_radius/1+12)*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*(d.outer_radius/1+12)*Math.sin((a.startAngle+a.endAngle)/2)}).attr("transform","rotate(-90)").attr("stroke-width",d.ticks_thickness).attr("stroke",d.ticks_color),e.exit().remove()},d.transitions.duration()),this},centerLabel:function(){if(PykCharts.boolean(d.showTotalAtTheCenter)&&("donut"==c||"election donut"==c)){var b=d.group.selectAll(a.selector+" .centerLabel").data([d.sum]);b.enter().append("text"),b.attr("class","centerLabel").text("").transition().delay(function(){return PykCharts.boolean(d.transitions.duration())?d.transitions.duration():void 0
}).text(function(){return d.k.appendUnits(d.sum)}).attr("pointer-events","none").attr("text-anchor","middle").attr("y",function(){return"donut"==c?.2*d.inner_radius:-.25*d.inner_radius}).attr("font-size",function(){return"donut"==c?.4*d.inner_radius:.2*d.inner_radius}).style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("fill","#484848"),b.exit().remove()}return this},set_start_end_angle:function(){return d.startAngle,d.endAngle,"pie"==c||"donut"==c?(d.start_angle=0*(Math.PI/180),d.end_angle=360*(Math.PI/180)):("election pie"==c||"election donut"==c)&&(d.start_angle=-90*(Math.PI/180),d.end_angle=90*(Math.PI/180)),this}};return b}},PykCharts.oneD.pyramid=function(a){{var c=this;new PykCharts.Configuration.Theme({})}this.execute=function(){c=new PykCharts.oneD.processInputs(c,a,"pyramid"),"default"===c.mode&&c.k.loading(),d3.json(a.data,function(b,d){c.data=d.groupBy("oned"),c.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),c.clubData_enable=c.data.length>c.clubData_maximumNodes?c.clubData_enable:"no",c.render()})},this.refresh=function(){d3.json(a.data,function(a,b){c.data=b.groupBy("oned"),c.refresh_data=b.groupBy("oned");var d=c.k.checkChangeInData(c.refresh_data,c.compare_data);c.compare_data=d[0];var e=d[1];e&&c.k.lastUpdatedAt("liveData"),c.new_data=c.optionalFeatures().clubData(),c.optionalFeatures().createChart().label().ticks()})},this.render=function(){c.fillChart=new PykCharts.Configuration.fillChart(c),c.onHoverEffect=new PykCharts.oneD.mouseEvent(a),c.transitions=new PykCharts.Configuration.transition(c),c.border=new PykCharts.Configuration.border(c),"default"===c.mode?(c.k.title(),c.k.subtitle(),c.new_data=c.optionalFeatures().clubData(),c.optionalFeatures().svgContainer().createChart().label().ticks(),c.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip().liveData(c),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c)):"infographics"===c.mode&&(c.new_data=c.data,c.optionalFeatures().svgContainer().createChart().label(),c.k.tooltip(),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c))},this.percentageValues=function(a){c.sum=d3.sum(a,function(a){return a.weight});var b=a.map(function(a){return a.weight/c.sum*100});return b.sort(function(a,b){return b-a}),b},this.pyramidLayout=function(){var a,b,d={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},coordinates:function(){function d(a){return d3.sum(h,function(b,c){return c>=a?b:void 0})}for(var e=b[0],f=b[1],g=e/2/f,h=c.percentageValues(a),i=[],j=e*f/2,k=0;k<a.length;k++){var l=d(k),m=l/100*j,n=Math.sqrt(m/g),o=2*g*n,p=(e-o)/2;i[k]=0===k?{values:[{x:e/2,y:0},{x:p,y:n},{x:o+p,y:n}]}:{values:[i[k-1].values[1],{x:p,y:n},{x:o+p,y:n},i[k-1].values[2]]}}return i}};return d},this.optionalFeatures=function(){var d={svgContainer:function(){return $(a.selector).css("background-color",c.bg),c.svgContainer=d3.select(a.selector).append("svg").attr("width",c.width).attr("height",c.height).attr("id","svgcontainer").attr("class","svgcontainer"),c.group=c.svgContainer.append("g").attr("id","pyrgrp"),this},createChart:function(){c.pyramid=c.pyramidLayout().data(c.new_data).size([c.width,c.height]),c.coordinates=c.pyramid.coordinates(),c.coordinates[0].values[1]=c.coordinates[c.coordinates.length-1].values[1],c.coordinates[0].values[2]=c.coordinates[c.coordinates.length-1].values[2];var d=c.new_data.length-1,e=(c.new_data.length-1,[]);for(i=0;i<c.new_data.length;i++)0==i?e[i]=c.new_data[i].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.new_data[i].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.new_data[i].weight)+"<td class='tooltip-right-content'>( "+(100*c.new_data[i].weight/c.sum).toFixed(2)+"% ) </tr></table>":(e[i]=c.new_data[d].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.new_data[d].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.new_data[d].weight)+"<td class='tooltip-right-content'>( "+(100*c.new_data[d].weight/c.sum).toFixed(2)+"% ) </tr></table>",d--);var f=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y}),g=[{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height}],d=c.new_data.length;return c.chart_data=c.group.selectAll(".pyr-path").data(c.coordinates),c.chart_data.enter().append("path"),c.chart_data.attr("class","pyr-path").attr("d",function(){return f(g)}).attr("stroke",c.border.color()).attr("stroke-width",c.border.width()).attr("stroke-dasharray",c.border.style()).attr("fill",function(a,e){return 0===e?b=c.new_data[e]:(d--,b=c.new_data[d]),c.fillChart.selectColor(b)}).on("mouseover",function(b,d){c.onHoverEffect.highlight(a.selector+" .pyr-path",this),c.mouseEvent.tooltipPosition(b),c.mouseEvent.toolTextShow(e[d])}).on("mouseout",function(b){c.onHoverEffect.highlightHide(a.selector+" .pyr-path"),c.mouseEvent.tooltipHide(b)}).on("mousemove",function(a){c.mouseEvent.tooltipPosition(a)}).transition().duration(c.transitions.duration()).attr("d",function(a){return f(a.values)}),c.chart_data.exit().remove(),this},label:function(){var a=c.new_data.length,b=c.new_data.length;return c.chart_text=c.group.selectAll("text").data(c.coordinates),c.chart_text.enter().append("text"),c.chart_text.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2+10}).attr("x",function(){return c.width/2}).text("").attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",c.label_weight).style("font-size",c.label_size).attr("fill",c.label_color).style("font-family",c.label_family),setTimeout(function(){c.chart_text.text(function(b,d){return 0===d?c.k.appendUnits(c.new_data[d].weight):(a--,c.k.appendUnits(c.new_data[a].weight))}).text(function(a,d){return this.getBBox().width<a.values[2].x-a.values[1].x&&this.getBBox().height<Math.abs(a.values[1].y-a.values[0].y)?0===d?c.k.appendUnits(c.new_data[d].weight):(b--,c.k.appendUnits(c.new_data[b].weight)):""})},c.transitions.duration()),c.chart_text.exit().remove(),this},ticks:function(){PykCharts.boolean(c.overflowTicks)&&c.svgContainer.style("overflow","visible");var a=c.group.selectAll(".ticks_label").data(c.coordinates);a.enter().append("text").attr("x",0).attr("y",0).attr("class","ticks_label");var b,d,e=[],f=c.new_data.length,g=c.new_data.length;a.attr("transform",function(a){return b=3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+30:(a.values[2].x+a.values[3].x)/2+30,d=4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2,"translate("+b+","+(d+5)+")"}),a.text(""),setTimeout(function(){a.text(function(a,b){return 0===b?c.new_data[b].name:(g--,c.new_data[g].name)}).text(function(a,b){return 0===b?(e[b]=this.getBBox().height,this.getBBox().height<a.values[1].y-a.values[0].y?c.new_data[b].name:""):(e[b]=this.getBBox().height,this.getBBox().height<a.values[0].y-a.values[1].y?(f--,c.new_data[f].name):"")}).style("fill",c.ticks_color).style("font-size",c.ticks_size).style("font-family",c.ticks_family).attr("text-anchor","start")},c.transitions.duration()),a.exit().remove();var h=c.group.selectAll(".pyr-ticks").data(c.coordinates);return h.enter().append("line").attr("class","pyr-ticks"),h.attr("x1",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y1",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("x2",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y2",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("stroke-width",c.ticks_thickness).attr("stroke",c.ticks_color),setTimeout(function(){h.attr("x2",function(a,b){return Math.abs(a.values[0].y-a.values[1].y)>e[b]?3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+20:(a.values[2].x+a.values[3].x)/2+20:3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2})},c.transitions.duration()),h.exit().remove(),this},clubData:function(){if(PykCharts.boolean(c.clubData_enable)){c.displayData=[],c.sorted_weight=_.map(c.data,function(a){return a.weight}),c.sorted_weight.sort(function(a,b){return b-a}),c.checkDuplicate=[];var a,b,d={name:c.clubData_text,color:c.clubData_color,tooltip:c.clubData_tooltipText,highlight:!1};c.getIndexByName=function(a){for(b=0;b<c.data.length;b++)if(c.data[b].name==a)return b};var e=function(a){var b=_.reject(c.sorted_weight,function(b){return b==c.data[a].weight});return b};if(0!==c.clubData_alwaysIncludeDataPoints.length)for(var f=0;f<c.clubData_alwaysIncludeDataPoints.length;f++)a=c.getIndexByName(c.clubData_alwaysIncludeDataPoints[f]),void 0!=a&&(c.displayData.push(c.data[a]),c.sorted_weight=e(a));c.getIndexByWeight=function(a){for(var b=0;b<c.data.length;b++)if(c.data[b].weight!=a);else if(_.contains(c.checkDuplicate,b)===!1)return c.checkDuplicate.push(b),b};var g=c.clubData_maximumNodes-c.displayData.length;if(g>0)for(c.displayData.push(d),b=0;g-1>b;b++)a=c.getIndexByWeight(c.sorted_weight[b]),c.displayData.push(c.data[a]);var h=d3.sum(c.sorted_weight,function(a,b){return b>=g-1?a:void 0});d.weight=h}else c.displayData=c.data;return c.displayData.sort(function(a,b){return a.weight-b.weight}),c.displayData}};return d}},PykCharts.oneD.treemap=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=new PykCharts.oneD.processInputs(b,a),optional=a.optional,b.selector=a.selector,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData_enable=b.data.length>b.clubData_maximumNodes?b.clubData_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData().createChart().label()})},this.render=function(){b.fillChart=new PykCharts.Configuration.fillChart(b),b.onHoverEffect=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&(b.k.title(),b.k.subtitle()),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"infographics"===b.mode&&(b.new_data={children:b.data}),"default"===b.mode&&b.optionalFeatures().clubData(),b.optionalFeatures().svgContainer().createChart().label(),"default"===b.mode&&b.k.liveData(b).createFooter().lastUpdatedAt().credits().dataSource()},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svgContainer=d3.select(b.selector).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svgContainer.append("g").attr("id","treemap"),this},createChart:function(){b.treemap=d3.layout.treemap().sort(function(a,b){return a.weight-b.weight}).size([b.width,b.height]).value(function(a){return a.weight}).sticky(!1),b.sum=d3.sum(b.new_data.children,function(a){return a.weight});var c;return b.node=b.treemap.nodes(b.new_data),c=b.new_data.children.length,b.chart_data=b.group.selectAll(".cell").data(b.node),b.chart_data.enter().append("svg:g").attr("class","cell").append("svg:rect").attr("class","treemap-rect"),b.chart_data.attr("class","cell").select("rect").attr("class","treemap-rect").attr("id",function(a,b){return b}).attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("width",function(a){return a.dx-1}).attr("height",0).attr("fill",function(a){return a.children?"white":b.fillChart.selectColor(a)}).on("mouseover",function(c){c.children||(c.tooltip=c.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+c.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"<td class='tooltip-right-content'>(&nbsp;"+(100*c.weight/b.sum).toFixed(2)+"%&nbsp;)</tr></table>",b.onHoverEffect.highlight(a.selector+" .treemap-rect",this),b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip))}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.onHoverEffect.highlightHide(a.selector+" .treemap-rect")}).on("mousemove",function(a){a.children||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.dy-1}),b.chart_data.exit().remove(),this},label:function(){return b.chart_text=b.group.selectAll(".name").data(b.node),b.chart_text1=b.group.selectAll(".weight").data(b.node),b.chart_text.enter().append("svg:text").attr("class","name"),b.chart_text1.enter().append("svg:text").attr("class","weight"),b.chart_text.attr("class","name").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2}),b.chart_text1.attr("class","weight").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2+15}),b.chart_text.attr("text-anchor","middle").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text(""),setTimeout(function(){b.chart_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":a.name:""})},b.transitions.duration()),b.chart_text1.attr("text-anchor","middle").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text("").attr("pointer-events","none"),setTimeout(function(){b.chart_text1.text(function(a){return a.children?" ":b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":b.k.appendUnits(a.weight):""})},b.transitions.duration()),b.chart_text.exit().remove(),b.chart_text1.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData_enable)){var a=[],c=0,d=0;if(b.data.length<=b.clubData_maximumNodes)return b.new_data={children:b.data},this;if(0!==b.clubData_alwaysIncludeDataPoints.length){var e=b.clubData_alwaysIncludeDataPoints.length;for(i=0;e>i;i++)a[i]=b.clubData_alwaysIncludeDataPoints[i]}var f=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&f.push(b.data[j]);for(b.data.sort(function(a,b){return b.weight-a.weight});f.length<b.clubData_maximumNodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;f.push(b.data[d]),d++}for(j=d;j<b.data.length;j++){for(i=0;i<f.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===f[i].name.toUpperCase()&&(c+=0,j++,i=-1);j<b.data.length&&(c+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};f.length>b.clubData_maximumNodes;){f.sort(g);{f.pop()}}var h={name:b.clubData_text,weight:c,color:b.clubData_color,tooltip:b.clubData_tooltip};f.length<b.clubData_maximumNodes&&f.push(h),b.new_data={children:f}}else b.new_data={children:b.data};return this}};return c}},PykCharts.multiD={};var theme=new PykCharts.Configuration.Theme({});PykCharts.multiD.configuration=function(a){var b=this,c=new PykCharts.Configuration.fillChart(a),d={magnify:function(a,b,c){b.on("mousemove",function(){var b=d3.mouse(this);c.focus(b[0]),a.attr("x",function(a){return c(a.x)}).attr("width",function(a){return c.rangeBand(a.x)})})},checkChangeInData:function(a,c){var d=Object.keys(c[0]),e=Object.keys(a[0]),f=!1;if(b.data=a.groupBy("oned"),d.length===e.length&&c.length===a.length){for(i=0;i<a.length;i++)for(j=0;j<d.length;j++)if(a[i][e[j]]!==c[i][d[j]]||d[j]!==e[j]){console.log("changed"),f=!0;break}}else f=!0;return b.compare_data=a,[b.compare_data,f]},opacity:function(b,c,d){if(PykCharts.boolean(a.size_enable))return.6;var e=d3.scale.linear().domain(d3.extent(d,function(a){return a.weight})).range([.1,1]);return e(b?b:_.min(c))},legendsPosition:function(a){return status?a.optionalFeatures().legendsContainer().svgContainer():a.optionalFeatures().svgContainer(),this},legends:function(d,e,f,g){if(status){var h=0,i=0;if(h=d.length,i=d.length,"vertical"===a.legends_display){g.attr("height",30*d.length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,l=function(){return a.chart_width-75},m=function(){return a.chart_width-100};var j=function(a,b){return 24*b+12},k=function(a,b){return 24*b+26}}if("horizontal"===a.legends_display){g.attr("height",70),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var l=function(){return h--,a.chart_width-(100*h+75)};k=30,rect_parameter1value=13,rect_parameter2value=13;var m=function(){return i--,a.chart_width-(100*i+100)};j=18}b.legends_text=e.selectAll(".legends_text").data(d),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif"),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,l).attr(text_parameter2,k).text(function(a){return a}),b.legends_text.exit().remove(),b.legends_rect=e.selectAll(".legends_rect").data(d),b.legends_rect.enter().append("rect").attr("class","legends_rect"),b.legends_rect.attr("class","legends_rect").attr("fill",function(a,b){return c(f[b])}).attr("fill-opacity",function(b,c){return"yes"===a.saturation_enable?(c+1)/d.length:1}).attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,m).attr(rect_parameter4,j),b.legends_rect.exit().remove()}return this},legendsGroupStacked:function(b,c,d,e){if(status){var f,g,h,k=0,l=[];for(i=0;i<d.length;i++)for(j=0;j<d[i].length;j++)l[k]=d[i][j],k++;g=l.length,f=l.length,h=-1,b.attr("height",90);var m=c.selectAll(".legends_g").data(d).enter().append("g").attr("class","legends_g").attr("fill",function(){return h++,e[h]});m.selectAll(".legends_rect").data(d[h]).enter().append("rect").attr("class","legends_rect").attr("x",function(){return f--,a.chart_width-(80*f+75)}).attr("y",20).attr("height",13).attr("width",13).attr("fill-opacity",function(b,c){return"yes"===a.saturation_enable?(d[c].length-c)/d[c].length:1}),c.selectAll(".legends_text").data(l).enter().append("text").attr("class","legends_text").attr("pointer-events","none").attr("x",function(){return g--,a.chart_width-(80*g+55)}).attr("y",32).attr("fill","#1D1D1D").attr("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").text(function(a){return a})}return this},mapGroup:function(b){var c=[],d={},e=0,f=!0,g=!0;if(b.forEach(function(b){b.group?f=!0:(f=!1,b.color||(g=!1,b.color=a.colorPalette[0]))}),f){b.forEach(function(b){d[b.group]||(b.color||(b.color=a.colorPalette[e],e++),c.push(b),d[b.group]=b)});var h=[],i={};e=0,c.forEach(function(b){i[b.color]?(b.color=a.colorPalette[e],e++,h.push(b),i[b.color]=b):(h.push(b),i[b.color]=b)});for(var j=h.length,k=b.length,l=0;j>l;l++)for(var m=0;k>m;m++)b[m].group===h[l].group&&(b[m].color=h[l].color);return[h,f]}return[b,f]}};return d},PykCharts.multiD.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.multiD.bubbleSizeCalculation=function(a,b,c){var d=function(d){if(d&&PykCharts.boolean(a.size_enable)){var e=d3.scale.linear().domain(d3.extent(b,function(a){return a.weight})).range(c);return e(d)}return a.bubbleRadius};return d},PykCharts.multiD.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.multiDimensionalCharts,g=b.optional;switch(a.yAxisDataFormat=b.yAxisDataFormat?b.yAxisDataFormat:f.yAxisDataFormat,a.xAxisDataFormat=b.xAxisDataFormat?b.xAxisDataFormat:f.xAxisDataFormat,a.selector=b.selector?b.selector:"body",a.width=_.isNumber(b.chart_width)?b.chart_width:d.chart_width,a.height=_.isNumber(b.chart_height)?b.chart_height:d.chart_height,a.margin_left=b.chart_margin_left&&_.isNumber(b.chart_margin_left)?b.chart_margin_left:d.chart_margin_left,a.margin_right=b.chart_margin_left&&_.isNumber(b.chart_margin_right)?b.chart_margin_right:d.chart_margin_right,a.margin_top=b.chart_margin_top&&_.isNumber(b.chart_margin_top)?b.chart_margin_top:d.chart_margin_top,a.margin_bottom=b.chart_margin_bottom&&_.isNumber(b.chart_margin_bottom)?b.chart_margin_bottom:d.chart_margin_bottom,a.grid_xEnabled=b.chart_grid_xEnabled?b.chart_grid_xEnabled:d.chart_grid_xEnabled,a.grid_yEnabled=b.chart_grid_yEnabled?b.chart_grid_yEnabled:d.chart_grid_yEnabled,a.grid_color=b.chart_grid_color?b.chart_grid_color:d.chart_grid_color,a.mode=b.mode?b.mode:"default",b&&PykCharts.boolean(b.title_text)?(a.title_size="size"in b?b.title_size:d.title_size,a.title_color=b.title_color?b.title_color:d.title_color,a.title_weight=b.title_weight?b.title_weight:d.title_weight,a.title_family=b.title_family?g.title_family:d.title_family):(a.title_size=d.title_size,a.title_color=d.title_color,a.title_weight=d.title_weight,a.title_family=d.title_family),b&&PykCharts.boolean(b.subtitle_text)?(a.subtitle_size="subtitle_size"in b?b.subtitle_size:d.subtitle_size,a.subtitle_color=b.subtitle_color?b.subtitle_color:d.subtitle_color,a.subtitle_weight=b.subtitle_weight?b.subtitle_weight:d.subtitle_weight,a.subtitle_family=b.subtitle_family?b.subtitle_family:d.subtitle_family):(a.subtitle_size=d.subtitle_size,a.subtitle_color=d.subtitle_color,a.subtitle_weight=d.subtitle_weight,a.subtitle_family=d.subtitle_family),a.axis_onHoverHighlightenable=PykCharts.boolean(b.axis_x_enable)&&b.axis_onHoverHighlightenable?b.axis_onHoverHighlightenable:f.axis_onHoverHighlightenable,a.axis_x_enable=b.axis_x_enable?b.axis_x_enable:f.axis_x_enable,a.axis_x_orient=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_orient?b.axis_x_orient:f.axis_x_orient,a.axis_x_position=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_position?b.axis_x_position:f.axis_x_position,a.axis_x_axisColor=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_axisColor?b.axis_x_axisColor:f.axis_x_axisColor,a.axis_x_labelColor=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_labelColor?b.axis_x_labelColor:f.axis_x_labelColor,a.axis_x_no_of_ticks=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_no_of_ticks?b.axis_x_no_of_ticks:f.axis_x_no_of_ticks,a.axis_x_tickPadding=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_tickPadding?b.axis_x_tickPadding:f.axis_x_tickPadding,a.axis_x_tickSize="axis_x_tickSize"in b&&PykCharts.boolean(b.axis_x_enable)?b.axis_x_tickSize:f.axis_x_tickSize,a.axis_x_tickFormat=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_tickFormat?b.axis_x_tickFormat:f.axis_x_tickFormat,a.axis_x_tickValues=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_tickValues?b.axis_x_tickValues:f.axis_x_tickValues,a.axis_x_outer_tick_size="axis_x_outer_tick_size"in b&&PykCharts.boolean(b.axis_x_enable)?b.axis_x_outer_tick_size:f.axis_x_outer_tick_size,a.axis_y_enable=b.axis_y_enable?b.axis_y_enable:f.axis_y_enable,a.axis_y_orient=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_orient?b.axis_y_orient:f.axis_y_orient,a.axis_y_position=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_position?b.axis_y_position:f.axis_y_position,a.axis_y_axisColor=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_axisColor?b.axis_y_axisColor:f.axis_y_axisColor,a.axis_y_labelColor=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_labelColor?b.axis_y_labelColor:f.axis_y_labelColor,a.axis_y_no_of_ticks=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_no_of_ticks?b.axis_y_no_of_ticks:f.axis_y_no_of_ticks,a.axis_y_tickPadding=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_tickPadding?b.axis_y_tickPadding:f.axis_y_tickPadding,a.axis_y_tickSize="axis_y_tickSize"in b&&PykCharts.boolean(b.axis_y_enable)?b.axis_y_tickSize:f.axis_y_tickSize,a.axis_y_tickFormat=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_tickFormat?b.axis_y_tickFormat:f.axis_y_tickFormat,a.axis_y_tickValues=PykCharts.boolean(b.axis_y_enable)&&b.axis_y_tickValues?b.axis_y_tickValues:f.axis_y_tickValues,a.axis_y_outer_tick_size="axis_y_outer_tick_size"in b&&PykCharts.boolean(b.axis_y_enable)?b.axis_y_outer_tick_size:f.axis_y_outer_tick_size,a.legends_enable=b.legends_enable?b.legends_enable:f.legends_enable,a.legends_display=b.legends_display?b.legends_display:f.legends_display,a.creditMySite_name=b.creditMySite_name?b.creditMySite_name:d.creditMySite_name,a.creditMySite_url=b.creditMySite_url?b.creditMySite_url:d.creditMySite_url,a.dataSource=b.dataSource?b.dataSource:"no",a.bg=b.backgroundColor?b.backgroundColor:d.backgroundColor,a.chartColor=b.chartColor?b.chartColor:d.chartColor,a.highlightColor=b.highlightColor?b.highlightColor:d.highlightColor,a.fullscreen=b.buttons_enableFullScreen?b.buttons_enableFullScreen:d.buttons_enableFullScreen,a.loading=b.loading_animationGifUrl?b.loading_animationGifUrl:d.loading_animationGifUrl,a.realTimeCharts_refreshFrequency=b.realTimeCharts_refreshFrequency?b.realTimeCharts_refreshFrequency:e.realTimeCharts_refreshFrequency,a.realTimeCharts_enableLastUpdatedAt=b.realTimeCharts_enableLastUpdatedAt?b.realTimeCharts_enableLastUpdatedAt:e.realTimeCharts_enableLastUpdatedAt,a.transition_duration=b.transition_duration?b.transition_duration:e.transition_duration,a.saturationEnable=b.saturation_enable?b.saturation_enable:"no",a.saturationColor=b.saturationColor?b.saturationColor:d.saturationColor,a.borderBetweenChartElements_width="borderBetweenChartElements_width"in b?b.borderBetweenChartElements_width:d.borderBetweenChartElements_width,a.borderBetweenChartElements_color=b.borderBetweenChartElements_color?b.borderBetweenChartElements_color:d.borderBetweenChartElements_color,a.borderBetweenChartElements_style=b.borderBetweenChartElements_style?b.borderBetweenChartElements_style:d.borderBetweenChartElements_style,a.borderBetweenChartElements_style){case"dotted":a.borderBetweenChartElements_style="1,3";break;case"dashed":a.borderBetweenChartElements_style="5,5";break;default:a.borderBetweenChartElements_style="0"}return a.ticks_thickness="ticks_thickness"in b?b.ticks_thickness:d.ticks_thickness,a.ticks_size="ticks_size"in b?b.ticks_size:d.ticks_size,a.ticks_color=b.ticks_color?b.ticks_color:d.ticks_color,a.ticks_family=b.ticks_family?b.ticks_family:d.ticks_family,a.zoom_enable=b.zoom_enable?b.zoom_enable:f.zoom_enable,a.label_size="label_size"in b?b.label_size:d.label_size,a.label_color=b.label_color?b.label_color:d.label_color,a.label_weight=b.label_weight?b.label_weight:d.label_weight,a.label_weight="thick"===a.label_weight?"bold":"normal",a.label_family=b.label_family?b.label_family:d.label_family,a.tooltip_enable=b.tooltip_enable?b.tooltip_enable:f.tooltip_enable,a.tooltip_mode=b.tooltip_mode?b.tooltip_mode:f.tooltipmode,a.legendsText_size=b.legendsText_size?b.legendsText_size:d.legendsText_size,a.legendsText_color=b.legendsText_color?b.legendsText_color:d.legendsText_color,a.legendsText_weight=b.legendsText_weight?b.legendsText_weight:d.legendsText_weight,a.legendsText_weight="thick"===a.legendsText_weight?"bold":"normal",a.legendsText_family=b.legendsText_family?b.legendsText_family:d.legendsText_family,a.size_enable=b.size_enable?b.size_enable:f.size_enable,a.units=b.units?b.units:!1,a.colorPalette=["#b2df8a","#1f78b4","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928","#a6cee3"],a.k=new PykCharts.Configuration(a),a},PykCharts.multiD.lineChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"line"),"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;c.stylesheet,a.optional}b.enableCrossHair=a.enableCrossHair?a.enableCrossHair:d.enableCrossHair,b.curvy_lines=a.line_curvy_lines?a.line_curvy_lines:d.line_curvy_lines,b.multiple_containers_enable=a.multiple_containers_enable?a.multiple_containers_enable:d.multiple_containers_enable,b.interpolate=PykCharts.boolean(b.curvy_lines)?"cardinal":"linear",b.color_from_data=a.line_color_from_data?a.line_color_from_data:d.line_color_from_data,d3.json(a.data,function(a,c){b.data=c.groupBy("line"),b.compare_data=b.data,b.data_length=b.data.length,b.dataTransformation(),$(b.selector+" #chart-loader").remove(),b.render()})},this.dataTransformation=function(){for(b.group_arr=[],b.color_arr=[],b.new_data=[],b.legend_text=[],j=0;j<b.data_length;j++)b.group_arr[j]=b.data[j].name,b.color_arr[j]=b.data[j].color;b.uniq_group_arr=b.group_arr.slice(),b.uniq_color_arr=b.color_arr.slice(),$.unique(b.uniq_group_arr),$.unique(b.uniq_color_arr);var a=b.uniq_group_arr.length;if(PykCharts.boolean(b.group_arr[0]))for(k=0;a>k;k++)for(b.new_data[k]={name:b.uniq_group_arr[k],data:[],color:b.uniq_color_arr[k]},l=0;l<b.data_length;l++)b.uniq_group_arr[k]===b.data[l].name&&b.new_data[k].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip});else for(b.new_data[0]={name:b.data[0].name||"",data:[]},l=0;l<b.data_length;l++)b.new_data[0].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip});b.new_data_length=b.new_data.length},this.render=function(){if(b.dataLineGroup=[],b.multid=new PykCharts.multiD.configuration(b),"default"===b.mode){if(b.transitions=new PykCharts.Configuration.transition(a),b.k.title().subtitle(),PykCharts.boolean(b.multiple_containers_enable)){for(b.w=b.width/3,b.height=b.height/2,b.reducedWidth=b.w-b.margin_left-b.margin_right,b.reducedHeight=b.height-b.margin_top-b.margin_bottom,i=0;i<b.new_data_length;i++)b.k.liveData(b).makeMainDiv(b.selector,i).tooltip(!0,b.selector,i),b.new_data1=b.new_data[i],b.optionalFeature().chartType().svgContainer(i),b.k.crossHair(b.svgContainer,i),b.optionalFeature().createChart(null,i).axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale).yAxis(b.svgContainer,b.yGroup,b.yScale).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale),(i+1)%4===0&&0!==i&&b.k.emptyDiv();b.k.emptyDiv()}else b.w=b.width,b.reducedWidth=b.w-b.margin_left-b.margin_right,b.reducedHeight=b.height-b.margin_top-b.margin_bottom,b.k.liveData(b).makeMainDiv(b.selector,1).tooltip(!0,b.selector,1),b.optionalFeature().chartType().svgContainer(1),b.k.crossHair(b.svgContainer,1),b.optionalFeature().createChart().axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale).yAxis(b.svgContainer,b.yGroup,b.yScale).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale);b.k.createFooter().lastUpdatedAt().credits().dataSource()}else"infographics"===b.mode&&(b.w=b.width,b.reducedWidth=b.w-b.margin_left-b.margin_right,b.reducedHeight=b.height-b.margin_top-b.margin_bottom,b.k.liveData(b).makeMainDiv(b.selector,1),b.optionalFeature().chartType().svgContainer(1).createChart().axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale).yAxis(b.svgContainer,b.yGroup,b.yScale));b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("line"),b.data_length=b.data.length;var d=b.multid.checkChangeInData(b.data,b.compare_data);b.compare_data=d[0];var e=d[1];b.dataTransformation(),e&&(b.k.lastUpdatedAt("liveData"),b.mouseEvent.tooltipHide(null,b.multiple_containers_enable,b.type),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")),b.optionalFeature().createChart("livedata"),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale).yAxis(b.svgContainer,b.yGroup,b.yScale).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale)
})},this.optionalFeature=function(){var c={chartType:function(){for(j=0;j<b.data_length;j++)for(k=j+1;k<b.data_length;k++)if(b.data[j].x===b.data[k].x){b.type="multilineChart";break}return b.type=b.type||"lineChart",this},svgContainer:function(a){return"multilineChart"===b.type?$(b.selector).attr("class","PykCharts-twoD PykCharts-line-chart PykCharts-multi-series2D"):"lineChart"===b.type&&$(b.selector).attr("class","PykCharts-twoD PykCharts-line-chart"),$(b.selector).css({"background-color":b.bg,position:"relative"}),b.svgContainer=d3.select(b.selector+" #tooltip-svg-container-"+a).append("svg:svg").attr("id","svg-"+a).attr("width",b.w).attr("height",b.height),b.group=b.svgContainer.append("g").attr("id","chartsvg").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),PykCharts.boolean(b.grid_yEnabled)&&b.group.append("g").attr("id","ygrid").attr("class","y grid-line"),PykCharts.boolean(b.grid_xEnabled)&&b.group.append("g").attr("id","xgrid").attr("class","x grid-line"),b.clip=b.svgContainer.append("svg:clipPath").attr("id","clip").append("svg:rect").attr("width",b.reducedWidth).attr("height",b.reducedHeight),b.chartBody=b.svgContainer.append("g").attr("id","clipPath").attr("clip-path","url(#clip)").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),this},axisContainer:function(){return PykCharts.boolean(b.axis_x_enable)&&(b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis")),PykCharts.boolean(b.axis_y_enable)&&(b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(c,d){var e,f,g,h,i,j=[];if("number"===b.yAxisDataFormat?(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),i=[min,max],f=b.k._domainBandwidth(i,2),g=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("linear",f,g)):"string"===b.yAxisDataFormat?(b.new_data[0].data.forEach(function(a){f.push(a.y)}),g=[0,b.reducedHeight],b.yScale=b.k.scaleIdentification("ordinal",f,g,0)):"time"===b.yAxisDataFormat&&(f=d3.extent(b.data,function(a){return new Date(a.x)}),g=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("time",f,g)),"number"===b.xAxisDataFormat?(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),e=[min,max],j=b.k._domainBandwidth(e,2),h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("linear",j,h),b.extra_left_margin=0):"string"===b.xAxisDataFormat?(b.new_data[0].data.forEach(function(a){j.push(a.x)}),h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("ordinal",j,h,0),b.extra_left_margin=b.xScale.rangeBand()/2):"time"===b.xAxisDataFormat&&(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),j=[min,max],h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("time",j,h),b.new_data[0].data.forEach(function(a){a.x=new Date(a.x)}),b.extra_left_margin=0),b.chart_path=d3.svg.line().x(function(a){return b.xScale(a.x)}).y(function(a){return b.yScale(a.y)}).interpolate(b.interpolate),b.chartPathClass="lineChart"===b.type?"line":"multi-line","livedata"===c){if(PykCharts.boolean(b.multiple_containers_enable)){type=b.type+b.svgContainer.attr("id");for(var k=0;k<b.new_data_length;k++){{var l=d3.select(b.selector+" #svg-"+k),m=l.select("#xaxis"),n=l.select("#yaxis");l.select("#xgrid"),l.select("#ygrid")}console.log(m,"m blank");var o=type.length,p=type.substring(0,o-1);console.log(l.select(b.selector+" #"+p+k),":'("),b.k.xAxis(b.svgContainer,m,b.xScale).yAxis(b.svgContainer,n,b.yScale).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale),l.select(b.selector+" #"+p+k).datum(b.new_data[k].data).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",b.chart_path)}"multilineChart"===b.type}else for(var k=0;k<b.new_data_length;k++)type=b.type+"-svg-"+k,b.svgContainer.select(b.selector+" #"+type).datum(b.new_data[k].data).attr("d",b.chart_path),"multilineChart"===b.type;"lineChart"===b.type&&"default"===b.mode?b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")}).on("mousemove",function(){PykCharts.boolean(b.multiple_containers_enable)?b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin):(console.log(b.dataLineGroup[0].attr("id"),"help :("),b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.type,b.tooltipMode,b.color_from_data,null))}):"multilineChart"===b.type&&void 0!==b.selected_line_data&&(b.selected_line_data=b.selected_line.__data__,b.selected_line_data_len=b.selected_line_data.length,PykCharts.boolean(b.legends_enable)?b.updateSelectedLine(b.selected.id):null)}else{if(PykCharts.boolean(b.multiple_containers_enable))type=b.type+b.svgContainer.attr("id"),b.dataLineGroup[0]=b.chartBody.append("path"),console.log(b.new_data1),b.dataLineGroup[0].datum(b.new_data1.data).attr("class",b.chartPathClass).attr("id",type).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",b.chart_path),b.legend_text[0]=b.svgContainer.append("text").attr("id",type).attr("x",65).attr("y",20).style("font-size",b.legendsText_size).style("font-weight",b.legendsText_weight).style("font-family",b.legendsText_family).html(b.new_data1.name),"multilineChart"===b.type&&(PykCharts.boolean(b.color_from_data)?(b.legend_text[0].style("fill",function(){return b.new_data[d].color}),b.dataLineGroup[0].style("stroke",function(){return b.new_data[d].color})):PykCharts.boolean(b.color_from_data)||(b.legend_text[0].style("fill",function(){return b.legendsText_color}),b.dataLineGroup[0].style("stroke",b.chartColor)));else for(var k=0;k<b.new_data_length;k++)type=b.type+"-svg-"+k,b.dataLineGroup[k]=b.chartBody.append("path"),b.dataLineGroup[k].datum(b.new_data[k].data).attr("class",b.chartPathClass).attr("id",type).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",b.chart_path),b.legend_text[k]=b.svgContainer.append("text").attr("id",type).attr("class","legend-heading").style("visibility","hidden").html(b.new_data[k].name),"multilineChart"===b.type&&(PykCharts.boolean(b.color_from_data)?(b.legend_text[k].style("fill",function(){return b.new_data[k].color}),b.dataLineGroup[k].style("stroke",function(){return b.new_data[k].color}).on("click",function(){b.selected_line=d3.event.target,b.selected_line_data=b.selected_line.__data__,b.selected_line_data_len=b.selected_line_data.length,b.deselected=b.selected,d3.select(b.deselected).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.chartColor}),b.selected=this,b.color_before_selection=d3.select(b.selected).style("stroke"),d3.select(b.selected).classed({"multi-line-selected":!0,"multi-line":!1,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.highlightColor}).style("opacity",1),d3.selectAll(a.selector+" path.multi-line").style("opacity",.3),PykCharts.boolean(b.legends_enable)&&(void 0!==b.deselected?d3.select("text#"+b.deselected.id).style("visibility","hidden"):null,d3.select(b.selector+" text#"+b.selected.id).style("visibility","visible"),b.updateSelectedLine(b.selected.id))})):PykCharts.boolean(b.color_from_data)||(b.legend_text[k].style("fill",function(){return b.legendsText_color}),b.dataLineGroup[k].style("stroke",b.chartColor).on("mouseover",function(){this!==b.selected&&d3.select(this).classed({"multi-line-hover":!0,"multi-line":!1}).style("stroke","orange")}).on("mouseout",function(){this!==b.selected&&d3.select(this).classed({"multi-line-hover":!1,"multi-line":!0}).style("stroke",b.chartColor)}).on("click",function(){b.selected_line=d3.event.target,b.selected_line_data=b.selected_line.__data__,b.selected_line_data_len=b.selected_line_data.length,b.deselected=b.selected,d3.select(b.deselected).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.chartColor}),b.selected=this,b.color_before_selection=d3.select(b.selected).style("stroke"),d3.select(b.selected).classed({"multi-line-selected":!0,"multi-line":!1,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.highlightColor}),PykCharts.boolean(b.legends_enable)&&(void 0!==b.deselected?d3.select("text#"+b.deselected.id).style("visibility","hidden"):null,d3.select(b.selector+" text#"+b.selected.id).style("visibility","visible"),b.updateSelectedLine(b.selected.id))})));"lineChart"===b.type&&"default"===b.mode?b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")}).on("mousemove",function(){console.log(b.dataLineGroup[0],"that.dataLineGroup","yooo"),b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.type,b.tooltipMode,b.color_from_data,null)}):"multilineChart"===b.type&&"default"===b.mode&&b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(null,b.multiple_containers_enable,b.type),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis");for(var c=0;c<b.new_data_length;c++)$(a.selector+" #svg-"+c).trigger("mouseout")}).on("mousemove",function(){var c=[];c[0]=d3.select(a.selector+" #"+this.id+" .multi-line"),b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,c,b.extra_left_margin,b.type,b.tooltipMode,b.color_from_data,b.multiple_containers_enable);for(var d=0;d<b.new_data_length;d++)$(a.selector+" #svg-"+d).trigger("mousemove")})}return this}};return c},this.updateSelectedLine=function(a){var c=parseFloat(d3.select(b.selector+" text#"+a).style("height"))/2,d=parseFloat(d3.select(b.selector+" text#"+a).style("width"))/2,e=(b.xScale(b.selected_line_data[0].x)+b.extra_left_margin+b.margin_left,b.yScale(b.selected_line_data[0].y)+b.margin.top,b.xScale(b.selected_line_data[b.selected_line_data_len-1].x)+b.extra_left_margin+b.margin_left),f=b.yScale(b.selected_line_data[b.selected_line_data_len-1].y)+b.margin_top;"vertical"===b.legends_display?(text_x=e-b.margin_left+25,text_y=f-b.margin_top+20,text_rotate=-90):"horizontal"===b.legends_display&&(text_x=e-b.margin_left+d+30,text_y=f-b.margin_top-c+20,text_rotate=0),d3.select(b.selector+" text#"+a).attr("transform","translate("+text_x+","+text_y+") rotate("+text_rotate+")").style("font-size",b.legendsText_size).style("font-weight",b.legendsText_weight).style("font-family",b.legendsText_family)}},PykCharts.multiD.areaChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"area"),"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;c.stylesheet,a.optional}b.enableCrossHair=a.enableCrossHair?a.enableCrossHair:d.enableCrossHair,b.curvy_lines=a.line_curvy_lines?a.line_curvy_lines:d.line_curvy_lines,b.interpolate=PykCharts.boolean(b.curvy_lines)?"cardinal":"linear",b.w=b.width-b.margin_left-b.margin_right,b.h=b.height-b.margin_top-b.margin_bottom,d3.json(a.data,function(a,c){b.data=c.groupBy("area"),b.compare_data=b.data,b.data_length=b.data.length,$(b.selector+" #chart-loader").remove(),b.render()})},this.render=function(){b.dataLineGroup=[],b.dataLineGroupBorder=[],b.multid=new PykCharts.multiD.configuration(b),"default"===b.mode?(b.transitions=new PykCharts.Configuration.transition(b),b.k.title().subtitle().liveData(b).makeMainDiv(a.selector,1).tooltip(!0,a.selector,1),b.optional_feature().chartType().svgContainer(1).createChart().axisContainer(),b.k.crossHair(b.svgContainer,b.type),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale).yAxis(b.svgContainer,b.yGroup,b.yScale).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale).createFooter().lastUpdatedAt().credits().dataSource()):"infographics"===b.mode&&(b.k.liveData(b).makeMainDiv(a.selector,1),b.optional_feature().chartType().svgContainer(1).createChart().axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale).yAxis(b.svgContainer,b.yGroup,b.yScale)),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)},this.refresh=function(){d3.json(a.data,function(c,d){b.data=d.groupBy("area"),b.data_length=b.data.length;var e=b.multid.checkChangeInData(b.data,b.compare_data);b.compare_data=e[0];var f=e[1];f&&(b.k.lastUpdatedAt("liveData"),b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")),b.optional_feature().createChart("liveData"),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale).yAxis(b.svgContainer,b.yGroup,b.yScale).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale).tooltip(!0,a.selector)})},this.optional_feature=function(){var c={chartType:function(){for(j=1;j<b.data_length;j++)if(b.data[0].x===b.data[j].x){b.type="stackedAreaChart";break}return b.type=b.type||"areaChart",this},svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD PykCharts-multi-series2D PykCharts-line-chart"),$(a.selector).css({"background-color":b.bg,position:"relative"}),b.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("id","svg-"+c).attr("width",b.width).attr("height",b.height),b.group=b.svgContainer.append("g").attr("id","chartsvg").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),PykCharts.boolean(b.chart_grid_yEnabled)&&b.group.append("g").attr("id","ygrid").attr("class","y grid-line"),PykCharts.boolean(b.chart_grid_xEnabled)&&b.group.append("g").attr("id","xgrid").attr("class","x grid-line"),b.clip=b.svgContainer.append("svg:clipPath").attr("id","clip").append("svg:rect").attr("width",b.w).attr("height",b.h),b.chartBody=b.svgContainer.append("g").attr("id","clipPath").attr("clip-path","url(#clip)").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),b.stack_layout=d3.layout.stack().values(function(a){return a.data}),this},axisContainer:function(){return PykCharts.boolean(b.axis_x_enable)&&(b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis")),PykCharts.boolean(b.axis_y_enable)&&(b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(c){if(b.group_arr=[],b.color_arr=[],b.new_data=[],b.legend_text=[],"areaChart"===b.type)for(b.new_data[0]={name:b.data[0].name||"",data:[]},j=0;j<b.data_length;j++)b.new_data[0].data.push({x:b.data[j].x,y:b.data[j].y,tooltip:b.data[j].tooltip,color:b.data[j].color||""});else if("stackedAreaChart"===b.type){for(j=0;j<b.data_length;j++)b.group_arr[j]=b.data[j].name,b.color_arr[j]=b.data[j].color;b.uniq_group_arr=b.group_arr.slice(),b.uniq_color_arr=b.color_arr.slice(),$.unique(b.uniq_group_arr),$.unique(b.uniq_color_arr);var d=b.uniq_group_arr.length;for(k=0;d>k;k++)for(b.new_data[k]={name:b.uniq_group_arr[k],data:[],color:b.uniq_color_arr[k]},l=0;l<b.data_length;l++)b.uniq_group_arr[k]===b.data[l].name&&b.new_data[k].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip})}b.new_data_length=b.new_data.length,b.layers=b.stack_layout(b.new_data);var e,f,g,h,i,m=[];if("number"===b.yAxisDataFormat?(max=d3.max(b.layers,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,i=[min,max],f=b.k._domainBandwidth(i,1),g=[b.h,0],b.yScale=b.k.scaleIdentification("linear",f,g)):"string"===b.yAxisDataFormat?(b.new_data[0].data.forEach(function(a){f.push(a.y)}),g=[0,b.h],b.yScale=b.k.scaleIdentification("ordinal",f,g,0)):"time"===b.yAxisDataFormat&&(b.layers.data.forEach(function(a){a.y0=new Date(a.y0),a.y=new Date(a.y)}),max=d3.max(b.layers,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,f=[min,max],g=[b.h,0],b.yScale=b.k.scaleIdentification("time",f,g)),"number"===b.xAxisDataFormat?(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),e=[min,max],m=b.k._domainBandwidth(e,2),h=[0,b.w],b.xScale=b.k.scaleIdentification("linear",m,h),b.extra_left_margin=0):"string"===b.xAxisDataFormat?(b.new_data[0].data.forEach(function(a){m.push(a.x)}),h=[0,b.w],b.xScale=b.k.scaleIdentification("ordinal",m,h,0),b.extra_left_margin=b.xScale.rangeBand()/2):"time"===b.xAxisDataFormat&&(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),m=[min,max],h=[0,b.w],b.xScale=b.k.scaleIdentification("time",m,h),b.new_data[0].data.forEach(function(a){a.x=new Date(a.x)}),b.extra_left_margin=0),b.zoom_event=d3.behavior.zoom().y(b.yScale).scaleExtent([1,2]).on("zoom",b.zoomed),PykCharts.boolean(b.zoom_enable)&&b.svgContainer.call(b.zoom_event),b.extra_left_margin=b.xScale.rangeBand()/2,b.chart_path=d3.svg.area().x(function(a){return b.xScale(a.x)}).y0(function(a){return b.yScale(a.y0)}).y1(function(a){return b.yScale(a.y0+a.y)}).interpolate(b.interpolate),b.chart_path_border=d3.svg.line().x(function(a){return b.xScale(a.x)}).y(function(a){return b.yScale(a.y0+a.y)}).interpolate(b.interpolate),b.chartPathClass="areaChart"===b.type?"area":"stacked-area","liveData"===c){for(var n=0;n<b.new_data_length;n++)type=b.chartPathClass+n,b.svgContainer.select("#"+type).datum(b.layers[n].data).attr("d",b.chart_path),b.svgContainer.select("#border-stacked-area"+n).datum(b.layers[n].data).attr("d",b.chart_path_border);"areaChart"===b.type&&b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(type),b.mouseEvent.axisHighlightHide(a.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(a.selector+" .y.axis")}).on("mousemove",function(){console.log(b.svgContainer.select("#"+type),"no no no"),b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.type,b.tooltip_mode)})}else{for(var n=0;n<b.new_data_length;n++)type=b.chartPathClass+n,b.dataLineGroup[n]=b.chartBody.append("path"),b.dataLineGroup[n].datum(b.layers[n].data).attr("class",b.chartPathClass).attr("id",type).style("fill",function(){return""!==b.new_data[n].color?b.new_data[n].color:b.chartColor}).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",b.chart_path),b.dataLineGroupBorder[n]=b.chartBody.append("path"),b.dataLineGroupBorder[n].datum(b.layers[n].data).attr("class","area-border").attr("id","border-stacked-area"+n).style("stroke",b.borderBetweenChartElements_color).style("stroke-width",b.borderBetweenChartElements_width).style("stroke-dasharray",b.borderBetweenChartElements_style).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",b.chart_path_border);"areaChart"===b.type?b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(a.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(a.selector+" .y.axis")}).on("mousemove",function(){b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.type,b.tooltip_mode)}):"stackedAreaChart"===b.type}return this}};return c},this.zoomed=function(){for(b.k.isOrdinal(b.svgContainer,".x.axis",b.xScale),b.k.isOrdinal(b.svgContainer,".x.grid",b.xScale),b.k.isOrdinal(b.svgContainer,".y.axis",b.yScale),b.k.isOrdinal(b.svgContainer,".y.grid",b.yScale),i=0;i<b.new_data_length;i++)type=b.chartPathClass+i,b.svgContainer.select(b.selector+" #"+type).attr("class",b.chartPathClass).attr("d",b.chart_path),b.svgContainer.select(b.selector+" #border-stacked-area"+i).attr("class","area-border").attr("d",b.chart_path_border)}},PykCharts.multiD.barChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});return this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"column"),b.grid_yEnabled=a.chart_grid_yEnabled?a.chart_grid_yEnabled:c.stylesheet.chart_grid_yEnabled,b.grid_color=a.chart_grid_color?a.chart_grid_color:c.stylesheet.chart_grid_color,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(a,c){b.data=c.groupBy("bar"),b.compare_data=c.groupBy("bar"),$(b.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("bar"),b.refresh_data=c.groupBy("bar");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var f=b.flattenData();b.the_bars=f[0],b.the_keys=f[1],b.the_layers=b.buildLayers(b.the_bars),1===b.no_of_groups&&(b.legends_enable="no"),b.optionalFeatures().createChart().legends().ticks(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale)})},this.render=function(){var b=this;b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var c=b.flattenData();b.the_bars=c[0],b.the_keys=c[1],b.the_layers=b.buildLayers(b.the_bars),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.multiD.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),b.border=new PykCharts.Configuration.border(b),1===b.no_of_groups&&(b.legends_enable="no"),"default"===b.mode?(b.k.title().subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().legendsContainer(1).svgContainer(1),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createChart().legends().axisContainer().ticks(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale)):"infographics"===b.mode&&(b.k.makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).createChart().axisContainer(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale))},this.optionalFeatures=function(){var b=this,c={svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD"),b.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer").style("background-color",b.bg),b.group=b.svgContainer.append("g").attr("id","svggroup").attr("class","svggroup").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),this},legendsContainer:function(c){return PykCharts.boolean(b.legends_enable)&&(b.legendsContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",50).attr("class","legendscontainer").attr("id","legendscontainer"),b.legendsGroup=b.legendsContainer.append("g").attr("id","legends").attr("class","legends").attr("transform","translate(0,10)")),this},axisContainer:function(){if(PykCharts.boolean(b.axis_y_enable)){var a=b.group.selectAll(".axis-line").data(["line"]);a.enter().append("line"),a.attr("class","axis-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",b.height-b.margin_top-b.margin_bottom).attr("stroke",b.axis_x_axisColor).attr("stroke-width","1px"),a.exit().remove(),b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis"),"right"===b.axis_y_position&&a.attr("x1",b.width-b.margin_left-b.margin_right).attr("x2",b.width-b.margin_left-b.margin_right)}return PykCharts.boolean(b.axis_x_enable)&&(b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis")),this},createChart:function(){{var c=b.width-b.margin_left-b.margin_right,d=b.no_of_groups+1,e=b.height-b.margin_top-b.margin_bottom,f=b.the_bars;b.the_keys}b.layers=b.the_layers;var g=b.getGroups();b.stack_layout=d3.layout.stack().values(function(a){return a.values})(b.layers),b.layers=b.layers.map(function(a){return{name:a.name,values:a.values.map(function(a){return{x:a.y,y:a.x,x0:a.y0,tooltip:a.tooltip?a.tooltip:a.y,color:a.color,group:a.group,name:a.name,highlight:a.highlight}})}});var h=[];b.layers.map(function(a,b){for(b in a.values){var c=a.values[b];h.push(c.x+c.x0)}}),b.yScale=d3.scale.ordinal().domain(f.map(function(a,b){return a.id||b})).rangeBands([0,e]);var i=[0,d3.max(h)];b.xScale=d3.scale.linear().domain(b.k._domainBandwidth(i,1)).range([0,c]);var j=[];for(var k in g){var l=g[k],m=b.yScale(l[0]),n=b.yScale.rangeBand()*l.length;m+=n/2,j.push({y:m,name:k})}b.y0=d3.scale.ordinal().domain(j.map(function(a){return a.name})).rangeRoundBands([0,e],.1),b.y1=d3.scale.ordinal().domain(b.barName.map(function(a){return a})).rangeRoundBands([0,b.y0.rangeBand()]),b.y_factor=0,b.height_factor=0,1===b.no_of_groups&&(b.y_factor=b.yScale.rangeBand()/4,b.height_factor=b.yScale.rangeBand()/(2*b.no_of_groups)),b.bars=b.group.selectAll(".bars").data(b.layers),b.bars.enter().append("g").attr("class","bars");var o=b.bars.selectAll("rect").data(function(a){return a.values});o.enter().append("svg:rect").attr("class","rect"),o.attr("width",0).attr("x",0).attr("fill",function(a){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a){return PykCharts.boolean(b.saturationEnable)?a.highlight?(d--,1):d>1?(d--,d/b.no_of_groups):(d=b.no_of_groups+1,d--,d/b.no_of_groups):void 0}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).attr("stroke-opacity",1).on("mouseover",function(c){b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip?c.tooltip:c.y),b.mouseEvent.axisHighlightShow(c.name,a.selector+" .axis-text","bar")}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.mouseEvent.axisHighlightHide(a.selector+" .axis-text","bar")}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}),o.attr("x",function(a){return b.xScale(a.x0)}).attr("width",function(a){return b.xScale(a.x)}).attr("height",function(){return b.yScale.rangeBand()+b.height_factor}).attr("y",function(a){return b.yScale(a.y)-b.y_factor}),b.bars.exit().remove();var p=b.group.selectAll("text.axis-text").data(j);return p.enter().append("text"),p.attr("class","axis-text").attr("y",function(a){return a.y}).attr("x",function(){return-10}).attr("fill",b.axis_y_labelColor).text(function(a){return a.name}),"right"===b.axis_y_position&&p.attr("x",function(){return b.width-b.margin_left-b.margin_right+10}),"left"===b.axis_y_position&&"right"===b.axis_y_orient&&p.attr("x",function(){return 10}),"right"===b.axis_y_position&&"left"===b.axis_y_orient&&p.attr("x",function(){return b.width-b.margin_left-b.margin_right-10}),"right"===b.axis_y_orient?p.attr("text-anchor","start"):"left"===b.axis_y_orient&&p.attr("text-anchor","end"),p.exit().remove(),this},ticks:function(){if(b.ticks_size){b.txt_width,b.txt_height,b.ticksElement=b.bars.selectAll("g").data(b.layers);var a=b.bars.selectAll(".ticksText").data(function(a){return a.values});a.enter().append("text").attr("class","ticksText"),a.attr("class","ticksText").text(function(a){return a.x?a.x:void 0}).style("font-weight",b.ticks_weight).style("font-size",b.ticks_size).attr("fill",b.ticks_color).style("font-family",b.ticks_family).text(function(a){return a.x&&(b.txt_width=this.getBBox().width,b.txt_height=this.getBBox().height,a.x&&b.txt_width<b.xScale(a.x)&&b.txt_height<b.yScale.rangeBand()+b.height_factor)?a.x:void 0}).attr("x",function(a){b.xScale(a.x);return b.xScale(a.x0)+b.xScale(a.x)+5}).attr("y",function(a){return b.yScale(a.y)-b.y_factor+b.yScale.rangeBand()/2}).attr("dy",function(){return 1===b.no_of_groups?b.yScale.rangeBand()/2:b.yScale.rangeBand()/4}).style("font-size",function(){return b.ticks_size}),a.exit().remove()}return this},legends:function(){if(PykCharts.boolean(b.legends_enable)){var a,c=b.getParameters();a=c[0].color,c=c.map(function(a){return a.name}),c=jQuery.unique(c);var d=0,e=0;if(d=c.length,e=c.length,"vertical"===b.legends_display){b.legendsContainer.attr("height",30*c.length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,h=function(){return b.width-b.width/4+16},i=function(){return b.width-b.width/4};var f=function(a,b){return 24*b+12},g=function(a,b){return 24*b+23}}else if("horizontal"===b.legends_display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var h=function(){return d--,b.width-(100*d+75)};g=30,rect_parameter1value=13,rect_parameter2value=13;var i=function(){return e--,b.width-(100*e+100)};f=18}var j=b.legendsGroup.selectAll("rect").data(c);j.enter().append("rect"),j.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,i).attr(rect_parameter4,f).attr("fill",function(){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a,c){return PykCharts.boolean(b.saturationEnable)?(b.no_of_groups-c)/b.no_of_groups:void 0}),j.exit().remove(),b.legends_text=b.legendsGroup.selectAll(".legends_text").data(c),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("font-size",12),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,h).attr(text_parameter2,g).text(function(a){return a}),b.legends_text.exit().remove()}return this}};return c},this.getGroups=function(){var a={};for(var c in b.the_bars){var d=b.the_bars[c];d.id&&(a[d.group]?a[d.group].push(d.id):a[d.group]=[d.id])}return a},this.buildLayers=function(a){function c(a){for(var b in e){var c=e[b];if(c.name==a)return c}return d(a)}function d(a){var b={name:a,values:[]};return e.push(b),b}var e=[];for(var f in a){var g=a[f];if(g.id){var h=g.id;for(var i in g)if("id"!==i){var j=g[i];for(var k in j){var l=j[k];if(l.name){var m=c(l.name);m.values.push({x:h,y:l.val,color:l.color,tooltip:l.tooltip,highlight:l.highlight,group:b.keys[h],name:g.group})}}}}}return e},this.flattenData=function(){var a=[-1];b.keys={};for(var c in b.data){var d=b.data[c];for(var e in d){for(var f in d[e]){var g="i"+c+"j"+f;if("object"==typeof d[e][f]){var h=Object.keys(d[e][f])[0];b.keys[g]=h,d[e][f].id=g,d[e][f].group=e,a.push(d[e][f])}}a.push(c)}}return[a,b.keys]},this.getParameters=function(){var c=[];for(var d in b.the_layers)if(b.the_layers[d].name){var e,f=b.the_layers[d].name;for(var g in b.the_layers[d].values)if(PykCharts.boolean(b.the_layers[d].values[g].y)){var e,f=b.the_layers[d].values[g].group;a.optional&&a.optional.colors?a.optional.colors.chartColor?e=b.chartColor:b.the_layers[d].values[0].color&&(e=b.the_layers[d].values[0].color):e=b.chartColor,c.push({name:f,color:e})}}return c},this.emptygroups=function(a){b.no_of_groups=d3.max(a,function(a){var b=_.values(a);return b[0].length});_.map(a,function(c,d){for(var e=_.values(c);e[0].length<b.no_of_groups;){var f=_.keys(c),g={name:"stack",tooltip:"null",color:"white",val:0,highlight:!1},h={group3:[g]};a[d][f[0]].push(h),e=_.values(c)}});return a},this.dataTransformation=function(){var a=[];b.barName=[];var c=b.data.length;b.data.sort(function(a,b){return b.x-a.x});for(var d=0;c>d;d++){var e,f={},g={};if(b.data[d].group||(b.data[d].group="group"+d),b.data[d].stack||(b.data[d].stack="stack"),b.barName[d]=b.data[d].group,f[b.data[d].y]=[],g[b.data[d].group]=[],e={name:b.data[d].stack,tooltip:b.data[d].tooltip,color:b.data[d].color,val:b.data[d].x,highlight:b.data[d].highlight},0===d)a.push(f),a[d][b.data[d].y].push(g),a[d][b.data[d].y][d][b.data[d].group].push(e);else{var h=a.length,i=0;for(i=0;h>i;i++)if(_.has(a[i],b.data[d].y)){var j=a[i][b.data[d].y],k=j.length,l=0;for(l=0;k>l&&!_.has(a[i][b.data[d].y][l],b.data[d].group);l++);k>l?a[i][b.data[d].y][l][b.data[d].group].push(e):(a[i][b.data[d].y].push(g),a[i][b.data[d].y][l][b.data[d].group].push(e));
break}i===h&&(a.push(f),a[i][b.data[d].y].push(g),a[i][b.data[d].y][0][b.data[d].group].push(e))}}return b.barName=_.unique(b.barName),a},this},PykCharts.multiD.columnChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});return this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"column"),b.grid_yEnabled=a.chart_grid_yEnabled?a.chart_grid_yEnabled:c.stylesheet.chart_grid_yEnabled,b.grid_color=a.chart_grid_color?a.chart_grid_color:c.stylesheet.chart_grid_color,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(a,c){b.data=c.groupBy("column"),b.compare_data=c.groupBy("column"),$(b.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("column"),b.refresh_data=c.groupBy("column");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var f=b.flattenData();b.the_bars=f[0],b.the_keys=f[1],b.the_layers=b.buildLayers(b.the_bars),1===b.no_of_groups&&(b.legends_enable="no"),b.optionalFeatures().createChart().legends(),b.k.yAxis(b.svgContainer,b.yGroup,b.yScaleInvert).yGrid(b.svgContainer,b.group,b.yScaleInvert)})},this.render=function(){var b=this;b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var c=b.flattenData();b.the_bars=c[0],b.the_keys=c[1],b.the_layers=b.buildLayers(b.the_bars),b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.multiD.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),1===b.no_of_groups&&(b.legends_enable="no"),"default"===b.mode?(b.k.title().subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().legendsContainer(1).svgContainer(1),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createChart().legends().axisContainer(),b.k.yAxis(b.svgContainer,b.yGroup,b.yScaleInvert).yGrid(b.svgContainer,b.group,b.yScaleInvert)):"infographics"===b.mode&&(b.k.makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).createChart().axisContainer(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.k.yAxis(b.svgContainer,b.ygroup,b.yScaleInvert))},this.optionalFeatures=function(){var b=this,c={svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD"),b.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer").style("background-color",b.bg),b.group=b.svgContainer.append("g").attr("id","svggroup").attr("class","svggroup").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),PykCharts.boolean(b.grid_yEnabled)&&b.group.append("g").attr("id","ygrid").style("stroke",b.grid_color).attr("class","y grid-line"),this},legendsContainer:function(c){return PykCharts.boolean(b.legends_enable)&&(b.legendsContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",50).attr("class","legendscontainer").attr("id","legendscontainer"),b.legendsGroup=b.legendsContainer.append("g").attr("id","legends").attr("class","legends").attr("transform","translate(0,10)")),this},axisContainer:function(){if(PykCharts.boolean(b.axis_x_enable)){var a=b.group.selectAll(".axis-line").data(["line"]);a.enter().append("line"),a.attr("class","axis-line").attr("x1",0).attr("y1",b.height-b.margin_top-b.margin_bottom).attr("x2",b.width-b.margin_left-b.margin_right).attr("y2",b.height-b.margin_top-b.margin_bottom).attr("stroke",b.axis_x_axisColor),"top"===b.axis_x_position&&a.attr("y1",0).attr("y2",0),a.exit().remove(),b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis").style("stroke","none")}return PykCharts.boolean(b.axis_y_enable)&&(b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(){var c=b.width-b.margin_left-b.margin_right,d=b.height-b.margin_top-b.margin_bottom,e=b.no_of_groups+1,f=b.the_bars,g=(b.the_keys,b.the_layers),h=b.getGroups();b.stack_layout=d3.layout.stack().values(function(a){return a.values})(g);var i=[];g.map(function(a,b){for(b in a.values){var c=a.values[b];i.push(c.y+c.y0)}}),b.xScale=d3.scale.ordinal().domain(f.map(function(a,b){return a.id||b})).rangeBands([0,c],.1),y_domain=[0,d3.max(i)],y_domain=b.k._domainBandwidth(y_domain,1),b.yScale=d3.scale.linear().domain(y_domain).range([0,d]),b.yScaleInvert=d3.scale.linear().domain([y_domain[1],y_domain[0]]).range([0,d]);var j,k,l,m,n=(d3.scale.category10(),[]),o=0,p=0;1===b.no_of_groups&&(o=b.xScale.rangeBand()/4,p=b.xScale.rangeBand()/(2*b.no_of_groups));for(m in h)j=h[m],k=b.xScale(j[0]),l=b.xScale.rangeBand()*j.length,k+=l/2,n.push({x:k,name:m});var q=b.group.selectAll(".bars").data(g);q.attr("class","bars"),q.enter().append("g").attr("class","bars");var r=q.selectAll("rect").data(function(a){return a.values});r.enter().append("svg:rect").attr("class","rect"),r.attr("height",0).attr("y",d).attr("fill",function(a){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a){return PykCharts.boolean(b.saturationEnable)?a.highlight?(e--,1):e>1?(e--,e/b.no_of_groups):(e=b.no_of_groups+1,e--,e/b.no_of_groups):void 0}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).attr("stroke-opacity",1).on("mouseover",function(c){b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip?c.tooltip:c.y),b.mouseEvent.axisHighlightShow(c.name,a.selector+" .axis-text","column")}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.mouseEvent.axisHighlightHide(a.selector+" .axis-text","column")}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}),r.attr("x",function(a){return b.xScale(a.x)-o}).attr("width",function(){return b.xScale.rangeBand()+p}).attr("height",function(a){return b.yScale(a.y)}).attr("y",function(a){return d-b.yScale(a.y0+a.y)}),q.exit().remove();var s=b.group.selectAll("text.axis-text").data(n);return s.enter().append("text"),s.attr("class","axis-text").attr("x",function(a){return a.x}).attr("text-anchor","middle").attr("fill",b.axis_x_labelColor).text(function(a){return a.name}),s.exit().remove(),"top"===b.axis_x_position&&("top"===b.axis_x_orient?s.attr("y",function(){return-15}):"bottom"===b.axis_x_orient&&s.attr("y",function(){return 15})),"top"===b.axis_x_orient?s.attr("y",function(){return d-15}):"bottom"===b.axis_x_orient&&s.attr("y",function(){return d+15}),this},legends:function(){if(PykCharts.boolean(b.legends_enable)){var a,c=b.getParameters();a=c[0].color,c=c.map(function(a){return a.name}),c=jQuery.unique(c);var d=0,e=0;if(d=c.length,e=c.length,"vertical"===b.legends_display){b.legendsContainer.attr("height",30*c.length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,h=function(){return b.width-b.width/4+16},i=function(){return b.width-b.width/4};var f=function(a,b){return 24*b+12},g=function(a,b){return 24*b+23}}else if("horizontal"===b.legends_display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var h=function(){return d--,b.width-(100*d+75)};g=30,rect_parameter1value=13,rect_parameter2value=13;var i=function(){return e--,b.width-(100*e+100)};f=18}var j=b.legendsGroup.selectAll("rect").data(c);j.enter().append("rect"),j.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,i).attr(rect_parameter4,f).attr("fill",function(){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a,c){return PykCharts.boolean(b.saturationEnable)?(b.no_of_groups-c)/b.no_of_groups:void 0}),j.exit().remove(),b.legends_text=b.legendsGroup.selectAll(".legends_text").data(c),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("font-size",12),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,h).attr(text_parameter2,g).text(function(a){return a}),b.legends_text.exit().remove()}return this}};return c},this.getGroups=function(){var a={};for(var c in b.the_bars){var d=b.the_bars[c];d.id&&(a[d.group]?a[d.group].push(d.id):a[d.group]=[d.id])}return a},this.buildLayers=function(a){function c(a){for(var b in e){var c=e[b];if(c.name==a)return c}return d(a)}function d(a){var b={name:a,values:[]};return e.push(b),b}var e=[];for(var f in a){var g=a[f];if(g.id){var h=g.id;for(var i in g)if("id"!==i){var j=g[i];for(var k in j){var l=j[k];if(l.name){var m=c(l.name);m.values.push({x:h,y:l.val,color:l.color,tooltip:l.tooltip,group:b.keys[h],name:g.group,highlight:l.highlight})}}}}}return e},this.flattenData=function(){var a=[-1];b.keys={};for(var c in b.data){var d=b.data[c];for(var e in d){for(var f in d[e]){var g="i"+c+"j"+f;if("object"==typeof d[e][f]){var h=Object.keys(d[e][f])[0];b.keys[g]=h,d[e][f].id=g,d[e][f].group=e,a.push(d[e][f])}}a.push(c)}}return[a,b.keys]},this.getParameters=function(){var c=[];for(var d in b.the_layers)if(b.the_layers[d].name)for(var e in b.the_layers[d].values)if(PykCharts.boolean(b.the_layers[d].values[e].y)){var f,g=b.the_layers[d].values[e].group;a.optional&&a.optional.colors?a.optional.colors.chartColor?f=b.chartColor:b.the_layers[d].values[0].color&&(f=b.the_layers[d].values[0].color):f=b.chartColor,c.push({name:g,color:f})}return c},this.emptygroups=function(a){b.no_of_groups=d3.max(a,function(a){var b=_.values(a);return b[0].length});_.map(a,function(c,d){for(var e=_.values(c);e[0].length<b.no_of_groups;){var f=_.keys(c),g={name:"stack",tooltip:"null",color:"white",val:0,highlight:!1},h={group3:[g]};a[d][f[0]].push(h),e=_.values(c)}});return a},this.dataTransformation=function(){var a=[];b.barName=[];var c=b.data.length;b.data.sort(function(a,b){return b.y-a.y});for(var d=0;c>d;d++){var e,f={},g={};if(b.data[d].group||(b.data[d].group="group"+d),b.data[d].stack||(b.data[d].stack="stack"),b.barName[d]=b.data[d].group,f[b.data[d].x]=[],g[b.data[d].group]=[],e={name:b.data[d].stack,tooltip:b.data[d].tooltip,color:b.data[d].color,val:b.data[d].y,highlight:b.data[d].highlight},0===d)a.push(f),a[d][b.data[d].x].push(g),a[d][b.data[d].x][d][b.data[d].group].push(e);else{var h=a.length,i=0;for(i=0;h>i;i++)if(_.has(a[i],b.data[d].x)){var j=a[i][b.data[d].x],k=j.length,l=0;for(l=0;k>l&&!_.has(a[i][b.data[d].x][l],b.data[d].group);l++);k>l?a[i][b.data[d].x][l][b.data[d].group].push(e):(a[i][b.data[d].x].push(g),a[i][b.data[d].x][l][b.data[d].group].push(e));break}i===h&&(a.push(f),a[i][b.data[d].x].push(g),a[i][b.data[d].x][0][b.data[d].group].push(e))}}return b.barName=_.unique(b.barName),a},this},PykCharts.multiD.scatterPlot=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"scatterplot"),"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;c.stylesheet,a.optional}b.multiD=new PykCharts.multiD.configuration(b),b.multiple_containers_enable=a.multiple_containers_enable&&a.multiple_containers_enable?a.multiple_containers_enable:d.multiple_containers_enable,b.bubbleRadius=a.scatterplot_radius&&_.isNumber(a.scatterplot_radius)?a.scatterplot_radius:d.scatterplot_radius,b.enableTicks=a.scatterplot_ticks&&_.isNumber(a.scatterplot_ticks)?a.scatterplot_ticks:d.scatterplot_ticks,b.zoomed_out=!0,b.radius_range=PykCharts.boolean(b.multiple_containers_enable)?[2*b.k._radiusCalculation(1.1),2*b.k._radiusCalculation(2.6)]:[2*b.k._radiusCalculation(4.5),2*b.k._radiusCalculation(11)],d3.json(a.data,function(c,d){b.data=d.groupBy("scatterplot"),b.compare_data=d.groupBy("scatterplot"),$(b.selector+" #chart-loader").remove();var e=new PykCharts.multiD.scatterplotFunction(a,b,"scatterplot");e.render()})}},PykCharts.multiD.pulse=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"pulse"),"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;c.stylesheet,a.optional}b.multiD=new PykCharts.multiD.configuration(b),b.multiple_containers_enable=a.multiple_containers_enable&&a.multiple_containers_enable?a.multiple_containers_enable:d.multiple_containers_enable,b.bubbleRadius=a.scatterplot_radius&&_.isNumber(a.scatterplot_radius)?a.scatterplot_radius:d.scatterplot_radius,b.enableTicks=a.scatterplot_ticks&&_.isNumber(a.scatterplot_ticks)?a.scatterplot_ticks:d.scatterplot_ticks,b.zoomed_out=!0,b.radius_range=[2*b.k._radiusCalculation(1.1),2*b.k._radiusCalculation(3.5)],d3.json(a.data,function(c,d){b.data=d.groupBy("pulse"),b.compare_data=d.groupBy("pulse"),$(b.selector+" #chart-loader").remove();var e=new PykCharts.multiD.scatterplotFunction(a,b,"pulse");e.render()})}},PykCharts.multiD.scatterplotFunction=function(a,b,c){function d(){e.zoomed_out=!1,e.optionalFeatures().plotCircle().label(),d3.select(e.selector+" #"+this.id).selectAll(".dot").attr("r",function(a){return e.sizes(a.weight)*d3.event.scale})}var e=b;e.refresh=function(){d3.json(a.data,function(a,b){e.data=b.groupBy("scatterplot"),e.refresh_data=b.groupBy("scatterplot");var c=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=c[0];var d=c[1];d&&e.k.lastUpdatedAt("liveData"),e.map_group_data=e.multiD.mapGroup(e.data),e.optionalFeatures().createChart().legends().label().ticks()})},this.render=function(){if(e.map_group_data=e.multiD.mapGroup(e.data),e.fillChart=new PykCharts.Configuration.fillChart(e),e.border=new PykCharts.Configuration.border(e),"default"===e.mode){if(e.k.title().subtitle(),e.uniq_group_arr=jQuery.unique(e.data.map(function(a){return a.group})),e.no_of_groups=1,PykCharts.boolean(e.multiple_containers_enable)&&"scatterplot"===c){for(e.no_of_groups=e.uniq_group_arr.length,e.w=e.width/4,e.height=e.height/2,e.margin_left=e.margin_left,e.margin_right=e.margin_right,i=0;i<e.no_of_groups;i++){for(e.new_data=[],j=0;j<e.data.length;j++)e.data[j].group===e.uniq_group_arr[i]&&e.new_data.push(e.data[j]);e.k.positionContainers(e.legends_enable,e),e.k.makeMainDiv(e.selector,i),e.optionalFeatures().legendsContainer(i).svgContainer(i),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().createChart().legends(i).label().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x).yAxis(e.svgContainer,e.yGroup,e.yScale),(i+1)%4===0&&0!==i&&e.k.emptyDiv()}e.k.emptyDiv()}else e.w=e.width,e.new_data=e.data,e.k.makeMainDiv(e.selector,1),e.optionalFeatures().legendsContainer(1).svgContainer(1),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().createChart().legends().label().zoom().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x).yAxis(e.svgContainer,e.yGroup,e.yScale);e.k.createFooter().lastUpdatedAt().credits().dataSource(),e.optionalFeatures().zoom()}else"infographics"===e.mode&&(e.radius_range=[7,18],e.new_data=e.data,e.w=e.width,e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.k.tooltip().makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(1),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().createChart(),e.k.xAxis(e.svgContainer,e.xGroup,e.x).yAxis(e.svgContainer,e.yGroup,e.yScale))},e.optionalFeatures=function(){var b={svgContainer:function(b){return $(a.selector+" #tooltip-svg-container-"+b).css("width",e.w),$(a.selector).attr("class","PykCharts-weighted"),e.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("width",e.w).attr("height",e.height).attr("id","svgcontainer"+b).attr("class","svgcontainer").style("background-color",e.bg),e.group=e.svgContainer.append("g").attr("transform","translate("+e.margin_left+","+e.margin_top+")").attr("id","main"),e.ticksElement=e.svgContainer.append("g").attr("transform","translate("+e.margin_left+","+e.margin_top+")").attr("id","main2"),PykCharts.boolean(e.axis_x_enable)&&(e.xGroup=e.group.append("g").attr("class","x axis").style("stroke","black")),PykCharts.boolean(e.axis_y_enable)&&(e.yGroup=e.group.append("g").attr("class","y axis").style("stroke","blue")),e.clip=e.group.append("svg:clipPath").attr("id","clip").append("svg:rect").attr("width",e.w-e.margin_left-e.margin_right).attr("height",e.height-e.margin_top-e.margin_bottom),e.chartBody=e.group.append("g").attr("clip-path","url(#clip)"),this},legendsContainer:function(a){return PykCharts.boolean(e.legends_enable)&&PykCharts.boolean(e.size_enable)&&e.map_group_data[1]&&(e.legendsContainer=d3.select(e.selector+" #tooltip-svg-container-"+a).append("svg").attr("width",e.w).attr("height",50).attr("class","legends").attr("id","legendscontainer"),e.legendsGroup=e.legendsContainer.append("g").attr("id","legends").attr("transform","translate(0,20)")),this},createChart:function(){if(e.weight=_.map(e.new_data,function(a){return a.weight}),e.weight=_.reject(e.weight,function(a){return 0==a}),e.sorted_weight=e.weight.slice(0),e.sorted_weight.sort(function(a,b){return a-b}),e.group.append("text").attr("fill","black").attr("text-anchor","end").attr("x",e.w-70).attr("y",e.height+40),e.zoomed_out===!0){var a,b,c,f,g=[],h=[];"number"===e.yAxisDataFormat?(f=d3.extent(e.data,function(a){return a.y}),h=e.k._domainBandwidth(f,2,function(){var a=d3.scale.linear().range([e.height-e.margin_top-e.margin_bottom,0]).domain(f);return yinvert=a.invert(e.radius_range[1]),yinvert=f[1]-yinvert}),b=[e.height-e.margin_top-e.margin_bottom,0],e.yScale=e.k.scaleIdentification("linear",h,b),e.extra_top_margin=0):"string"===e.yAxisDataFormat?(e.data.forEach(function(a){h.push(a.y)}),b=[0,e.height-e.margin_top-e.margin_bottom],e.yScale=e.k.scaleIdentification("ordinal",h,b,0),e.extra_top_margin=e.yScale.rangeBand()/2):"time"===e.yAxisDataFormat&&(h=d3.extent(e.data,function(a){return new Date(a.x)}),b=[e.height-e.margin_top-e.margin_bottom,0],e.yScale=e.k.scaleIdentification("time",h,b),e.extra_top_margin=0),"number"===e.xAxisDataFormat?(a=d3.extent(e.data,function(a){return a.x}),g=e.k._domainBandwidth(a,2,function(){var b=d3.scale.linear().range([0,e.w-e.margin_left-e.margin_right]).domain(a);return xinvert=b.invert(e.radius_range[1]),xinvert=a[1]-xinvert}),c=[0,e.w-e.margin_left-e.margin_right],e.x=e.k.scaleIdentification("linear",g,c),e.extra_left_margin=0):"string"===e.xAxisDataFormat?(e.data.forEach(function(a){g.push(a.x)}),c=[0,e.w-e.margin_left-e.margin_right],e.x=e.k.scaleIdentification("ordinal",g,c,0),e.extra_left_margin=e.x.rangeBand()/2):"time"===e.xAxisDataFormat&&(max=d3.max(e.data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),min=d3.min(e.data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),g=[min,max],c=[0,e.w-e.margin_left-e.margin_right],e.x=e.k.scaleIdentification("time",g,c),e.new_data[0].data.forEach(function(a){a.x=new Date(a.x)}),e.extra_left_margin=0),PykCharts.boolean(e.zoom_enable)&&"string"!==e.yAxisDataFormat&&"string"!==e.xAxisDataFormat&&"default"===e.mode&&e.svgContainer.call(d3.behavior.zoom().x(e.x).y(e.yScale).scaleExtent([1,10]).on("zoom",d)),e.optionalFeatures().plotCircle()}return this},legends:function(a){if(PykCharts.boolean(e.legends_enable)&&PykCharts.boolean(e.size_enable)&&e.map_group_data[1]){var b=(_.uniq(e.sorted_weight),0),c=0;if("vertical"===e.legends_display){e.legendsContainer.attr("height",30*e.map_group_data[0].length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,g=function(){return e.w-e.w/4+16},h=function(){return e.w-e.w/4};var d=function(a,b){return 24*b+12},f=function(a,b){return 24*b+23}}else if("horizontal"===e.legends_display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",b=0,c=0;var g=function(a,b){return 0===b&&(c=0),e.w-(100*b+75)>0?e.w-(100*b+75):e.w-(100*c+75)<e.w?(c++,e.w-(100*(c-1)+75)):(c=0,c++,e.w-(100*(c-1)+75))};f=function(a,d){return 0===d&&(b=0,c=0),e.w-(100*d+75)>0||(e.w-(100*c+75)<e.w?(0===c&&b++,c++):(c=0,c++,b++)),24*b+23},rect_parameter1value=13,rect_parameter2value=13;var h=function(a,d){return 0===d&&(b=0,c=0),e.w-(100*d+100)>=0?e.w-(100*d+100):e.w-(100*d+100)<e.w?(b++,0===c&&e.legendsContainer.attr("height",50*(b+1)),c++,e.w-(100*(c-1)+100)):(c=0,c++,b++,e.w-(100*(c-1)+100))};d=function(a,d){return 0===d&&(b=0,c=0),e.w-(100*d+75)>0||(e.w-(100*c+75)<e.w?(0==c&&b++,c++):(c=0,c++,b++)),24*b+12}}var i;if(PykCharts.boolean(e.multiple_containers_enable)){var j=[];j.push(e.map_group_data[0][a]),i=e.legendsGroup.selectAll("rect").data(j),e.legends_text=e.legendsGroup.selectAll(".legends_text").data(j)}else i=e.legendsGroup.selectAll("rect").data(e.map_group_data[0]),e.legends_text=e.legendsGroup.selectAll(".legends_text").data(e.map_group_data[0]);i.enter().append("rect"),i.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,h).attr(rect_parameter4,d).attr("fill",function(a){return e.fillChart.colorPieW(a)}).attr("opacity",function(){return.6}),i.exit().remove(),e.legends_text.enter().append("text").attr("class","legends_text").attr("fill",e.legendsText_color).attr("pointer-events","none").style("font-family",e.legendsText_family).attr("font-size",e.legendsText_size),e.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,g).attr(text_parameter2,f).text(function(a){return a.group}),e.legends_text.exit().remove()}return this},ticks:function(){if(PykCharts.boolean(e.enableTicks)){var a=e.ticksElement.selectAll("text").data(e.new_data);a.enter().append("text"),a.attr("transform",function(a){return"translate("+e.x(a.x)+","+e.yScale(a.y)+")"}).style("text-anchor","middle").style("font-family",e.label_family).style("font-size",e.label_size).attr("pointer-events","none").attr("dx",-1).attr("dy",function(a){return-e.sizes(a.weight)-4}),a.text(function(a){return console.log(a),a.name}),a.exit().remove()}return this},zoom:function(){return this},plotCircle:function(){return e.circlePlot=e.chartBody.selectAll(".dot").data(e.new_data),e.circlePlot.enter().append("circle").attr("class","dot"),e.circlePlot.attr("r",function(a){return e.sizes(a.weight)}).attr("cx",function(a){return e.x(a.x)+e.extra_left_margin}).attr("cy",function(a){return e.yScale(a.y)+e.extra_top_margin}).style("fill",function(a){return e.fillChart.colorPieW(a)}).style("fill-opacity",function(a){return e.multiD.opacity(a.weight,e.weight,e.data)}).attr("stroke",e.border.color()).attr("stroke-width",e.border.width()).attr("stroke-dasharray",e.border.style()).attr("stroke-opacity",1).on("mouseover",function(a){tooltipText=a.tooltip?a.tooltip:"<table class='PykCharts'><tr><th colspan='2'>"+a.name+"</th></tr><tr><td>X</td><td>"+a.x+"</td></tr><tr><td>Y</td><td>"+a.y+"</td></tr><tr><td>Weight</td><td>"+a.weight+"</td></tr></table>",e.mouseEvent.tooltipPosition(a),e.mouseEvent.toolTextShow(tooltipText),PykCharts.boolean(e.size_enable)&&d3.select(this).style("fill-opacity",1)}).on("mouseout",function(a){e.mouseEvent.tooltipHide(a),PykCharts.boolean(e.size_enable)&&d3.selectAll(".dot").style("fill-opacity",.5)}).on("mousemove",function(a){e.mouseEvent.tooltipPosition(a)}),e.circlePlot.exit().remove(),this},label:function(){return PykCharts.boolean(e.label_size)&&(e.circleLabel=e.chartBody.selectAll(".text").data(e.new_data),e.circleLabel.enter().append("text").attr("class","text"),e.circleLabel.attr("x",function(a){return e.x(a.x)+e.extra_left_margin}).attr("y",function(a){return e.yScale(a.y)+e.extra_top_margin+5}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",e.label_weight).style("font-size",e.label_size).attr("fill",e.label_color).style("font-family",e.label_family).text(function(a){return a.weight}).text(function(a){return this.getBBox().width<2*e.sizes(a.weight)&&this.getBBox().height<2*e.sizes(a.weight)?a.weight:""}),e.circleLabel.exit().remove()),this}};return b}},PykCharts.multiD.spiderWeb=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){"default"===b.mode&&b.k.loading(),b=new PykCharts.multiD.processInputs(b,a,"spiderweb"),b.multiD=new PykCharts.multiD.configuration(b),b.axisTitle=a.axisTitle?a.axisTitle:c.multiDimensionalCharts.spiderweb_axisTitle,b.bubbleRadius=a.spiderweb_radius&&_.isNumber(a.spiderweb_radius)?a.spiderweb_radius:c.multiDimensionalCharts.spiderweb_radius,b.outerRadius=a.spiderweb_outer_radius_percent&&_.isNumber(a.spiderweb_outer_radius_percent)?a.spiderweb_outer_radius_percent:c.multiDimensionalCharts.spiderweb_outer_radius_percent,b.inner_radius=0,b.enableTicks=a.enableTicks?a.enableTicks:c.multiDimensionalCharts.spiderweb_enableTicks,b.outerRadius=b.k._radiusCalculation(b.outerRadius),d3.json(a.data,function(a,c){b.data=c.groupBy("spiderweb"),b.compare_data=c.groupBy("spiderweb"),$(b.selector+" #chart-loader").remove(),b.render()})},b.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("spiderweb"),b.refresh_data=c.groupBy("spiderweb");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.map_group_data=b.multiD.mapGroup(b.data),b.optionalFeatures().createChart().legends().axisTicks().axisTitle()})},this.render=function(){b.radius_range=[3*b.outerRadius/100,.09*b.outerRadius],b.fillChart=new PykCharts.Configuration.fillChart(b),b.sizes=new PykCharts.multiD.bubbleSizeCalculation(b,b.data,b.radius_range),b.border=new PykCharts.Configuration.border(b),b.map_group_data=b.multiD.mapGroup(b.data),"default"===b.mode?(b.k.title(),b.k.subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().legendsContainer(1).svgContainer(1),b.k.liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createChart().axisTicks().axisTitle().legends(),b.k.createFooter().lastUpdatedAt().credits().dataSource()):"infographics"===b.mode&&(b.optionalFeatures().svgContainer().createChart().axisTicks().axisTitle(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b))},this.degrees=function(a){return a/Math.PI*180-90},this.optionalFeatures=function(){var a=this,b={svgContainer:function(b){return $(a.selector).attr("class","PykCharts-spider-web"),a.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("class","svgcontainer").attr("id","svgcontainer").attr("width",a.width).attr("height",a.height).style("background-color",a.bg),a.group=a.svgContainer.append("g").attr("id","spidergrp").attr("transform","translate("+a.width/2+","+a.height/2+")"),this},legendsContainer:function(b){return PykCharts.boolean(a.legends_enable)&&PykCharts.boolean(a.size_enable)&&a.map_group_data[1]&&(a.legendsContainer=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("class","legendsvg").attr("id","legendscontainer").attr("width",a.width).attr("height",50),a.legendsGroup=a.legendsContainer.append("g").attr("class","legendgrp").attr("id","legendgrp")),this},createChart:function(){var b,c,d;for(a.group_arr=[],a.uniq_group_arr=[],j=0;j<a.data.length;j++)a.group_arr[j]=a.data[j].name;a.uniq_group_arr=_.uniq(a.group_arr);var e=a.uniq_group_arr.length;for(a.new_data=[],k=0;e>k;k++)for(a.new_data[k]={name:a.uniq_group_arr[k],data:[]},l=0;l<a.data.length;l++)a.uniq_group_arr[k]===a.data[l].name&&a.new_data[k].data.push({x:a.data[l].x,y:a.data[l].y,weight:a.data[l].weight,color:a.data[l].color,tooltip:a.data[l].tooltip});var f=a.new_data[0].data;for(d=d3.max(a.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),c=d3.min(a.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),a.yScale=d3.scale.linear().domain([c,d]).range([a.inner_radius,a.outerRadius]),a.y_domain=[],a.nodes=[],b=0;b<a.new_data.length;b++){var g=[];for(j=0;j<a.new_data[b].data.length;j++)g[j]=a.yScale(a.new_data[b].data[j].y);a.y_domain[b]=g}for(b=0;b<a.new_data.length;b++){a.y=d3.scale.linear().domain(d3.extent(a.y_domain[b],function(a){return a})).range([.1,.9]);var h=[];for(j=0;j<f.length;j++)h[j]={x:j,y:a.y(a.y_domain[b][j]),tooltip:a.new_data[b].data[j].tooltip||a.new_data[b].data[j].weight};a.nodes[b]=h}for(m=0;m<a.new_data.length;m++){var i=[];for(j=0;j<a.new_data[m].data.length;j++)i[j]=a.new_data[m].data[j].tooltip;for(a.angle=d3.scale.ordinal().domain(d3.range(a.new_data[m].data.length+1)).rangePoints([0,2*Math.PI]),a.radius=d3.scale.linear().range([a.inner_radius,a.outerRadius]),a.yAxis=[],b=0;b<a.new_data[m].data.length;b++)a.yAxis.push({x:b,y:.25},{x:b,y:.5},{x:b,y:.75},{x:b,y:1});var n,o=[];for(b=0;b<a.yAxis.length;b++)n=b<a.yAxis.length-4?a.yAxis[b+4]:a.yAxis[b-a.yAxis.length+4],o.push({source:a.yAxis[b],target:n});var p,q=[];for(b=0;b<a.nodes[m].length;b++)b<a.nodes[m].length-1?(n=a.nodes[m][b+1],p=a.fillChart.colorPieW(a.new_data[m].data[b])):(n=a.nodes[m][0],p=a.fillChart.colorPieW(a.new_data[m].data[b])),q.push({source:a.nodes[m][b],target:n,color:p});var r=a.group.selectAll("#link"+m).data(q);r.enter().append("path").attr("class","link"),r.attr("class","link").attr("stroke",function(a){return a.color}).attr("stroke-opacity",1).attr("id","link"+m).attr("d",d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})),r.exit().remove(),a.weight=_.map(a.new_data[m].data,function(a){return a.weight}),a.weight=_.reject(a.weight,function(a){return 0==a}),a.sorted_weight=a.weight.slice(0),a.sorted_weight.sort(function(a,b){return a-b});var s=a.group.selectAll(".node"+m).data(a.nodes[m]);s.enter().append("circle").attr("class","node"+m).attr("transform",function(b){return"rotate("+a.degrees(a.angle(b.x))+")"}),s.attr("class","node"+m).attr("cx",function(b){return a.radius(b.y)}).attr("r",function(b,c){return a.sizes(a.new_data[m].data[c].weight)}).style("fill",function(b,c){return a.fillChart.colorPieW(a.new_data[m].data[c])}).style("opacity",function(b,c){return a.multiD.opacity(a.new_data[m].data[c].weight,a.weight,a.data)}).attr("stroke",a.border.color()).attr("stroke-width",a.border.width()).attr("stroke-dasharray",a.border.style()).on("mouseover",function(b){a.mouseEvent.tooltipPosition(b),a.mouseEvent.toolTextShow(b.tooltip)}).on("mouseout",function(b){a.mouseEvent.tooltipHide(b)}).on("mousemove",function(b){a.mouseEvent.tooltipPosition(b)}),s.exit().remove()}return a.group.selectAll(".axis").data(d3.range(a.new_data[0].data.length)).enter().append("line").attr("class","axis").attr("transform",function(b){return"rotate("+a.degrees(a.angle(b))+")"}).attr("x1",a.radius.range()[0]).attr("x2",a.radius.range()[1]),a.group.selectAll(".grid").data(o).enter().append("path").attr("class","grid").attr("d",d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})),this},legends:function(){if(PykCharts.boolean(a.legends_enable)&&PykCharts.boolean(a.size_enable)&&a.map_group_data[1]){var b=(_.uniq(a.sorted_weight),0),c=0;if("vertical"===a.legends_display){a.legendsContainer.attr("height",30*a.map_group_data[0].length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,f=function(){return a.width-a.width/4+16},g=function(){return a.width-a.width/4};var d=function(a,b){return 24*b+12},e=function(a,b){return 24*b+23}}else if("horizontal"===a.legends_display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",b=0,c=0;
var f=function(b,d){return 0===d&&(c=0),a.w-(100*d+75)>0?a.width-(100*d+75):a.width-(100*c+75)<a.width?(c++,a.width-(100*(c-1)+75)):(c=0,c++,a.width-(100*(c-1)+75))};e=function(d,e){return 0===e&&(b=0,c=0),a.width-(100*e+75)>0||(a.width-(100*c+75)<a.width?(0===c&&b++,c++):(c=0,c++,b++)),24*b+23},rect_parameter1value=13,rect_parameter2value=13;var g=function(d,e){return 0===e&&(b=0,c=0),a.w-(100*e+100)>=0?a.width-(100*e+100):a.width-(100*e+100)<a.width?(b++,0===c&&a.legendsContainer.attr("height",50*(c+1)),c++,a.width-(100*(c-1)+100)):(c=0,c++,b++,a.width-(100*(c-1)+100))};d=function(d,e){return 0===e&&(b=0,c=0),a.width-(100*e+75)>0||(a.width-(100*c+75)<a.width?(0==c&&b++,c++):(c=0,c++,b++)),24*b+12}}var h=a.legendsGroup.selectAll("rect").data(a.map_group_data[0]);h.enter().append("rect"),h.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,g).attr(rect_parameter4,d).attr("fill",function(b){return a.fillChart.colorPieW(b)}).attr("opacity",function(){return.6}),h.exit().remove(),a.legends_text=a.legendsGroup.selectAll(".legends_text").data(a.map_group_data[0]),a.legends_text.enter().append("text").attr("class","legends_text").attr("fill",a.legendsText_color).attr("pointer-events","none").style("font-family",a.legendsText_family).attr("font-size",a.legendsText_size),a.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,f).attr(text_parameter2,e).text(function(a){return a.name}),a.legends_text.exit().remove()}return this},axisTitle:function(){if(PykCharts.boolean(a.axisTitle)){a.length=a.new_data[0].data.length;var b=a.group.selectAll("text.axisTitle").data(a.nodes[0]);b.enter().append("text").attr("class","axisTitle"),b.attr("transform",function(){return"translate("+-a.outerRadius+","+-a.outerRadius+")"}).style("text-anchor","middle").attr("x",function(b,c){return a.outerRadius*(1-.2*Math.sin(2*c*Math.PI/a.length))+1.25*a.outerRadius*Math.sin(2*c*Math.PI/a.length)}).attr("y",function(b,c){return a.outerRadius*(1-.6*Math.cos(2*c*Math.PI/a.length))-.47*a.outerRadius*Math.cos(2*c*Math.PI/a.length)}).style("font-size",a.label_size).style("font-family",a.label_family),b.text(function(b,c){return a.new_data[0].data[c].x}),b.exit().remove()}return this},axisTicks:function(){if(PykCharts.boolean(a.enableTicks)){var b=a.yScale.domain();a.ticksElement=a.svgContainer.append("g").attr("transform","translate("+a.width/2+","+a.height/2+")");var c=b[1]/4,d=[];for(i=4,j=0;i>=0;i--,j++)d[j]=i*c;var e=a.ticksElement.selectAll("text.ticks").data(d);e.enter().append("text").attr("class","ticks"),e.style("text-anchor","start").attr("transform","translate(5,"+-a.outerRadius+")").attr("x",0).attr("y",function(b,c){return c*(a.outerRadius/4)}).attr("dy",-2),e.text(function(a){return a}).style("font-size",a.label_size).style("font-family",a.label_family)}return this}};return b}},PykCharts.maps={},PykCharts.maps.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.maps.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.mapsTheme,g=b.optional;switch(a.selector=b.selector?b.selector:d.selector,a.width=_.isNumber(parseInt(b.chart_width,10))?b.chart_width:f.chart_width,a.height=_.isNumber(parseInt(b.chart_height,10))?b.chart_height:f.chart_height,a.mapCode=b.mapCode?b.mapCode:f.mapCode,a.enableClick=b.enableClick?b.enableClick:f.enableClick,a.bg=b.colors_backgroundColor?b.colors_backgroundColor:d.backgroundColor,a.timeline_duration=b.timeline_duration?b.timeline_duration:f.timeline_duration,a.margin_left=b.timeline_margin_left?b.timeline_margin_left:f.timeline_margin_left,a.margin_right=b.timeline_margin_right?b.timeline_margin_right:f.timeline_margin_right,a.margin_top=b.timeline_margin_top?b.timeline_margin_top:f.timeline_margin_top,a.margin_bottom=b.timeline_margin_bottom?b.timeline_margin_bottom:f.timeline_margin_bottom,a.tooltip_enable=b.tooltip_enable?b.tooltip_enable:f.tooltip_enable,a.tooltip_mode=b.tooltip_mode?b.tooltip_mode:f.tooltip_mode,a.tooltip_positionTop=b.tooltip_positionTop?b.tooltip_positionTop:f.tooltip_positionTop,a.tooltip_positionLeft=b.tooltip_positionLeft?b.tooltip_positionLeft:f.tooltip_positionLeft,a.tooltipTopCorrection=d3.select(a.selector).style("top"),a.tooltipLeftCorrection=d3.select(a.selector).style("left"),a.colors_defaultColor=b.colors_defaultColor?b.colors_defaultColor:f.colors_defaultColor,a.colors_total=b.colors_total&&_.isNumber(parseInt(b.colors_total,10))?parseInt(b.colors_total,10):f.colors_total,a.colors_type=b.colors_type?b.colors_type:f.colors_type,a.colors_palette=b.colors_palette?b.colors_palette:f.colors_palette,a.axis_onHoverHighlightenable=PykCharts.boolean(b.axis_x_enable)&&b.axis_onHoverHighlightenable?b.axis_onHoverHighlightenable:f.axis_onHoverHighlightenable,a.axis_x_enable=b.axis_x_enable?b.axis_x_enable:f.axis_x_enable,a.axis_x_orient=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_orient?b.axis_x_orient:f.axis_x_orient,a.axis_x_axisColor=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_axisColor?b.axis_x_axisColor:f.axis_x_axisColor,a.axis_x_labelColor=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_labelColor?b.axis_x_labelColor:f.axis_x_labelColor,a.axis_x_no_of_ticks=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_no_of_ticks?b.axis_x_no_of_ticks:f.axis_x_no_of_ticks,a.axis_x_tickPadding=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_tickPadding?b.axis_x_tickPadding:f.axis_x_tickPadding,a.axis_x_tickSize="axis_x_tickSize"in b&&PykCharts.boolean(b.axis_x_enable)?b.axis_x_tickSize:f.axis_x_tickSize,a.axis_x_tickFormat=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_tickFormat?b.axis_x_tickFormat:f.axis_x_tickFormat,a.axis_x_tickValues=PykCharts.boolean(b.axis_x_enable)&&b.axis_x_tickValues?b.axis_x_tickValues:f.axis_x_tickValues,a.axis_x_outer_tick_size="axis_x_outer_tick_size"in b&&PykCharts.boolean(b.axis_x_enable)?b.axis_x_outer_tick_size:f.axis_x_outer_tick_size,a.label_enable=b.label_enable?b.label_enable:f.label_enable,a.legends_enable=b.legends_enable?b.legends_enable:f.legends_enable,a.legends_display=b.legends_display?b.legends_display:f.legends_display,a.borderBetweenChartElements_width="borderBetweenChartElements_width"in b?b.borderBetweenChartElements_width:d.borderBetweenChartElements_width,a.borderBetweenChartElements_color=b.borderBetweenChartElements_color?b.borderBetweenChartElements_color:d.borderBetweenChartElements_color,a.borderBetweenChartElements_style=b.borderBetweenChartElements_style?b.borderBetweenChartElements_style:d.borderBetweenChartElements_style,a.borderBetweenChartElements_style){case"dotted":a.borderBetweenChartElements_style="1,3";break;case"dashed":a.borderBetweenChartElements_style="5,5";break;default:a.borderBetweenChartElements_style="0"}return a.onhover=b.onhover?b.onhover:f.onhover,a.defaultZoomLevel=b.defaultZoomLevel?b.defaultZoomLevel:80,a.loading=b.loading_animationGifUrl?b.loading_animationGifUrl:d.loading_animationGifUrl,a.highlightArea=b.highlightArea?b.highlightArea:f.highlightArea,b&&PykCharts.boolean(b.title_text)?(a.title_size="size"in b?b.title_size:d.title_size,a.title_color=b.title_color?b.title_color:d.title_color,a.title_weight=b.title_weight?b.title_weight:d.title_weight,a.title_family=b.title_family?g.title_family:d.title_family):(a.title_size=d.title_size,a.title_color=d.title_color,a.title_weight=d.title_weight,a.title_family=d.title_family),b&&PykCharts.boolean(b.subtitle_text)?(a.subtitle_size="subtitle_size"in b?b.subtitle_size:d.subtitle_size,a.subtitle_color=b.subtitle_color?b.subtitle_color:d.subtitle_color,a.subtitle_weight=b.subtitle_weight?b.subtitle_weight:d.subtitle_weight,a.subtitle_family=b.subtitle_family?b.subtitle_family:d.subtitle_family):(a.subtitle_size=d.subtitle_size,a.subtitle_color=d.subtitle_color,a.subtitle_weight=d.subtitle_weight,a.subtitle_family=d.subtitle_family),a.realTimeCharts_refreshFrequency=b.realTimeCharts_refreshFrequency?b.realTimeCharts_refreshFrequency:e.realTimeCharts_refreshFrequency,a.realTimeCharts_enableLastUpdatedAt=b.realTimeCharts_enableLastUpdatedAt?b.realTimeCharts_enableLastUpdatedAt:e.realTimeCharts_enableLastUpdatedAt,a.transition_duration=b.transition_duration?b.transition_duration:e.transition_duration,a.creditMySite_name=b.creditMySite_name?b.creditMySite_name:d.creditMySite_name,a.creditMySite_url=b.creditMySite_url?b.creditMySite_url:d.creditMySite_url,a.dataSource=b.dataSource?b.dataSource:"no",a.units=b.units?b.units:!1,a.k=new PykCharts.Configuration(a),a},PykCharts.maps.oneLayer=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=PykCharts.maps.processInputs(b,a),d3.json(a.data,function(c){b.data=c,b.k.totalColors(b.colors_total).colorType(b.colors_type).loading(b.loading).tooltip(),d3.json("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/maps/"+b.mapCode+"-topo.json",function(c){b.map_data=c,d3.json("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/palette/colorPalette.json",function(c){b.color_palette_data=c,$(b.selector).html("");var d=new PykCharts.maps.mapFunctions(a,b,"oneLayer");d.render()})}),b.extent_size=d3.extent(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.extent_size[1]-b.extent_size[0]})}},PykCharts.maps.timelineMap=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=PykCharts.maps.processInputs(b,a),d3.json(a.data,function(c){b.timeline_data=c;var d=d3.extent(c,function(a){return a.timestamp});b.data=_.where(c,{timestamp:d[0]}),b.redeced_width=b.width-2*b.margin_left-b.margin_right,b.redeced_height=b.height-b.margin_top-b.margin_bottom,b.k.totalColors(b.colors_total).colorType(b.colors_type).loading(b.loading).tooltip(b.tooltip_enable),d3.json("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/maps/"+b.mapCode+"-topo.json",function(c){b.map_data=c,d3.json("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/palette/colorPalette.json",function(c){b.color_palette_data=c;var d=d3.extent(b.timeline_data,function(a){return a.timestamp});b.data=_.where(b.timeline_data,{timestamp:d[0]}),b.data.sort(function(a,b){return a.timestamp-b.timestamp}),$(b.selector).html("");var e=new PykCharts.maps.mapFunctions(a,b,"timeline");e.render()})}),b.extent_size=d3.extent(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.extent_size[1]-b.extent_size[0]})}},PykCharts.maps.mapFunctions=function(a,b,c){var d=b;this.render=function(){d.border=new PykCharts.Configuration.border(d),d.k.title().subtitle();var b=150,e=[d.width/2,d.height/2];d.current_palette=_.where(d.color_palette_data,{name:d.colors_palette,number:d.colors_total})[0],d.optionalFeatures().legends(d.legends_enable),$(a.selector).css("background-color",d.bg),d.svgContainer=d3.select(d.selector).append("svg").attr("width",d.width).attr("height",d.height).attr("style","border:1px solid lightgrey").style("border-radius","5px");var f=d.svgContainer.append("g").attr("id","map_group"),g=f.append("defs"),h=g.append("filter").attr("id","dropshadow");h.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1).attr("result","blur"),h.append("feOffset").attr("in","blur").attr("dx",1).attr("dy",1).attr("result","offsetBlur");var i=h.append("feMerge");if(i.append("feMergeNode").attr('in", "offsetBlur'),i.append("feMergeNode").attr("in","SourceGraphic"),d.group=f.selectAll("g").data(topojson.feature(d.map_data,d.map_data.objects).features).enter().append("g"),"world"===d.mapCode)var j=[0,0];else var j=d3.geo.centroid(topojson.feature(d.map_data,d.map_data.objects));var k=d3.geo.mercator().center(j).scale(b).translate(e);d.path=d3.geo.path().projection(k);var l=d.path.bounds(topojson.feature(d.map_data,d.map_data.objects)),m=b*d.width/(l[1][0]-l[0][0]),n=b*d.height/(l[1][1]-l[0][1]),b=n>m?m:n,e=[d.width-(l[0][0]+l[1][0])/2,d.height-(l[0][1]+l[1][1])/2];k=d3.geo.mercator().center(j).scale(d.defaultZoomLevel/100*b).translate(e),d.path=d.path.projection(k);var o=d3.select("#pyk-tooltip");d.chart_data=d.group.append("path").attr("d",d.path).attr("class","area").attr("iso2",function(a){return a.properties.iso_a2}).attr("state_name",function(a){return a.properties.NAME_1}).attr("fill",d.renderColor).attr("prev_fill",function(){return d3.select(this).attr("fill")}).attr("opacity",d.renderOpacity).attr("stroke",d.border.color()).attr("stroke-width",d.border.width()+"px").attr("stroke-dasharray",d.border.style()).on("mouseover",function(a){PykCharts.boolean(d.tooltip_enable)&&(o.style("visibility","visible"),o.html(_.where(d.data,{iso2:a.properties.iso_a2})[0].tooltip)),d.bodColor(a)}).on("mousemove",function(){PykCharts.boolean(d.tooltip_enable)&&("moving"===d.tooltip_mode?o.style("top",function(){return d3.event.pageY-20+"px"}).style("left",function(){return d3.event.pageX+20+"px"}):"fixed"===d.tooltip_mode&&o.style("top",d.tooltip_positionTop+"px").style("left",d.tooltip_positionLeft+"px"))}).on("mouseout",function(a){PykCharts.boolean(d.tooltip_enable)&&o.style("visibility","hidden"),d.bodUncolor(a)}),d.optionalFeatures().label(d.label_enable).enableClick(d.enableClick),d.k.credits(),d.k.dataSource(),"timeline"===c&&d.renderTimeline()},d.optionalFeatures=function(){var a={legends:function(a){return PykCharts.boolean(a)&&d.renderLegend(),this},label:function(a){return PykCharts.boolean(a)&&d.renderLabel(),this},enableClick:function(a){return PykCharts.boolean(a)&&(d.chart_data.on("click",d.clicked),d.onhover1=d.onhover),this},axisContainer:function(a){return PykCharts.boolean(a)&&(d.gxaxis=d.svgContainer.append("g").attr("id","xaxis").attr("class","x axis").attr("transform","translate("+2*d.margin_left+","+d.redeced_height+")")),this}};return a},d.renderColor=function(a,b){if(!PykCharts.boolean(a))return!1;var c,e=_.where(d.data,{iso2:a.properties.iso_a2});if(e.length>0){if("colors"===d.colors_type)return e.length>0&&""!==e[0].color?e[0].color:d.colors_defaultColor;if("saturation"===d.colors_type){if("yes"===d.highlightArea&&"true"==e[0].highlight)return e[0].highlight_color;if(""!==d.colors_palette)for(c=e[0].size,b=0;b<d.current_palette.colors.length;b++)if(c>=d.extent_size[0]+b*(d.difference/d.current_palette.colors.length)&&c<=d.extent_size[0]+(b+1)*(d.difference/d.current_palette.colors.length))return d.current_palette.colors[b];return d.colors_defaultColor}return d.colors_defaultColor}return d.colors_defaultColor},d.renderOpacity=function(a){return""===d.colors_palette&&"saturation"===d.colors_type?(d.oneninth=+d3.format(".2f")(d.difference/10),d.opacity=(d.extent_size[0]+_.where(d.data,{iso2:a.properties.iso_a2})[0].size+d.oneninth)/d.difference,d.opacity):1},d.renderLegend=function(){var b,c;if("saturation"===d.colors_type){if(d.legendsContainer=d3.select(d.selector).append("svg").attr("id","legend-container").attr("width",d.width).attr("height",50),"vertical"===d.legends_display){var e=0,f=0;""===d.colors_palette?d.legendsContainer.attr("height",290):d.legendsContainer.attr("height",30*d.current_palette.number+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,i=function(){return d.width-d.width/12+18},j=function(){return d.width-d.width/12};var g=function(){return e++,24*e+12},h=function(){return f++,24*f+23}}else if("horizontal"===a.legends_display){var e=0,f=0;""===d.colors_palette?(e=9,f=9):(e=d.current_palette.number,f=d.current_palette.number,d.legendsContainer.attr("height",30*d.current_palette.number+20)),d.legendsContainer.attr("height",50),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var i=function(){return f--,d.width-(60*f+40)};h=30,rect_parameter1value=13,rect_parameter2value=13;var j=function(){return e--,d.width-(60*e+60)};g=18}if(""===d.colors_palette)for(b=1;9>=b;b++)c=d3.format(".1f")(d.extent_size[1]/9),d.leg=d3.round(c*b),d.legendsContainer.append("rect").attr("x",function(a){j(a,b)}).attr("y",function(a){g(a,b)}).attr("width",rect_parameter1value).attr("height",rect_parameter2value).attr("fill",d.defaultColor).attr("opacity",b/9),d.legendsContainer.append("text").attr("x",i).attr("y",h).style("font-size",10).style("font","Arial").text("< "+d.leg);else for(b=1;b<=d.current_palette.number;b++)d.leg=d3.round(d.extent_size[0]+b*(d.difference/d.current_palette.number)),d.legendsContainer.append("rect").attr("x",j).attr("y",g).attr("width",rect_parameter1value).attr("height",rect_parameter2value).attr("fill",d.current_palette.colors[b-1]),d.legendsContainer.append("text").attr("x",i).attr("y",h).style("font-size",10).style("font","Arial").text("< "+d.leg);$("#legend-container").after("</br>")}else $("#legend-container").remove()},d.renderLabel=function(){d.group.append("text").attr("x",function(a){return d.path.centroid(a)[0]}).attr("y",function(a){return d.path.centroid(a)[1]}).attr("text-anchor","middle").attr("font-size","10").attr("pointer-events","none").text(function(a){return a.properties.NAME_1})},d.bodColor=function(a){var b=_.where(d.data,{iso2:a.properties.iso_a2});"none"!==d.onhover1?"highlight_border"===d.onhover1?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",d.border.color()).attr("stroke-width",parseInt(d.border.width())+1.5+"px").attr("stroke-dasharray",d.border.style()):"shadow"===d.onhover1?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("filter","url(#dropshadow)").attr("opacity",function(){return""===d.colors_palette&&"saturation"===d.colors_type?(d.oneninth_dim=+d3.format(".2f")(d.difference/10),d.opacity_dim=(d.extent_size[0]+b[0].size+d.oneninth_dim)/d.difference,d.opacity_dim/2):.5}):"color_saturation"===d.onhover1&&d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("opacity",function(){return""===d.colors_palette&&"saturation"===d.colors_type?(d.oneninth_dim=+d3.format(".2f")(d.difference/10),d.opacity_dim=(d.extent_size[0]+b[0].size+d.oneninth_dim)/d.difference,d.opacity_dim/2):.5}):d.bodUncolor(a)},d.bodUncolor=function(a){d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",d.border.color()).attr("stroke-width",d.border.width()).attr("stroke-dasharray",d.border.style()).attr("filter",null).attr("opacity",function(){return""===d.colors_palette&&"saturation"===d.colors_type?(d.oneninth_high=+d3.format(".2f")(d.difference/10),d.opacity_high=(d.extent_size[0]+_.where(d.data,{iso2:a.properties.iso_a2})[0].size+d.oneninth_high)/d.difference,d.opacity_high):1})},this.clicked=function(a){var b={};b.container=d3.event.target.ownerSVGElement.parentNode.id,b.area=a.properties,b.data=_.where(d.data,{iso2:a.properties.iso_a2})[0];try{customFunction(b)}catch(c){}},d.renderTimeline=function(){var a,b,c=[],e=interval1=1;d.optionalFeatures().axisContainer(!0),a=d3.extent(d.timeline_data,function(a){return a.timestamp}),b=[0,d.redeced_width],d.xScale=d.k.scaleIdentification("linear",a,b),d.k.xAxis(d.svgContainer,d.gxaxis,d.xScale),_.each(d.timeline_data,function(a){-1===c.indexOf(a.timestamp)&&c.push(a.timestamp)}),c.sort(function(a,b){return a-b});var f,g=d3.select(d.selector+" .axis").node().getBBox(),h=function(){if("playing"===f)i.attr("xlink:href","https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/assets/images/play.gif"),clearInterval(d.play_interval),f="paused";else{f="playing",i.attr("xlink:href","https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/assets/images/pause.gif"),d.play_interval=setInterval(function(){j.attr("x",2*d.margin_left+d.xScale(c[e])-7),d.data=_.where(d.timeline_data,{timestamp:c[e]}),d.data.sort(function(a,b){return a.timestamp-b.timestamp}),_.each(d.data,function(a){d3.select("path[iso2='"+a.iso2+"']").attr("fill",d.renderColor)}),e++,e===c.length&&clearInterval(d.play_interval)},d.timeline_duration);var a=setTimeout(function(){var b=setInterval(function(){interval1++,interval1===e&&(clearInterval(b),clearTimeout(a)),interval1===c.length&&(clearInterval(b),i.attr("xlink:href","https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/assets/images/play.gif"),j.attr("x",2*d.margin_left+d.xScale(c[0])-7),e=interval1=1,f="")},d.timeline_duration)},d.timeline_duration)}},i=d.svgContainer.append("image").attr("xlink:href","https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/assets/images/play.gif").attr("x",d.margin_left/2).attr("y",d.redeced_height-d.margin_top-g.height/2).attr("width","24px").attr("height","21px").style("cursor","pointer").on("click",h),j=d.svgContainer.append("image").attr("xlink:href","https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/assets/images/marker.png").attr("x",2*d.margin_left+d.xScale(c[0])-7).attr("y",d.redeced_height).attr("width","14px").attr("height","12px")}},function(){function a(a){var b=document.createElement("script");b.type="text/javascript",b.async=!1,b.onload=b.onreadystatechange=function(){try{_&&d3&&($||jQuery)&&d3.customHive&&topojson&&window.PykChartsInit()}catch(a){}},b.src=a;var c=document.getElementsByTagName("link")[0];c.parentNode.insertBefore(b,c)}try{d3||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/d3.min.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/d3.min.js")}try{_||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/underscore-min.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/underscore-min.js")}try{$||jQuery||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/jquery-1.11.1.min.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/jquery-1.11.1.min.js")}try{topojson||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/topojson.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/topojson.js")}try{d3.customHive||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/custom-hive.min.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/custom-hive.min.js")}}();