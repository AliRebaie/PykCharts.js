var PykCharts={};Array.prototype.groupBy=function(a){for(var b,c,d=[],e={oned:["name"],line:["x","name"],area:["x","name"],bar:["y","group"],column:["x","group"],scatterplot:["x","y","name","group"],pulse:["x","y","name","group"],spiderweb:["x","y","name"]},f={oned:{dimension:"name",fact:"weight"},line:{dimension:"x",fact:"y",name:"name"},area:{dimension:"x",fact:"y",name:"name"},bar:{dimension:"y",fact:"x",name:"group"},column:{dimension:"x",fact:"y",name:"group"},scatterplot:{dimension:"x",fact:"y",weight:"weight",name:"name",group:"group"},pulse:{dimension:"y",fact:"x",weight:"weight",name:"name",group:"group"},spiderweb:{dimension:"x",fact:"y",name:"name",weight:"weight"}},g=e[a],h=this,i=[],b=0,j=h.length;j>b;b+=1){var c=h[b];if(0==i.length)i.push([c]);else{for(var k=!1,l=0,m=i.length;m>l;l+=1){var n=i[l],o=!0,p=n[0];g.forEach(function(a){p[a]!==c[a]&&(o=!1)}),o&&(k=n)}k?k.push(c):i.push([c])}}for(b in i)if($.isArray(i[b])){c={};var q=i[b],r=f[a];c[r.dimension]=q[0][r.dimension],r.name&&(c[r.name]=q[0][r.name]),r.weight?(c[r.weight]=d3.sum(q,function(b){return b[f[a].weight]}),c[r.fact]=q[0][r.fact]):c[r.fact]=d3.sum(q,function(b){return b[f[a].fact]}),r.group&&(c[r.group]=q[0][r.group]);var s=_.extend(c,_.omit(q[0],_.values(f[a])));d.push(s)}return d},PykCharts.boolean=function(a){var b=["0","f","false","n","no",""],c=[void 0,null,0/0];return _.contains(c,a)?!1:(value=a.toLocaleString(),value=value.toLowerCase(),b.indexOf(value)>-1?!1:!0)},PykCharts.Configuration=function(a){var b=this,c={liveData:function(b){var c=a.real_time_charts_refresh_frequency;return PykCharts.boolean(c)&&setInterval(b.refresh,1e3*c),this},emptyDiv:function(){return d3.select(a.selector).append("div").style("clear","both"),this},scaleIdentification:function(a,b,c,d){var e;return"ordinal"===a?e=d3.scale.ordinal().domain(b).rangeRoundBands(c,d):"linear"===a?e=d3.scale.linear().domain(b).range(c):"time"===a?e=d3.time.scale().domain(b).range(c):void 0},appendUnits:function(b){b=PykCharts.numberFormat(b);var c,d,e;return d=a.units_prefix,e=a.units_suffix,d&&""!==d?(c=d+" "+b,e&&(c+=" "+e)):c=e&&""!==e?b+" "+e:b,c},title:function(){if(PykCharts.boolean(a.title_text)&&a.title_size){var c;c=PykCharts.boolean(a.export_enable)?.9*a.width:a.width,b.titleDiv=d3.select(a.selector).append("div").attr("id","title").style("width",c+"px").style("text-align","left").style("float","left").html("<span style='pointer-events:none;font-size:"+a.title_size+"px;color:"+a.title_color+";font-weight:"+a.title_weight+";font-family:"+a.title_family+"'>"+a.title_text+"</span>")}return this},subtitle:function(){return PykCharts.boolean(a.subtitle_text)&&a.subtitle_size&&(b.subtitleDiv=d3.select(a.selector).append("div").attr("id","sub-title").style("width",a.width+"px").style("text-align","left").html("<span style='pointer-events:none;font-size:"+a.subtitle_size+"px;color:"+a.subtitle_color+";font-weight:"+a.subtitle_weight+";font-family:"+a.subtitle_family+"'>"+a.subtitle_text+"</span>")),this},createFooter:function(){return d3.select(a.selector).append("table").attr("id","footer").style("background",a.bg).attr("width",a.width+"px"),this},lastUpdatedAt:function(b){if(PykCharts.boolean(a.real_time_charts_refresh_frequency)&&PykCharts.boolean(a.real_time_charts_last_updated_at_enable))if("liveData"===b){var c=new Date,d=c.getDate()+"/"+(c.getMonth()+1)+"/"+c.getFullYear()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();$(a.selector+" #lastUpdatedAt").html("<span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+d+"</span>")}else{var c=new Date,d=c.getDate()+"/"+(c.getMonth()+1)+"/"+c.getFullYear()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();d3.select(a.selector+" #footer").append("tr").attr("class","PykCharts-credits").html("<td colspan=2 style='text-align:right' id='lastUpdatedAt'><span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+d+"</span></tr>")}return this},checkChangeInData:function(a,c){var d=Object.keys(c[0]),e=Object.keys(a[0]),f=!1;if(d.length===e.length&&c.length===a.length){for(i=0;i<a.length;i++)for(j=0;j<d.length;j++)if(a[i][e[j]]!==c[i][d[j]]||d[j]!==e[j]){f=!0;break}}else f=!0;return b.compare_data=a,[b.compare_data,f]},credits:function(){if(PykCharts.boolean(a.credit_my_site_name)||PykCharts.boolean(a.credit_my_site_url)){var b=!0;""===a.credit_my_site_name&&(a.credit_my_site_name=a.credit_my_site_url),""===a.credit_my_site_url&&(b=!1),d3.select(a.selector+" #footer").append("tr").attr("class","PykCharts-credits").attr("id","credit-datasource").append("td").style("text-align","left").html("<span style='pointer-events:none;'>Credits: </span><a href='"+a.credit_my_site_url+"' target='_blank' onclick='return "+b+"'>"+a.credit_my_site_name+"</a>")}return this},dataSource:function(){if(PykCharts.boolean(a.data_source_name)||PykCharts.boolean(a.data_source_url)){var b=!0;""===a.data_source_name&&(a.data_source_name=a.data_source_url),""===a.data_source_url&&(b=!1),$(a.selector+" #footer").length?d3.select(a.selector+" table #credit-datasource").style("background",a.bg).append("td").style("text-align","right").html("<span style='pointer-events:none;'>Source: </span><a href='"+a.data_source_url+"' target='_blank' onclick='return "+b+"'>"+a.data_source_name+"</a></tr>"):d3.select(a.selector).append("table").attr("id","footer").style("background",a.bg).attr("width",a.width+"px").append("tr").attr("class","PykCharts-credits").append("td").style("text-align","right").html("<span style='pointer-events:none;'>Source: </span><a href='"+a.data_source_url+"' target='_blank' onclick='return "+b+"'>"+a.data_source_name+"</a></tr>")}return this},makeMainDiv:function(b,c){var d=d3.select(b).append("div").attr("id","tooltip-svg-container-"+c).attr("class","main-div").style("width",a.width);return PykCharts.boolean(a.panels_enable)&&d.style("float","left").style("width","auto"),this},tooltip:function(b,c,d){if(PykCharts.boolean(a.tooltip_enable)&&"default"===a.mode)if(void 0!==c){var e=a.selector.substr(1,a.selector.length);PykCharts.Configuration.tooltipp=d3.select("body").append("div").attr("id","tooltip-svg-container-"+d+"-pyk-tooltip"+e).attr("class","pyk-tooltip").style("height","auto").style("weight","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("border","1px solid #CCCCCC").style("font-family","'Helvetica Neue', Helvetica, Arial, sans-serif").style("font-size","12px").style("text-align","center").style("min-width","30px").style("z-index","10").style("visibility","hidden").style("box-shadow","0 5px 10px rgba(0,0,0,.2)")}else PykCharts.Configuration.tooltipp=d3.select("body").append("div").attr("id","pyk-tooltip").attr("class","pyk-tooltip").style("height","auto").style("weight","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("border","1px solid #CCCCCC").style("font-family","'Helvetica Neue', Helvetica, Arial, sans-serif").style("font-size","12px").style("text-align","center").style("min-width","30px").style("z-index","10").style("visibility","hidden").style("box-shadow","0 5px 10px rgba(0,0,0,.2)");else PykCharts.boolean(a.tooltip_enable)&&(PykCharts.Configuration.tooltipp="fixed"===a.tooltip_mode?d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("weight","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("border","1px solid #CCCCCC").style("font-family","'Helvetica Neue', Helvetica, Arial, sans-serif").style("font-size","12px").style("text-align","center").style("min-width","30px").style("z-index","10").style("visibility","hidden").style("box-shadow","0 5px 10px rgba(0,0,0,.2)"):d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("weight","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("border","1px solid #CCCCCC").style("font-family","'Helvetica Neue', Helvetica, Arial, sans-serif").style("font-size","12px").style("text-align","center").style("min-width","30px").style("z-index","10").style("visibility","hidden").style("box-shadow","0 5px 10px rgba(0,0,0,.2)"));return this},annotation:function(b,c,d,e){var f=new PykCharts.Configuration.mouseEvent(a),g=d3.select(b).selectAll(".PykCharts-annotation-circle").data(c);g.enter().append("circle").attr("class","PykCharts-annotation-circle");var h=d3.select(b).selectAll(".PykCharts-annotation-text").data(c);h.enter().append("text").attr("class","PykCharts-annotation-text"),h.attr("x",function(b){return parseInt(d(b.x))+a.extra_left_margin+a.margin_left}).attr("y",function(b){return parseInt(e(b.y)-16+a.margin_top)}).attr("text-anchor","middle").style("font-size","12px").text(function(a){return a.annotation}).text(function(a,b){return b+1}).style("pointer-events","none"),g.attr("cx",function(b){return parseInt(d(b.x))+a.extra_left_margin+a.margin_left}).attr("cy",function(b){return parseInt(e(b.y))-20+a.margin_top}).attr("r",8).style("cursor","pointer").on("click",function(a){f.tooltipPosition(a),f.tooltipTextShow(a.annotation)})},crossHair:function(b,c,d,e){if(PykCharts.boolean(a.crosshair_enable)&&"default"===a.mode)for(PykCharts.Configuration.cross_hair_v=b.append("g").attr("class","line-cursor").style("display","none"),PykCharts.Configuration.cross_hair_v.append("line").attr("class","cross-hair-v").attr("id","cross-hair-v"),PykCharts.Configuration.cross_hair_h=b.append("g").attr("class","line-cursor").style("display","none"),PykCharts.Configuration.cross_hair_h.append("line").attr("class","cross-hair-h").attr("id","cross-hair-h"),j=0;c>j;j++)PykCharts.Configuration.focus_circle=b.append("g").attr("class","focus").style("display","none").attr("id","f_circle"+j),PykCharts.Configuration.focus_circle.append("circle").attr("fill",function(){return e.colorPieMS(d[j])}).attr("id","focus-circle"+j).attr("r",6);return this},fullScreen:function(c){return PykCharts.boolean(a.fullScreen)&&(b.fullScreenButton=d3.select(a.selector).append("input").attr("type","image").attr("id","btn-zoom").attr("src","../../PykCharts/img/apple_fullscreen.jpg").style("font-size","30px").style("left","800px").style("top","0px").style("position","absolute").style("height","4%").on("click",c.fullScreen)),this},loading:function(){if(PykCharts.boolean(a.loading)){$(a.selector).html("<div id='chart-loader'><img src="+a.loading+"></div>");var b=$(a.selector).height();$(a.selector+" #chart-loader").css({visibility:"visible","padding-left":a.width/2+"px","padding-top":b/2+"px"})}return this},positionContainers:function(b,c){return PykCharts.boolean(a.legends_enable)&&!PykCharts.boolean(a.variable_circle_size_enable)?(("top"==b||"left"==b)&&c.optionalFeatures().legendsContainer().svgContainer(),("bottom"==b||"right"==b)&&c.optionalFeatures().svgContainer().legendsContainer()):c.optionalFeatures().svgContainer(),this},yGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid_y_enable)){var e=PykCharts.Configuration.makeYGrid(a,d);c.selectAll(a.selector+" g.y.grid-line").style("stroke",function(){return a.grid_color}).call(e)}return this},xGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid_x_enable)){var e=PykCharts.Configuration.makeXGrid(a,d);c.selectAll(a.selector+" g.x.grid-line").style("stroke",function(){return a.grid_color}).call(e)}return this},xAxis:function(b,c,d,e,f,g){a.width,a.height;void 0===g&&(g=0);var h=new PykCharts.Configuration(a);if(PykCharts.boolean(a.axis_x_enable)){d3.selectAll(a.selector+" .x.axis").attr("fill",function(){return a.axis_x_label_color}),"bottom"===a.axis_x_position&&c.attr("transform","translate(0,"+(a.height-a.margin_top-a.margin_bottom-g)+")");var i=PykCharts.Configuration.makeXAxis(a,d);if(0!=a.axis_x_pointer_values.length){var j=[];"time"===a.axis_x_data_format?_.each(a.axis_x_pointer_values,function(a){j.push(new Date(a))}):j=a.axis_x_pointer_values,i.tickValues(j)}c.style("stroke",function(){return a.axis_x_line_color}).call(i),"string"===a.axis_x_data_format&&"no"===a.panels_enable&&h.ordinalXAxisTickFormat(f,e)}return this},yAxis:function(b,c,d,e){var f,g=(a.width,a.height,new PykCharts.Configuration(a));if(f=PykCharts.boolean(a.panels_enable)?a.w:a.width,PykCharts.boolean(a.axis_y_enable)){"right"===a.axis_y_position&&c.attr("transform","translate("+(f-a.margin_left-a.margin_right)+",0)"),d3.selectAll(a.selector+" .y.axis").attr("fill",function(){return a.axis_y_label_color});var h=PykCharts.Configuration.makeYAxis(a,d);0!=a.axis_y_pointer_values.length&&h.tickValues(a.axis_y_pointer_values);{new PykCharts.Configuration.mouseEvent(a)}c.style("stroke",function(){return a.axis_y_line_color}).call(h),"string"===a.axis_y_data_format&&"no"===a.panels_enable&&g.ordinalYAxisTickFormat(e)}return this},xAxisTitle:function(b){var c;return c=PykCharts.boolean(a.panels_enable)?a.w:a.width,"bottom"===a.axis_x_position?b.append("text").attr("class","x-axis-title").attr("x",(c-a.margin_left-a.margin_right)/2).attr("y",a.margin_bottom).style("text-anchor","middle").style("fill",a.axis_x_label_color).style("font-weight","bold").text(a.axis_x_title):"top"===a.axis_x_position&&b.append("text").attr("class","x-axis-title").attr("x",(c-a.margin_left-a.margin_right)/2).attr("y",-a.margin_top+10).style("text-anchor","middle").style("fill",a.axis_x_label_color).style("font-weight","bold").text(a.axis_x_title),this},yAxisTitle:function(b){var c;return c=PykCharts.boolean(a.panels_enable)?a.w:a.width,"left"===a.axis_y_position?b.append("text").attr("class","y-axis-title").attr("x",-a.height/2).attr("transform","rotate(-90)").attr("y",-(a.margin_left-12)).style("fill",a.axis_y_label_color).style("font-weight","bold").text(a.axis_y_title):"right"===a.axis_y_position&&b.append("text").attr("class","y-axis-title").attr("x",-a.height/2).attr("transform","rotate(-90)").style("fill",a.axis_y_label_color).style("font-weight","bold").attr("y",a.margin_right-12).attr("dy",".71em").text(a.axis_y_title),this},isOrdinal:function(b,c,d,e,f){var g=new PykCharts.Configuration(a);return".x.axis"===c?(b.select(c).call(PykCharts.Configuration.makeXAxis(a,d)),"string"===a.axis_x_data_format&&"no"===a.panels_enable&&g.ordinalXAxisTickFormat(e,f)):".x.grid"===c?b.select(c).call(PykCharts.Configuration.makeXGrid(a,d)):".y.axis"===c?(b.select(c).call(PykCharts.Configuration.makeYAxis(a,d)),"string"===a.axis_y_data_format&&"no"===a.panels_enable&&g.ordinalyAxisTickFormat(e)):".y.grid"===c&&b.select(c).call(PykCharts.Configuration.makeYGrid(a,d)),this},ordinalXAxisTickFormat:function(b,c){var d,e,f=new PykCharts.Configuration.mouseEvent(a),g=$(a.selector+" g.x.axis text"),h=g.length,j=0,k=2*c;for(_.each(g,function(a){j=a.getBBox().width>j?a.getBBox().width:j}),k>=j+10?e=1:k>=.75*j&&j>k?e=2:k>=.65*j&&.75*j>k?e=3:k>=.55*j&&.65*j>k?e=4:k>=.35*j&&.55*j>k?e=5:(20>=k||.35*j>k)&&(e=0),i=0;h>i;i++)d=g[i].innerHTML,0===e?d="":k>=g[i].getBBox().width+10&&1===e||(k>=.75*g[i].getBBox().width&&k<g[i].getBBox().width&&2===e?d=d.substr(0,5)+"..":k>=.65*g[i].getBBox().width&&k<.75*g[i].getBBox().width&&3===e?d=d.substr(0,4)+"..":4===e?d=d.substr(0,3):5===e&&(d=d.substr(0,2))),g[i].innerHTML=d;return xaxistooltip=d3.selectAll(a.selector+" g.x.axis text").data(b),xaxistooltip.on("mouseover",function(a){f.tooltipPosition(a),f.tooltipTextShow(a)}).on("mousemove",function(a){f.tooltipPosition(a),f.tooltipTextShow(a)}).on("mouseout",function(a){f.tooltipHide(a)}),this},ordinalYAxisTickFormat:function(b){var c,d=new PykCharts.Configuration.mouseEvent(a),e=$(a.selector+" g.y.axis text"),f=e.length;for(i=0;f>i;i++)c=e[i].innerHTML,e[i].getBBox().width>.7*a.margin_left&&(c=c.substr(0,3)+".."),e[i].innerHTML=c;return xaxistooltip=d3.selectAll(a.selector+" g.y.axis text").data(b),xaxistooltip.on("mouseover",function(a){d.tooltipPosition(a),d.tooltipTextShow(a)}).on("mousemove",function(a){d.tooltipPosition(a),d.tooltipTextShow(a)}).on("mouseout",function(a){d.tooltipHide(a)}),this},totalColors:function(a){var c=parseInt(a,10);return c>2&&10>c?(b.total_colors=c,this):(b.total_colors=9,this)},colorType:function(a){return"colors"===a&&(b.legends="no"),this},xAxisDataFormatIdentification:function(a){return _.isNumber(a[0].x)||!isNaN(a[0].x)?"number":isNaN(new Date(a[0].x).getTime())?"string":"time"},yAxisDataFormatIdentification:function(a){return _.isNumber(a[0].y)||!isNaN(a[0].y)?"number":isNaN(new Date(a[0].y).getTime())?"string":"time"},resize:function(b,c,d){var e=a.width/a.height,f=$(a.selector).width();f>a.width&&(f=a.width),PykCharts.boolean(b)&&(b.attr("width",f),b.attr("height",f/e));var g;PykCharts.boolean(a.title_text)&&PykCharts.boolean(a.export_enable)&&(g=.9*f,$(a.selector+" #title").css("width",g)),PykCharts.boolean(a.subtitle_text)&&(g=.9*f,$(a.selector+" #sub-title").css("width",g)),PykCharts.boolean(a.export_enable)&&(div_size=f,div_float="none",div_left=f-15,PykCharts.boolean(a.title_text)&&a.title_size&&(div_size=.1*f,div_float="left",div_left=0),$(a.selector+" #export").css("width",div_size).css("left",div_left).css("float",div_float),$(a.selector+" #dropdown-multipleConatiner-export").css("left",f-80+"px")),void 0!==d&&d.attr("width",f);var h=$(a.selector+" #footer");h&&h.attr("width",f);var i=$(a.selector+" .main-div");i&&!PykCharts.boolean(a.panels_enable)&&$(a.selector+" .main-div").css("width",f),PykCharts.boolean(c)},__proto__:{_domainBandwidth:function(a,b,c){if(addFactor=0,"time"===c){var d=a[0],e=a[1],f=[];return padding=.1*(e-d),0===b?f[0]=d-(padding+addFactor):1===b?f[1]=e+(padding+addFactor):2===b&&(f[0]=d-(padding+addFactor),f[1]=e+(padding+addFactor)),[new Date(f[0]),new Date(f[1])]}return padding=.1*(a[1]-a[0]),0===b?a[0]-=padding+addFactor:1===b?a[1]=parseFloat(a[1],10)+(padding+addFactor):2===b&&(a[0]-=padding+addFactor,a[1]=parseFloat(a[1],10)+(padding+addFactor)),a},_radiusCalculation:function(b,c){var d;return d="percentageBar"===c?a.height:"spiderweb"===c?d3.min([a.width,a.height-a.legendsGroup_height-20]):void 0!==c?a.width:d3.min([a.width,a.height]),d*b/200}},backgroundColor:function(a){function b(a){return d=a,c=$(a).css("background-color"),"transparent"!==c&&"rgba(0, 0, 0, 0)"!==c?$(a).colourBrightness(c):void 0!==$(a)[0].parentNode.tagName&&"body"!==$(a)[0].parentNode.tagName.toLowerCase()?b($(a)[0].parentNode):void $(a).colourBrightness("rgb(255,255,255)")}$(a.selector).css({"background-color":a.background_color,position:"relative"});var c,d;return b(a.selector),a.img=$(d)[0].classList.contains("light")?"../img/download.png":"../img/download-light.png",this},"export":function(b,c,d,e,f){if(PykCharts.boolean(a.export_enable)){if(d3.select(a.selector).append("div").attr("id","dropdown-multipleConatiner-export").attr("class","pyk-tooltip").style("left",a.width-80+"px").style("top","10px").style("height","auto").style("width","auto").style("padding","8px 8px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","3px").style("border","1px solid #CCCCCC").style("font-family","'Helvetica Neue', Helvetica, Arial, sans-serif").style("font-size","12px").style("text-align","center").style("z-index","10").style("visibility","hidden").style("box-shadow","0 5px 10px rgba(0,0,0,.2)"),PykCharts.boolean(e))for(var g=0;g<f.length;g++)d3.select(a.selector+" #dropdown-multipleConatiner-export").append("span").attr("id",d+g).on("mouseover",function(){$(this).css("background-color","#E0E0E1")}).on("mouseout",function(){$(this).css("background-color","#fff")}).style("margin-bottom","3px").style("cursor","pointer").html("Panel "+(g+1)+"<br>");else d3.select(a.selector+" #dropdown-multipleConatiner-export").append("span").attr("id",d+"span").on("mouseover",function(){$(this).css("background-color","#E0E0E1")}).on("mouseout",function(){$(this).css("background-color","#fff")}).style("margin-bottom","3px").style("cursor","pointer").html("Export as SVG<br>");var h=d+"canvas",i=document.createElement("canvas");i.setAttribute("id",h),i.setAttribute("width",500),i.setAttribute("height",500);var j="export",k=a.width;div_float="none",div_left=a.width-15,PykCharts.boolean(a.title_text)&&a.title_size&&(k=.1*a.width,div_float="left",div_left=0);var l=(d3.select(b.selector).append("div").attr("id",j).style("width",k+"px").style("left",div_left+"px").style("float",div_float).style("text-align","right").html("<img title='Export to SVG' src='"+a.img+"' style='left:"+div_left+"px;margin-bottom:3px;cursor:pointer;'/>"),document.getElementById(h));paper.setup(l);var m=new paper.Project;m._view._viewSize.width=b.width,m._view._viewSize.height=b.height;var n=d+".svg";if($(b.selector+" #"+j).click(function(){d3.select(a.selector+" #dropdown-multipleConatiner-export").style("visibility","visible")}),PykCharts.boolean(e))for(var g=0;g<f.length;g++)$(b.selector+" #"+d+g).click(function(){d3.select(a.selector+" #dropdown-multipleConatiner-export").style("visibility","hidden");var e=this.id.substring(this.id.length-1,this.id.length);b.k.processSVG(document.querySelector(a.selector+" #"+c+e),d),m.importSVG(document.querySelector(a.selector+" #"+c+e));var f=m.exportSVG({asString:!0});downloadDataURI({data:"data:image/svg+xml;base64,"+btoa(f),filename:n}),m.clear()});else $(b.selector+" #"+d+"span").click(function(){d3.select(a.selector+" #dropdown-multipleConatiner-export").style("visibility","hidden"),b.k.processSVG(document.querySelector(a.selector+" "+c),d),m.importSVG(document.querySelector(a.selector+" "+c));var e=m.exportSVG({asString:!0});downloadDataURI({data:"data:image/svg+xml;base64,"+btoa(e),filename:n}),m.clear()})}return this},processSVG:function(a){for(var b=a.querySelectorAll("text"),c=0;c<b.length;c++)if(b[c].hasAttribute("dy")){var d=b[c].getAttribute("dy"),e=d.length;if("em"==d.substring(e-2,e)){var f=12*parseFloat(d);b[c].setAttribute("dy",f)}}return this},errorHandling:function(b){console.log("%c[Error Pykih Charts] ","color: red;font-weight:bold;font-size:13px"," at "+a.selector+'.(Invalid value for attribute "'+b+'")  Visit http://www.pykih.com/'),a.stop=!0},validator:function(){var b={validatingSelector:function(b){try{if(!document.getElementById(b))throw"selector"}catch(c){a.k.errorHandling(c,"#1")}return this},validatingDataType:function(b,c){try{if(!_.isNumber(b))throw c}catch(d){a.k.errorHandling(d,"#2")}return this},validatingChartMode:function(b){try{if("default"!==b.toLowerCase()&&"infographics"!==b.toLowerCase())throw"mode"}catch(c){a.k.errorHandling(c,"#3")}return this},validatingAxisDataFormat:function(b,c){if(b)try{if("number"!==b.toLowerCase()&&"string"!==b.toLowerCase()&&"time"!==b.toLowerCase())throw c}catch(d){a.k.errorHandling(d,"#4")}return this},validatingColorMode:function(b){if(b)try{if("color"!==b.toLowerCase()&&"saturation"!==b.toLowerCase())throw"color_mode"}catch(c){a.k.errorHandling(c,"#5")}return this},validatingAxisPointerPosition:function(b,c){try{if("left"!==b.toLowerCase()&&"right"!==b.toLowerCase()&&"top"!==b.toLowerCase()&&"bottom"!==b.toLowerCase())throw c}catch(d){a.k.errorHandling(d,"#6")}return this},validatingBorderBetweenChartElementsStyle:function(b,c){try{if("1,3"!==b.toLowerCase()&&"5,5"!==b.toLowerCase()&&"0"!==b.toLowerCase())throw c}catch(d){a.k.errorHandling(d,"#7")}return this},validatingLegendsPosition:function(b,c){try{if("horizontal"!==b.toLowerCase()&&"vertical"!==b.toLowerCase())throw c}catch(d){a.k.errorHandling(d,"#8")}return this},isArray:function(b,c){console.log(b,"value");try{if(!$.isArray(b))throw c}catch(d){a.k.errorHandling(d,"#9")}return this},validatingTimeScaleDataType:function(b,c){if(b)try{if("date"!==b.toLowerCase()&&"year"!==b.toLowerCase()&&"month"!==b.toLowerCase()&&"hours"!==b&&"minutes"!==b)throw c}catch(d){a.k.errorHandling(d,"#9")}return this},validatingTooltipMode:function(b,c){if(b)try{if("fixed"!==b.toLowerCase()&&"moving"!==b.toLowerCase())throw c}catch(d){a.k.errorHandling(d,"#9")}return this},validatingFontWeight:function(b,c){try{if("bold"!==b.toLowerCase()&&"normal"!==b.toLowerCase())throw c}catch(d){a.k.errorHandling(d,"#9")}return this}};return b}};return c};var configuration=PykCharts.Configuration;configuration.mouseEvent=function(a){var b=this;b.tooltip=configuration.tooltipp,b.cross_hair_v=configuration.cross_hair_v,b.cross_hair_h=configuration.cross_hair_h,b.focus_circle=configuration.focus_circle,b.pt_circle=configuration.pt_circle,b.start_pt_circle=configuration.start_pt_circle;var c={tooltipPosition:function(c,d,e,f,g,h){if(PykCharts.boolean(a.tooltip_enable)){if(void 0!==d){var i=a.selector.substr(1,a.selector.length),j=parseFloat($("#tooltip-svg-container-"+h+"-pyk-tooltip"+i).css("width"));tooltip=$("#tooltip-svg-container-"+h+"-pyk-tooltip"+i),offset=$(a.selector).offset(),tooltip.css("visibility","visible").css("top",e+g+offset.top+"px").css("left",d+a.margin_left+f-j+offset.left+"px")}else b.tooltip.style("visibility","visible").style("top",d3.event.pageY-20+"px").style("left",d3.event.pageX+30+"px");return b.tooltip}},tooltipTextShow:function(c,d,e,f){var g=a.selector.substr(1,a.selector.length);return PykCharts.boolean(a.tooltip_enable)&&("yes"===d&&"multilineChart"===e?$("#tooltip-svg-container-"+f+"-pyk-tooltip"+g).html(c):b.tooltip.html(c)),this},tooltipHide:function(c,d,e){return PykCharts.boolean(a.tooltip_enable)?"yes"===d&&"multilineChart"===e?d3.selectAll(".pyk-tooltip").style("visibility","hidden"):b.tooltip.style("visibility","hidden"):void 0},crossHairPosition:function(b,c,d,e,f,g,h,j,l,m,n){if((PykCharts.boolean(a.crosshair_enable)||PykCharts.boolean(a.tooltip_enable)||PykCharts.boolean(a.axis_onhover_hightlight_enable))&&"default"===a.mode){var o=a.margin_left+g+$(a.selector+" #"+f[0][0][0].parentNode.parentNode.id).offset().left,p=$(a.selector+" #"+f[0][0][0].parentNode.parentNode.id).offset().top,q=c.length,r=a.margin_left,s=(a.margin_right,a.margin_top),t=a.margin_bottom,u=(a.width,a.height),v=parseInt(d3.event.target.id.substr(d3.event.target.id.length-1,1)),w=d3.event.pageX-o,x=d3.event.pageY-p-s,y=[];if("string"===a.axis_x_data_format)y=d.range();else for(temp=d.range(),pad=(temp[1]-temp[0])/c[0].data.length,len=c[0].data.length,strt=0,i=0;len>i;i++)strt+=pad,y[i]=strt;var z,A,B,C,D,E,F,G,H,I,J=e.range(),K=[],L=[],M=y.length;for(z=0;M>z;z++)for(k=0;k<J.length;k++){if(z+1>=M)return!1;if(E===y[z]&&F===y[z+1]&&I===J[k])return!1;if(w>=y[z]&&w<=y[z+1]&&x<=J[k])if(F=y[z],E=y[z+1],H=J[k+1],I=J[k],B=F-w,C=w-E,B>=C?(A=b[z].x,K.push(b[z].y),tooltipText=b[z].tooltip||b[z].y,D=d(A)+g+r,L=e(b[z].y)+s):(A=b[z+1].x,K.push(b[z+1].y),tooltipText=b[z+1].tooltip||b[z+1].y,D=d(A)+g+r,L=e(b[z+1].y)+s),"multilineChart"===j){if("no"===n){var N=[];d3.selectAll(a.selector+" #pyk-tooltip").classed({"pyk-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var O=c[0].data.length,P="";K=[];for(var Q=0;q>Q;Q++)for(var R=0;O>R;R++)cond="time"===a.axis_x_data_format?Date.parse(A)===Date.parse(c[Q].data[R].x):c[Q].data[R].x===A,cond&&(K.push(c[Q].data[R].y),N.push(e(c[Q].data[R].y)+s),PykCharts.boolean(m)?PykCharts.boolean(m)&&(P+="<tr><td><div style='padding:2px;width:5px;height:5px;background-color:"+c[Q].color+"'></div></td><td>"+c[Q].name+"</td><td><b>"+c[Q].data[R].tooltip+"</b></td></tr>",G=3):(P+="<tr><td>"+c[Q].name+"</td><td><b>"+c[Q].data[R].tooltip+"</b></td></tr>",G=2));D+=6,tooltipText="<table><thead><th colspan='"+G+"'>"+A+"</th></thead><tbody>"+P+"</tbody></table>","stackedAreaChart"===j?(v=1,this.tooltipPosition(tooltipText,D,x,60,70,v)):this.tooltipPosition(tooltipText,D,x,60,-15,v),this.tooltipTextShow(tooltipText),a.crosshair_enable?this.crossHairShow(D,s,D,u-t,D,N,j,K.length,n,c):null,this.axisHighlightShow(K,a.selector+" .y.axis",h),this.axisHighlightShow(A,a.selector+" .x.axis",h)}else if("yes"===n){D+=5;for(var O=c[0].data.length,Q=0;q>Q;Q++)for(var S=$(a.selector+" #svg-"+Q).offset().left,T=$(a.selector+" #svg-"+Q).offset().top-$(a.selector).offset().top,R=0;O>R;R++)cond="time"===a.axis_x_data_format?Date.parse(A)===Date.parse(c[Q].data[R].x):c[Q].data[R].x===A,cond&&(K.push(c[Q].data[R].y),tooltipText=c[Q].data[R].tooltip,L=e(c[Q].data[R].y)+s,this.tooltipPosition(tooltipText,D+S,L+T,-15,-15,Q),this.tooltipTextShow(tooltipText,n,j,Q),a.crosshair_enable?this.crossHairShow(D,s,D,u-t,D,L,j,K.length,n,c[Q],Q):null)}}else if("lineChart"===j||"areaChart"===j)"fixed"===a.tooltip_mode.toLowerCase()?this.tooltipPosition(tooltipText,0,L,-14,23,v):"moving"===a.tooltip_mode.toLowerCase()&&this.tooltipPosition(tooltipText,D,L,5,-45,v),this.tooltipTextShow(tooltipText),a.crosshair_enable?this.crossHairShow(D,s,D,u-t,D,L,j,K.length,n):null,this.axisHighlightShow(K,a.selector+" .y.axis",h),this.axisHighlightShow(A,a.selector+" .x.axis",h);else if("stackedAreaChart"===j){var N=[];d3.selectAll(a.selector+" #pyk-tooltip").classed({"pyk-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var O=c[0].data.length,P="";K=[];for(var Q=0;q>Q;Q++)for(var R=0;O>R;R++)cond="time"===a.axis_x_data_format?Date.parse(A)===Date.parse(c[Q].data[R].x):c[Q].data[R].x===A,cond&&(K.push(c[Q].data[R].y),N.push(e(c[Q].data[R].y+c[Q].data[R].y0)+s),PykCharts.boolean(m)?PykCharts.boolean(m)&&(P+="<tr><td><div style='padding:2px;width:5px;height:5px;background-color:"+c[Q].color+"'></div></td><td>"+c[Q].name+"</td><td><b>"+c[Q].data[R].tooltip+"</b></td></tr>",G=3):(P+="<tr><td>"+c[Q].name+"</td><td><b>"+c[Q].data[R].tooltip+"</b></td></tr>",G=2));D+=6,tooltipText="<table><thead><th colspan='"+G+"'>"+A+"</th></thead><tbody>"+P+"</tbody></table>","stackedAreaChart"===j?(v=1,this.tooltipPosition(tooltipText,D,x,60,70,v)):this.tooltipPosition(tooltipText,D,x,60,-15,v),this.tooltipTextShow(tooltipText),a.crosshair_enable?this.crossHairShow(D,s,D,u-t,D,N,j,K.length,n,c):null,this.axisHighlightShow(K,a.selector+" .y.axis",h),this.axisHighlightShow(A,a.selector+" .x.axis",h)}}}},crossHairShow:function(c,d,e,f,g,h,i,k,l,m,n){if(PykCharts.boolean(a.crosshair_enable)&&void 0!==c)if("lineChart"===i||"areaChart"===i)b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c).attr("y1",d).attr("x2",e).attr("y2",f),b.cross_hair_h.style("display","block"),b.cross_hair_h.select(a.selector+" #cross-hair-h").attr("x1",a.margin_left).attr("y1",h).attr("x2",a.width-a.margin_right).attr("y2",h),b.focus_circle.style("display","block").attr("transform","translate("+g+","+h+")");else if("multilineChart"===i)if("no"===l)for(b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c-5).attr("y1",d).attr("x2",e-5).attr("y2",f),j=0;j<m.length;j++)d3.select(a.selector+" #f_circle"+j).style("display","block").attr("transform","translate("+(g-3)+","+h[j]+")");else"yes"===l&&(d3.selectAll(a.selector+" .line-cursor").style("display","block"),d3.selectAll(a.selector+" .cross-hair-v").attr("x1",c-5).attr("y1",d).attr("x2",e-5).attr("y2",f),d3.select(a.selector+" #svg-"+n+" .cross-hair-h").attr("x1",a.margin_left).attr("y1",h).attr("x2",a.width-a.margin_right).attr("y2",h),d3.select(a.selector+" #svg-"+n+" .focus").style("display","block").attr("transform","translate("+(g-5)+","+h+")"));else if("stackedAreaChart"===i)for(b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c-5).attr("y1",d).attr("x2",e-5).attr("y2",f),j=0;j<m.length;j++)d3.select(a.selector+" #f_circle"+j).style("display","block").attr("transform","translate("+(g-3)+","+h[j]+")");return this},crossHairHide:function(c){return PykCharts.boolean(a.crosshair_enable)&&(b.cross_hair_v.style("display","none"),"lineChart"===c||"areaChart"===c?(b.cross_hair_h.style("display","none"),b.focus_circle.style("display","none")):("multilineChart"===c||"stackedAreaChart"===c)&&(d3.selectAll(a.selector+" .line-cursor").style("display","none"),d3.selectAll(a.selector+" .focus").style("display","none"))),this
},axisHighlightShow:function(b,c,d,e){var f,g,h,i,j;if(PykCharts.boolean(a.axis_onhover_hightlight_enable))if(c===a.selector+" .y.axis"){i=c+" .tick text",h=a.axis_y_label_color,j=d3.selectAll(i)[0].length,d3.selectAll(i).style("fill","#bbb").style("font-size","12px").style("font-weight","normal");for(var k=0;j>k;k++)for(var e=0;e<b.length;e++)d3.selectAll(i)[0][k].innerHTML==b[e]&&d3.select(d3.selectAll(i)[0][k]).style("fill",h).style("font-size","13px").style("font-weight","bold")}else{c===a.selector+" .x.axis"?(i=c+" .tick text",h=a.axis_x_label_color):c===a.selector+" .axis-text"&&"column"===e?(i=c,h=a.axis_x_label_color):c===a.selector+" .axis-text"&&"bar"===e&&(i=c,h=a.axis_y_label_color),void 0!==g&&d3.select(d3.selectAll(i)[0][g]).style("fill",h).style("font-weight","normal");var l=d.length;for(f=0;l>f&&d[f]!==b;f++);g=f,d3.selectAll(i).style("fill","#bbb").style("font-size","12px").style("font-weight","normal"),d3.select(d3.selectAll(i)[0][f]).style("fill",h).style("font-size","13px").style("font-weight","bold")}return this},axisHighlightHide:function(b,c){var d,e;return PykCharts.boolean(a.axis_onhover_hightlight_enable)&&(b===a.selector+" .y.axis"?(e=b+" .tick text",d=a.axis_y_label_color):b===a.selector+" .x.axis"?(e=b+" .tick text",d=a.axis_x_label_color):b===a.selector+" .axis-text"&&"column"===c?(e=b,d=a.axis_x_label_color):b===a.selector+" .axis-text"&&"bar"===c&&(e=b,d=a.axis_y_label_color),d3.selectAll(e).style("fill",d).style("font-size","12px").style("font-weight","normal")),this}};return c},configuration.fillChart=function(a,b){var c={selectColor:function(b){return b.name===a.highlight?a.highlight_color:a.chart_color},colorChart:function(c){return c.name===a.highlight?b.stylesheet.highlight_color:b.stylesheet.chart_color},colorPieW:function(b){return PykCharts.boolean(a.variable_circle_size_enable)?PykCharts.boolean(a.variable_circle_size_enable)?b.color?b.color:a.chart_color.length?a.color:a.chart_color[0]:void 0:a.saturation_color},colorPieMS:function(b){return b.name.toLowerCase()===a.highlight.toLowerCase()?a.highlight_color:"saturation"===a.color_mode?a.saturation_color:"color"===a.color_mode?b.color:"color"===a.color_mode?a.chart_color:a.chart_color[0]},colorGroup:function(b){return"saturation"===a.color_mode?a.saturation_color:"color"===a.color_mode?b.color:"color"===a.color_mode?a.chart_color[0]:void 0},colorLegends:function(b){return"saturation"===a.color_mode?a.saturation_color:"color"===a.color_mode&&b?b:"color"===a.color_mode?a.chart_color:a.chart_color[0]}};return c},configuration.border=function(a){var b={width:function(){return a.border_between_chart_elements_thickness},color:function(){return a.border_between_chart_elements_color},style:function(){return a.border_between_chart_elements_style}};return b},configuration.makeXAxis=function(c,d){var e=(PykCharts.Configuration(c),d3.svg.axis().scale(d).tickSize(c.axis_x_pointer_size).outerTickSize(c.axis_x_outer_pointer_size).tickFormat(function(a){return"yes"===c.panels_enable&&"string"===c.axis_x_data_format?a.substr(0,2):a}).tickPadding(c.axis_x_pointer_padding).orient(c.axis_x_pointer_position));return"time"===c.axis_x_data_format&&PykCharts.boolean(c.axis_x_time_value_datatype)?("month"===c.axis_x_time_value_datatype?(a=d3.time.month,b="%b"):"date"===c.axis_x_time_value_datatype?(a=d3.time.day,b="%d"):"year"===c.axis_x_time_value_datatype?(a=d3.time.year,b="%Y"):"hours"===c.axis_x_time_value_datatype?(a=d3.time.hour,b="%H"):"minutes"===c.axis_x_time_value_datatype&&(a=d3.time.minute,b="%M"),e.ticks(a,c.axis_x_time_value_interval).tickFormat(d3.time.format(b))):"number"===c.axis_x_data_format&&e.ticks(c.axis_x_no_of_axis_value),e},configuration.makeYAxis=function(c,d){var e=(PykCharts.Configuration(c),d3.svg.axis().scale(d).orient(c.axis_y_pointer_position).tickSize(c.axis_y_pointer_size).outerTickSize(c.axis_y_outer_pointer_size).tickPadding(c.axis_y_pointer_padding).tickFormat(function(a){return a}));return"time"===c.axis_y_data_format&&PykCharts.boolean(c.axis_y_time_value_type)?("month"===c.axis_y_time_value_type?(a=d3.time.month,b="%b"):"date"===c.axis_y_time_value_type?(a=d3.time.day,b="%d"):"year"===c.axis_y_time_value_type?(a=d3.time.year,b="%Y"):"hours"===c.axis_y_time_value_type?(a=d3.time.hour,b="%H"):"minutes"===c.axis_y_time_value_type&&(a=d3.time.minute,b="%M"),xaxis.ticks(a,c.axis_y_time_value_unit).tickFormat(d3.time.format(b))):"number"===c.axis_y_data_format&&e.ticks(c.axis_y_no_of_axis_value),e},configuration.makeXGrid=function(a,b){var c=d3.svg.axis().scale(b).orient("bottom").ticks(a.axis_x_no_of_axis_value).tickFormat("").tickSize(a.height-a.margin_top-a.margin_bottom).outerTickSize(0);return c},configuration.makeYGrid=function(a,b){var c;c=PykCharts.boolean(a.panels_enable)?a.w-a.margin_left-a.margin_right:a.width-a.margin_left-a.margin_right;var d=d3.svg.axis().scale(b).orient("left").ticks(a.axis_x_no_of_axis_value).tickSize(-c).tickFormat("").outerTickSize(0);return d},configuration.transition=function(a){var b={duration:function(){return"default"===a.mode&&PykCharts.boolean(a.transition_duration)?1e3*a.transition_duration:0}};return b},configuration.Theme=function(){var a=this;return a.stylesheet={mode:"default",selector:"",chart_height:400,chart_width:600,chart_margin_top:35,chart_margin_right:50,chart_margin_bottom:35,chart_margin_left:50,title_size:15,title_color:"#1D1D1D",title_weight:"bold",title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",subtitle_size:12,subtitle_color:"black",subtitle_weight:"normal",subtitle_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",highlight:"",highlight_color:"#08306b",background_color:"transparent",chart_color:["#255AEE"],saturation_color:"#255AEE",border_between_chart_elements_thickness:1,border_between_chart_elements_color:"white",border_between_chart_elements_style:"solid",legends_enable:"yes",legends_display:"horizontal",legends_text_size:13,legends_text_color:"white",legends_text_weight:"normal",legends_text_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",label_size:13,label_color:"white",label_weight:"normal",label_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pointer_overflow_enable:"no",pointer_thickness:1,pointer_weight:"normal",pointer_size:13,pointer_color:"#1D1D1D",pointer_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",export_enable:"yes",export_image_url:"",color_mode:"saturation",axis_x_enable:"yes",axis_x_title:"X axis",axis_x_position:"bottom",axis_x_pointer_position:"top",axis_x_line_color:"#1D1D1D",axis_x_label_color:"#1D1D1D",axis_x_no_of_axis_value:5,axis_x_pointer_size:5,axis_x_pointer_padding:6,axis_x_pointer_values:[],axis_x_outer_pointer_size:0,axis_x_time_value_datatype:"",axis_x_time_value_interval:0,axis_x_data_format:"string",loading_gif_url:"https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/img/loader.gif",tooltip_enable:"yes",tooltip_mode:"moving",credit_my_site_name:"Pykih",credit_my_site_url:"http://www.pykih.com"},a.functionality={real_time_charts_refresh_frequency:0,real_time_charts_last_updated_at_enable:"yes",transition_duration:0},a.oneDimensionalCharts={clubdata_enable:"yes",clubdata_text:"Others",clubdata_maximum_nodes:5,pie_radius_percent:70,donut_radius_percent:70,donut_inner_radius_percent:40,donut_show_total_at_center:"yes",pictograph_show_all_images:"yes",pictograph_total_count_enable:"yes",pictograph_current_count_enable:"yes",pictograph_image_per_line:3,pictograph_image_width:79,pictograph_image_height:66,pictograph_current_count_size:64,pictograph_current_count_color:"#255AEE",pictograph_current_count_weight:"normal",pictograph_current_count_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pictograph_total_count_size:64,pictograph_total_count_color:"grey",pictograph_total_count_weight:"normal",pictograph_total_count_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",funnel_rect_width:100,funnel_rect_height:100,percent_column_rect_width:15,percent_row_rect_height:26},a.multiDimensionalCharts={chart_grid_x_enable:"yes",chart_grid_y_enable:"yes",chart_grid_color:"#ddd",axis_onhover_hightlight_enable:"no",axis_y_enable:"yes",axis_y_position:"left",axis_y_pointer_position:"left",axis_y_line_color:"#1D1D1D",axis_y_label_color:"#1D1D1D",axis_y_no_of_axis_value:5,axis_y_pointer_size:5,axis_y_pointer_padding:6,axis_y_pointer_values:[],axis_y_outer_pointer_size:0,axis_y_time_value_datatype:"",axis_y_time_value_interval:0,axis_y_data_format:"number",panels_enable:"no",variable_circle_size_enable:"yes",crosshair_enable:"yes",zoom_enable:"no",zoom_level:3,spiderweb_outer_radius_percent:80,spiderweb_axis_title:"yes",spiderweb_pointer:"yes",scatterplot_radius:20,scatterplot_pointer:"no",line_curvy_lines:"no",data_sort_enable:"yes",data_sort_type:"alphabetically",data_sort_order:"ascending"},a.treeCharts={zoom_enable:"no",nodeRadius:4.5},a.mapsTheme={total_no_of_colors:3,palette_color:"Blue-1",tooltip_position_top:0,tooltip_position_left:0,timeline_duration:1e3,timeline_margin_top:5,timeline_margin_right:25,timeline_margin_bottom:25,timeline_margin_left:45,label_enable:"no",click_enable:"yes",onhover:"shadow"},a},PykCharts.oneD={},PykCharts.oneD.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.oneD.processInputs=function(a,b){{var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.oneDimensionalCharts;b.optional}if(a.selector=b.selector?b.selector:d.selector,b.chart_width){var g=$(b.selector).width();b.chart_width=g<b.chart_width?g:b.chart_width}switch(a.width=b.chart_width?b.chart_width:d.chart_width,a.mode=b.mode?b.mode:d.mode,b&&PykCharts.boolean(b.title_text)?(a.title_text=b.title_text,a.title_size="title_size"in b?b.title_size:d.title_size,a.title_color=b.title_color?b.title_color:d.title_color,a.title_weight=b.title_weight?b.title_weight:d.title_weight,a.title_family=b.title_family?b.title_family:d.title_family):(a.title_size=d.title_size,a.title_color=d.title_color,a.title_weight=d.title_weight,a.title_family=d.title_family),b&&PykCharts.boolean(b.subtitle_text)?(a.subtitle_text=b.subtitle_text,a.subtitle_size="subtitle_size"in b?b.subtitle_size:d.subtitle_size,a.subtitle_color=b.subtitle_color?b.subtitle_color:d.subtitle_color,a.subtitle_weight=b.subtitle_weight?b.subtitle_weight:d.subtitle_weight,a.subtitle_family=b.subtitle_family?b.subtitle_family:d.subtitle_family):(a.subtitle_size=d.subtitle_size,a.subtitle_color=d.subtitle_color,a.subtitle_weight=d.subtitle_weight,a.subtitle_family=d.subtitle_family),a.real_time_charts_refresh_frequency=b.real_time_charts_refresh_frequency?b.real_time_charts_refresh_frequency:e.real_time_charts_refresh_frequency,a.real_time_charts_last_updated_at_enable=b.real_time_charts_last_updated_at_enable?b.real_time_charts_last_updated_at_enable:e.real_time_charts_last_updated_at_enable,b.credit_my_site_name||b.credit_my_site_url?(a.credit_my_site_name=b.credit_my_site_name?b.credit_my_site_name:"",a.credit_my_site_url=b.credit_my_site_url?b.credit_my_site_url:""):(a.credit_my_site_name=d.credit_my_site_name,a.credit_my_site_url=d.credit_my_site_url),a.data_source_name=b.data_source_name?b.data_source_name:"",a.data_source_url=b.data_source_url?b.data_source_url:"",a.clubdata_enable=b.clubdata_enable?b.clubdata_enable:f.clubdata_enable,a.clubdata_text=PykCharts.boolean(b.clubdata_enable)&&b.clubdata_text?b.clubdata_text:f.clubdata_text,a.clubdata_maximum_nodes=PykCharts.boolean(b.clubdata_maximum_nodes)&&b.clubdata_maximum_nodes?b.clubdata_maximum_nodes:f.clubdata_maximum_nodes,a.clubdata_always_include_data_points=PykCharts.boolean(b.clubdata_enable)&&b.clubdata_always_include_data_points?b.clubdata_always_include_data_points:[],a.transition_duration=b.transition_duration?b.transition_duration:e.transition_duration,a.pointer_overflow_enable=b.pointer_overflow_enable?b.pointer_overflow_enable:d.pointer_overflow_enable,a.background_color=b.background_color?b.background_color:d.background_color,a.chart_color=b.chart_color?b.chart_color:d.chart_color,a.highlight_color=b.highlight_color?b.highlight_color:d.highlight_color,a.fullscreen_enable=b.fullscreen_enable?b.fullscreen_enable:d.fullscreen_enable,a.loading=b.loading_gif_url?b.loading_gif_url:d.loading_gif_url,a.tooltip_enable=b.tooltip_enable?b.tooltip_enable:d.tooltip_enable,a.border_between_chart_elements_thickness="border_between_chart_elements_thickness"in b?b.border_between_chart_elements_thickness:d.border_between_chart_elements_thickness,a.border_between_chart_elements_color=b.border_between_chart_elements_color?b.border_between_chart_elements_color:d.border_between_chart_elements_color,a.border_between_chart_elements_style=b.border_between_chart_elements_style?b.border_between_chart_elements_style:d.border_between_chart_elements_style,a.border_between_chart_elements_style){case"dotted":a.border_between_chart_elements_style="1,3";break;case"dashed":a.border_between_chart_elements_style="5,5";break;default:a.border_between_chart_elements_style="0"}return a.highlight=b.highlight?b.highlight:d.highlight,a.label_size="label_size"in b?b.label_size:d.label_size,a.label_color=b.label_color?b.label_color:d.label_color,a.label_weight=b.label_weight?b.label_weight:d.label_weight,a.label_family=b.label_family?b.label_family:d.label_family,a.pointer_thickness="pointer_thickness"in b?b.pointer_thickness:d.pointer_thickness,a.pointer_size="pointer_size"in b?b.pointer_size:d.pointer_size,a.pointer_color=b.pointer_color?b.pointer_color:d.pointer_color,a.pointer_family=b.pointer_family?b.pointer_family:d.pointer_family,a.pointer_weight=b.pointer_weight?b.pointer_weight:d.pointer_weight,a.donut_show_total_at_center=b.donut_show_total_at_center?b.donut_show_total_at_center:f.donut_show_total_at_center,a.units_prefix=b.units_prefix?b.units_prefix:!1,a.units_suffix=b.units_suffix?b.units_suffix:!1,a.export_enable=b.export_enable?b.export_enable:d.export_enable,a.export_image_url=b.export_image_url?b.export_image_url:d.export_image_url,a.k=new PykCharts.Configuration(a),a.k.validator().validatingSelector(a.selector.substring(1,a.selector.length)).validatingChartMode(a.mode).validatingDataType(a.width,"chart_width").validatingDataType(a.title_size,"title_size").validatingDataType(a.subtitle_size,"subtitle_size").validatingDataType(a.real_time_charts_refresh_frequency,"real_time_charts_refresh_frequency").validatingDataType(a.transition_duration,"transition_duration").validatingDataType(a.border_between_chart_elements_thickness,"border_between_chart_elements_thickness").validatingDataType(a.label_size,"label_size").validatingDataType(a.pointer_thickness,"pointer_thickness").validatingDataType(a.pointer_size,"pointer_size").validatingDataType(a.clubdata_maximum_nodes,"clubdata_maximum_nodes").validatingBorderBetweenChartElementsStyle(a.border_between_chart_elements_style,"border_between_chart_elements_style").isArray(a.chart_color,"chart_color").validatingFontWeight(a.title_weight,"title_weight").validatingFontWeight(a.subtitle_weight,"subtitle_weight").validatingFontWeight(a.pointer_weight,"pointer_weight").validatingFontWeight(a.label_weight,"label_weight"),a},PykCharts.oneD.bubble=function(a){var b=this;this.execute=function(){b=PykCharts.oneD.processInputs(b,a),b.height=a.chart_height?a.chart_height:b.width,b.k.validator().validatingDataType(b.height,"chart_height"),b.stop||("default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){console.log(a.data,"data"),b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.render()}))},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.new_data=b.optionalFeatures().clubData(),b.optionalFeatures().createChart().label()})},this.render=function(){b.fillChart=new PykCharts.Configuration.fillChart(b),b.onHoverEffect=new PykCharts.oneD.mouseEvent(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#svgcontainer","bubble").emptyDiv().subtitle(),b.new_data=b.optionalFeatures().clubData(),b.optionalFeatures().svgContainer().createChart().label(),b.k.createFooter().lastUpdatedAt().credits().dataSource().liveData(b).tooltip()):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#svgcontainer","bubble").emptyDiv(),b.new_data={children:b.data},b.optionalFeatures().svgContainer().createChart().label(),b.k.tooltip()),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)},this.optionalFeatures=function(){var c={svgContainer:function(){return b.svgContainer=d3.select(b.selector).append("svg").attr("class","svgcontainer").attr("id","svgcontainer").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height).attr("width",b.width).attr("height",b.height),b.group=b.svgContainer.append("g").attr("id","bubgrp"),this},createChart:function(){b.bubble=d3.layout.pack().sort(function(a,b){return b.weight-a.weight}).size([b.width,b.height]).value(function(a){return a.weight}).padding(20),b.sum=d3.sum(b.new_data.children,function(a){return a.weight});b.new_data.children.length;return b.node=b.bubble.nodes(b.new_data),b.chart_data=b.group.selectAll(".bubble-node").data(b.node),b.chart_data.enter().append("g").attr("class","bubble-node").append("circle"),b.chart_data.attr("class","bubble-node").select("circle").attr("class","bubble").attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("r",0).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("fill",function(a){return a.children?b.background_color:b.fillChart.selectColor(a)}).on("mouseover",function(c){c.children||"default"!==b.mode||(b.onHoverEffect.highlight(a.selector+" .bubble",this),c.tooltip=c.tooltip||"<table><thead><th colspan='2' class='tooltip-heading'>"+c.name+"</th></thead><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"  <td class='tooltip-right-content'>(&nbsp;"+(100*c.weight/b.sum).toFixed(2)+"%&nbsp;)</tr></table>",b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(c.tooltip))}).on("mouseout",function(c){"default"===b.mode&&(b.mouseEvent.tooltipHide(c),b.onHoverEffect.highlightHide(a.selector+" .bubble"))}).on("mousemove",function(a){a.children||"default"!==b.mode||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("r",function(a){return a.r}),b.chart_data.exit().remove(),this},label:function(){return b.chart_text=b.group.selectAll(".name").data(b.node),b.chart_text1=b.group.selectAll(".weight").data(b.node),b.chart_text.enter().append("svg:text").attr("class","name"),b.chart_text1.enter().append("svg:text").attr("class","weight"),b.chart_text.attr("class","name").attr("x",function(a){return a.x}).attr("y",function(a){return a.y-5}),b.chart_text1.attr("class","weight").attr("x",function(a){return a.x}).attr("y",function(a){return a.y+10}),b.chart_text.attr("text-anchor","middle").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text(""),setTimeout(function(){b.chart_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<2*a.r&&this.getBBox().height<2*a.r?a.children?" ":a.name:""})},b.transitions.duration()),b.chart_text1.attr("text-anchor","middle").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text("").attr("pointer-events","none"),setTimeout(function(){b.chart_text1.text(function(a){return a.children?" ":b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<2*a.r*.55&&this.getBBox().height<2*a.r*.55?a.children?" ":(100*a.weight/b.sum).toFixed(1)+"%":""})},b.transitions.duration()),b.chart_text.exit().remove(),b.chart_text1.exit().remove(),this},clubData:function(){var a;if(PykCharts.boolean(b.clubdata_enable)){var c,d,e=[],f=0,g=[];if(b.data.length<=b.clubdata_maximum_nodes)return a={children:b.data};if(0!==b.clubdata_always_include_data_points.length){var h=b.clubdata_always_include_data_points.length;for(d=0;h>d;d++)e[d]=b.clubdata_always_include_data_points[d]}for(d=0;d<e.length;d++)for(c=0;c<b.data.length;c++)e[d].toUpperCase()===b.data[c].name.toUpperCase()&&g.push(b.data[c]);for(b.data.sort(function(a,b){return b.weight-a.weight});g.length<b.clubdata_maximum_nodes-1;){for(d=0;d<e.length;d++)b.data[f].name.toUpperCase()===e[d].toUpperCase()&&f++;g.push(b.data[f]),f++}var i=0;for(c=f;c<b.data.length;c++){for(d=0;d<g.length&&d<b.data.length;d++)b.data[c].name.toUpperCase()===g[d].name.toUpperCase()&&(i+=0,c++,d=-1);c<b.data.length&&(i+=b.data[c].weight)}for(var j=function(a,b){return b.weight-a.weight};g.length>b.clubdata_maximum_nodes;){g.sort(j);{g.pop()}}var k={name:b.clubdata_text,weight:i,color:b.clubData_color,tooltip:b.clubData_tooltipText,highlight:!1};g.length<b.clubdata_maximum_nodes&&g.push(k),g.sort(function(a,b){return a.weight-b.weight}),a={children:g},b.map1=a.children.map(function(a){return a.weight})}else b.data.sort(function(a,b){return a.weight-b.weight}),a={children:b.data};return a}};return c}},PykCharts.oneD.funnel=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a),b.height=a.chart_height?a.chart_height:b.width;var d=(a.optional,c.oneDimensionalCharts);b.rect_width=a.funnel_rect_width&&_.isNumber(a.funnel_rect_width)?a.funnel_rect_width:d.funnel_rect_width,b.rect_height=a.funnel_rect_height&&_.isNumber(a.funnel_rect_height)?a.funnel_rect_height:d.funnel_rect_height,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData().createChart().label().ticks()})},this.render=function(){var a=this;a.fillChart=new PykCharts.Configuration.fillChart(a),a.onHoverEffect=new PykCharts.oneD.mouseEvent(a),a.transitions=new PykCharts.Configuration.transition(a),a.border=new PykCharts.Configuration.border(a),"default"===a.mode&&a.k.title().backgroundColor(a).export(a,"#svgcontainer","funnel").emptyDiv().subtitle(),a.k.tooltip(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a),"infographics"===a.mode&&(a.k.backgroundColor(a).export(a,"#svgcontainer","funnel").emptyDiv(),a.new_data=a.data),"default"===a.mode&&a.optionalFeatures().clubData(),a.optionalFeatures().svgContainer().createChart().label().ticks(),"default"===a.mode&&a.k.liveData(a).createFooter().lastUpdatedAt().credits().dataSource(),$(window).on("load",function(){return a.k.resize(a.svgContainer)}).on("resize",function(){return a.k.resize(a.svgContainer)})},this.funnelLayout=function(){var a,b,c,d=this,e={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},mouth:function(a){return 2!==a.length||(c=a),this},coordinates:function(){function e(a){return d3.sum(q,function(b,c){return c>=a?b:void 0})}for(var f=b[0],g=b[1],h=c[0],i=c[1],j=(f-h)/2,k=g-i,l=0,m=0,n=0,o=0,p=[],q=d.percentageValues(a),r=j/k,s=(f+h)/2*k,t=h*i,u=s+t,v=t/u*100,w=a.length-1;w>=0;w--){var x=e(w);if(v>=x)n=x/v*i,l=g-n,p[w]=w===a.length-1?{values:[{x:(f-h)/2,y:l},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:l}]}:{values:[{x:(f-h)/2,y:l},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:l}]};else{var y;y=0===o?(x-v)/100*s:x/100*s;var z=2*r,A=2*h,B=2*y;m=(-A+Math.sqrt(Math.pow(A,2)-4*z*-B))/(2*z),l=g-m-i;var C=2*r*m+h,D=(f-C)/2;if(0===o)p[w]=w===a.length-1?{values:[{x:D,y:l},{x:(f-h)/2,y:k},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:k},{x:C+D,y:l}]}:{values:[{x:D,y:l},{x:(f-h)/2,y:k},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:k},{x:C+D,y:l}]};else{var E;E=6===p[w+1].values.length?5:3,p[w]={values:[{x:D,y:l},p[w+1].values[0],p[w+1].values[E],{x:C+D,y:l}]}}o=1}}return p}};return e},this.percentageValues=function(a){var b=this;b.sum=d3.sum(a,function(a){return a.weight});var c=a.map(function(a){return a.weight/b.sum*100});return c.sort(function(a,b){return b-a}),c},this.optionalFeatures=function(){var c={svgContainer:function(){return b.svgContainer=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svgContainer.append("g").attr("id","funnel"),this},createChart:function(){b.per_values=b.percentageValues(b.new_data),b.funnel=b.funnelLayout().data(b.new_data).size([b.width,b.height]).mouth([b.rect_width,b.rect_height]),b.coordinates=b.funnel.coordinates();var c=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});b.chart_data=b.group.selectAll(".fun-path").data(b.coordinates);var d=[{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0}];return b.chart_data.enter().append("path").attr("class","fun-path"),b.chart_data.attr("class","fun-path").attr("d",function(){return c(d)}).attr("fill",function(a,c){return b.fillChart.selectColor(b.new_data[c])}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).attr("stroke-opacity",1).on("mouseover",function(c,d){"default"===b.mode&&(b.onHoverEffect.highlight(a.selector+" .fun-path",this),tooltip=b.new_data[d].tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.new_data[d].name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(b.new_data[d].weight)+"<td class='tooltip-right-content'>(&nbsp; "+b.per_values[d].toFixed(2)+"%&nbsp) </tr></table>",b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(tooltip))}).on("mouseout",function(c){"default"===b.mode&&(b.onHoverEffect.highlightHide(a.selector+" .fun-path"),b.mouseEvent.tooltipHide(c))}).on("mousemove",function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("d",function(a){return c(a.values)}),b.chart_data.exit().remove(),this},label:function(){return b.chart_text=b.group.selectAll("text").data(b.coordinates),b.chart_text.enter().append("text"),b.chart_text.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+5:(a.values[0].y-a.values[2].y)/2+a.values[2].y+5}).attr("x",function(){return b.width/2}),b.chart_text.text(""),setTimeout(function(){b.chart_text.text(function(a,c){return b.per_values[c].toFixed(1)+"%"}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text(function(a,c){return this.getBBox().width<a.values[3].x-a.values[1].x&&this.getBBox().height<a.values[2].y-a.values[0].y?b.per_values[c].toFixed(1)+"%":""})},b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){PykCharts.boolean(b.pointer_overflow_enable)&&b.svgContainer.style("overflow","visible");var a=[],c=b.group.selectAll(".ticks_label").data(b.coordinates);c.attr("class","ticks_label"),c.enter().append("text").attr("x",0).attr("y",0);var d,e;c.attr("transform",function(a){return 4===a.values.length?(d=(a.values[3].x+a.values[2].x)/2+10,e=(a.values[0].y+a.values[2].y)/2+5):(d=a.values[4].x+10,e=a.values[4].y+5),"translate("+d+","+e+")"}),c.text(""),setTimeout(function(){c.text(function(a,c){return b.new_data[c].name}).text(function(c,d){return a[d]=this.getBBox().height,this.getBBox().height<c.values[2].y-c.values[0].y?b.new_data[d].name:""}).attr("font-size",b.pointer_size).attr("text-anchor","start").attr("fill",b.pointer_color).attr("pointer-events","none").attr("font-family",b.pointer_family).attr("font-weight",b.pointer_weight)},b.transitions.duration()),c.exit().remove();var f=b.group.selectAll(".funnel-ticks").data(b.coordinates);return f.enter().append("line").attr("class","funnel-ticks"),f.attr("x1",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:a.values[4].x}).attr("y1",function(a){return 4===a.values.length?(a.values[0].y+a.values[2].y)/2:a.values[4].y}).attr("x2",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:a.values[4].x}).attr("y2",function(a){return 4===a.values.length?(a.values[0].y+a.values[2].y)/2:a.values[4].y}).attr("stroke-width",b.pointer_thickness).attr("stroke",b.pointer_color),setTimeout(function(){f.attr("x2",function(b,c){return b.values[2].y-b.values[0].y>a[c]?4===b.values.length?(b.values[3].x+b.values[2].x)/2+5:b.values[4].x+5:4===b.values.length?(b.values[3].x+b.values[2].x)/2:b.values[4].x})},b.transitions.duration()),f.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubdata_enable)){var a=[];if(0!==b.clubdata_always_include_data_points.length){var c=b.clubdata_always_include_data_points.length;for(i=0;c>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubdata_maximum_nodes;){d.sort(g);{d.pop()}}var h={name:b.clubdata_text,weight:f,color:b.clubData_color,tooltip:b.clubData_tooltip};d.length<b.clubdata_maximum_nodes&&d.push(h),d.sort(function(a,b){return b.weight-a.weight}),b.new_data=d}else b.data.sort(function(a,b){return b.weight-a.weight}),b.new_data=b.data;return this}};return c}},PykCharts.oneD.percentageColumn=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){var b=this;b=new PykCharts.oneD.processInputs(b,a,"percentageColumn"),a.percent_column_rect_width&&a.percent_column_rect_width>100&&(a.percent_column_rect_width=100),b.percent_column_rect_width=a.percent_column_rect_width?a.percent_column_rect_width:c.oneDimensionalCharts.percent_column_rect_width,b.percent_column_rect_width=2*b.k._radiusCalculation(b.percent_column_rect_width,"percentageColumn"),b.height=a.chart_height?a.chart_height:b.width,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData().createChart().label().ticks()})},this.render=function(){var b=this;b.fillChart=new PykCharts.Configuration.fillChart(b),b.onHoverEffect=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&b.k.title().backgroundColor(b).export(b,"#svgcontainer","percentageColumn").emptyDiv().subtitle(),"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#svgcontainer","percentageColumn").emptyDiv(),b.new_data=b.data),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"default"===b.mode&&(percent_column=b.optionalFeatures().clubData()),b.optionalFeatures().svgContainer().createChart().label().ticks(),"default"===b.mode&&b.k.liveData(b).createFooter().lastUpdatedAt().credits().dataSource(),$(window).on("load",function(){return b.k.resize(b.svgContainer)
}).on("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var c={createChart:function(){var c=b.new_data.map(function(a){return a.weight});c.sum=function(){for(var a=0,b=0;b<this.length;++b)a+=this[b];return a};var d=c.sum();return b.new_data.forEach(function(a,b){this[b].percentValue=100*a.weight/d},b.new_data),b.new_data.sort(function(a,b){return b.weight-a.weight}),b.chart_data=b.group.selectAll(".per-rect").data(b.new_data),b.chart_data.enter().append("rect").attr("class","per-rect"),b.chart_data.attr("x",0).attr("y",function(a,c){if(0===c)return 0;var d=0,e=b.new_data.slice(0,c);return e.forEach(function(a,b){d+=this[b].percentValue},e),d*b.height/100}).attr("width",b.percent_column_rect_width).attr("height",0).attr("fill",function(a){return b.fillChart.selectColor(a)}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).on("mouseover",function(c){"default"===b.mode&&(c.tooltip=c.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+c.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"<td class='tooltip-right-content'>(&nbsp;"+c.percentValue.toFixed(2)+"%&nbsp)</tr></table>",b.onHoverEffect.highlight(a.selector+" .per-rect",this),b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(c.tooltip))}).on("mouseout",function(c){"default"===b.mode&&(b.onHoverEffect.highlightHide(a.selector+" .per-rect"),b.mouseEvent.tooltipHide(c))}).on("mousemove",function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.percentValue*b.height/100}),b.chart_data.exit().remove(),this},svgContainer:function(){return b.svgContainer=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svgContainer.append("g").attr("id","funnel"),this},label:function(){b.chart_text=b.group.selectAll(".per-text").data(b.new_data);var a=0;return b.chart_text.enter().append("text").attr("class","per-text"),b.chart_text.attr("class","per-text").attr("x",b.percent_column_rect_width/2).attr("y",function(c,d){return a+=c.percentValue,0===d?(0+a*b.height/100)/2+5:((a-c.percentValue)*b.height/100+a*b.height/100)/2+5}),a=0,b.chart_text.text("").attr("fill",b.label_color).style("font-size",b.label_size).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label_weight).style("font-family",b.label_family),setTimeout(function(){b.chart_text.text(function(a){return a.percentValue.toFixed(1)+"%"}).text(function(a){return this.getBBox().width<b.width/4&&this.getBBox().height<a.percentValue*b.height/100?a.percentValue.toFixed(1)+"%":""})},b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){PykCharts.boolean(b.pointer_overflow_enable)&&b.svgContainer.style("overflow","visible");var a,c,d=0,e=0,f=[];d=0;var g=b.group.selectAll(".per-ticks").data(b.new_data);g.enter().append("line").attr("class","per-ticks");var h=b.group.selectAll(".ticks_label").data(b.new_data);return h.enter().append("text").attr("class","ticks_label"),h.attr("class","ticks_label").attr("transform",function(e){return d+=e.percentValue,a=b.percent_column_rect_width+10,c=((d-e.percentValue)*b.height/100+d*b.height/100)/2+5,"translate("+a+","+c+")"}),h.text(function(){return""}).attr("font-size",b.pointer_size).attr("text-anchor","start").attr("fill",b.pointer_color).attr("font-family",b.pointer_family).attr("font-weight",b.pointer_weight).attr("pointer-events","none"),setTimeout(function(){h.text(function(a){return a.name}).text(function(a,c){return f[c]=this.getBBox().height,this.getBBox().height<a.percentValue*b.height/100?a.name:""}),d=0,g.attr("x1",function(){return b.percent_column_rect_width}).attr("y1",function(a,c){return d+=a.percentValue,0===c?(0+d*b.height/100)/2:((d-a.percentValue)*b.height/100+d*b.height/100)/2}).attr("x2",function(){return b.percent_column_rect_width}).attr("y2",function(a,c){return e+=a.percentValue,0===c?(0+e*b.height/100)/2:((e-a.percentValue)*b.height/100+e*b.height/100)/2}).attr("stroke-width",b.pointer_thickness).attr("stroke",b.pointer_color).attr("x2",function(a,c){return a.percentValue*b.height/100>f[c]?b.percent_column_rect_width+5:b.percent_column_rect_width})},b.transitions.duration()),h.exit().remove(),g.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubdata_enable)){var a=[];if(0!==b.clubdata_always_include_data_points.length){var c=b.clubdata_always_include_data_points.length;for(i=0;c>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubdata_maximum_nodes;){d.sort(g);{d.pop()}}var h={name:b.clubdata_text,weight:f,tooltip:b.clubdata_tooltip};d.length<b.clubdata_maximum_nodes&&d.push(h),b.new_data=d}else b.data.sort(function(a,b){return b.weight-a.weight}),b.new_data=b.data;return this}};return c}},PykCharts.oneD.percentageBar=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){var b=this;b=new PykCharts.oneD.processInputs(b,a,"percentageBar"),a.percent_row_rect_height&&a.percent_row_rect_height>100&&(a.percent_row_rect_height=100),b.height=a.chart_height?a.chart_height:b.width/2,b.percent_row_rect_height=a.percent_row_rect_height?a.percent_row_rect_height:c.oneDimensionalCharts.percent_row_rect_height,b.percent_row_rect_height=2*b.k._radiusCalculation(b.percent_row_rect_height,"percentageBar"),"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData().createChart().label().ticks()})},this.render=function(){var b=this;b.fillChart=new PykCharts.Configuration.fillChart(b),b.onHoverEffect=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&b.k.title().backgroundColor(b).export(b,"#svgcontainer","percentageBar").emptyDiv().subtitle(),"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#svgcontainer","percentageBar").emptyDiv(),b.new_data=b.data),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"default"===b.mode&&(percent_bar=b.optionalFeatures().clubData()),b.optionalFeatures().svgContainer().createChart().label().ticks(),"default"===b.mode&&b.k.liveData(b).createFooter().lastUpdatedAt().credits().dataSource(),$(window).on("load",function(){return b.k.resize(b.svgContainer)}).on("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var c={createChart:function(){var c=b.new_data.map(function(a){return a.weight});c.sum=function(){for(var a=0,b=0;b<this.length;++b)a+=this[b];return a};var d=c.sum();return b.new_data.forEach(function(a,b){this[b].percentValue=100*a.weight/d},b.new_data),b.new_data.sort(function(a,b){return b.weight-a.weight}),b.chart_data=b.group.selectAll(".per-rect").data(b.new_data),b.chart_data.enter().append("rect").attr("class","per-rect"),b.chart_data.attr("x",0).attr("x",function(a,c){if(0===c)return 0;var d=0,e=b.new_data.slice(0,c);return e.forEach(function(a,b){d+=this[b].percentValue},e),d*b.width/100}).attr("width",0).attr("height",function(){return b.percent_row_rect_height}).attr("fill",function(a){return b.fillChart.selectColor(a)}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).on("mouseover",function(c){"default"===b.mode&&(c.tooltip=c.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+c.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"<td class='tooltip-right-content'>(&nbsp;"+c.percentValue.toFixed(2)+"%&nbsp)</tr></table>",b.onHoverEffect.highlight(a.selector+" .per-rect",this),b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(c.tooltip))}).on("mouseout",function(c){"default"===b.mode&&(b.onHoverEffect.highlightHide(a.selector+" .per-rect"),b.mouseEvent.tooltipHide(c))}).on("mousemove",function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("width",function(a){return a.percentValue*b.width/100}),b.chart_data.exit().remove(),this},svgContainer:function(){return b.svgContainer=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svgContainer.append("g").attr("id","percentageBar"),this},label:function(){b.chart_text=b.group.selectAll(".per-text").data(b.new_data);var a=0;return b.chart_text.enter().append("text").attr("class","per-text"),b.chart_text.attr("class","per-text").attr("y",b.percent_row_rect_height/2).attr("x",function(c,d){return a+=c.percentValue,0===d?(0+a*b.width/100)/2:((a-c.percentValue)*b.width/100+a*b.width/100)/2}),a=0,b.chart_text.text("").attr("fill",b.label_color).style("font-size",b.label_size).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label_weight).style("font-family",b.label_family),setTimeout(function(){b.chart_text.text(function(a){return a.percentValue.toFixed(1)+"%"}).text(function(a){return this.getBBox().width<a.percentValue*b.width/100&&this.getBBox().height<b.percent_row_rect_height?a.percentValue.toFixed(1)+"%":""})},b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){PykCharts.boolean(b.pointer_overflow_enable)&&b.svgContainer.style("overflow","visible");var a,c,d=0,e=0,f=[];d=0;var g=b.group.selectAll(".per-ticks").data(b.new_data);g.enter().append("line").attr("class","per-ticks");var h=b.group.selectAll(".ticks_label").data(b.new_data);return h.enter().append("text").attr("class","ticks_label"),h.attr("class","ticks_label").attr("transform",function(e){return d+=e.percentValue,c=b.percent_row_rect_height+20,a=((d-e.percentValue)*b.width/100+d*b.width/100)/2,"translate("+a+","+c+")"}),h.text(function(){return""}).attr("font-size",b.pointer_size).attr("text-anchor","middle").attr("fill",b.pointer_color).attr("font-family",b.pointer_family).attr("font-weight",b.pointer_weight).attr("pointer-events","none"),setTimeout(function(){h.text(function(a){return a.name}).text(function(a,c){return f[c]=this.getBBox().width,this.getBBox().width<a.percentValue*b.width/100?a.name:""}),d=0,g.attr("y1",function(){return b.percent_row_rect_height}).attr("x1",function(a,c){return d+=a.percentValue,0===c?(0+d*b.width/100)/2:((d-a.percentValue)*b.width/100+d*b.width/100)/2}).attr("y2",function(){return b.percent_row_rect_height}).attr("x2",function(a,c){return e+=a.percentValue,0===c?(0+e*b.width/100)/2:((e-a.percentValue)*b.width/100+e*b.width/100)/2}).attr("stroke-width",b.pointer_thickness).attr("stroke",b.pointer_color).attr("y2",function(a,c){return a.percentValue*b.width/100>f[c]?b.percent_row_rect_height+5:b.percent_row_rect_height})},b.transitions.duration()),h.exit().remove(),g.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubdata_enable)){var a=[];if(0!==b.clubdata_always_include_data_points.length){var c=b.clubdata_always_include_data_points.length;for(i=0;c>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubdata_maximum_nodes;){d.sort(g);{d.pop()}}var h={name:b.clubdata_text,weight:f,tooltip:b.clubdata_tooltip};d.length<b.clubdata_maximum_nodes&&d.push(h),b.new_data=d}else b.data.sort(function(a,b){return b.weight-a.weight}),b.new_data=b.data;return this}};return c}},PykCharts.oneD.pictograph=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a);var d=(a.optional,c.oneDimensionalCharts);b.showTotal=a.pictograph_show_all_images?a.pictograph_show_all_images:d.pictograph_show_all_images,b.enableTotal=a.pictograph_total_count_enable?a.pictograph_total_count_enable:d.pictograph_total_count_enable,b.enableCurrent=a.pictograph_current_count_enable?a.pictograph_current_count_enable:d.pictograph_current_count_enable,b.imgperline=a.pictograph_image_per_line?a.pictograph_image_per_line:d.pictograph_image_per_line,b.current_count_size=a.pictograph_current_count_size?a.pictograph_current_count_size:d.pictograph_current_count_size,b.current_count_color=a.pictograph_current_count_color?a.pictograph_current_count_color:d.pictograph_current_count_color,b.current_count_weight=a.pictograph_current_count_weight?a.pictograph_current_count_weight:d.pictograph_current_count_weight,b.current_count_family=a.pictograph_current_count_family?a.pictograph_current_count_family:d.pictograph_current_count_family,b.total_count_size=a.pictograph_total_count_size?a.pictograph_total_count_size:d.pictograph_total_count_size,b.total_count_color=a.pictograph_total_count_color?a.pictograph_total_count_color:d.pictograph_total_count_color,b.total_count_weight=a.pictograph_total_count_weight?a.pictograph_total_count_weight:d.pictograph_total_count_weight,b.total_count_family=a.pictograph_total_count_family?a.pictograph_total_count_family:d.pictograph_total_count_family,b.imageWidth=a.pictograph_image_width?a.pictograph_image_width:d.pictograph_image_width,b.imageHeight=a.pictograph_image_height?a.pictograph_image_height:d.pictograph_image_height,b.height=a.chart_height?a.chart_height:b.width,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.sort(function(a,b){return b.weight-a.weight}),$(a.selector+" #chart-loader").remove(),b.render()})},this.render=function(){b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode?b.k.title().backgroundColor(b).export(b,"#svgcontainer","pictograph").emptyDiv().subtitle():b.k.backgroundColor(b).export(b,"#svgcontainer","pictograph").emptyDiv(),b.optionalFeatures().svgContainer().createChart().labelText().enableLabel(),"default"===b.mode&&b.k.createFooter().credits().dataSource(),$(window).on("load",function(){return b.k.resize(b.svgContainer)}).on("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var c={svgContainer:function(){return b.svgContainer=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height),b.group=b.svgContainer.append("g").attr("transform","translate("+b.imageWidth+",0)"),b.group1=b.svgContainer.append("g").attr("transform","translate(0,0)"),this},createChart:function(){var a=0,c=1;b.optionalFeatures().showTotal();for(var d=0,e=1;e<=b.weight;e++)e<=b.data[1].weight?b.group.append("image").attr("xlink:href",b.data[1].image).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"):b.group.append("image").attr("xlink:href",b.data[0].image).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"),d++,c++,d>=b.imgperline&&(a++,c=1,d=0,b.group.append("text").html("<br><br>"));return this},showTotal:function(){return b.weight=PykCharts.boolean(b.showTotal)?b.data[0].weight:b.data[1].weight,this},enableLabel:function(){if(PykCharts.boolean(b.enableTotal)){var a,c=b.data[0].weight/b.imgperline;this.labelText(),b.group1.append("text").attr("font-family",b.total_count_family).attr("font-size",b.total_count_size).attr("font-weight",b.total_count_weight).attr("fill",b.total_count_color).text("/"+b.data[0].weight).text(function(){return a=this.getBBox().height,"/"+b.data[0].weight}).attr("x",b.textWidth+5).attr("y",function(){return b.imageHeight*c/2+a/2})}return this},labelText:function(){if(PykCharts.boolean(b.enableCurrent)){var a,c=b.data[0].weight/b.imgperline;b.group1.append("text").attr("x",0).attr("font-family",b.current_count_family).attr("font-size",b.current_count_size).attr("font-weight",b.current_count_weight).attr("fill",b.current_count_color).text(b.data[1].weight).text(function(){return a=this.getBBox().height,b.textWidth=this.getBBox().width,b.data[1].weight}).attr("y",function(){return b.imageHeight*c/2+a/2})}return this}};return c}},PykCharts.oneD.pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),a.chart_height?(b.height=a.chart_height,b.calculation=void 0):(b.height=b.width,b.calculation="pie"),a.pie_radius_percent&&a.pie_radius_percent>100&&(a.pie_radius_percent=100),b.height_translate=b.height/2,b.radiusPercent=a.pie_radius_percent&&_.isNumber(a.pie_radius_percent)?a.pie_radius_percent:c.oneDimensionalCharts.pie_radius_percent,b.innerRadiusPercent=0,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"pie");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",e.render()})}},PykCharts.oneD.donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),a.chart_height?(b.height=a.chart_height,b.calculation=void 0):(b.height=b.width,b.calculation="pie"),a.donut_radius_percent&&a.donut_radius_percent>100&&(a.donut_radius_percent=100),a.donut_inner_radius_percent&&a.donut_inner_radius_percent>100&&(a.donut_inner_radius_percent=100),b.height_translate=b.height/2,b.radiusPercent=a.donut_radius_percent&&_.isNumber(a.donut_radius_percent)?a.donut_radius_percent:c.oneDimensionalCharts.donut_radius_percent,b.innerRadiusPercent=a.donut_inner_radius_percent&&_.isNumber(a.donut_inner_radius_percent)?a.donut_inner_radius_percent:c.oneDimensionalCharts.donut_inner_radius_percent,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"donut");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",e.render()})}},PykCharts.oneD.election_pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),a.chart_height?(b.height=a.chart_height,b.calculation=void 0,b.height_translate=b.height/2):(b.height=b.width/2,b.calculation="pie",b.height_translate=b.height),a.pie_radius_percent&&a.pie_radius_percent>100&&(a.pie_radius_percent=100),b.radiusPercent=a.pie_radius_percent&&_.isNumber(a.pie_radius_percent)?a.pie_radius_percent:c.oneDimensionalCharts.pie_radius_percent,b.innerRadiusPercent=0,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election pie");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",e.render()})}},PykCharts.oneD.election_donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),a.chart_height?(b.height=a.chart_height,b.calculation=void 0,b.height_translate=b.height/2):(b.height=b.width/2,b.calculation="pie",b.height_translate=b.height),a.donut_radius_percent&&a.donut_radius_percent>100&&(a.donut_radius_percent=100),a.donut_inner_radius_percent&&a.donut_inner_radius_percent>100&&(a.donut_inner_radius_percent=100),b.radiusPercent=a.donut_radius_percent&&_.isNumber(a.donut_radius_percent)?a.donut_radius_percent:c.oneDimensionalCharts.donut_radius_percent,b.innerRadiusPercent=a.donut_inner_radius_percent&&_.isNumber(a.donut_inner_radius_percent)&&a.donut_inner_radius_percent?a.donut_inner_radius_percent:c.oneDimensionalCharts.donut_inner_radius_percent,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election donut");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",e.render()})}},PykCharts.oneD.pieFunctions=function(a,b,c){var d=b;d.refresh=function(){d3.json(a.data,function(a,b){d.data=b.groupBy("oned"),d.refresh_data=b.groupBy("oned");var c=d.k.checkChangeInData(d.refresh_data,d.compare_data);d.compare_data=c[0];var e=c[1];e&&d.k.lastUpdatedAt("liveData"),d.new_data=d.optionalFeatures().clubData(),d.optionalFeatures().createChart().label().ticks().centerLabel()})},this.render=function(){d.count=1,d.fillChart=new PykCharts.Configuration.fillChart(d),d.onHoverEffect=new PykCharts.oneD.mouseEvent(a),d.border=new PykCharts.Configuration.border(d),d.transitions=new PykCharts.Configuration.transition(d),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d),"default"==d.mode.toLowerCase()?(d.k.title().backgroundColor(d).export(d,"#container",c).emptyDiv().subtitle(),d.optionalFeatures().svgContainer(),d.new_data=d.optionalFeatures().clubData(),d.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip(),d.optionalFeatures().set_start_end_angle().createChart().label().ticks().centerLabel(),d.k.liveData(d)):"infographics"==d.mode.toLowerCase()&&(d.new_data=d.data,d.k.backgroundColor(d).export(d,"#container",c).emptyDiv(),d.optionalFeatures().svgContainer().set_start_end_angle().createChart().label().ticks().centerLabel(),d.k.tooltip()),$(window).on("load",function(){return d.k.resize(d.svgContainer)}).on("resize",function(){return d.k.resize(d.svgContainer)})},d.optionalFeatures=function(){var b={svgContainer:function(){return d.svgContainer=d3.select(d.selector).append("svg").attr("width",d.width).attr("height",function(){return d.height}).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+d.width+" "+d.height).attr("id","container").attr("class","svgcontainer"),d.group=d.svgContainer.append("g").attr("transform","translate("+d.width/2+","+d.height_translate+")").attr("id","pieGroup"),this},createChart:function(){if(d3.select(d.selector+" #pieGroup").node().innerHTML="","pie"==c.toLowerCase()||"donut"==c.toLowerCase()){d.new_data.sort(function(a,b){return a.weight-b.weight});var b=d.new_data.pop();d.new_data.unshift(b)}else("election pie"==c.toLowerCase()||"election donut"==c.toLowerCase())&&d.new_data.sort(function(a,b){return b.weight-a.weight});return d.sum=_.reduce(d.data,function(a,b){return a+b.weight},0),d.inner_radius=d.k._radiusCalculation(d.innerRadiusPercent,d.calculation),d.outer_radius=d.k._radiusCalculation(d.radiusPercent,d.calculation),d.arc=d3.svg.arc().innerRadius(d.inner_radius).outerRadius(d.outer_radius),d.pie=d3.layout.pie().value(function(a){return a.weight}).sort(null).startAngle(d.start_angle).endAngle(d.end_angle),d.chart_data=d.group.selectAll("path").data(d.pie(d.new_data)),d.chart_data.enter().append("path"),d.chart_data.attr("class","pie"),d.chart_data.attr("fill",function(a){return d.fillChart.selectColor(a.data)}).on("mouseover",function(b){"default"===d.mode&&(b.data.tooltip=b.data.tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.data.name+"</tr><tr><td class='tooltip-left-content'>"+d.k.appendUnits(b.data.weight)+"<td class='tooltip-right-content'>( "+(100*b.data.weight/d.sum).toFixed(2)+"% ) </tr></table>",d.onHoverEffect.highlight(a.selector+" .pie",this),d.mouseEvent.tooltipPosition(b),d.mouseEvent.tooltipTextShow(b.data.tooltip))}).on("mouseout",function(b){"default"===d.mode&&(d.onHoverEffect.highlightHide(a.selector+" .pie"),d.mouseEvent.tooltipHide(b))}).on("mousemove",function(a){"default"===d.mode&&d.mouseEvent.tooltipPosition(a)}).attr("stroke",d.border.color()).attr("stroke-width",d.border.width()).attr("stroke-dasharray",d.border.style()),d.chart_data.transition().delay(function(a,b){return d.transition_duration&&"default"==d.mode?b*d.transition_duration*1e3/d.new_data.length:0}).duration(d.transitions.duration()/d.new_data.length).attrTween("d",function(a){var b=d3.interpolate(a.startAngle,a.endAngle);return function(c){return a.endAngle=b(c),d.arc(a)}}),d.chart_data.exit().remove(),this},label:function(){return d.chart_text=d.group.selectAll("text").data(d.pie(d.new_data)),d.chart_text.enter().append("text").attr("class","pie-label").attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),d.chart_text.attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),d.chart_text.text("").attr("fill","red"),setTimeout(function(){d.chart_text.text(function(a){return d.k.appendUnits(a.data.weight)}).attr("text-anchor","middle").attr("pointer-events","none").text(function(a){return"pie"===c.toLowerCase()||"election pie"===c.toLowerCase()?this.getBBox().width<(a.endAngle-a.startAngle)*(d.outer_radius/2)*.9?(100*a.data.weight/d.sum).toFixed(1)+"%":"":this.getBBox().width<Math.abs(a.endAngle-a.startAngle)*d.outer_radius*.9&&this.getBBox().height<.75*(d.outer_radius-d.inner_radius)?(100*a.data.weight/d.sum).toFixed(1)+"%":""}).attr("dy",5).style("font-weight",d.label_weight).style("font-size",d.label_size).attr("fill",d.label_color).style("font-family",d.label_family),d.chart_text.exit().remove()},d.transitions.duration()),this},clubData:function(){if(PykCharts.boolean(d.clubdata_enable)){d.displayData=[],d.sorted_weight=_.map(d.data,function(a){return a.weight}),d.sorted_weight.sort(function(a,b){return b-a}),d.checkDuplicate=[];var a,b,c={name:d.clubdata_text,color:d.clubData_color,tooltip:d.clubData_tooltipText,highlight:!1};d.getIndexByName=function(a){for(b=0;b<d.data.length;b++)if(d.data[b].name==a)return b};var e=function(a){var b=_.reject(d.sorted_weight,function(b){return b==d.data[a].weight});return b};if(0!==d.clubdata_always_include_data_points.length)for(var f=0;f<d.clubdata_always_include_data_points.length;f++)a=d.getIndexByName(d.clubdata_always_include_data_points[f]),void 0!=a&&(d.displayData.push(d.data[a]),d.sorted_weight=e(a));d.getIndexByWeight=function(a){for(var b=0;b<d.data.length;b++)if(d.data[b].weight!=a);else if(_.contains(d.checkDuplicate,b)===!1)return d.checkDuplicate.push(b),b};var g=d.clubdata_maximum_nodes-d.displayData.length,h=d3.sum(d.sorted_weight,function(a,b){return b>=g-1?a:void 0});if(c.weight=h,g>0)for(d.displayData.push(c),b=0;g-1>b;b++)a=d.getIndexByWeight(d.sorted_weight[b]),d.displayData.push(d.data[a])}else d.displayData=d.data;return d.displayData},ticks:function(){PykCharts.boolean(d.pointer_overflow_enable)&&d.svgContainer.style("overflow","visible");var a=d.group.selectAll(".ticks_label").data(d.pie(d.new_data));a.attr("class","ticks_label"),a.enter().append("text").attr("x",0).attr("y",0);var b,c;a.attr("transform",function(a){return a.endAngle-a.startAngle<.2?(b=1*(d.outer_radius+30)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),c=1*(d.outer_radius/1+20)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)):(b=1*(d.outer_radius+22)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),c=1*(d.outer_radius/1+24)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)),"translate("+b+","+c+")"}),a.text(""),setTimeout(function(){a.text(function(a){return a.data.name}).attr("text-anchor",function(a){var b=(a.endAngle-a.startAngle)/2+a.startAngle;return b>0&&1.5>b?"start":b>=1.5&&3.5>b?"middle":b>=3.5&&6>b?"end":b>=6?"middle":0>b?"middle":void 0}).attr("dy",5).attr("pointer-events","none").style("fill",d.pointer_color).style("font-size",d.pointer_size).style("font-weight",d.pointer_weight).style("font-family",d.pointer_family),a.exit().remove()},d.transitions.duration());var e=d.group.selectAll("line").data(d.pie(d.new_data));return e.enter().append("line").attr("class","ticks"),e.attr("x1",function(a){return 1*d.outer_radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y1",function(a){return 1*d.outer_radius*Math.sin((a.endAngle+a.startAngle)/2)}).attr("x2",function(a){return 1*d.outer_radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*d.outer_radius*Math.sin((a.endAngle+a.startAngle)/2)}),setTimeout(function(){e.attr("x2",function(a){return 1*(d.outer_radius/1+12)*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*(d.outer_radius/1+12)*Math.sin((a.startAngle+a.endAngle)/2)}).attr("transform","rotate(-90)").attr("stroke-width",d.pointer_thickness).attr("stroke",d.pointer_color),e.exit().remove()},d.transitions.duration()),this},centerLabel:function(){if(PykCharts.boolean(d.donut_show_total_at_center)&&("donut"==c||"election donut"==c)){var b,e=d.group.selectAll(a.selector+" .centerLabel").data([d.sum]);e.enter().append("text"),e.attr("class","centerLabel").text(""),setTimeout(function(){e.text(function(){return d.k.appendUnits(d.sum)}).text(function(){return b=this.getBBox().height,d.k.appendUnits(d.sum)}).attr("pointer-events","none").attr("text-anchor","middle").attr("y",function(){return"donut"==c?b/2:-.25*d.inner_radius}).attr("font-size",function(){return"donut"==c?.32*d.inner_radius:.2*d.inner_radius}).style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("fill","#484848")},d.transitions.duration()),e.exit().remove()}return this},set_start_end_angle:function(){return d.startAngle,d.endAngle,"pie"==c||"donut"==c?(d.start_angle=0*(Math.PI/180),d.end_angle=360*(Math.PI/180)):("election pie"==c||"election donut"==c)&&(d.start_angle=-90*(Math.PI/180),d.end_angle=90*(Math.PI/180)),this}};return b}},PykCharts.oneD.pyramid=function(a){{var c=this;new PykCharts.Configuration.Theme({})}this.execute=function(){c=new PykCharts.oneD.processInputs(c,a,"pyramid"),c.height=a.chart_height?a.chart_height:c.width,"default"===c.mode&&c.k.loading(),d3.json(a.data,function(b,d){c.data=d.groupBy("oned"),c.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),c.clubdata_enable=c.data.length>c.clubdata_maximum_nodes?c.clubdata_enable:"no",c.render()})},this.refresh=function(){d3.json(a.data,function(a,b){c.data=b.groupBy("oned"),c.refresh_data=b.groupBy("oned");var d=c.k.checkChangeInData(c.refresh_data,c.compare_data);c.compare_data=d[0];var e=d[1];e&&c.k.lastUpdatedAt("liveData"),c.new_data=c.optionalFeatures().clubData(),c.optionalFeatures().createChart().label().ticks()})},this.render=function(){c.fillChart=new PykCharts.Configuration.fillChart(c),c.onHoverEffect=new PykCharts.oneD.mouseEvent(a),c.transitions=new PykCharts.Configuration.transition(c),c.border=new PykCharts.Configuration.border(c),"default"===c.mode?(c.k.title().backgroundColor(c).export(c,"#svgcontainer","pyramid").emptyDiv().subtitle(),c.new_data=c.optionalFeatures().clubData(),c.optionalFeatures().svgContainer().createChart().label().ticks(),c.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip().liveData(c),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c)):"infographics"===c.mode&&(c.new_data=c.data,c.k.backgroundColor(c).export(c,"#svgcontainer","pyramid").emptyDiv(),c.optionalFeatures().svgContainer().createChart().label().ticks(),c.k.tooltip(),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c)),$(window).on("load",function(){return c.k.resize(c.svgContainer)
}).on("resize",function(){return c.k.resize(c.svgContainer)})},this.percentageValues=function(a){c.sum=d3.sum(a,function(a){return a.weight});var b=a.map(function(a){return a.weight/c.sum*100});return b.sort(function(a,b){return b-a}),b},this.pyramidLayout=function(){var a,b,d={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},coordinates:function(){function d(a){return d3.sum(h,function(b,c){return c>=a?b:void 0})}for(var e=b[0],f=b[1],g=e/2/f,h=c.percentageValues(a),i=[],j=e*f/2,k=0;k<a.length;k++){var l=d(k),m=l/100*j,n=Math.sqrt(m/g),o=2*g*n,p=(e-o)/2;i[k]=0===k?{values:[{x:e/2,y:0},{x:p,y:n},{x:o+p,y:n}]}:{values:[i[k-1].values[1],{x:p,y:n},{x:o+p,y:n},i[k-1].values[2]]}}return i}};return d},this.optionalFeatures=function(){var d={svgContainer:function(){return c.svgContainer=d3.select(a.selector).append("svg").attr("width",c.width).attr("height",c.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+c.width+" "+c.height).attr("id","svgcontainer").attr("class","svgcontainer"),c.group=c.svgContainer.append("g").attr("id","pyrgrp"),this},createChart:function(){c.pyramid=c.pyramidLayout().data(c.new_data).size([c.width,c.height]),c.coordinates=c.pyramid.coordinates(),c.coordinates[0].values[1]=c.coordinates[c.coordinates.length-1].values[1],c.coordinates[0].values[2]=c.coordinates[c.coordinates.length-1].values[2];var d=c.new_data.length-1,e=(c.new_data.length-1,[]);for(i=0;i<c.new_data.length;i++)0==i?e[i]=c.new_data[i].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.new_data[i].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.new_data[i].weight)+"<td class='tooltip-right-content'>( "+(100*c.new_data[i].weight/c.sum).toFixed(2)+"% ) </tr></table>":(e[i]=c.new_data[d].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.new_data[d].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.new_data[d].weight)+"<td class='tooltip-right-content'>( "+(100*c.new_data[d].weight/c.sum).toFixed(2)+"% ) </tr></table>",d--);var f=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y}),g=[{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height}],d=c.new_data.length;return c.chart_data=c.group.selectAll(".pyr-path").data(c.coordinates),c.chart_data.enter().append("path"),c.chart_data.attr("class","pyr-path").attr("d",function(){return f(g)}).attr("stroke",c.border.color()).attr("stroke-width",c.border.width()).attr("stroke-dasharray",c.border.style()).attr("fill",function(a,e){return 0===e?b=c.new_data[e]:(d--,b=c.new_data[d]),c.fillChart.selectColor(b)}).on("mouseover",function(b,d){"default"===c.mode&&(c.onHoverEffect.highlight(a.selector+" .pyr-path",this),c.mouseEvent.tooltipPosition(b),c.mouseEvent.tooltipTextShow(e[d]))}).on("mouseout",function(b){"default"===c.mode&&(c.onHoverEffect.highlightHide(a.selector+" .pyr-path"),c.mouseEvent.tooltipHide(b))}).on("mousemove",function(a){"default"===c.mode&&c.mouseEvent.tooltipPosition(a)}).transition().duration(c.transitions.duration()).attr("d",function(a){return f(a.values)}),c.chart_data.exit().remove(),this},label:function(){var a=c.new_data.length,b=c.new_data.length;return c.chart_text=c.group.selectAll("text").data(c.coordinates),c.chart_text.enter().append("text"),c.chart_text.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2+10}).attr("x",function(){return c.width/2}).text("").attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",c.label_weight).style("font-size",c.label_size).attr("fill",c.label_color).style("font-family",c.label_family),setTimeout(function(){c.chart_text.text(function(b,d){return 0===d?(100*c.new_data[d].weight/c.sum).toFixed(1)+"%":(a--,(100*c.new_data[a].weight/c.sum).toFixed(1)+"%")}).text(function(a,d){return this.getBBox().width<a.values[2].x-a.values[1].x&&this.getBBox().height<Math.abs(a.values[1].y-a.values[0].y)?0===d?(100*c.new_data[d].weight/c.sum).toFixed(1)+"%":(b--,(100*c.new_data[b].weight/c.sum).toFixed(1)+"%"):""})},c.transitions.duration()),c.chart_text.exit().remove(),this},ticks:function(){PykCharts.boolean(c.pointer_overflow_enable)&&c.svgContainer.style("overflow","visible");var a=c.group.selectAll(".ticks_label").data(c.coordinates);a.enter().append("text").attr("x",0).attr("y",0).attr("class","ticks_label");var b,d,e=[],f=c.new_data.length,g=c.new_data.length;a.attr("transform",function(a){return b=3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+30:(a.values[2].x+a.values[3].x)/2+30,d=4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2,"translate("+b+","+(d+5)+")"}),a.text(""),setTimeout(function(){a.text(function(a,b){return 0===b?c.new_data[b].name:(g--,c.new_data[g].name)}).text(function(a,b){return 0===b?(e[b]=this.getBBox().height,this.getBBox().height<a.values[1].y-a.values[0].y?c.new_data[b].name:""):(e[b]=this.getBBox().height,this.getBBox().height<a.values[0].y-a.values[1].y?(f--,c.new_data[f].name):"")}).style("fill",c.pointer_color).style("font-size",c.pointer_size).style("font-family",c.pointer_family).style("font-weight",c.pointer_weight).attr("text-anchor","start")},c.transitions.duration()),a.exit().remove();var h=c.group.selectAll(".pyr-ticks").data(c.coordinates);return h.enter().append("line").attr("class","pyr-ticks"),h.attr("x1",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y1",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("x2",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y2",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("stroke-width",c.pointer_thickness).attr("stroke",c.pointer_color),setTimeout(function(){h.attr("x2",function(a,b){return Math.abs(a.values[0].y-a.values[1].y)>e[b]?3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+20:(a.values[2].x+a.values[3].x)/2+20:3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2})},c.transitions.duration()),h.exit().remove(),this},clubData:function(){if(PykCharts.boolean(c.clubdata_enable)){c.displayData=[],c.sorted_weight=_.map(c.data,function(a){return a.weight}),c.sorted_weight.sort(function(a,b){return b-a}),c.checkDuplicate=[];var a,b,d={name:c.clubdata_text,color:c.clubData_color,tooltip:c.clubData_tooltipText,highlight:!1};c.getIndexByName=function(a){for(b=0;b<c.data.length;b++)if(c.data[b].name==a)return b};var e=function(a){var b=_.reject(c.sorted_weight,function(b){return b==c.data[a].weight});return b};if(0!==c.clubdata_always_include_data_points.length)for(var f=0;f<c.clubdata_always_include_data_points.length;f++)a=c.getIndexByName(c.clubdata_always_include_data_points[f]),void 0!=a&&(c.displayData.push(c.data[a]),c.sorted_weight=e(a));c.getIndexByWeight=function(a){for(var b=0;b<c.data.length;b++)if(c.data[b].weight!=a);else if(_.contains(c.checkDuplicate,b)===!1)return c.checkDuplicate.push(b),b};var g=c.clubdata_maximum_nodes-c.displayData.length;if(g>0)for(c.displayData.push(d),b=0;g-1>b;b++)a=c.getIndexByWeight(c.sorted_weight[b]),c.displayData.push(c.data[a]);var h=d3.sum(c.sorted_weight,function(a,b){return b>=g-1?a:void 0});d.weight=h}else c.displayData=c.data;return c.displayData.sort(function(a,b){return a.weight-b.weight}),c.displayData}};return d}},PykCharts.oneD.treemap=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=new PykCharts.oneD.processInputs(b,a),optional=a.optional,b.selector=a.selector,b.height=a.chart_height?a.chart_height:b.width,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),b.compare_data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("oned"),b.refresh_data=c.groupBy("oned");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData().createChart().label()})},this.render=function(){b.fillChart=new PykCharts.Configuration.fillChart(b),b.onHoverEffect=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&b.k.title().backgroundColor(b).export(b,"#svgcontainer","treemap").emptyDiv().subtitle(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#svgcontainer","treemap").emptyDiv(),b.new_data={children:b.data}),"default"===b.mode&&b.optionalFeatures().clubData(),b.optionalFeatures().svgContainer().createChart().label(),"default"===b.mode&&b.k.liveData(b).createFooter().lastUpdatedAt().credits().dataSource(),$(window).on("load",function(){return b.k.resize(b.svgContainer)}).on("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var c={svgContainer:function(){return b.svgContainer=d3.select(b.selector).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svgContainer.append("g").attr("id","treemap"),this},createChart:function(){b.treemap=d3.layout.treemap().sort(function(a,b){return a.weight-b.weight}).size([b.width,b.height]).value(function(a){return a.weight}).sticky(!1),b.sum=d3.sum(b.new_data.children,function(a){return a.weight});var c;return b.node=b.treemap.nodes(b.new_data),c=b.new_data.children.length,b.chart_data=b.group.selectAll(".cell").data(b.node),b.chart_data.enter().append("svg:g").attr("class","cell").append("svg:rect").attr("class","treemap-rect"),b.chart_data.attr("class","cell").select("rect").attr("class","treemap-rect").attr("id",function(a,b){return"rect"+b}).attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("width",function(a){return a.dx-1}).attr("height",0).attr("fill",function(a){return a.children?"white":b.fillChart.selectColor(a)}).on("mouseover",function(c){c.children||"default"!==b.mode||(c.tooltip=c.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+c.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"<td class='tooltip-right-content'>(&nbsp;"+(100*c.weight/b.sum).toFixed(2)+"%&nbsp;)</tr></table>",b.onHoverEffect.highlight(a.selector+" .treemap-rect",this),b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(c.tooltip))}).on("mouseout",function(c){"default"===b.mode&&(b.mouseEvent.tooltipHide(c),b.onHoverEffect.highlightHide(a.selector+" .treemap-rect"))}).on("mousemove",function(a){a.children||"default"!==b.mode||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.dy-1}),b.chart_data.exit().remove(),this},label:function(){return b.chart_text=b.group.selectAll(".name").data(b.node),b.chart_text1=b.group.selectAll(".weight").data(b.node),b.chart_text.enter().append("svg:text").attr("class","name"),b.chart_text1.enter().append("svg:text").attr("class","weight"),b.chart_text.attr("class","name").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2}),b.chart_text1.attr("class","weight").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2+15}),b.chart_text.attr("text-anchor","middle").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text(""),setTimeout(function(){b.chart_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":a.name:""})},b.transitions.duration()),b.chart_text1.attr("text-anchor","middle").style("font-weight",b.label_weight).style("font-size",b.label_size).attr("fill",b.label_color).style("font-family",b.label_family).text("").attr("pointer-events","none"),setTimeout(function(){b.chart_text1.text(function(a){return a.children?" ":b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":(100*a.weight/b.sum).toFixed(1)+"%":""})},b.transitions.duration()),b.chart_text.exit().remove(),b.chart_text1.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubdata_enable)){var a=[],c=0,d=0;if(b.data.length<=b.clubdata_maximum_nodes)return b.new_data={children:b.data},this;if(0!==b.clubdata_always_include_data_points.length){var e=b.clubdata_always_include_data_points.length;for(i=0;e>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var f=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&f.push(b.data[j]);for(b.data.sort(function(a,b){return b.weight-a.weight});f.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;f.push(b.data[d]),d++}for(j=d;j<b.data.length;j++){for(i=0;i<f.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===f[i].name.toUpperCase()&&(c+=0,j++,i=-1);j<b.data.length&&(c+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};f.length>b.clubdata_maximum_nodes;){f.sort(g);{f.pop()}}var h={name:b.clubdata_text,weight:c,color:b.clubData_color,tooltip:b.clubData_tooltip};f.length<b.clubdata_maximum_nodes&&f.push(h),b.new_data={children:f}}else b.new_data={children:b.data};return this}};return c}},PykCharts.multiD={};var theme=new PykCharts.Configuration.Theme({});PykCharts.multiD.configuration=function(a){var b=this,c=new PykCharts.Configuration.fillChart(a),d={magnify:function(a,b,c){b.on("mousemove",function(){var b=d3.mouse(this);c.focus(b[0]),a.attr("x",function(a){return c(a.x)}).attr("width",function(a){return c.rangeBand(a.x)})})},checkChangeInData:function(a,c){var d=Object.keys(c[0]),e=Object.keys(a[0]),f=!1;if(b.data=a.groupBy("oned"),d.length===e.length&&c.length===a.length){for(i=0;i<a.length;i++)for(j=0;j<d.length;j++)if(a[i][e[j]]!==c[i][d[j]]||d[j]!==e[j]){f=!0;break}}else f=!0;return b.compare_data=a,[b.compare_data,f]},opacity:function(b,c,d){if(PykCharts.boolean(a.variable_circle_size_enable))return.6;var e=d3.scale.linear().domain(d3.extent(d,function(a){return a.weight})).range([.1,1]);return e(b?b:_.min(c))},legendsPosition:function(a){return status?a.optionalFeatures().legendsContainer().svgContainer():a.optionalFeatures().svgContainer(),this},legends:function(d,e,f,g){if(status){var h=0,i=0;if(h=d.length,i=d.length,"vertical"===a.legends_display){g.attr("height",30*d.length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,l=function(){return a.chart_width-75},m=function(){return a.chart_width-100};var j=function(a,b){return 24*b+12},k=function(a,b){return 24*b+26}}if("horizontal"===a.legends_display){g.attr("height",70),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var l=function(){return h--,a.chart_width-(100*h+75)};k=30,rect_parameter1value=13,rect_parameter2value=13;var m=function(){return i--,a.chart_width-(100*i+100)};j=18}b.legends_text=e.selectAll(".legends_text").data(d),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif"),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,l).attr(text_parameter2,k).text(function(a){return a}),b.legends_text.exit().remove(),b.legends_rect=e.selectAll(".legends_rect").data(d),b.legends_rect.enter().append("rect").attr("class","legends_rect"),b.legends_rect.attr("class","legends_rect").attr("fill",function(a,b){return c(f[b])}).attr("fill-opacity",function(b,c){return"yes"===a.saturation_enable?(c+1)/d.length:1}).attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,m).attr(rect_parameter4,j),b.legends_rect.exit().remove()}return this},legendsGroupStacked:function(b,c,d,e){if(status){var f,g,h,k=0,l=[];for(i=0;i<d.length;i++)for(j=0;j<d[i].length;j++)l[k]=d[i][j],k++;g=l.length,f=l.length,h=-1,b.attr("height",90);var m=c.selectAll(".legends_g").data(d).enter().append("g").attr("class","legends_g").attr("fill",function(){return h++,e[h]});m.selectAll(".legends_rect").data(d[h]).enter().append("rect").attr("class","legends_rect").attr("x",function(){return f--,a.chart_width-(80*f+75)}).attr("y",20).attr("height",13).attr("width",13).attr("fill-opacity",function(b,c){return"yes"===a.saturation_enable?(d[c].length-c)/d[c].length:1}),c.selectAll(".legends_text").data(l).enter().append("text").attr("class","legends_text").attr("pointer-events","none").attr("x",function(){return g--,a.chart_width-(80*g+55)}).attr("y",32).attr("fill","#1D1D1D").attr("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").text(function(a){return a})}return this},mapGroup:function(b){var c=[],d={},e=0,f=!0,g=!0;if(b.forEach(function(b){b.group?f=!0:(f=!1,a.chart_color?(f=!1,b.color=a.chart_color[0]):b.color?(g=!1,b.color=b.color):(g=!1,b.color=a.default_color[0]))}),k=0,f){b.forEach(function(f){!d[f.group]&&f.color?(d[f.group]=f,f.color=0!==a.chart_color.length&&PykCharts.boolean(a.chart_color[e])?a.chart_color[e]:f.color?f.color:a.default_color,k<b.length-2&&f.group!==b[k+1].group&&e++,c.push(f)):k<b.length-2&&f.group!==b[k+1].group&&e++,k++}),e=0,k=0,b.forEach(function(f){d[f.group]?k<b.length-2&&f.group!==b[k+1].group&&e++:(d[f.group]=f,f.color=0!==a.chart_color.length&&PykCharts.boolean(a.chart_color[e])?a.chart_color[e]:a.default_color,k<b.length-2&&f.group!==b[k+1].group&&e++,c.push(f)),k++});var h=[];e=0,c.forEach(function(a){h.push(a)});for(var i=h.length,j=b.length,k=0;i>k;k++)for(var l=0;j>l;l++)b[l].group===h[k].group&&(b[l].color=h[k].color);return[h,f]}return[b,f]}};return d},PykCharts.multiD.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.multiD.bubbleSizeCalculation=function(a,b,c){var d=function(d){if(d&&PykCharts.boolean(a.variable_circle_size_enable)){var e=d3.scale.linear().domain(d3.extent(b,function(a){return a.weight})).range(c);return e(d)}return a.bubbleRadius};return d},PykCharts.multiD.processInputs=function(a,b){{var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.multiDimensionalCharts;b.optional}if(a.selector=b.selector?b.selector:"body",b.chart_width){var g=$(b.selector).width();b.chart_width=g<b.chart_width?g:b.chart_width}switch(a.width=b.chart_width?b.chart_width:d.chart_width,a.height=b.chart_height?b.chart_height:d.chart_height,a.margin_left=b.chart_margin_left?b.chart_margin_left:d.chart_margin_left,a.margin_right=b.chart_margin_right?b.chart_margin_right:d.chart_margin_right,a.margin_top=b.chart_margin_top?b.chart_margin_top:d.chart_margin_top,a.margin_bottom=b.chart_margin_bottom?b.chart_margin_bottom:d.chart_margin_bottom,a.grid_x_enable=b.chart_grid_x_enable?b.chart_grid_x_enable:f.chart_grid_x_enable,a.grid_y_enable=b.chart_grid_y_enable?b.chart_grid_y_enable:f.chart_grid_y_enable,a.grid_color=b.chart_grid_color?b.chart_grid_color:d.chart_grid_color,a.mode=b.mode?b.mode:"default",a.color_mode=b.color_mode?b.color_mode:d.color_mode,b&&PykCharts.boolean(b.title_text)?(a.title_text=b.title_text,a.title_size="title_size"in b?b.title_size:d.title_size,a.title_color=b.title_color?b.title_color:d.title_color,a.title_weight=b.title_weight?b.title_weight:d.title_weight,a.title_family=b.title_family?b.title_family:d.title_family):(a.title_size=d.title_size,a.title_color=d.title_color,a.title_weight=d.title_weight,a.title_family=d.title_family),b&&PykCharts.boolean(b.subtitle_text)?(a.subtitle_text=b.subtitle_text,a.subtitle_size="subtitle_size"in b?b.subtitle_size:d.subtitle_size,a.subtitle_color=b.subtitle_color?b.subtitle_color:d.subtitle_color,a.subtitle_weight=b.subtitle_weight?b.subtitle_weight:d.subtitle_weight,a.subtitle_family=b.subtitle_family?b.subtitle_family:d.subtitle_family):(a.subtitle_size=d.subtitle_size,a.subtitle_color=d.subtitle_color,a.subtitle_weight=d.subtitle_weight,a.subtitle_family=d.subtitle_family),a.axis_x_enable=b.axis_x_enable?b.axis_x_enable:d.axis_x_enable,a.axis_onhover_hightlight_enable=PykCharts.boolean(a.axis_x_enable)&&b.axis_onhover_hightlight_enable?b.axis_onhover_hightlight_enable:f.axis_onhover_hightlight_enable,a.axis_x_title=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_title?b.axis_x_title:d.axis_x_title,a.axis_x_pointer_position=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_pointer_position?b.axis_x_pointer_position:d.axis_x_pointer_position,a.axis_x_position=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_position?b.axis_x_position:d.axis_x_position,a.axis_x_line_color=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_line_color?b.axis_x_line_color:d.axis_x_line_color,a.axis_x_label_color=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_label_color?b.axis_x_label_color:d.axis_x_label_color,a.axis_x_no_of_axis_value=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_no_of_axis_value?b.axis_x_no_of_axis_value:d.axis_x_no_of_axis_value,a.axis_x_pointer_padding=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_pointer_padding?b.axis_x_pointer_padding:d.axis_x_pointer_padding,a.axis_x_pointer_size="axis_x_pointer_size"in b&&PykCharts.boolean(a.axis_x_enable)?b.axis_x_pointer_size:d.axis_x_pointer_size,a.axis_x_value_format=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_value_format?b.axis_x_value_format:d.axis_x_value_format,a.axis_x_pointer_values=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_pointer_values?b.axis_x_pointer_values:d.axis_x_pointer_values,a.axis_x_outer_pointer_size="axis_x_outer_pointer_size"in b&&PykCharts.boolean(a.axis_x_enable)?b.axis_x_outer_pointer_size:d.axis_x_outer_pointer_size,a.axis_x_time_value_datatype=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_time_value_datatype?b.axis_x_time_value_datatype:d.axis_x_time_value_datatype,a.axis_x_time_value_interval=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_time_value_interval?b.axis_x_time_value_interval:d.axis_x_time_value_interval,a.axis_y_enable=b.axis_y_enable?b.axis_y_enable:f.axis_y_enable,a.axis_y_title=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_title?b.axis_y_title:f.axis_y_title,a.axis_y_pointer_position=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_pointer_position?b.axis_y_pointer_position:f.axis_y_pointer_position,a.axis_y_position=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_position?b.axis_y_position:f.axis_y_position,a.axis_y_line_color=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_line_color?b.axis_y_line_color:f.axis_y_line_color,a.axis_y_label_color=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_label_color?b.axis_y_label_color:f.axis_y_label_color,a.axis_y_no_of_axis_value=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_no_of_axis_value?b.axis_y_no_of_axis_value:f.axis_y_no_of_axis_value,a.axis_y_pointer_padding=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_pointer_padding?b.axis_y_pointer_padding:f.axis_y_pointer_padding,a.axis_y_pointer_size="axis_y_pointer_size"in b&&PykCharts.boolean(a.axis_y_enable)?b.axis_y_pointer_size:f.axis_y_pointer_size,a.axis_y_value_format=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_value_format?b.axis_y_value_format:f.axis_y_value_format,a.axis_y_pointer_values=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_pointer_values?b.axis_y_pointer_values:f.axis_y_pointer_values,a.axis_y_outer_pointer_size="axis_y_outer_pointer_size"in b&&PykCharts.boolean(a.axis_y_enable)?b.axis_y_outer_pointer_size:f.axis_y_outer_pointer_size,a.axis_y_time_value_datatype=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_time_value_datatype?b.axis_y_time_value_datatype:f.axis_y_time_value_datatype,a.axis_y_time_value_interval=PykCharts.boolean(a.axis_y_enable)&&b.axis_y_time_value_interval?b.axis_y_time_value_interval:f.axis_y_time_value_interval,a.legends_enable=b.legends_enable?b.legends_enable:d.legends_enable,a.legends_display=b.legends_display?b.legends_display:d.legends_display,b.credit_my_site_name||b.credit_my_site_url?(a.credit_my_site_name=b.credit_my_site_name?b.credit_my_site_name:"",a.credit_my_site_url=b.credit_my_site_url?b.credit_my_site_url:""):(a.credit_my_site_name=d.credit_my_site_name,a.credit_my_site_url=d.credit_my_site_url),a.data_source_name=b.data_source_name?b.data_source_name:"",a.data_source_url=b.data_source_url?b.data_source_url:"",a.background_color=b.background_color?b.background_color:d.background_color,a.chart_color=b.chart_color?b.chart_color:[],a.default_color=d.chart_color,a.highlight_color=b.highlight_color?b.highlight_color:d.highlight_color,a.fullscreen_enable=b.fullscreen_enable?b.fullscreen_enable:d.fullscreen_enable,a.loading=b.loading_gif_url?b.loading_gif_url:d.loading_gif_url,a.real_time_charts_refresh_frequency=b.real_time_charts_refresh_frequency?b.real_time_charts_refresh_frequency:e.real_time_charts_refresh_frequency,a.real_time_charts_last_updated_at_enable=b.real_time_charts_last_updated_at_enable?b.real_time_charts_last_updated_at_enable:e.real_time_charts_last_updated_at_enable,a.transition_duration=b.transition_duration?b.transition_duration:e.transition_duration,a.saturation_color=b.saturation_color?b.saturation_color:d.saturation_color,a.border_between_chart_elements_thickness="border_between_chart_elements_thickness"in b?b.border_between_chart_elements_thickness:d.border_between_chart_elements_thickness,a.border_between_chart_elements_color=b.border_between_chart_elements_color?b.border_between_chart_elements_color:d.border_between_chart_elements_color,a.border_between_chart_elements_style=b.border_between_chart_elements_style?b.border_between_chart_elements_style:d.border_between_chart_elements_style,a.border_between_chart_elements_style){case"dotted":a.border_between_chart_elements_style="1,3";break;case"dashed":a.border_between_chart_elements_style="5,5";break;case"solid":a.border_between_chart_elements_style="0"}return a.pointer_thickness="pointer_thickness"in b?b.pointer_thickness:d.pointer_thickness,a.pointer_size="pointer_size"in b?b.pointer_size:d.pointer_size,a.pointer_color=b.pointer_color?b.pointer_color:d.pointer_color,a.pointer_family=b.pointer_family?b.pointer_family:d.pointer_family,a.pointer_weight=b.pointer_weight?b.pointer_weight:d.pointer_weight,a.zoom_enable=b.zoom_enable?b.zoom_enable:f.zoom_enable,a.zoom_level=b.zoom_level?b.zoom_level:f.zoom_level,a.label_size="label_size"in b?b.label_size:d.label_size,a.label_color=b.label_color?b.label_color:d.label_color,a.label_weight=b.label_weight?b.label_weight:d.label_weight,a.label_family=b.label_family?b.label_family:d.label_family,a.tooltip_enable=b.tooltip_enable?b.tooltip_enable:d.tooltip_enable,a.tooltip_mode=b.tooltip_mode?b.tooltip_mode:d.tooltip_mode,a.legends_text_size=b.legends_text_size?b.legends_text_size:d.legends_text_size,a.legends_text_color=b.legends_text_color?b.legends_text_color:d.legends_text_color,a.legends_text_weight=b.legends_text_weight?b.legends_text_weight:d.legends_text_weight,a.legends_text_family=b.legends_text_family?b.legends_text_family:d.legends_text_family,a.highlight=b.highlight?b.highlight:d.highlight,a.variable_circle_size_enable=b.variable_circle_size_enable?b.variable_circle_size_enable:f.variable_circle_size_enable,a.units=b.units?b.units:!1,a.panels_enable=b.panels_enable?b.panels_enable:f.panels_enable,a.export_enable=b.export_enable?b.export_enable:d.export_enable,a.export_image_url=b.export_image_url?b.export_image_url:d.export_image_url,a.k=new PykCharts.Configuration(a),a.k.validator().validatingSelector(a.selector.substring(1,a.selector.length)).validatingChartMode(a.mode).validatingDataType(a.width,"chart_width").validatingDataType(a.height,"chart_height").validatingDataType(a.margin_left,"chart_margin_left").validatingDataType(a.margin_right,"chart_margin_right").validatingDataType(a.margin_top,"chart_margin_top").validatingDataType(a.margin_bottom,"chart_margin_bottom").validatingDataType(a.title_size,"title_size").validatingDataType(a.subtitle_size,"subtitle_size").validatingDataType(a.real_time_charts_refresh_frequency,"real_time_charts_refresh_frequency").validatingDataType(a.transition_duration,"transition_duration").validatingDataType(a.border_between_chart_elements_thickness,"border_between_chart_elements_thickness").validatingDataType(a.axis_x_pointer_size,"axis_x_pointer_size").validatingDataType(a.axis_y_pointer_size,"axis_y_pointer_size").validatingDataType(a.label_size,"label_size").validatingDataType(a.legends_text_size,"legends_text_size").validatingDataType(a.zoom_level,"zoom_level").validatingDataType(a.pointer_thickness,"pointer_thickness").validatingDataType(a.pointer_size,"pointer_size").validatingDataType(a.axis_x_outer_pointer_size,"axis_x_outer_pointer_size").validatingDataType(a.axis_y_outer_pointer_size,"axis_y_outer_pointer_size").validatingDataType(a.axis_x_pointer_padding,"axis_x_pointer_padding").validatingDataType(a.axis_y_pointer_padding,"axis_y_pointer_padding").validatingDataType(a.axis_x_no_of_axis_value,"axis_x_no_of_axis_value").validatingDataType(a.axis_y_no_of_axis_value,"axis_y_no_of_axis_value").validatingDataType(a.axis_x_time_value_interval,"axis_x_time_value_interval").validatingDataType(a.axis_y_time_value_interval,"axis_y_time_value_interval").validatingAxisDataFormat(b.axis_x_data_format,"axis_x_data_format").validatingAxisDataFormat(b.axis_y_data_format,"axis_y_data_format").validatingColorMode(a.color_mode,"color_mode").validatingAxisPointerPosition(a.axis_y_pointer_position,"axis_y_pointer_position").validatingAxisPointerPosition(a.axis_x_pointer_position,"axis_x_pointer_position").validatingAxisPointerPosition(a.axis_x_position,"axis_x_position").validatingAxisPointerPosition(a.axis_y_position,"axis_y_position").validatingBorderBetweenChartElementsStyle(a.border_between_chart_elements_style,"border_between_chart_elements_style").validatingLegendsPosition(a.legends_display,"legends_display").isArray(a.axis_x_pointer_values,"axis_x_pointer_values").isArray(a.axis_y_pointer_values,"axis_y_pointer_values").isArray(a.chart_color,"chart_color").validatingTimeScaleDataType(a.axis_x_time_value_datatype,"axis_x_time_value_datatype").validatingTimeScaleDataType(a.axis_y_time_value_datatype,"axis_y_time_value_datatype").validatingTooltipMode(a.tooltip_mode,"tooltip_mode").validatingFontWeight(a.title_weight,"title_weight").validatingFontWeight(a.subtitle_weight,"subtitle_weight").validatingFontWeight(a.pointer_weight,"pointer_weight").validatingFontWeight(a.label_weight,"label_weight").validatingFontWeight(a.legends_text_weight,"legends_text_weight"),a},PykCharts.multiD.lineChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){if(b=new PykCharts.multiD.processInputs(b,a,"line"),!b.stop){"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;c.stylesheet,a.optional}b.crosshair_enable=a.crosshair_enable?a.crosshair_enable:d.crosshair_enable,b.curvy_lines=a.line_curvy_lines?a.line_curvy_lines:d.line_curvy_lines,b.interpolate=PykCharts.boolean(b.curvy_lines)?"cardinal":"linear",b.color_from_data=a.line_color_from_data?a.line_color_from_data:d.line_color_from_data,d3.json(a.data,function(c,d){b.data=d.groupBy("line"),b.axis_y_data_format=a.axis_y_data_format?a.axis_y_data_format:b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format=a.axis_x_data_format?a.axis_x_data_format:b.k.xAxisDataFormatIdentification(b.data),b.compare_data=b.data,b.data_length=b.data.length,b.dataTransformation(),$(b.selector+" #chart-loader").remove(),b.render()
})}},this.dataTransformation=function(){for(b.group_arr=[],b.color_arr=[],b.new_data=[],b.ticks=[],j=0;j<b.data_length;j++)b.group_arr[j]=b.data[j].name;b.uniq_group_arr=b.group_arr.slice(),b.uniq_color_arr=[],$.unique(b.uniq_group_arr);var a=b.uniq_group_arr.length;for(k=0;a>k;k++)if(b.chart_color[k])b.uniq_color_arr[k]=b.chart_color[k];else{for(l=0;l<b.data_length;l++)if(b.uniq_group_arr[k]===b.data[l].name&&b.data[l].color){b.uniq_color_arr[k]=b.data[l].color;break}PykCharts.boolean(b.uniq_color_arr[k])||(b.uniq_color_arr[k]=b.default_color[0])}for(k=0;a>k;k++)for(b.new_data[k]={name:b.uniq_group_arr[k],data:[],color:b.uniq_color_arr[k]},l=0;l<b.data_length;l++)b.uniq_group_arr[k]===b.data[l].name&&b.new_data[k].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip,annotation:b.data[l].annotations||""});b.new_data_length=b.new_data.length},this.render=function(){if(b.dataLineGroup=[],b.clicked,b.multid=new PykCharts.multiD.configuration(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),b.transitions=new PykCharts.Configuration.transition(a),"default"===b.mode){if(b.k.title(),PykCharts.boolean(b.panels_enable)){for(b.k.backgroundColor(b).export(b,"svg-","lineChart",b.panels_enable,b.new_data).emptyDiv().subtitle(),b.w=b.width/3,b.height=b.height/2,b.reducedWidth=b.w-b.margin_left-b.margin_right,b.reducedHeight=b.height-b.margin_top-b.margin_bottom,b.fill_data=[],i=0;i<b.new_data_length;i++)b.k.liveData(b).makeMainDiv(b.selector,i).tooltip(!0,b.selector,i),b.new_data1=b.new_data[i],b.fill_data[0]=b.new_data1,b.optionalFeature().chartType().svgContainer(i).createGroups(i),b.k.crossHair(b.svgContainer,1,b.fill_data,b.fillColor),b.optionalFeature().createChart(null,i).ticks(i).axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup),(i+1)%4===0&&0!==i&&b.k.emptyDiv();b.k.emptyDiv()}else b.k.backgroundColor(b).export(b,"#svg-1","lineChart").emptyDiv().subtitle(),b.w=b.width,b.reducedWidth=b.w-b.margin_left-b.margin_right,b.reducedHeight=b.height-b.margin_top-b.margin_bottom,b.k.liveData(b).makeMainDiv(b.selector,1).tooltip(!0,b.selector,1),b.optionalFeature().chartType().svgContainer(1).createGroups(1).hightLightOnload(),b.k.crossHair(b.svgContainer,b.new_data_length,b.new_data,b.fillColor),b.optionalFeature().createChart().ticks().axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup);b.k.createFooter().lastUpdatedAt().credits().dataSource(),b.annotation()}else if("infographics"===b.mode)if(PykCharts.boolean(b.panels_enable)){for(b.k.export(b,"svg-","lineChart",b.panels_enable,b.new_data).emptyDiv(),b.w=b.width/3,b.height=b.height/2,b.reducedWidth=b.w-b.margin_left-b.margin_right,b.reducedHeight=b.height-b.margin_top-b.margin_bottom,b.fill_data=[],i=0;i<b.new_data_length;i++)b.new_data1=b.new_data[i],b.fill_data[0]=b.new_data1,b.k.makeMainDiv(b.selector,i),b.optionalFeature().chartType().svgContainer(i).createGroups(i).createChart(null,i).ticks(i).axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup),(i+1)%4===0&&0!==i&&b.k.emptyDiv();b.k.emptyDiv()}else b.k.export(b,"#svg-1","lineChart").emptyDiv(),b.w=b.width,b.reducedWidth=b.w-b.margin_left-b.margin_right,b.reducedHeight=b.height-b.margin_top-b.margin_bottom,b.k.makeMainDiv(b.selector,1),b.optionalFeature().chartType().svgContainer(1).createGroups(1).createChart().ticks().axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup);PykCharts.boolean(b.panels_enable)?$(window).on("load",function(){return b.k.resize(null)}).on("resize",function(){return b.k.resize(null)}):$(window).on("load",function(){return b.k.resize(b.svgContainer,"yes")}).on("resize",function(){return b.k.resize(b.svgContainer,"yes")}),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("line"),b.data_length=b.data.length;var d=b.multid.checkChangeInData(b.data,b.compare_data);b.compare_data=d[0];var e=d[1];b.dataTransformation(),e&&(b.k.lastUpdatedAt("liveData"),b.mouseEvent.tooltipHide(null,b.panels_enable,b.type),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")),b.optionalFeature().hightLightOnload().createChart("livedata").ticks(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale),b.annotation()})},this.optionalFeature=function(){var c={chartType:function(){for(j=0;j<b.data_length;j++)for(k=j+1;k<b.data_length;k++)if(b.data[j].x===b.data[k].x){b.type="multilineChart";break}return b.type=b.type||"lineChart",this},hightLightOnload:function(){if("multilineChart"===b.type&&b.new_data_length>0&&b.highlight)for(var a=0;a<b.uniq_group_arr.length;a++)b.new_data[a].highlight=b.highlight.toLowerCase()===b.uniq_group_arr[a].toLowerCase()?!0:!1;return this},svgContainer:function(a){return"multilineChart"===b.type?$(b.selector).attr("class","PykCharts-twoD PykCharts-line-chart PykCharts-multi-series2D"):"lineChart"===b.type&&$(b.selector).attr("class","PykCharts-twoD PykCharts-line-chart"),b.svgContainer=d3.select(b.selector+" #tooltip-svg-container-"+a).append("svg:svg").attr("id","svg-"+a).attr("width",b.w).attr("height",b.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.w+" "+b.height),this},createGroups:function(a){return b.group=b.svgContainer.append("g").attr("id","chartsvg").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),PykCharts.boolean(b.grid_y_enable)&&b.group.append("g").attr("id","ygrid").attr("class","y grid-line"),PykCharts.boolean(b.grid_x_enable)&&b.group.append("g").attr("id","xgrid").attr("class","x grid-line"),b.clip=b.svgContainer.append("svg:clipPath").attr("id","clip"+a+b.selector).append("svg:rect").attr("width",b.reducedWidth).attr("height",b.reducedHeight),b.chartBody=b.svgContainer.append("g").attr("id","clipPath").attr("clip-path","url(#clip"+a+b.selector+")").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),this},axisContainer:function(){return PykCharts.boolean(b.axis_x_enable)&&(b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis")),PykCharts.boolean(b.axis_y_enable)&&(b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(c,d){function e(a){b.dataLineGroup[a].transition().duration(b.transitions.duration()).attrTween("d",function(){var c=d3.scale.quantile().domain([0,1]).range(d3.range(1,v.length+1));return function(d){return b.chart_path(b.new_data[a].data.slice(0,c(d)))}})}function f(a){b.dataLineGroup[0].transition().duration(b.transitions.duration()).attrTween("d",function(){var c=d3.scale.quantile().domain([0,1]).range(d3.range(1,b.new_data[a].data.length+1));return function(d){return b.chart_path(b.new_data[a].data.slice(0,c(d)))}})}var g,h,i,k,l,m=[];if("number"===b.axis_y_data_format?(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),l=[min,max],h=b.k._domainBandwidth(l,2),i=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("linear",h,i)):"string"===b.axis_y_data_format?(b.new_data[0].data.forEach(function(a){h.push(a.y)}),i=[0,b.reducedHeight],b.yScale=b.k.scaleIdentification("ordinal",h,i,0)):"time"===b.axis_y_data_format&&(h=d3.extent(b.data,function(a){return new Date(a.x)}),i=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("time",h,i)),b.xdomain=[],"number"===b.axis_x_data_format)max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),g=[min,max],m=b.k._domainBandwidth(g,2),k=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("linear",m,k),b.extra_left_margin=0,b.ydomain=b.yScale.domain();else if("string"===b.axis_x_data_format)b.new_data[0].data.forEach(function(a){m.push(a.x)}),k=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("ordinal",m,k,0),b.extra_left_margin=b.xScale.rangeBand()/2,b.xdomain=b.xScale.domain();else if("time"===b.axis_x_data_format){for(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),m=[min,max],k=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("time",m,k),o=0;o<b.new_data_length;o++)b.new_data[o].data.forEach(function(a){a.x=new Date(a.x)}),b.data.forEach(function(a){a.x=new Date(a.x),b.xdomain.push(a.x)});b.extra_left_margin=0}if(b.count=1,b.zoom_event=d3.behavior.zoom(),"string"!==b.axis_y_data_format&&"string"!==b.axis_x_data_format?b.zoom_event.x(b.xScale).y(b.yScale).scale(b.count).on("zoom",b.zoomed):b.zoom_event.y(b.yScale).scale(b.count).on("zoom",b.zoomed),PykCharts.boolean(b.zoom_enable)&&"default"===b.mode)for(PykCharts.boolean(b.panels_enable)?(n=b.new_data_length,j=0):(n=2,j=1),o=j;n>o;o++)d3.selectAll(b.selector+" #svg-"+o).call(b.zoom_event),d3.selectAll(b.selector+" #svg-"+o).on("wheel.zoom",null).on("mousewheel.zoom",null);if(b.chart_path=d3.svg.line().x(function(a){return b.xScale(a.x)}).y(function(a){return b.yScale(a.y)}).interpolate(b.interpolate),b.chartPathClass="lineChart"===b.type?"line":"multi-line","livedata"===c){if(PykCharts.boolean(b.panels_enable)){u=b.type+b.svgContainer.attr("id");for(var o=0;o<b.new_data_length;o++){var p=d3.select(b.selector+" #svg-"+o),q=p.select("#xaxis"),r=p.select("#yaxis"),s=(p.select("#xgrid"),p.select("#ygrid"),u.length),t=u.substring(0,s-1);b.k.xAxis(b.svgContainer,q,b.xScale).yAxis(b.svgContainer,r,b.yScale).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale),p.select(b.selector+" #"+t+o).datum(b.new_data[o].data).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",b.chart_path)}}else for(var o=0;o<b.new_data_length;o++)u=b.type+"-svg-"+o,b.svgContainer.select(b.selector+" #"+u).datum(b.new_data[o].data).attr("d",b.chart_path).style("stroke",function(){return b.new_data[o].highlight&&"multilineChart"===b.type&&!b.clicked?b.highlightLine(this,null):b.clicked?b.highlightLine(b.selected,null):d3.select(this).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}),b.fillColor.colorPieMS(b.new_data[o])}),d3.selectAll(b.selector+" text#"+(b.type+"-svg-"+o)).style("fill",function(){return b.fillColor.colorPieMS(b.new_data[o])});"lineChart"===b.type&&"default"===b.mode&&b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")}).on("mousemove",function(){PykCharts.boolean(b.panels_enable)?b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.xdomain):b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.xdomain,b.type,b.tooltipMode,b.color_from_data,null)})}else{if(PykCharts.boolean(b.panels_enable))u=b.type+b.svgContainer.attr("id"),b.dataLineGroup[0]=b.chartBody.append("path"),b.dataLineGroup[0].datum(b.new_data1.data).attr("class",b.chartPathClass).attr("id",u).attr("transform","translate("+b.extra_left_margin+",0)").style("stroke",function(){return b.fillColor.colorPieMS(b.new_data[d])}),f(d);else{var o;for(o=0;o<b.new_data_length;o++){var u=b.type+"-svg-"+o;b.dataLineGroup[o]=b.chartBody.append("path");var v=b.new_data[o].data;b.ticks[o]=b.svgContainer.append("text").attr("id",u).attr("class","legend-heading").style("visibility","hidden").html(b.new_data[o].name).style("fill",function(){return b.fillColor.colorPieMS(b.new_data[o])}),b.dataLineGroup[o].datum(b.new_data[o].data).attr("class",b.chartPathClass).attr("id",u).attr("transform","translate("+b.extra_left_margin+",0)").style("stroke",function(){return b.new_data[o].highlight&&"multilineChart"===b.type&&b.highlightLine(this,null,b.new_data[o].highlight),b.fillColor.colorPieMS(b.new_data[o])}).style("stroke-opacity",function(){return"multilineChart"===b.type&&"saturation"===b.color_mode?(o+1)/b.new_data.length:1}).on("click",function(){"multilineChart"===b.type&&(b.clicked=!0,b.highlightLine(d3.event.target,b.clicked))}).on("mouseover",function(){"multilineChart"!==b.type||this===b.selected||"saturation"!==b.color_mode&&!b.hover||(b.previous_color=d3.select(this).style("stroke-opacity"),b.click_color=d3.select(this).style("stroke"),d3.select(this).classed({"multi-line-hover":!0,"multi-line":!1}).style("stroke","orange"))}).on("mouseout",function(a,c){"multilineChart"!==b.type||this===b.selected||"saturation"!==b.color_mode&&!b.hover||d3.select(this).classed({"multi-line-hover":!1,"multi-line":!0}).style("stroke",function(){return b.new_data[c].highlight&&"multilineChart"===b.type&&b.highlightLine(this,null,b.new_data[c].highlight),b.click_color}).style("stroke-opacity",function(){return"multilineChart"===b.type&&"saturation"===b.color_mode?b.previous_color:1})}).attr("d",function(){return b.chart_path(v[0])}),e(o)}}"lineChart"===b.type&&"default"===b.mode?b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")}).on("mousemove",function(){b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.xdomain,b.type,b.tooltipMode,b.color_from_data,null)}):"multilineChart"===b.type&&"default"===b.mode&&b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(null,b.panels_enable,b.type),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis");for(var c=0;c<b.new_data_length;c++)$(a.selector+" #svg-"+c).trigger("mouseout")}).on("mousemove",function(){var c=[];c[0]=d3.select(a.selector+" #"+this.id+" .multi-line"),b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,c,b.extra_left_margin,b.xdomain,b.type,b.tooltipMode,b.color_from_data,b.panels_enable);for(var d=0;d<b.new_data_length;d++)$(a.selector+" #svg-"+d).trigger("mousemove")})}return this},ticks:function(){return PykCharts.boolean(b.pointer_size)&&(PykCharts.boolean(b.panels_enable)?(type=b.type+b.svgContainer.attr("id"),"bottom"!==b.axis_x_position||"left"!==b.axis_y_position&&"right"!==b.axis_y_position?"top"!==b.axis_x_position||"left"!==b.axis_y_position&&"right"!==b.axis_y_position||(b.ticks[0]=b.svgContainer.append("text").attr("id",type).attr("x",b.w-b.margin_left).attr("y",b.height-b.margin_bottom).attr("dy",10).attr("text-anchor","end").style("font-size",b.pointer_size).style("font-weight",b.pointer_weight).style("font-family",b.pointer_family).html(b.new_data1.name).style("fill",function(){return b.fillColor.colorPieMS(b.new_data1)})):b.ticks[0]=b.svgContainer.append("text").attr("id",type).attr("x",b.margin_left).attr("y",b.margin_top).attr("dy",-5).style("font-size",b.pointer_size).style("font-weight",b.pointer_weight).style("font-family",b.pointer_family).html(b.new_data1.name).style("fill",function(){return b.fillColor.colorPieMS(b.new_data1)})):(tickPosition=function(a,c){var d,e;return"left"===b.axis_y_position?(d=b.xScale(b.new_data[c].data[b.new_data[c].data.length-1].x)+b.extra_left_margin+b.margin_left,e=b.yScale(b.new_data[c].data[b.new_data[c].data.length-1].y)+b.margin_top):"right"===b.axis_y_position&&(d=b.xScale(b.new_data[c].data[0].x)+b.extra_left_margin+b.margin_left-10,e=b.yScale(b.new_data[c].data[0].y)+b.margin_top),text_x=d,text_y=e,text_rotate=0,"translate("+text_x+","+text_y+") rotate("+text_rotate+")"},orient=function(){return"left"===b.axis_y_position?"start":"right"===b.axis_y_position?"end":void 0},b.ticks=b.svgContainer.selectAll(".legend-heading").data(b.new_data),b.ticks.enter().append("text"),b.ticks.attr("id",function(a,c){return b.type+"-svg-"+c}).attr("class","legend-heading").text(function(a){return a.name}).text(function(a){return b.tick_w=this.getBBox().width+5,a.name}).attr("transform",tickPosition).style("font-size",b.pointer_size).style("font-weight",function(a){return a.highlight?"bold":b.pointer_weight}).style("font-family",b.pointer_family).style("visibility","visible").attr("text-anchor",orient).attr("dx",5).attr("dy",5).style("fill",function(a,c){return b.fillColor.colorPieMS(b.new_data[c])}),b.ticks.exit().remove())),this}};return c},this.zoomed=function(){if(PykCharts.boolean(b.panels_enable))for(i=0;i<b.new_data_length;i++)type=b.type+"svg-"+i,currentContainer=d3.selectAll(b.selector+" #svg-"+i),b.k.isOrdinal(currentContainer,".x.axis",b.xScale,b.xdomain,b.extra_left_margin),b.k.isOrdinal(currentContainer,".x.grid",b.xScale),b.k.isOrdinal(currentContainer,".y.axis",b.yScale,b.ydomain),b.k.isOrdinal(currentContainer,".y.grid",b.yScale),currentContainer.select(b.selector+" #"+type).attr("class",b.chartPathClass).attr("d",b.chart_path);else for(b.k.isOrdinal(b.svgContainer,".x.axis",b.xScale,b.xdomain,b.extra_left_margin),b.k.isOrdinal(b.svgContainer,".x.grid",b.xScale),b.k.isOrdinal(b.svgContainer,".y.axis",b.yScale,b.ydomain),b.k.isOrdinal(b.svgContainer,".y.grid",b.yScale),i=0;i<b.new_data_length;i++)type=b.type+"-svg-"+i,b.svgContainer.select(b.selector+" #"+type).attr("class",b.chartPathClass).attr("d",b.chart_path);"dblclick"===event.type&&b.count++,b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis"),b.count===b.zoom_level+1&&b.zoomOut(),b.annotation(),b.optionalFeature().ticks()},this.zoomOut=function(){b.optionalFeature().createChart("livedata"),b.k.isOrdinal(b.svgContainer,".x.axis",b.xScale,b.xdomain,b.extra_left_margin),b.k.isOrdinal(b.svgContainer,".x.grid",b.xScale),b.k.isOrdinal(b.svgContainer,".y.axis",b.yScale,b.ydomain),b.k.isOrdinal(b.svgContainer,".y.grid",b.yScale)},this.highlightLine=function(c,d){b.selected_line=c,b.selected_line_data=b.selected_line.__data__,b.selected_line_data_len=b.selected_line_data.length,b.deselected=b.selected,d3.select(b.deselected).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}),b.selected=c,d3.select(b.selected).classed({"multi-line-selected":!0,"multi-line":!1,"multi-line-hover":!1}),"multilineChart"!==b.type||"saturation"!==b.color_mode&&!b.hover||d3.select(b.selected).style("stroke",function(){return b.click_color}),d&&(d3.selectAll(a.selector+" path.multi-line").style("stroke-opacity",.3),d3.selectAll(a.selector+" .legend-heading").style("opacity",.3),d3.select(b.selector+" text#"+b.selected.id).style("opacity",1).style("font-weight","bold"),d3.select(b.selected).style("stroke-opacity",1))},this.annotation=function(){if(b.line=d3.svg.line().x(function(a){return a.x}).y(function(a){return a.y}),PykCharts.boolean(b.panels_enable)){if(PykCharts.boolean(b.panels_enable))for(i=0;i<b.new_data_length;i++){var a=[],c=15;b.new_data[i].data.map(function(b){b.annotation&&a.push({annotation:b.annotation,x:b.x,y:b.y})});var d=d3.select(b.selector+" #svg-"+i).selectAll(b.selector+" .PykCharts-annotation-line").data(a);d.enter().append("path"),d.attr("class","PykCharts-annotation-line").attr("d",function(a){var d=[{x:parseInt(b.xScale(a.x))+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(a.y)-c+b.margin_top)},{x:parseInt(b.xScale(a.x))+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(a.y)+b.margin_top)}];return b.line(d)}),d.exit().remove(),b.k.annotation(b.selector+" #svg-"+i,a,b.xScale,b.yScale)}}else{var c=15,a=[];for(i=0;i<b.new_data_length;i++)b.new_data[i].data.map(function(b){b.annotation&&a.push({annotation:b.annotation,x:b.x,y:b.y})});var d=b.svgContainer.selectAll(b.selector+" .PykCharts-annotation-line").data(a);d.enter().append("path"),d.attr("class","PykCharts-annotation-line").attr("d",function(a){var d=[{x:parseInt(b.xScale(a.x))+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(a.y)-c+b.margin_top)},{x:parseInt(b.xScale(a.x))+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(a.y)+b.margin_top)}];return b.line(d)}),d.exit().remove(),b.k.annotation(b.selector+" #svg-1",a,b.xScale,b.yScale)}}},PykCharts.multiD.areaChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){if(b=new PykCharts.multiD.processInputs(b,a,"area"),!b.stop){"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;c.stylesheet,a.optional}b.crosshair_enable=a.crosshair_enable?a.crosshair_enable:d.crosshair_enable,b.curvy_lines=a.line_curvy_lines?a.line_curvy_lines:d.line_curvy_lines,b.color_from_data=a.line_color_from_data?a.line_color_from_data:d.line_color_from_data,b.interpolate=PykCharts.boolean(b.curvy_lines)?"cardinal":"linear",b.w=b.width-b.margin_left-b.margin_right,b.h=b.height-b.margin_top-b.margin_bottom,d3.json(a.data,function(c,d){b.data=d.groupBy("area"),b.axis_y_data_format=a.axis_y_data_format?a.axis_y_data_format:b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format=a.axis_x_data_format?a.axis_x_data_format:b.k.xAxisDataFormatIdentification(b.data),b.compare_data=b.data,b.data_length=b.data.length,$(b.selector+" #chart-loader").remove(),b.render()})}},this.render=function(){b.dataLineGroup=[],b.dataLineGroupBorder=[],b.multid=new PykCharts.multiD.configuration(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#svg-1","areaChart").liveData(b).emptyDiv().subtitle().makeMainDiv(a.selector,1).tooltip(!0,a.selector,1),b.optional_feature().chartType().svgContainer(1).createGroups(1).createChart().axisContainer(),b.k.crossHair(b.svgContainer,b.new_data_length,b.new_data,b.fillColor),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup).createFooter().lastUpdatedAt().credits().dataSource()):"infographics"===b.mode&&(b.k.liveData(b).backgroundColor(b).export(b,"#svg-1","areaChart").emptyDiv().makeMainDiv(a.selector,1),b.optional_feature().chartType().svgContainer(1).createGroups(1).createChart().axisContainer(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup)),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),$(window).on("load",function(){return b.k.resize(b.svgContainer,"yes")}).on("resize",function(){return b.k.resize(b.svgContainer,"yes")})},this.refresh=function(){d3.json(a.data,function(c,d){b.data=d.groupBy("area"),b.data_length=b.data.length;var e=b.multid.checkChangeInData(b.data,b.compare_data);b.compare_data=e[0];var f=e[1];f&&(b.k.lastUpdatedAt("liveData"),b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")),b.optional_feature().createChart("liveData"),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain).yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain).yGrid(b.svgContainer,b.group,b.yScale).xGrid(b.svgContainer,b.group,b.xScale).tooltip(!0,a.selector)})},this.optional_feature=function(){var c={chartType:function(){for(j=1;j<b.data_length;j++)if(b.data[0].x===b.data[j].x){b.type="stackedAreaChart";break}return b.type=b.type||"areaChart",this},svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD PykCharts-multi-series2D PykCharts-line-chart"),b.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("id","svg-"+c).attr("width",b.width).attr("height",b.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height),this},createGroups:function(a){return b.group=b.svgContainer.append("g").attr("id","chartsvg").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),PykCharts.boolean(b.grid_y_enable)&&b.group.append("g").attr("id","ygrid").attr("class","y grid-line"),PykCharts.boolean(b.grid_x_enable)&&b.group.append("g").attr("id","xgrid").attr("class","x grid-line"),b.clip=b.svgContainer.append("svg:clipPath").attr("id","clip"+a+b.selector).append("svg:rect").attr("width",b.w).attr("height",b.h),b.chartBody=b.svgContainer.append("g").attr("id","clipPath").attr("clip-path","url(#clip"+a+b.selector+" )").attr("transform","translate("+b.margin_left+","+b.margin_top+")"),b.stack_layout=d3.layout.stack().values(function(a){return a.data}),this},axisContainer:function(){return PykCharts.boolean(b.axis_x_enable)&&(b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis")),PykCharts.boolean(b.axis_y_enable)&&(b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(c){function d(a){b.dataLineGroup[a].transition().duration(b.transitions.duration()).attrTween("d",function(){var c=d3.scale.quantile().domain([0,1]).range(d3.range(1,q.length+1));return function(d){return b.chart_path(b.new_data[a].data.slice(0,c(d)))}})}function e(a){b.dataLineGroupBorder[a].transition().duration(b.transitions.duration()).attrTween("d",function(){var c=d3.scale.quantile().domain([0,1]).range(d3.range(1,b.layers[a].data.length+1));return function(d){return b.chart_path(b.layers[a].data.slice(0,c(d)))}})}for(b.group_arr=[],b.color_arr=[],b.new_data=[],b.legend_text=[],j=0;j<b.data_length;j++)b.group_arr[j]=b.data[j].name;b.uniq_group_arr=b.group_arr.slice(),b.uniq_color_arr=[],$.unique(b.uniq_group_arr);var f=b.uniq_group_arr.length;for(k=0;f>k;k++)if(b.chart_color[k])b.uniq_color_arr[k]=b.chart_color[k];else{for(l=0;l<b.data_length;l++)if(b.uniq_group_arr[k]===b.data[l].name&&b.data[l].color){b.uniq_color_arr[k]=b.data[l].color;break}PykCharts.boolean(b.uniq_color_arr[k])||(b.uniq_color_arr[k]=b.default_color[0])}for(k=0;f>k;k++)for(b.new_data[k]={name:b.uniq_group_arr[k],data:[],color:b.uniq_color_arr[k]},l=0;l<b.data_length;l++)b.uniq_group_arr[k]===b.data[l].name&&b.new_data[k].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip,annotation:b.data[l].annotations||""});b.new_data_length=b.new_data.length,b.layers=b.stack_layout(b.new_data);var g,h,i,m,n,o=[];if(b.count=1,"number"===b.axis_y_data_format?(max=d3.max(b.layers,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,n=[min,max],h=b.k._domainBandwidth(n,1),i=[b.h,0],b.yScale=b.k.scaleIdentification("linear",h,i)):"string"===b.axis_y_data_format?(b.new_data[0].data.forEach(function(a){h.push(a.y)}),i=[0,b.h],b.yScale=b.k.scaleIdentification("ordinal",h,i,0)):"time"===b.axis_y_data_format&&(b.layers.data.forEach(function(a){a.y0=new Date(a.y0),a.y=new Date(a.y)}),max=d3.max(b.layers,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,h=[min,max],i=[b.h,0],b.yScale=b.k.scaleIdentification("time",h,i)),"number"===b.axis_x_data_format)max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),g=[min,max],o=b.k._domainBandwidth(g,2),m=[0,b.w],b.xScale=b.k.scaleIdentification("linear",o,m),b.extra_left_margin=0;else if("string"===b.axis_x_data_format)b.new_data[0].data.forEach(function(a){o.push(a.x)}),m=[0,b.w],b.xScale=b.k.scaleIdentification("ordinal",o,m,0),b.extra_left_margin=b.xScale.rangeBand()/2;else if("time"===b.axis_x_data_format){for(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),o=[min,max],m=[0,b.w],b.xScale=b.k.scaleIdentification("time",o,m),p=0;p<b.new_data_length;p++)b.new_data[p].data.forEach(function(a){a.x=new Date(a.x)});b.data.forEach(function(a){a.x=new Date(a.x)}),b.extra_left_margin=0}if(b.xdomain=b.xScale.domain(),b.ydomain=b.yScale.domain(),b.zoom_event=d3.behavior.zoom(),"string"!==b.axis_y_data_format&&"string"!==b.axis_x_data_format?b.zoom_event.x(b.xScale).y(b.yScale).scale(b.count).on("zoom",b.zoomed):b.zoom_event.y(b.yScale).scale(b.count).on("zoom",b.zoomed),PykCharts.boolean(b.zoom_enable)&&"default"===b.mode&&(b.svgContainer.call(b.zoom_event),b.svgContainer.on("wheel.zoom",null).on("mousewheel.zoom",null)),b.chart_path=d3.svg.area().x(function(a){return b.xScale(a.x)}).y0(function(a){return b.yScale(a.y0)}).y1(function(a){return b.yScale(a.y0+a.y)}).interpolate(b.interpolate),b.chart_path_border=d3.svg.line().x(function(a){return b.xScale(a.x)}).y(function(a){return b.yScale(a.y0+a.y)}).interpolate(b.interpolate),b.chartPathClass="areaChart"===b.type?"area":"stacked-area","liveData"===c){for(var p=0;p<b.new_data_length;p++)type=b.chartPathClass+p,b.svgContainer.select("#"+type).datum(b.layers[p].data).attr("d",b.chart_path),b.svgContainer.select("#border-stacked-area"+p).datum(b.layers[p].data).attr("d",b.chart_path_border);"areaChart"===b.type&&b.svgContainer.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(type),b.mouseEvent.axisHighlightHide(a.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(a.selector+" .y.axis")}).on("mousemove",function(){b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.xdomain,b.type,b.tooltip_mode)})}else{for(var p=0;p<b.new_data_length;p++){var q=b.new_data[p].data;type=b.chartPathClass+p,b.dataLineGroup[p]=b.chartBody.append("path"),b.dataLineGroup[p].datum(b.layers[p].data).attr("class",b.chartPathClass).attr("id",type).style("fill",function(){return b.fillColor.colorPieMS(b.new_data[p])}).style("fill-opacity",function(){return"stackedAreaChart"===b.type&&"saturation"===b.color_mode?(p+1)/b.new_data.length:void 0}).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",function(){return b.chart_path(q[0])}),d(p),b.dataLineGroupBorder[p]=b.chartBody.append("path"),b.dataLineGroupBorder[p].datum(b.layers[p].data).attr("class","area-border").attr("id","border-stacked-area"+p).style("stroke",b.border_between_chart_elements_color).style("stroke-width",b.border_between_chart_elements_thickness).style("stroke-dasharray",b.border_between_chart_elements_style).attr("transform","translate("+b.extra_left_margin+",0)").attr("d",b.chart_path_border),e(p)}b.svgContainer.on("mouseout",function(){if(b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis"),"stackedAreaChart"===b.type)for(var c=0;c<b.new_data_length;c++)$(a.selector+" #svg-"+c).trigger("mouseout")}).on("mousemove",function(){if("areaChart"===b.type)b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.extra_left_margin,b.xdomain,b.type,b.tooltip_mode);else if("stackedAreaChart"===b.type){var c=[];c[0]=d3.select(a.selector+" #"+this.id+" .stacked-area"),b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,c,b.extra_left_margin,b.xdomain,b.type,b.tooltipMode,b.color_from_data,"no");for(var d=0;d<b.new_data_length;d++)$(a.selector+" #svg-"+d).trigger("mousemove")}})}return b.annotation(),this}};return c},this.zoomed=function(){for(b.k.isOrdinal(b.svgContainer,".x.axis",b.xScale,b.xdomain,b.extra_left_margin),b.k.isOrdinal(b.svgContainer,".x.grid",b.xScale),b.k.isOrdinal(b.svgContainer,".y.axis",b.yScale,b.ydomain),b.k.isOrdinal(b.svgContainer,".y.grid",b.yScale),i=0;i<b.new_data_length;i++)type=b.chartPathClass+i,b.svgContainer.select(b.selector+" #"+type).attr("class",b.chartPathClass).attr("d",b.chart_path),b.svgContainer.select(b.selector+" #border-stacked-area"+i).attr("class","area-border").attr("d",b.chart_path_border);
"dblclick"===event.type&&b.count++,b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis"),b.count===b.zoom_level+1&&b.zoomOut(),b.annotation()},b.zoomOut=function(){b.optional_feature().createChart("liveData"),b.k.isOrdinal(b.svgContainer,".x.axis",b.xScale,b.xdomain,b.extra_left_margin),b.k.isOrdinal(b.svgContainer,".x.grid",b.xScale),b.k.isOrdinal(b.svgContainer,".y.axis",b.yScale,b.ydomain),b.k.isOrdinal(b.svgContainer,".y.grid",b.yScale)},b.annotation=function(){if(b.line=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y}),"areaChart"===b.type&&"default"===b.mode){var a=10,c=[];b.new_data[0].data.map(function(a){a.annotation&&c.push({annotation:a.annotation,x:a.x,y:a.y})});var d=b.svgContainer.selectAll(b.selector+" .linechart-arrows").data(c);d.enter().append("path"),d.attr("class","linechart-arrows").attr("d",function(c){var d=[{x:parseInt(b.xScale(c.x)-.5*a)+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(c.y)-a+b.margin_top)},{x:parseInt(b.xScale(c.x)+.5*a)+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(c.y)-a+b.margin_top)},{x:parseInt(b.xScale(c.x))+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(c.y)+b.margin_top)}];return b.line(d)}).attr("stroke","darkgray").attr("fill","#eeeeee"),d.exit().remove(),b.k.annotation(b.selector+" #svg-1",c,b.xScale,b.yScale)}else if("stackedAreaChart"===b.type&&"default"===b.mode){var a=10,c=[];for(i=0;i<b.new_data_length;i++)b.new_data[i].data.map(function(a){a.annotation&&c.push({annotation:a.annotation,x:a.x,y:a.y+a.y0})});var d=b.svgContainer.selectAll(".linechart-arrows").data(c);d.enter().append("path"),d.attr("class","linechart-arrows").attr("d",function(c){var d=[{x:parseInt(b.xScale(c.x)-.5*a)+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(c.y)-a+b.margin_top)},{x:parseInt(b.xScale(c.x)+.5*a)+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(c.y)-a+b.margin_top)},{x:parseInt(b.xScale(c.x))+b.extra_left_margin+b.margin_left,y:parseInt(b.yScale(c.y)+b.margin_top)}];return b.line(d)}).attr("stroke","darkgray").attr("fill","#eeeeee"),d.exit().remove(),b.k.annotation(b.selector+" #svg-1",c,b.xScale,b.yScale)}}},PykCharts.multiD.barChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});return this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"column");var d=c.multiDimensionalCharts;b.stop||(b.grid_y_enable=a.chart_grid_y_enable?a.chart_grid_y_enable:c.stylesheet.chart_grid_y_enable,b.grid_color=a.chart_grid_color?a.chart_grid_color:c.stylesheet.chart_grid_color,b.axis_x_data_format="",b.data_sort_enable=a.data_sort_enable?a.data_sort_enable:d.data_sort_enable,b.data_sort_type=PykCharts.boolean(b.data_sort_enable)&&a.data_sort_type?a.data_sort_type:d.data_sort_type,b.data_sort_order=PykCharts.boolean(b.data_sort_enable)&&a.data_sort_order?a.data_sort_order:d.data_sort_order,"default"===b.mode&&b.k.loading(),b.multiD=new PykCharts.multiD.configuration(b),d3.json(a.data,function(a,c){b.data=c.groupBy("bar"),b.compare_data=c.groupBy("bar"),$(b.selector+" #chart-loader").remove(),b.render()}))},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("bar"),b.refresh_data=c.groupBy("bar");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var f=b.flattenData();b.the_bars=f[0],b.the_keys=f[1],b.the_layers=b.buildLayers(b.the_bars),1===b.no_of_groups&&(b.legends_enable="no"),b.map_group_data=b.multiD.mapGroup(b.data),b.optionalFeatures().createChart().legends().ticks(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,void 0,void 0,b.legendsGroup_height)})},this.render=function(){var b=this;b.map_group_data=b.multiD.mapGroup(b.data),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var c=b.flattenData();b.the_bars=c[0],b.the_keys=c[1],b.the_layers=b.buildLayers(b.the_bars),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.multiD.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),b.border=new PykCharts.Configuration.border(b),1===b.no_of_groups&&(b.legends_enable="no"),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#svgcontainer","barChart").emptyDiv().subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).legendsContainer(1),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().legends().createGroups().createChart().axisContainer().ticks().highlightRect()):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#svgcontainer","barChart").emptyDiv().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).legendsContainer(1).createGroups().createChart().axisContainer(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,void 0,void 0,b.legendsGroup_height).xAxisTitle(b.xGroup),PykCharts.boolean(b.legends_enable)?$(window).on("load",function(){return b.k.resize(b.svgContainer,"",b.legendsContainer)}).on("resize",function(){return b.k.resize(b.svgContainer,"",b.legendsContainer)}):$(window).on("load",function(){return b.k.resize(b.svgContainer,"")}).on("resize",function(){return b.k.resize(b.svgContainer,"")})},this.optionalFeatures=function(){var b=this,c={svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD"),b.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height),this},createGroups:function(){return b.group=b.svgContainer.append("g").attr("id","svggroup").attr("class","svggroup").attr("transform","translate("+b.margin_left+","+(b.margin_top+b.legendsGroup_height)+")"),this},legendsContainer:function(){return PykCharts.boolean(b.legends_enable)&&"default"===b.mode?b.legendsGroup=b.svgContainer.append("g").attr("id","legends").attr("class","legends").attr("transform","translate(0,10)"):b.legendsGroup_height=0,this},axisContainer:function(){if(PykCharts.boolean(b.axis_y_enable)){var a=b.group.selectAll(".axis-line").data(["line"]);a.enter().append("line"),a.attr("class","axis-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",b.height-b.margin_top-b.margin_bottom-b.legendsGroup_height).attr("stroke",b.axis_x_line_color).attr("stroke-width","1px"),a.exit().remove(),"left"===b.axis_y_position?b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis").append("text").attr("transform","rotate(-90)").attr("x",-(b.height-b.margin_top-b.margin_bottom-b.legendsGroup_height)/2).attr("y",-60).attr("dy",".71em").style("text-anchor","end").style("fill",b.axis_x_label_color).text(b.axis_y_title):"right"===b.axis_y_position&&(a.attr("x1",b.width-b.margin_left-b.margin_right).attr("x2",b.width-b.margin_left-b.margin_right),b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis").append("text").attr("transform","rotate(-90)").attr("x",-(b.height-b.margin_top-b.margin_bottom-b.legendsGroup_height)/2).attr("y",b.width-b.margin_left-b.margin_right+12).attr("dy",".71em").style("text-anchor","end").style("fill",b.axis_x_label_color).text(b.axis_y_title))}return PykCharts.boolean(b.axis_x_enable)&&(b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis")),this},createChart:function(){{var c=b.width-b.margin_left-b.margin_right,d=b.no_of_groups+1,e=b.height-b.margin_top-b.margin_bottom-b.legendsGroup_height,f=b.the_bars;b.the_keys}b.layers=b.the_layers;var g=b.getGroups();b.stack_layout=d3.layout.stack().values(function(a){return a.values})(b.layers),b.layers=b.layers.map(function(a){return{name:a.name,values:a.values.map(function(a){return{x:a.y,y:a.x,x0:a.y0,tooltip:a.tooltip?a.tooltip:a.y,color:a.color,group:a.group,name:a.name}})}});var h=[];b.layers.map(function(a,b){for(b in a.values){var c=a.values[b];h.push(c.x+c.x0)}}),b.yScale=d3.scale.ordinal().domain(f.map(function(a,b){return a.id||b})).rangeBands([0,e]);var i=[0,d3.max(h)];b.xScale=d3.scale.linear().domain(b.k._domainBandwidth(i,1)).range([0,c]);var j=[];for(var k in g){var l=g[k],m=b.yScale(l[0]),n=b.yScale.rangeBand()*l.length;m+=n/2,j.push({y:m,name:k})}b.domain=j.map(function(a){return a.name}),b.y0=d3.scale.ordinal().domain(j.map(function(a){return a.name})).rangeRoundBands([0,e],.1),b.y1=d3.scale.ordinal().domain(b.barName.map(function(a){return a})).rangeRoundBands([0,b.y0.rangeBand()]),b.y_factor=0,b.height_factor=0,1===b.no_of_groups&&(b.y_factor=b.yScale.rangeBand()/4,b.height_factor=b.yScale.rangeBand()/(2*b.no_of_groups)),b.highlight_y_positions=[],b.highlight_x_positions=[],b.bars=b.group.selectAll(".bars").data(b.layers),b.bars.enter().append("g").attr("class","bars");var o=b.bars.selectAll("rect").data(function(a){return a.values});o.enter().append("svg:rect").attr("class","rect"),o.attr("width",0).attr("x",0).attr("fill",function(a){return 1===b.no_of_groups?b.fillColor.colorPieMS(a):b.fillColor.colorGroup(a)}).attr("fill-opacity",function(){return"saturation"===b.color_mode?d>1?(d--,d/b.no_of_groups):(d=b.no_of_groups+1,d--,d/b.no_of_groups):void 0}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).attr("stroke-opacity",1).on("mouseover",function(c){"default"===b.mode&&(b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(c.tooltip?c.tooltip:c.y),b.mouseEvent.axisHighlightShow(c.name,a.selector+" .axis-text",b.domain,"bar"))}).on("mouseout",function(c){"default"===b.mode&&(b.mouseEvent.tooltipHide(c),b.mouseEvent.axisHighlightHide(a.selector+" .axis-text","bar"))}).on("mousemove",function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)}),o.attr("x",function(a){return b.xScale(a.x0)}).attr("width",function(a){return b.highlight.toLowerCase()===a.name.toLowerCase()&&b.highlight_x_positions.push(b.xScale(a.x)),b.xScale(a.x)}).attr("height",function(){return b.yScale.rangeBand()+b.height_factor}).attr("y",function(a){return b.highlight.toLowerCase()===a.name.toLowerCase()&&b.highlight_y_positions.push(b.yScale(a.y)-b.y_factor),b.yScale(a.y)-b.y_factor}),b.bars.exit().remove();var p=b.group.selectAll("text.axis-text").data(j);return p.enter().append("text"),p.attr("class","axis-text").attr("y",function(a){return a.y}).attr("x",function(){return-10}).attr("fill",b.axis_y_labelColor).text(function(a){return a.name}).text(function(a){return this.getBBox().width>.8*b.margin_left?a.name.substr(0,2)+"..":a.name}).on("mouseover",function(a){b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.name)}).on("mouseout",function(a){b.mouseEvent.tooltipHide(a)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}),"right"===b.axis_y_position&&p.attr("x",function(){return b.width-b.margin_left-b.margin_right+10}),"left"===b.axis_y_position&&"right"===b.axis_y_pointer_position&&p.attr("x",function(){return 10}),"right"===b.axis_y_position&&"left"===b.axis_y_pointer_position&&p.attr("x",function(){return b.width-b.margin_left-b.margin_right-10}),"right"===b.axis_y_pointer_position?p.attr("text-anchor","start"):"left"===b.axis_y_pointer_position&&p.attr("text-anchor","end"),p.exit().remove(),this},ticks:function(){if(b.pointer_size){b.txt_width,b.txt_height,b.ticksElement=b.bars.selectAll("g").data(b.layers);var a=b.bars.selectAll(".ticksText").data(function(a){return a.values});a.enter().append("text").attr("class","ticksText"),a.attr("class","ticksText").text(function(a){return a.x?a.x:void 0}).style("font-weight",b.pointer_weight).style("font-size",b.pointer_size).attr("fill",b.pointer_color).style("font-family",b.pointer_family).text(function(a){return a.x&&(b.txt_width=this.getBBox().width,b.txt_height=this.getBBox().height,a.x&&b.txt_width<b.xScale(a.x)&&b.txt_height<b.yScale.rangeBand()+b.height_factor)?a.x:void 0}).attr("x",function(a){b.xScale(a.x);return b.xScale(a.x0)+b.xScale(a.x)+5}).attr("y",function(a){return b.yScale(a.y)-b.y_factor+b.yScale.rangeBand()/2}).attr("dy",function(){return 1===b.no_of_groups?b.yScale.rangeBand()/2:b.yScale.rangeBand()/4}).style("font-size",function(){return b.pointer_size}),a.exit().remove()}return this},highlightRect:function(){function a(a,b){return a-b}if(b.no_of_groups>1){b.highlight_x_positions.sort(a),b.highlight_y_positions.sort(a);var c,d=b.highlight_x_positions.length,e=b.highlight_y_positions.length,f=-5,g=b.highlight_y_positions[0]-5,h=b.highlight_x_positions[d-1]+15+b.txt_width;c=PykCharts.boolean(b.highlight_x_positions[0])?b.highlight_y_positions[e-1]-b.highlight_y_positions[0]+10+b.yScale.rangeBand()+b.height_factor:b.highlight_y_positions[e-1]-b.highlight_y_positions[0]+10,b.group.append("rect").attr("class","highlight-rect").attr("x",f).attr("y",g).attr("width",h).attr("height",c).attr("fill","none").attr("stroke",b.highlight_color).attr("stroke-width","1.5").attr("stroke-dasharray","5,5").attr("stroke-opacity",1)}return this},legends:function(){if(PykCharts.boolean(b.legends_enable)){var a,c=b.getParameters();a=c.map(function(a){return a.color}),c=c.map(function(a){return a.name}),c=_.uniq(c);var d=0,e=0;if(d=c.length,e=c.length,"vertical"===b.legends_display){b.legendsGroup_height=30*c.length+20,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,h=function(){return b.width-b.width/4+16},i=function(){return b.width-b.width/4};var f=function(a,b){return 24*b+12},g=function(a,b){return 24*b+23}}else if("horizontal"===b.legends_display){b.legendsGroup_height=50,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var h=function(){return d--,b.width-(100*d+75)};g=30,rect_parameter1value=13,rect_parameter2value=13;var i=function(){return e--,b.width-(100*e+100)};f=18}var j=b.legendsGroup.selectAll("rect").data(c);j.enter().append("rect"),j.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,i).attr(rect_parameter4,f).attr("fill",function(c,d){return"color"===b.color_mode?a[d]:a[0]}).attr("fill-opacity",function(a,c){return"saturation"===b.color_mode?(b.no_of_groups-c)/b.no_of_groups:void 0}),j.exit().remove(),b.legends_text=b.legendsGroup.selectAll(".legends_text").data(c),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("font-size",12),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,h).attr(text_parameter2,g).text(function(a){return a}),b.legends_text.exit().remove()}return this}};return c},this.getGroups=function(){var a={};for(var c in b.the_bars){var d=b.the_bars[c];d.id&&(a[d.group]?a[d.group].push(d.id):a[d.group]=[d.id])}return a},this.buildLayers=function(a){function c(a){for(var b in e){var c=e[b];if(c.name==a)return c}return d(a)}function d(a){var b={name:a,values:[]};return e.push(b),b}var e=[];for(var f in a){var g=a[f];if(g.id){var h=g.id;for(var i in g)if("id"!==i){var j=g[i];for(var k in j){var l=j[k];if(l.name){{var m=c(l.name);b.unique_group.indexOf(b.keys[h])}m.values.push({x:h,y:l.val,group:b.keys[h],color:l.color,tooltip:l.tooltip,name:g.group})}}}}}return e},this.flattenData=function(){var a=[-1];b.keys={};for(var c in b.data){var d=b.data[c];for(var e in d){for(var f in d[e]){var g="i"+c+"j"+f;if("object"==typeof d[e][f]){var h=Object.keys(d[e][f])[0];b.keys[g]=h,d[e][f].id=g,d[e][f].group=e,a.push(d[e][f])}}a.push(c)}}return[a,b.keys]},this.getParameters=function(){var a=[];for(var c in b.the_layers)if(b.the_layers[c].name){var d,e=b.the_layers[c].name;for(var f in b.the_layers[c].values)if(PykCharts.boolean(b.the_layers[c].values[f].y)){var d,e=b.the_layers[c].values[f].group;"saturation"===b.color_mode?d=b.saturation_color:"color"===b.color_mode&&b.the_layers[0].values[f].color&&(d=b.the_layers[0].values[f].color),a.push({name:e,color:d})}}return a},this.emptygroups=function(a){b.no_of_groups=d3.max(a,function(a){var b=_.values(a);return b[0].length});_.map(a,function(c,d){for(var e=_.values(c);e[0].length<b.no_of_groups;){var f=_.keys(c),g={name:"stack",tooltip:"null",color:"white",val:0},h={group3:[g]};a[d][f[0]].push(h),e=_.values(c)}});return a},this.dataTransformation=function(){var a=[];b.barName=[];var c=b.data.length;b.unique_group=b.data.map(function(a){return a.group}),b.unique_group=_.uniq(b.unique_group),PykCharts.boolean(b.data_sort_enable)&&b.data.sort(function(a,c){switch(b.data_sort_type){case"numerically":return"descending"===b.data_sort_order?c.x-a.x:a.x-c.x;case"alphabetically":return a.y<c.y?"descending"===b.data_sort_order?1:-1:a.y>c.y?"descending"===b.data_sort_order?-1:1:0;case"date":return"descending"===b.data_sort_order?new Date(c.y)-new Date(a.y):new Date(a.y)-new Date(c.y)}});for(var d=0;c>d;d++){var e,f={},g={};if(b.data[d].group||(b.data[d].group="group"+d),b.data[d].stack||(b.data[d].stack="stack"),b.barName[d]=b.data[d].group,f[b.data[d].y]=[],g[b.data[d].group]=[],e={name:b.data[d].stack,tooltip:b.data[d].tooltip,color:b.data[d].color,val:b.data[d].x},0===d)a.push(f),a[d][b.data[d].y].push(g),a[d][b.data[d].y][d][b.data[d].group].push(e);else{var h=a.length,i=0;for(i=0;h>i;i++)if(_.has(a[i],b.data[d].y)){var j=a[i][b.data[d].y],k=j.length,l=0;for(l=0;k>l&&!_.has(a[i][b.data[d].y][l],b.data[d].group);l++);k>l?a[i][b.data[d].y][l][b.data[d].group].push(e):(a[i][b.data[d].y].push(g),a[i][b.data[d].y][l][b.data[d].group].push(e));break}i===h&&(a.push(f),a[i][b.data[d].y].push(g),a[i][b.data[d].y][0][b.data[d].group].push(e))}}return b.barName=_.unique(b.barName),a},this},PykCharts.multiD.columnChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});return this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"column"),b.stop||(b.grid_color=a.chart_grid_color?a.chart_grid_color:c.stylesheet.chart_grid_color,"default"===b.mode&&b.k.loading(),b.multiD=new PykCharts.multiD.configuration(b),d3.json(a.data,function(a,c){b.data=c.groupBy("column"),b.compare_data=c.groupBy("column"),$(b.selector+" #chart-loader").remove(),b.render()}))},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("column"),b.refresh_data=c.groupBy("column");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var f=b.flattenData();b.the_bars=f[0],b.the_keys=f[1],b.the_layers=b.buildLayers(b.the_bars),1===b.no_of_groups&&(b.legends_enable="no"),b.map_group_data=b.multiD.mapGroup(b.data),b.optionalFeatures().createChart().legends(),b.k.yAxis(b.svgContainer,b.yGroup,b.yScaleInvert).yGrid(b.svgContainer,b.group,b.yScaleInvert)})},this.render=function(){var b=this;b.map_group_data=b.multiD.mapGroup(b.data),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var c=b.flattenData();b.the_bars=c[0],b.the_keys=c[1],b.the_layers=b.buildLayers(b.the_bars),b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.multiD.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),1===b.no_of_groups&&(b.legends_enable="no"),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#svgcontainer","columnChart").emptyDiv().subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).legendsContainer(1),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().legends().createGroups(1).createChart().axisContainer().highlightRect(),b.k.yAxis(b.svgContainer,b.yGroup,b.yScaleInvert).yAxisTitle(b.yGroup).yGrid(b.svgContainer,b.group,b.yScaleInvert)):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#svgcontainer","columnChart").emptyDiv().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).legendsContainer(1).createGroups(1).createChart().axisContainer(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.k.yAxis(b.svgContainer,b.yGroup,b.yScaleInvert).yAxisTitle(b.yGroup)),PykCharts.boolean(b.legends_enable)?$(window).on("load",function(){return b.k.resize(b.svgContainer,"",b.legendsContainer)}).on("resize",function(){return b.k.resize(b.svgContainer,"",b.legendsContainer)}):$(window).on("load",function(){return b.k.resize(b.svgContainer,"")}).on("resize",function(){return b.k.resize(b.svgContainer,"")})},this.optionalFeatures=function(){var b=this,c={svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD"),b.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.width+" "+b.height),this},createGroups:function(){return b.group=b.svgContainer.append("g").attr("id","svggroup").attr("class","svggroup").attr("transform","translate("+b.margin_left+","+(b.margin_top+b.legendsGroup_height)+")"),PykCharts.boolean(b.grid_y_enable)&&b.group.append("g").attr("id","ygrid").style("stroke",b.grid_color).attr("class","y grid-line"),this},legendsContainer:function(){return PykCharts.boolean(b.legends_enable)&&"default"===b.mode?b.legendsGroup=b.svgContainer.append("g").attr("id","legends").attr("class","legends").attr("transform","translate(0,10)"):b.legendsGroup_height=0,this},axisContainer:function(){if(PykCharts.boolean(b.axis_x_enable)){var a=b.group.selectAll(".axis-line").data(["line"]);a.enter().append("line"),a.attr("class","axis-line").attr("x1",0).attr("y1",b.height-b.margin_top-b.margin_bottom-b.legendsGroup_height).attr("x2",b.width-b.margin_left-b.margin_right).attr("y2",b.height-b.margin_top-b.margin_bottom-b.legendsGroup_height).attr("stroke",b.axis_x_line_color),a.exit().remove(),"bottom"===b.axis_x_position?b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis").style("stroke","none").append("text").attr("x",(b.width-b.margin_left-b.margin_right)/2).attr("y",b.height-b.margin_bottom-b.margin_top-b.legendsGroup_height).attr("dy",b.margin_top+10).style("fill",b.axis_x_label_color).style("text-anchor","end").text(b.axis_x_title):"top"===b.axis_x_position&&(a.attr("y1",0).attr("y2",0),b.xGroup=b.group.append("g").attr("id","xaxis").attr("class","x axis").style("stroke","none").append("text").attr("x",(b.width-b.margin_left-b.margin_right)/2).attr("y",-40).attr("dy",b.margin_top+b.legendsGroup_height+10).style("fill",b.axis_x_label_color).style("text-anchor","end").text(b.axis_x_title))}return PykCharts.boolean(b.axis_y_enable)&&(b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(){{var c=b.width-b.margin_left-b.margin_right,d=b.height-b.margin_top-b.margin_bottom-b.legendsGroup_height,e=b.no_of_groups+1,f=b.the_bars;b.the_keys}b.groups=b.getGroups();var g=b.the_layers;b.stack_layout=d3.layout.stack().values(function(a){return a.values})(g);var h=[];g.map(function(a,b){for(b in a.values){var c=a.values[b];h.push(c.y+c.y0)}}),b.xScale=d3.scale.ordinal().domain(f.map(function(a,b){return a.id||b})).rangeBands([0,c],.1),b.highlight_y_positions=[],b.highlight_x_positions=[],y_domain=[0,d3.max(h)],y_domain=b.k._domainBandwidth(y_domain,1),b.yScale=d3.scale.linear().domain(y_domain).range([0,d]),b.yScaleInvert=d3.scale.linear().domain([y_domain[1],y_domain[0]]).range([0,d]);var i,j,k,l,m=(d3.scale.category10(),[]),n=0,o=0;1===b.no_of_groups&&(n=b.xScale.rangeBand()/4,o=b.xScale.rangeBand()/(2*b.no_of_groups));for(l in b.groups)i=b.groups[l],j=b.xScale(i[0]),k=b.xScale.rangeBand()*i.length,j+=k/2,m.push({x:j,name:l});var p=c/m.length,q=b.group.selectAll(".bars").data(g);q.attr("class","bars"),q.enter().append("g").attr("class","bars"),b.domain=m.map(function(a){return a.name});var r=q.selectAll("rect").data(function(a){return a.values});r.enter().append("svg:rect").attr("class","rect"),r.attr("height",0).attr("y",d).attr("fill",function(a){return 1===b.no_of_groups?b.fillColor.colorPieMS(a):b.fillColor.colorGroup(a)}).attr("fill-opacity",function(){return"saturation"===b.color_mode?e>1?(e--,e/b.no_of_groups):(e=b.no_of_groups+1,e--,e/b.no_of_groups):void 0}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).attr("stroke-opacity",1).on("mouseover",function(c){"default"===b.mode&&(b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(c.tooltip?c.tooltip:c.y),b.mouseEvent.axisHighlightShow(c.name,a.selector+" .axis-text",b.domain,"column"))}).on("mouseout",function(c){"default"===b.mode&&(b.mouseEvent.tooltipHide(c),b.mouseEvent.axisHighlightHide(a.selector+" .axis-text","column"))}).on("mousemove",function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)}),r.attr("x",function(a){return b.highlight.toLowerCase()===a.name.toLowerCase()&&b.highlight_x_positions.push(b.xScale(a.x)-n),b.xScale(a.x)-n}).attr("width",function(){return b.xScale.rangeBand()+o}).attr("height",function(a){return b.yScale(a.y)}).attr("y",function(a){return b.highlight.toLowerCase()===a.name.toLowerCase()&&b.highlight_y_positions.push(b.yScale(a.y0+a.y)),d-b.yScale(a.y0+a.y)}),q.exit().remove();var s=b.group.selectAll("text.axis-text").data(m);return s.enter().append("text"),s.attr("class","axis-text").attr("x",function(a){return a.x}).attr("text-anchor","middle").attr("fill",b.axis_x_labelColor).text(function(a){return a.name}).text(function(a){return this.getBBox().width>.8*p?a.name.substr(0,3)+"..":a.name}).on("mouseover",function(a){b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.name)}).on("mouseout",function(a){b.mouseEvent.tooltipHide(a)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}),s.exit().remove(),"top"===b.axis_x_position?"top"===b.axis_x_pointer_position?s.attr("y",function(){return-15}):"bottom"===b.axis_x_pointer_position&&s.attr("y",function(){return 15}):"top"===b.axis_x_pointer_position?s.attr("y",function(){return d-15}):"bottom"===b.axis_x_pointer_position&&s.attr("y",function(){return d+15}),this},highlightRect:function(){function a(a,b){return a-b}if(b.no_of_groups>1){b.highlight_x_positions.sort(a),b.highlight_y_positions.sort(a);var c,d=b.highlight_x_positions.length,e=b.highlight_y_positions.length,f=b.highlight_x_positions[0]-5,g=b.height-b.margin_bottom-b.margin_top-b.legendsGroup_height-b.highlight_y_positions[e-1]-5,c=b.highlight_y_positions[e-1]+10;width=PykCharts.boolean(b.highlight_y_positions[0])?b.highlight_x_positions[d-1]-b.highlight_x_positions[0]+10+b.xScale.rangeBand():b.highlight_x_positions[d-1]-b.highlight_x_positions[0]+10,b.group.append("rect").attr("class","highlight-rect").attr("x",f).attr("y",g).attr("width",width).attr("height",c).attr("fill","none").attr("stroke",b.highlight_color).attr("stroke-width","1.5").attr("stroke-dasharray","5,5").attr("stroke-opacity",1)}return this},legends:function(){if(PykCharts.boolean(b.legends_enable)){var a,c=b.getParameters();a=c.map(function(a){return a.color}),c=c.map(function(a){return a.name}),c=_.uniq(c);var d=0,e=0;if(d=c.length,e=c.length,"vertical"===b.legends_display){b.legendsGroup.attr("height",30*c.length+20),b.legendsGroup_height=30*c.length+20,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,h=function(){return b.width-b.width/4+16},i=function(){return b.width-b.width/4};var f=function(a,b){return 24*b+12},g=function(a,b){return 24*b+23}}else if("horizontal"===b.legends_display){b.legendsGroup_height=50,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var h=function(){return d--,b.width-(100*d+75)};g=30,rect_parameter1value=13,rect_parameter2value=13;var i=function(){return e--,b.width-(100*e+100)};f=18}var j=b.legendsGroup.selectAll("rect").data(c);j.enter().append("rect"),j.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,i).attr(rect_parameter4,f).attr("fill",function(c,d){return"color"===b.color_mode?a[d]:a[0]}).attr("fill-opacity",function(a,c){return"saturation"===b.color_mode?(b.no_of_groups-c)/b.no_of_groups:void 0}),j.exit().remove(),b.legends_text=b.legendsGroup.selectAll(".legends_text").data(c),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("font-size",12),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,h).attr(text_parameter2,g).text(function(a){return a}),b.legends_text.exit().remove()}return this}};return c},this.getGroups=function(){var a={};for(var c in b.the_bars){var d=b.the_bars[c];d.id&&(a[d.group]?a[d.group].push(d.id):a[d.group]=[d.id])}return a},this.buildLayers=function(a){function c(a){for(var b in e){var c=e[b];if(c.name==a)return c}return d(a)}function d(a){var b={name:a,values:[]};return e.push(b),b}var e=[];for(var f in a){var g=a[f];if(g.id){var h=g.id;for(var i in g)if("id"!==i){var j=g[i];for(var k in j){var l=j[k];if(l.name){{var m=c(l.name);b.unique_group.indexOf(b.keys[h])}m.values.push({x:h,y:l.val,group:b.keys[h],color:l.color,tooltip:l.tooltip,name:g.group})}}}}}return e},this.flattenData=function(){var a=[-1];b.keys={};for(var c in b.data){var d=b.data[c];for(var e in d){for(var f in d[e]){var g="i"+c+"j"+f;if("object"==typeof d[e][f]){var h=Object.keys(d[e][f])[0];b.keys[g]=h,d[e][f].id=g,d[e][f].group=e,a.push(d[e][f])}}a.push(c)}}return[a,b.keys]},this.getParameters=function(){var a=[];for(var c in b.the_layers)if(b.the_layers[c].name)for(var d in b.the_layers[c].values)if(PykCharts.boolean(b.the_layers[c].values[d].y)){var e,f=b.the_layers[c].values[d].group;"saturation"===b.color_mode?e=b.saturation_color:"color"===b.color_mode&&b.the_layers[0].values[d].color&&(e=b.the_layers[0].values[d].color),a.push({name:f,color:e})}return a},this.emptygroups=function(a){b.no_of_groups=d3.max(a,function(a){var b=_.values(a);return b[0].length});_.map(a,function(c,d){for(var e=_.values(c);e[0].length<b.no_of_groups;){var f=_.keys(c),g={name:"stack",tooltip:"null",color:"white",val:0},h={group3:[g]};a[d][f[0]].push(h),e=_.values(c)}});return a},this.dataTransformation=function(){var a=[];b.barName=[];var c=b.data.length;b.unique_group=b.data.map(function(a){return a.group}),b.unique_group=_.uniq(b.unique_group);for(var d=0;c>d;d++){var e,f={},g={};if(b.data[d].group||(b.data[d].group="group"+d),b.data[d].stack||(b.data[d].stack="stack"),b.barName[d]=b.data[d].group,f[b.data[d].x]=[],g[b.data[d].group]=[],e={name:b.data[d].stack,tooltip:b.data[d].tooltip,color:b.data[d].color,val:b.data[d].y},0===d)a.push(f),a[d][b.data[d].x].push(g),a[d][b.data[d].x][d][b.data[d].group].push(e);else{var h=a.length,i=0;for(i=0;h>i;i++)if(_.has(a[i],b.data[d].x)){var j=a[i][b.data[d].x],k=j.length,l=0;for(l=0;k>l&&!_.has(a[i][b.data[d].x][l],b.data[d].group);l++);k>l?a[i][b.data[d].x][l][b.data[d].group].push(e):(a[i][b.data[d].x].push(g),a[i][b.data[d].x][l][b.data[d].group].push(e));break}i===h&&(a.push(f),a[i][b.data[d].x].push(g),a[i][b.data[d].x][0][b.data[d].group].push(e))}}return b.barName=_.unique(b.barName),a},this},PykCharts.multiD.scatterPlot=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){if(b=new PykCharts.multiD.processInputs(b,a,"scatterplot"),!b.stop){"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;
c.stylesheet,a.optional}b.multiD=new PykCharts.multiD.configuration(b),b.panels_enable=a.panels_enable&&a.panels_enable?a.panels_enable:d.panels_enable,b.bubbleRadius=a.scatterplot_radius&&_.isNumber(a.scatterplot_radius)?a.scatterplot_radius:d.scatterplot_radius,b.enableTicks=a.scatterplot_pointer?a.scatterplot_pointer:d.scatterplot_pointer,b.zoomed_out=!0,b.radius_range=PykCharts.boolean(b.panels_enable)?[2*b.k._radiusCalculation(1.1),2*b.k._radiusCalculation(2.6)]:[2*b.k._radiusCalculation(4.5),2*b.k._radiusCalculation(11)],d3.json(a.data,function(c,d){b.data=d.groupBy("scatterplot"),b.axis_y_data_format=a.axis_y_data_format?a.axis_y_data_format:b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format=a.axis_x_data_format?a.axis_x_data_format:b.k.xAxisDataFormatIdentification(b.data),b.compare_data=d.groupBy("scatterplot"),$(b.selector+" #chart-loader").remove();var e=new PykCharts.multiD.scatterplotFunction(a,b,"scatterplot");e.render()})}}},PykCharts.multiD.pulse=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"pulse"),"default"===b.mode&&b.k.loading();{var d=c.multiDimensionalCharts;c.stylesheet,a.optional}b.multiD=new PykCharts.multiD.configuration(b),b.panels_enable=a.panels_enable&&a.panels_enable?a.panels_enable:d.panels_enable,b.bubbleRadius=a.scatterplot_radius&&_.isNumber(a.scatterplot_radius)?a.scatterplot_radius:.6*d.scatterplot_radius,b.zoomed_out=!0,b.radius_range=[2*b.k._radiusCalculation(1.1),2*b.k._radiusCalculation(3.5)],d3.json(a.data,function(c,d){b.data=d.groupBy("pulse"),b.axis_y_data_format=a.axis_y_data_format?a.axis_y_data_format:b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format=a.axis_x_data_format?a.axis_x_data_format:b.k.xAxisDataFormatIdentification(b.data),b.compare_data=d.groupBy("pulse"),$(b.selector+" #chart-loader").remove();var e=new PykCharts.multiD.scatterplotFunction(a,b,"pulse");e.render()})}},PykCharts.multiD.scatterplotFunction=function(a,b,c){function d(){e.zoomed_out=!1;var a,b=this.id,c=b.length;a=PykCharts.boolean(e.panels_enable)?e.no_of_groups:1;for(var d=0;a>d;d++){var f=b.substring(0,c-1);current_container=d3.select(e.selector+" #"+f+d),e.k.isOrdinal(current_container,".x.axis",e.x),e.k.isOrdinal(current_container,".y.axis",e.yScale),e.optionalFeatures().plotCircle().label(),d3.select(e.selector+" #"+f+d).selectAll(".dot").attr("r",function(a){return e.sizes(a.weight)*d3.event.scale}).attr("cx",function(a){return e.x(a.x)+e.extra_left_margin}).attr("cy",function(a){return e.yScale(a.y)+e.extra_top_margin}),d3.select(e.selector+" #"+f+d).selectAll(".text").style("font-size",e.label_size).attr("x",function(a){return e.x(a.x)+e.extra_left_margin}).attr("y",function(a){return e.yScale(a.y)+e.extra_top_margin+5})}if(e.count++,e.count===e.zoom_level+1)for(var d=0;a>d;d++){if("yes"===e.panels_enable)for(e.new_data=[],j=0;j<e.data.length;j++)e.data[j].group===e.uniq_group_arr[d]&&e.new_data.push(e.data[j]);else e.new_data=e.data;var f=b.substring(0,c-1);d3.select(e.selector+" #"+f+d).call(function(){return e.zoomOut(d)}),e.count=1}}var e=b;e.refresh=function(){d3.json(a.data,function(a,b){e.data=b.groupBy("scatterplot"),e.refresh_data=b.groupBy("scatterplot");var c=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=c[0];var d=c[1];d&&e.k.lastUpdatedAt("liveData"),e.map_group_data=e.multiD.mapGroup(e.data),e.optionalFeatures().createChart().legends().plotCircle().label().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain)})},this.render=function(){if(e.map_group_data=e.multiD.mapGroup(e.data),e.fillChart=new PykCharts.Configuration.fillChart(e),e.border=new PykCharts.Configuration.border(e),e.uniq_group_arr=_.uniq(e.data.map(function(a){return a.group})),e.no_of_groups=1,"default"===e.mode){if(PykCharts.boolean(e.panels_enable)&&"scatterplot"===c){for(e.k.title().backgroundColor(e).export(e,"svgcontainer",c,e.panels_enable,e.uniq_group_arr).emptyDiv().subtitle(),e.no_of_groups=e.uniq_group_arr.length,e.w=e.width/4,e.height=e.height/2,e.margin_left=e.margin_left,e.margin_right=e.margin_right,i=0;i<e.no_of_groups;i++){for(e.new_data=[],j=0;j<e.data.length;j++)e.data[j].group===e.uniq_group_arr[i]&&e.new_data.push(e.data[j]);e.k.positionContainers(e.legends_enable,e),e.k.makeMainDiv(e.selector,i),e.optionalFeatures().svgContainer(i).legendsContainer(i),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends(i).createGroups(i).createChart().label().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup),(i+1)%4===0&&0!==i&&e.k.emptyDiv()}e.k.emptyDiv()}else e.k.title().backgroundColor(e).export(e,"#svgcontainer0",c).emptyDiv().subtitle(),e.w=e.width,e.new_data=e.data,e.k.makeMainDiv(e.selector,0),e.optionalFeatures().svgContainer(0).legendsContainer(0),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends().createGroups(0).createChart().ticks(),"scatterplot"===c&&e.optionalFeatures().label(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup);e.k.createFooter().lastUpdatedAt().credits().dataSource()}else if("infographics"===e.mode)if(PykCharts.boolean(e.panels_enable)&&"scatterplot"===c){for(e.k.backgroundColor(e).export(e,"svgcontainer",c,e.panels_enable,e.uniq_group_arr).emptyDiv(),e.no_of_groups=e.uniq_group_arr.length,e.w=e.width/4,e.height=e.height/2,e.margin_left=e.margin_left,e.margin_right=e.margin_right,i=0;i<e.no_of_groups;i++){for(e.new_data=[],j=0;j<e.data.length;j++)e.data[j].group===e.uniq_group_arr[i]&&e.new_data.push(e.data[j]);e.k.makeMainDiv(e.selector,i),e.optionalFeatures().svgContainer(i).legendsContainer(i),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends(i).createGroups(i).createChart().label().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup),(i+1)%4===0&&0!==i&&e.k.emptyDiv()}e.k.emptyDiv()}else e.k.backgroundColor(e).export(e,"#svgcontainer0",c).emptyDiv(),e.w=e.width,e.new_data=e.data,e.k.makeMainDiv(e.selector,0),e.optionalFeatures().svgContainer(0).legendsContainer(0),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends().createGroups(0).createChart().ticks(),"scatterplot"===c&&e.optionalFeatures().label(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup);PykCharts.boolean(e.panels_enable)?$(window).on("load",function(){return e.k.resize()}).on("resize",function(){return e.k.resize()}):"scatterplot"===c&&PykCharts.boolean(e.legends_enable)&&PykCharts.boolean(e.variable_circle_size_enable)&&e.map_group_data[1]?$(window).on("load",function(){return e.k.resize(e.svgContainer,"",e.legendsContainer)}).on("resize",function(){return e.k.resize(e.svgContainer,"",e.legendsContainer)}):$(window).on("load",function(){return e.k.resize(e.svgContainer)}).on("resize",function(){return e.k.resize(e.svgContainer)})},e.optionalFeatures=function(){var b={svgContainer:function(b){return $(a.selector+" #tooltip-svg-container-"+b).css("width",e.w),$(a.selector).attr("class","PykCharts-weighted"),e.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("width",e.w).attr("height",e.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+e.w+" "+e.height).attr("id","svgcontainer"+b).attr("class","svgcontainer"),this},createGroups:function(a){return e.group=e.svgContainer.append("g").attr("transform","translate("+e.margin_left+","+(e.margin_top+e.legendsGroup_height)+")").attr("id","main"),e.ticksElement=e.svgContainer.append("g").attr("transform","translate("+e.margin_left+","+e.margin_top+")").attr("id","main2"),PykCharts.boolean(e.axis_x_enable)&&(e.xGroup=e.group.append("g").attr("class","x axis").attr("id","xaxis").style("stroke","black")),PykCharts.boolean(e.axis_y_enable)&&(e.yGroup=e.group.append("g").attr("class","y axis").attr("id","yaxis").style("stroke","blue")),e.clip=e.group.append("svg:clipPath").attr("id","clip"+a+e.selector).append("svg:rect").attr("width",e.w-e.margin_left-e.margin_right).attr("height",e.height-e.margin_top-e.margin_bottom-e.legendsGroup_height),e.chartBody=e.group.append("g").attr("id","clip"+a).attr("clip-path","url(#clip"+a+e.selector+")"),this},legendsContainer:function(){return PykCharts.boolean(e.legends_enable)&&PykCharts.boolean(e.variable_circle_size_enable)&&e.map_group_data[1]&&"default"===e.mode?e.legendsGroup=e.svgContainer.append("g").attr("id","legends").attr("transform","translate(0,20)"):e.legendsGroup_height=0,this},createChart:function(a){if(e.weight=_.map(e.new_data,function(a){return a.weight}),e.weight=_.reject(e.weight,function(a){return 0==a}),e.sorted_weight=e.weight.slice(0),e.sorted_weight.sort(function(a,b){return a-b}),e.group.append("text").attr("fill","black").attr("text-anchor","end").attr("x",e.w-70).attr("y",e.height+40),e.zoomed_out===!0){var b,f,g,h,i=[],j=[];if("number"===e.axis_y_data_format?(h=d3.extent(e.data,function(a){return a.y}),j=e.k._domainBandwidth(h,2,"number"),f=[e.height-e.margin_top-e.margin_bottom-e.legendsGroup_height,0],e.yScale=e.k.scaleIdentification("linear",h,f),e.extra_top_margin=0):"string"===e.axis_y_data_format?(e.data.forEach(function(a){j.push(a.y)}),f=[0,e.height-e.margin_top-e.margin_bottom-e.legendsGroup_height],e.yScale=e.k.scaleIdentification("ordinal",j,f,0),e.extra_top_margin=e.yScale.rangeBand()/2):"time"===e.axis_y_data_format&&(j=d3.extent(e.data,function(a){return new Date(a.x)}),f=[e.height-e.margin_top-e.margin_bottom-e.legendsGroup_height,0],e.yScale=e.k.scaleIdentification("time",j,f),e.extra_top_margin=0),"number"===e.axis_x_data_format?(b=d3.extent(e.data,function(a){return a.x}),i=e.k._domainBandwidth(b,2),g=[0,e.w-e.margin_left-e.margin_right],e.x=e.k.scaleIdentification("linear",i,g),e.extra_left_margin=0):"string"===e.axis_x_data_format?(e.data.forEach(function(a){i.push(a.x)}),g=[0,e.w-e.margin_left-e.margin_right],e.x=e.k.scaleIdentification("ordinal",i,g,0),e.extra_left_margin=e.x.rangeBand()/2):"time"===e.axis_x_data_format&&(max=d3.max(e.data,function(a){return new Date(a.x)}),min=d3.min(e.data,function(a){return new Date(a.x)}),b=[min.getTime(),max.getTime()],i=e.k._domainBandwidth(b,2,"time"),g=[0,e.w-e.margin_left-e.margin_right],e.x=e.k.scaleIdentification("time",i,g),e.data.forEach(function(a){a.x=new Date(a.x)}),e.extra_left_margin=0),e.xdomain=e.x.domain(),e.ydomain=e.yScale.domain(),e.x1=1,e.y1=12,e.count=1,"pulse"!==c)var k=d3.behavior.zoom().x(e.x).y(e.yScale).scale(e.count).on("zoom",d);if(PykCharts.boolean(e.zoom_enable)&&"string"!==e.axis_y_data_format&&"string"!==e.axis_x_data_format&&"default"===e.mode){var l;l=PykCharts.boolean(e.panels_enable)?e.no_of_groups:1;for(var m=0;m<e.no_of_groups;m++)d3.select(e.selector+" #svgcontainer"+m).call(k),d3.select(e.selector+" #svgcontainer"+m).on("wheel.zoom",null).on("mousewheel.zoom",null)}e.optionalFeatures().plotCircle(a)}return this},legends:function(a){if(PykCharts.boolean(e.legends_enable)&&PykCharts.boolean(e.variable_circle_size_enable)&&e.map_group_data[1]&&"default"===e.mode){var b=(_.uniq(e.sorted_weight),0),c=0;if("vertical"===e.legends_display){e.legendsGroup.attr("height",30*e.map_group_data[0].length+20),e.legendsGroup_height=30*e.map_group_data[0].length+20,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,g=function(){return e.w-e.w/4+16},h=function(){return e.w-e.w/4};var d=function(a,b){return 24*b+12},f=function(a,b){return 24*b+23}}else if("horizontal"===e.legends_display){e.legendsGroup_height=50,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",b=0,c=0;var g=function(a,b){return 0===b&&(c=0),e.w-(100*b+75)>0?e.w-(100*b+75):e.w-(100*c+75)<e.w?(c++,e.w-(100*(c-1)+75)):(c=0,c++,e.w-(100*(c-1)+75))};f=function(a,d){return 0===d&&(b=0,c=0),e.w-(100*d+75)>0||(e.w-(100*c+75)<e.w?(0===c&&b++,c++):(c=0,c++,b++)),24*b+23},rect_parameter1value=13,rect_parameter2value=13;var h=function(a,d){return 0===d&&(b=0,c=0),e.w-(100*d+100)>=0?e.w-(100*d+100):e.w-(100*d+100)<e.w?(b++,0===c&&(e.legendsContainer.attr("height",50*(b+1)),e.legendsGroup.attr("height",50*(b+1))),c++,e.w-(100*(c-1)+100)):(c=0,c++,b++,e.w-(100*(c-1)+100))};d=function(a,d){return 0===d&&(b=0,c=0),e.w-(100*d+75)>0||(e.w-(100*c+75)<e.w?(0==c&&b++,c++):(c=0,c++,b++)),24*b+12}}var i;if(PykCharts.boolean(e.panels_enable)){var j=[];j.push(e.map_group_data[0][a]),i=e.legendsGroup.selectAll("rect").data(j),e.legends_text=e.legendsGroup.selectAll(".legends_text").data(j)}else i=e.legendsGroup.selectAll("rect").data(e.map_group_data[0]),e.legends_text=e.legendsGroup.selectAll(".legends_text").data(e.map_group_data[0]);i.enter().append("rect"),i.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,h).attr(rect_parameter4,d).attr("fill",function(a){return e.fillChart.colorPieW(a)}).attr("fill-opacity",function(){return.6}),i.exit().remove(),e.legends_text.enter().append("text").attr("class","legends_text").attr("fill",e.legends_text_color).attr("pointer-events","none").style("font-family",e.legends_text_family).attr("font-size",e.legends_text_size),e.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,g).attr(text_parameter2,f).text(function(a){return a.group}),e.legends_text.exit().remove()}return this},ticks:function(){if(PykCharts.boolean(e.enableTicks)){var a=e.ticksElement.selectAll("text").data(e.new_data);a.enter().append("text"),a.attr("transform",function(a){return"translate("+e.x(a.x)+","+e.yScale(a.y)+")"}).style("text-anchor","middle").style("font-family",e.label_family).style("font-size",e.label_size).attr("pointer-events","none").attr("dx",-1).attr("dy",function(a){return-e.sizes(a.weight)-4}),a.text(function(a){return a.name}),a.exit().remove()}return this},plotCircle:function(){return e.circlePlot=e.chartBody.selectAll(".dot").data(e.new_data),e.circlePlot.enter().append("circle").attr("class","dot"),e.circlePlot.attr("r",function(a){return e.sizes(a.weight)}).attr("cx",function(a){return e.x(a.x)+e.extra_left_margin}).attr("cy",function(a){return e.yScale(a.y)+e.extra_top_margin}).attr("fill",function(a){return e.fillChart.colorPieW(a)}).attr("fill-opacity",function(a){return e.multiD.opacity(a.weight,e.weight,e.data)}).attr("stroke",e.border.color()).attr("stroke-width",e.border.width()).attr("stroke-dasharray",e.border.style()).attr("stroke-opacity",1).on("mouseover",function(a){"default"===e.mode&&(tooltipText=a.tooltip?a.tooltip:"<table><thead><th colspan='2'><b>"+a.name+"</b></th></thead><tr><td>X</td><td><b>"+a.x+"</b></td></tr><tr><td>Y</td><td><b>"+a.y+"<b></td></tr><tr><td>Weight</td><td><b>"+a.weight+"</b></td></tr></table>",e.mouseEvent.tooltipPosition(a),e.mouseEvent.tooltipTextShow(tooltipText),PykCharts.boolean(e.variable_circle_size_enable)&&d3.select(this).style("fill-opacity",1))}).on("mouseout",function(a){"default"===e.mode&&(e.mouseEvent.tooltipHide(a),PykCharts.boolean(e.variable_circle_size_enable)&&d3.selectAll(".dot").style("fill-opacity",.5))}).on("mousemove",function(a){"default"===e.mode&&e.mouseEvent.tooltipPosition(a)}).on("dblclick",function(){d3.event.stopPropagation()}).on("mousedown",function(){d3.event.stopPropagation()}),e.circlePlot.exit().remove(),this},label:function(){return PykCharts.boolean(e.label_size)&&(e.circleLabel=e.chartBody.selectAll(".text").data(e.new_data),e.circleLabel.enter().append("text").attr("class","text"),e.circleLabel.attr("x",function(a){return e.x(a.x)+e.extra_left_margin}).attr("y",function(a){return e.yScale(a.y)+e.extra_top_margin+5}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",e.label_weight).style("font-size",e.label_size).attr("fill",e.label_color).style("font-family",e.label_family).text(function(a){return a.weight}).text(function(a){return this.getBBox().width<2*e.sizes(a.weight)&&this.getBBox().height<2*e.sizes(a.weight)?a.weight:""}),e.circleLabel.exit().remove()),this}};return b},e.zoomOut=function(b){e.zoomed_out=!0,e.x1=1,e.y1=12,e.optionalFeatures().createChart(b).label();var c=d3.select(a.selector+" #svgcontainer"+b),d=c.select("#xaxis"),f=c.select("#yaxis");e.k.xAxis(c,d,e.x,e.extra_left_margin,e.xdomain,e.legendsGroup_height).yAxis(c,f,e.yScale,e.ydomain),d3.select(e.selector+" #svgcontainer"+b).selectAll(".dot").attr("r",function(a){return e.sizes(a.weight)}).attr("cx",function(a){return e.x(a.x)+e.extra_left_margin}).attr("cy",function(a){return e.yScale(a.y)+e.extra_top_margin}),d3.select(e.selector+" #svgcontainer"+b).selectAll(".text").style("font-size",e.label_size).attr("x",function(a){return e.x(a.x)+e.extra_left_margin}).attr("y",function(a){return e.yScale(a.y)+e.extra_top_margin+5})}},PykCharts.multiD.spiderWeb=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){var d=c.multiDimensionalCharts;b=new PykCharts.multiD.processInputs(b,a,"spiderweb"),b.stop||("default"===b.mode&&b.k.loading(),a.spiderweb_outer_radius_percent&&a.spiderweb_outer_radius_percent>100&&(a.spiderweb_outer_radius_percent=100),b.multiD=new PykCharts.multiD.configuration(b),b.axisTitle=a.spiderweb_axis_title?a.spiderweb_axis_title:c.multiDimensionalCharts.spiderweb_axis_title,b.bubbleRadius=a.spiderweb_radius&&_.isNumber(a.spiderweb_radius)?a.spiderweb_radius:.6*d.scatterplot_radius,b.outerRadius=a.spiderweb_outer_radius_percent&&_.isNumber(a.spiderweb_outer_radius_percent)?a.spiderweb_outer_radius_percent:d.spiderweb_outer_radius_percent,b.inner_radius=0,b.enableTicks=a.spiderweb_pointer?a.spiderweb_pointer:d.spiderweb_pointer,d3.json(a.data,function(a,c){b.data=c.groupBy("spiderweb"),b.compare_data=c.groupBy("spiderweb"),$(b.selector+" #chart-loader").remove(),b.render()}))},b.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("spiderweb"),b.refresh_data=c.groupBy("spiderweb");var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.map_group_data=b.multiD.mapGroup(b.data),b.optionalFeatures().createChart().legends().axisTicks().axisTitle()})},this.render=function(){b.fillChart=new PykCharts.Configuration.fillChart(b),b.border=new PykCharts.Configuration.border(b),b.map_group_data=b.multiD.mapGroup(b.data),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#svgcontainer","spiderweb").emptyDiv().subtitle().makeMainDiv(b.selector,1),b.h=b.height,b.optionalFeatures().svgContainer(1).legendsContainer(1),b.k.liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().legends().createGroups(),b.outerRadius=b.k._radiusCalculation(b.outerRadius,"spiderweb"),b.radius_range=[3*b.outerRadius/100,.09*b.outerRadius],b.sizes=new PykCharts.multiD.bubbleSizeCalculation(b,b.data,b.radius_range),b.optionalFeatures().createChart().axisTicks().axisTitle(),b.k.createFooter().lastUpdatedAt().credits().dataSource()):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#svgcontainer","spiderweb").emptyDiv(),b.k.makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).legendsContainer().createGroups(),b.outerRadius=b.k._radiusCalculation(b.outerRadius,"spiderweb"),b.radius_range=[3*b.outerRadius/100,.09*b.outerRadius],b.sizes=new PykCharts.multiD.bubbleSizeCalculation(b,b.data,b.radius_range),b.optionalFeatures().createChart().axisTicks().axisTitle(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)),PykCharts.boolean(b.legends_enable)?$(window).on("load",function(){return b.k.resize(b.svgContainer,"",b.legendsContainer)}).on("resize",function(){return b.k.resize(b.svgContainer,"",b.legendsContainer)}):$(window).on("load",function(){return b.k.resize(b.svgContainer,"")}).on("resize",function(){return b.k.resize(b.svgContainer,"")})},this.degrees=function(a){return a/Math.PI*180-90},this.optionalFeatures=function(){var a=this,b={svgContainer:function(b){return $(a.selector).attr("class","PykCharts-spider-web"),a.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("class","svgcontainer").attr("id","svgcontainer").attr("width",a.width).attr("height",a.height).attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+a.width+" "+a.height),this},createGroups:function(){return a.group=a.svgContainer.append("g").attr("id","spidergrp").attr("transform","translate("+a.width/2+","+(a.h+a.legendsGroup_height+20)/2+")"),a.ticksElement=a.svgContainer.append("g").attr("transform","translate("+a.width/2+","+(a.h+a.legendsGroup_height+20)/2+")"),this},legendsContainer:function(){return PykCharts.boolean(a.legends_enable)&&PykCharts.boolean(a.variable_circle_size_enable)&&a.map_group_data[1]&&"default"===a.mode?a.legendsGroup=a.svgContainer.append("g").attr("class","legendgrp").attr("id","legendgrp"):a.legendsGroup_height=0,this},createChart:function(){var b,c,d;for(a.group_arr=[],a.uniq_group_arr=[],j=0;j<a.data.length;j++)a.group_arr[j]=a.data[j].group;a.uniq_group_arr=_.uniq(a.group_arr);var e=a.uniq_group_arr.length;for(a.new_data=[],k=0;e>k;k++)for(a.new_data[k]={name:a.uniq_group_arr[k],data:[]},l=0;l<a.data.length;l++)a.uniq_group_arr[k]===a.data[l].group&&a.new_data[k].data.push({x:a.data[l].x,y:a.data[l].y,weight:a.data[l].weight,color:a.data[l].color,tooltip:a.data[l].tooltip});var f=a.new_data[0].data;for(d=d3.max(a.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),c=d3.min(a.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),a.yScale=d3.scale.linear().domain([c,d]).range([a.inner_radius,a.outerRadius]),a.y_domain=[],a.nodes=[],b=0;b<a.new_data.length;b++){var g=[];for(j=0;j<a.new_data[b].data.length;j++)g[j]=a.yScale(a.new_data[b].data[j].y);a.y_domain[b]=g}for(b=0;b<a.new_data.length;b++){a.y=d3.scale.linear().domain(d3.extent(a.y_domain[b],function(a){return a})).range([.1,.9]);var h=[];for(j=0;j<f.length;j++)h[j]={x:j,y:a.y(a.y_domain[b][j]),tooltip:a.new_data[b].data[j].tooltip||a.new_data[b].data[j].weight};a.nodes[b]=h}for(m=0;m<a.new_data.length;m++){var i=[];for(j=0;j<a.new_data[m].data.length;j++)i[j]=a.new_data[m].data[j].tooltip;for(a.angle=d3.scale.ordinal().domain(d3.range(a.new_data[m].data.length+1)).rangePoints([0,2*Math.PI]),a.radius=d3.scale.linear().range([a.inner_radius,a.outerRadius]),a.yAxis=[],b=0;b<a.new_data[m].data.length;b++)a.yAxis.push({x:b,y:.25},{x:b,y:.5},{x:b,y:.75},{x:b,y:1});var n,o=[];for(b=0;b<a.yAxis.length;b++)n=b<a.yAxis.length-4?a.yAxis[b+4]:a.yAxis[b-a.yAxis.length+4],o.push({source:a.yAxis[b],target:n});var p,q=[];for(b=0;b<a.nodes[m].length;b++)b<a.nodes[m].length-1?(n=a.nodes[m][b+1],p=a.fillChart.colorPieW(a.new_data[m].data[b])):(n=a.nodes[m][0],p=a.fillChart.colorPieW(a.new_data[m].data[b])),q.push({source:a.nodes[m][b],target:n,color:p});var r=a.group.selectAll("#link"+m).data(q);r.enter().append("path").attr("class","link"),r.attr("class","link").attr("stroke",function(a){return a.color}).attr("stroke-opacity",1).attr("id","link"+m).attr("d",d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})),r.exit().remove(),a.weight=_.map(a.new_data[m].data,function(a){return a.weight}),a.weight=_.reject(a.weight,function(a){return 0==a}),a.sorted_weight=a.weight.slice(0),a.sorted_weight.sort(function(a,b){return a-b});var s=a.group.selectAll(".node"+m).data(a.nodes[m]);s.enter().append("circle").attr("class","node"+m).attr("transform",function(b){return"rotate("+a.degrees(a.angle(b.x))+")"}),s.attr("class","node"+m).attr("cx",function(b){return a.radius(b.y)}).attr("r",function(b,c){return a.sizes(a.new_data[m].data[c].weight)}).style("fill",function(b,c){return a.fillChart.colorPieW(a.new_data[m].data[c])}).style("fill-opacity",function(b,c){return a.multiD.opacity(a.new_data[m].data[c].weight,a.weight,a.data)}).attr("stroke",a.border.color()).attr("stroke-width",a.border.width()).attr("stroke-dasharray",a.border.style()).on("mouseover",function(b){"default"===a.mode&&(a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(b.tooltip))}).on("mouseout",function(b){"default"===a.mode&&a.mouseEvent.tooltipHide(b)}).on("mousemove",function(b){"default"===a.mode&&a.mouseEvent.tooltipPosition(b)}),s.exit().remove()}return a.group.selectAll(".axis").data(d3.range(a.new_data[0].data.length)).enter().append("line").attr("class","axis").attr("transform",function(b){return"rotate("+a.degrees(a.angle(b))+")"}).attr("x1",a.radius.range()[0]).attr("x2",a.radius.range()[1]),a.group.selectAll(".grid").data(o).enter().append("path").attr("class","grid").attr("d",d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})),this},legends:function(){if(PykCharts.boolean(a.legends_enable)&&PykCharts.boolean(a.variable_circle_size_enable)&&a.map_group_data[1]&&"default"===a.mode){var b=(_.uniq(a.sorted_weight),0),c=0;if("vertical"===a.legends_display){a.legendsGroup.attr("height",30*a.map_group_data[0].length+20),a.legendsGroup_height=30*a.map_group_data[0].length+20,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,f=function(){return a.width-a.width/4+16},g=function(){return a.width-a.width/4};var d=function(a,b){return 24*b+12},e=function(a,b){return 24*b+23}}else if("horizontal"===a.legends_display){a.legendsGroup_height=50,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",b=0,c=0;var f=function(b,d){return 0===d&&(c=0),a.w-(100*d+75)>0?a.width-(100*d+75):a.width-(100*c+75)<a.width?(c++,a.width-(100*(c-1)+75)):(c=0,c++,a.width-(100*(c-1)+75))};e=function(d,e){return 0===e&&(b=0,c=0),a.width-(100*e+75)>0||(a.width-(100*c+75)<a.width?(0===c&&b++,c++):(c=0,c++,b++)),24*b+23},rect_parameter1value=13,rect_parameter2value=13;var g=function(d,e){return 0===e&&(b=0,c=0),a.w-(100*e+100)>=0?a.width-(100*e+100):a.width-(100*e+100)<a.width?(b++,0===c&&(a.legendsGroup.attr("height",50*(c+1)),a.legendsGroup_height=50*(c+1)),c++,a.width-(100*(c-1)+100)):(c=0,c++,b++,a.width-(100*(c-1)+100))};d=function(d,e){return 0===e&&(b=0,c=0),a.width-(100*e+75)>0||(a.width-(100*c+75)<a.width?(0==c&&b++,c++):(c=0,c++,b++)),24*b+12}}var h=a.legendsGroup.selectAll("rect").data(a.map_group_data[0]);h.enter().append("rect"),h.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,g).attr(rect_parameter4,d).attr("fill",function(b){return a.fillChart.colorPieW(b)}).attr("fill-opacity",function(){return.6}),h.exit().remove(),a.legends_text=a.legendsGroup.selectAll(".legends_text").data(a.map_group_data[0]),a.legends_text.enter().append("text").attr("class","legends_text").attr("fill",a.legends_text_color).attr("pointer-events","none").style("font-family",a.legends_text_family).attr("font-size",a.legends_text_size),a.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,f).attr(text_parameter2,e).text(function(a){return a.group}),a.legends_text.exit().remove()}return this},axisTitle:function(){if(PykCharts.boolean(a.axisTitle)){a.length=a.new_data[0].data.length;var b=a.group.selectAll("text.axisTitle").data(a.nodes[0]);b.enter().append("text").attr("class","axisTitle"),b.attr("transform",function(){return"translate("+-a.outerRadius+","+-a.outerRadius+")"}).style("text-anchor","middle").attr("x",function(b,c){return a.outerRadius*(1-.2*Math.sin(2*c*Math.PI/a.length))+1.25*a.outerRadius*Math.sin(2*c*Math.PI/a.length)}).attr("y",function(b,c){return a.outerRadius*(1-.6*Math.cos(2*c*Math.PI/a.length))-.47*a.outerRadius*Math.cos(2*c*Math.PI/a.length)}).style("font-size",a.label_size).style("font-family",a.label_family),b.text(function(b,c){return a.new_data[0].data[c].x}),b.exit().remove()}return this},axisTicks:function(){if(PykCharts.boolean(a.enableTicks)){console.log("appending labels");var b=a.yScale.domain(),c=b[1]/4,d=[];for(i=4,j=0;i>=0;i--,j++)d[j]=i*c;var e=a.ticksElement.selectAll("text.ticks").data(d);e.enter().append("text").attr("class","ticks"),e.style("text-anchor","start").attr("transform","translate(5,"+-a.outerRadius+")").attr("x",0).attr("y",function(b,c){return c*(a.outerRadius/4)}).attr("dy",-2),e.text(function(a){return a}).style("font-size",a.label_size).style("font-family",a.label_family),e.exit().remove()}return this}};return b}},PykCharts.maps={},PykCharts.maps.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.maps.processInputs=function(a,b){{var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.mapsTheme;b.optional}switch(a.selector=b.selector?b.selector:d.selector,a.width=b.chart_width&&_.isNumber(parseInt(b.chart_width,10))?b.chart_width:d.chart_width,console.log(a.width,d.chart_width),a.height=b.chart_height&&_.isNumber(parseInt(b.chart_height,10))?b.chart_height:d.chart_height,a.map_code=b.map_code?b.map_code:f.map_code,a.click_enable=b.click_enable?b.click_enable:f.click_enable,a.background_color=b.background_color?b.background_color:d.background_color,a.timeline_duration=b.timeline_duration?b.timeline_duration:f.timeline_duration,a.margin_left=b.timeline_margin_left?b.timeline_margin_left:f.timeline_margin_left,a.margin_right=b.timeline_margin_right?b.timeline_margin_right:f.timeline_margin_right,a.margin_top=b.timeline_margin_top?b.timeline_margin_top:f.timeline_margin_top,a.margin_bottom=b.timeline_margin_bottom?b.timeline_margin_bottom:f.timeline_margin_bottom,a.tooltip_enable=b.tooltip_enable?b.tooltip_enable:d.tooltip_enable,a.tooltip_mode=b.tooltip_mode?b.tooltip_mode:d.tooltip_mode,a.tooltip_position_top=b.tooltip_position_top?b.tooltip_position_top:f.tooltip_position_top,a.tooltip_position_left=b.tooltip_position_left?b.tooltip_position_left:f.tooltip_position_left,a.tooltipTopCorrection=d3.select(a.selector).style("top"),a.tooltipLeftCorrection=d3.select(a.selector).style("left"),a.default_color=b.chart_color?b.chart_color:d.chart_color,a.total_no_of_colors=b.total_no_of_colors&&_.isNumber(parseInt(b.total_no_of_colors,10))?parseInt(b.total_no_of_colors,10):f.total_no_of_colors,a.color_mode=b.color_mode?b.color_mode:d.color_mode,a.palette_color=b.palette_color?b.palette_color:f.palette_color,a.axis_x_enable=b.axis_x_enable?b.axis_x_enable:d.axis_x_enable,a.axis_x_pointer_position=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_pointer_position?b.axis_x_pointer_position:d.axis_x_pointer_position,a.axis_x_line_color=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_line_color?b.axis_x_line_color:d.axis_x_line_color,a.axis_x_label_color=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_label_color?b.axis_x_label_color:d.axis_x_label_color,a.axis_x_no_of_axis_value=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_no_of_axis_value?b.axis_x_no_of_axis_value:d.axis_x_no_of_axis_value,a.axis_x_pointer_padding=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_pointer_padding?b.axis_x_pointer_padding:d.axis_x_pointer_padding,a.axis_x_pointer_size="axis_x_pointer_size"in b&&PykCharts.boolean(a.axis_x_enable)?b.axis_x_pointer_size:d.axis_x_pointer_size,a.axis_x_value_format=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_value_format?b.axis_x_value_format:d.axis_x_value_format,a.axis_x_pointer_values=PykCharts.boolean(a.axis_x_enable)&&b.axis_x_pointer_values?b.axis_x_pointer_values:d.axis_x_pointer_values,a.axis_x_outer_pointer_size="axis_x_outer_pointer_size"in b&&PykCharts.boolean(a.axis_x_enable)?b.axis_x_outer_pointer_size:d.axis_x_outer_pointer_size,a.label_enable=b.label_enable?b.label_enable:f.label_enable,a.legends_enable=b.legends_enable?b.legends_enable:d.legends_enable,a.legends_display=b.legends_display?b.legends_display:d.legends_display,a.border_between_chart_elements_thickness="border_between_chart_elements_thickness"in b?b.border_between_chart_elements_thickness:d.border_between_chart_elements_thickness,a.border_between_chart_elements_color=b.border_between_chart_elements_color?b.border_between_chart_elements_color:d.border_between_chart_elements_color,a.border_between_chart_elements_style=b.border_between_chart_elements_style?b.border_between_chart_elements_style:d.border_between_chart_elements_style,a.border_between_chart_elements_style){case"dotted":a.border_between_chart_elements_style="1,3";
break;case"dashed":a.border_between_chart_elements_style="5,5";break;default:a.border_between_chart_elements_style="0"}return a.onhover=b.onhover?b.onhover:f.onhover,a.default_zoom_level=b.default_zoom_level?b.default_zoom_level:80,a.loading=b.loading_gif_url?b.loading_gif_url:d.loading_gif_url,a.highlight=b.highlight?b.highlight:d.highlight,a.highlight_color=b.highlight_color?b.highlight_color:d.highlight_color,b&&PykCharts.boolean(b.title_text)?(a.title_text=b.title_text,a.title_size="title_size"in b?b.title_size:d.title_size,a.title_color=b.title_color?b.title_color:d.title_color,a.title_weight=b.title_weight?b.title_weight:d.title_weight,a.title_family=b.title_family?b.title_family:d.title_family):(a.title_size=d.title_size,a.title_color=d.title_color,a.title_weight=d.title_weight,a.title_family=d.title_family),b&&PykCharts.boolean(b.subtitle_text)?(a.subtitle_text=b.subtitle_text,a.subtitle_size="subtitle_size"in b?b.subtitle_size:d.subtitle_size,a.subtitle_color=b.subtitle_color?b.subtitle_color:d.subtitle_color,a.subtitle_weight=b.subtitle_weight?b.subtitle_weight:d.subtitle_weight,a.subtitle_family=b.subtitle_family?b.subtitle_family:d.subtitle_family):(a.subtitle_size=d.subtitle_size,a.subtitle_color=d.subtitle_color,a.subtitle_weight=d.subtitle_weight,a.subtitle_family=d.subtitle_family),a.real_time_charts_refresh_frequency=b.real_time_charts_refresh_frequency?b.real_time_charts_refresh_frequency:e.real_time_charts_refresh_frequency,a.real_time_charts_last_updated_at_enable=b.real_time_charts_last_updated_at_enable?b.real_time_charts_last_updated_at_enable:e.real_time_charts_last_updated_at_enable,a.transition_duration=b.transition_duration?b.transition_duration:e.transition_duration,b.credit_my_site_name||b.credit_my_site_url?(a.credit_my_site_name=b.credit_my_site_name?b.credit_my_site_name:"",a.credit_my_site_url=b.credit_my_site_url?b.credit_my_site_url:""):(a.credit_my_site_name=d.credit_my_site_name,a.credit_my_site_url=d.credit_my_site_url),a.data_source_name=b.data_source_name?b.data_source_name:"",a.data_source_url=b.data_source_url?b.data_source_url:"",a.units=b.units?b.units:!1,a.export_enable=b.export_enable?b.export_enable:d.export_enable,a.k=new PykCharts.Configuration(a),a},PykCharts.maps.oneLayer=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=PykCharts.maps.processInputs(b,a),d3.json(a.data,function(c){b.data=c,b.compare_data=c,b.k.totalColors(b.total_no_of_colors).colorType(b.color_mode).loading(b.loading).tooltip(),d3.json("../data/maps/"+b.map_code+"-topo.json",function(c){b.map_data=c,_.each(b.map_data.objects.geometries,function(a){var b=a.properties.NAME_1.replace("'","&#39;");return a.properties.NAME_1=b,a}),d3.json("../data/maps/colorPalette.json",function(c){b.color_palette_data=c,$(b.selector).html("");var d=new PykCharts.maps.mapFunctions(a,b,"oneLayer");d.render()})}),b.extent_size=d3.extent(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.extent_size[1]-b.extent_size[0]})}},PykCharts.maps.timelineMap=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=PykCharts.maps.processInputs(b,a),d3.json(a.data,function(c){b.timeline_data=c,b.compare_data=c;var d=d3.extent(c,function(a){return a.timestamp});b.data=_.where(c,{timestamp:d[0]}),b.redeced_width=b.width-2*b.margin_left-b.margin_right,b.k.totalColors(b.total_no_of_colors).colorType(b.color_mode).loading(b.loading).tooltip(b.tooltip_enable),d3.json("../data/maps/"+b.map_code+"-topo.json",function(c){b.map_data=c,_.each(b.map_data.objects.geometries,function(a){var b=a.properties.NAME_1.replace("'","&#39;");return a.properties.NAME_1=b,a}),d3.json("../data/maps/colorPalette.json",function(c){b.color_palette_data=c;var d=d3.extent(b.timeline_data,function(a){return a.timestamp});b.data=_.where(b.timeline_data,{timestamp:d[0]}),b.data.sort(function(a,b){return a.timestamp-b.timestamp}),$(b.selector).html("");var e=new PykCharts.maps.mapFunctions(a,b,"timeline");e.render()})}),b.extent_size=d3.extent(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.extent_size[1]-b.extent_size[0]})}},PykCharts.maps.mapFunctions=function(a,b,c){var d=b;this.render=function(){d.border=new PykCharts.Configuration.border(d),d.k.title().backgroundColor(d),"oneLayer"===c&&d.k.export(d,"#svgcontainer",c).emptyDiv().subtitle(),d.current_palette=_.where(d.color_palette_data,{name:d.palette_color,number:d.total_no_of_colors})[0],"timeline"===c&&d.k.subtitle(),d.optionalFeatures().svgContainer().legendsContainer(d.legends_enable).legends(d.legends_enable).createMap().label(d.label_enable).enableClick(d.click_enable),d.redeced_height=d.height-d.margin_top-d.margin_bottom,d.k.createFooter().lastUpdatedAt().credits().dataSource(),"timeline"===c&&(d.optionalFeatures().axisContainer(!0),d.renderDataForTimescale(),d.backgroundColor(),d.renderButtons(),d.renderTimeline()),PykCharts.boolean(d.legends_enable)&&"saturation"===d.color_mode?$(window).on("load",function(){return d.k.resize(d.svgContainer,"",d.legendsContainer)}).on("resize",function(){return d.k.resize(d.svgContainer,"",d.legendsContainer)}):$(window).on("load",function(){return d.k.resize(d.svgContainer,"")}).on("resize",function(){return d.k.resize(d.svgContainer,"")})},d.refresh=function(){"oneLayer"===c?d3.json(a.data,function(a){d.data=a,d.refresh_data=a;var b=d.k.checkChangeInData(d.refresh_data,d.compare_data);d.compare_data=b[0];var c=b[1];c&&d.k.lastUpdatedAt("liveData"),d.extent_size=d3.extent(d.data,function(a){return parseInt(a.size,10)}),d.difference=d.extent_size[1]-d.extent_size[0],d.optionalFeatures().legends(d.legends_enable).createMap()}):d3.json(a.data,function(a){d.timeline_data=a,d.refresh_data=a;var b=d.k.checkChangeInData(d.refresh_data,d.compare_data);d.compare_data=b[0];var c=b[1],e=d3.extent(a,function(a){return a.timestamp});d.data=_.where(a,{timestamp:e[0]}),d.optionalFeatures().legends(d.legends_enable).createMap(),d.renderDataForTimescale(),d.renderTimeline(),c&&d.k.lastUpdatedAt("liveData")})},d.optionalFeatures=function(){var b={legends:function(a){return PykCharts.boolean(a)&&d.renderLegend(),this},legendsContainer:function(a){return PykCharts.boolean(a)&&"saturation"===d.color_mode?d.legendsContainer=d.svgContainer.append("g").attr("id","legend-container"):d.legendsGroup_height=0,this},label:function(a){return PykCharts.boolean(a)&&d.renderLabel(),this},svgContainer:function(){$(d.selector).css("width","100%"),d.svgContainer=d3.select(d.selector).append("svg").attr("width",d.width).attr("height",d.height).attr("id","svgcontainer").attr("class","PykCharts-map").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+d.width+" "+d.height),d.map_cont=d.svgContainer.append("g").attr("id","map_group");var a=d.map_cont.append("defs"),b=a.append("filter").attr("id","dropshadow");b.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1).attr("result","blur"),b.append("feOffset").attr("in","blur").attr("dx",1).attr("dy",1).attr("result","offsetBlur");var c=b.append("feMerge");return c.append("feMergeNode").attr('in", "offsetBlur'),c.append("feMergeNode").attr("in","SourceGraphic"),this},createMap:function(){var b=150,c=[d.width/2,d.height/2];if($(a.selector).css("background-color",d.background_color),d.group=d.map_cont.selectAll(".map_group").data(topojson.feature(d.map_data,d.map_data.objects).features),d.group.enter().append("g").attr("class","map_group").append("path"),"world"===d.map_code||"world_without_antarctica"===d.map_code)var e=[0,0];else var e=d3.geo.centroid(topojson.feature(d.map_data,d.map_data.objects));var f=d3.geo.mercator().center(e).scale(b).translate(c);d.path=d3.geo.path().projection(f);var g=d.path.bounds(topojson.feature(d.map_data,d.map_data.objects)),h=b*d.width/(g[1][0]-g[0][0]),i=b*d.height/(g[1][1]-g[0][1]),b=i>h?h:i,c=[d.width-(g[0][0]+g[1][0])/2,d.height-(g[0][1]+g[1][1])/2];f=d3.geo.mercator().center(e).scale(d.default_zoom_level/100*b).translate(c),d.path=d.path.projection(f);var j=d3.select("#pyk-tooltip");return d.chart_data=d.group.select("path").attr("d",d.path).attr("class","area").attr("iso2",function(a){return a.properties.iso_a2}).attr("area_name",function(a){return a.properties.NAME_1}).attr("fill",d.renderColor).attr("prev_fill",function(){return d3.select(this).attr("fill")}).attr("opacity",d.renderOpacity).style("stroke",d.border.color()).style("stroke-width",d.border.width()+"px").style("stroke-dasharray",d.border.style()).on("mouseover",function(a){PykCharts.boolean(d.tooltip_enable)&&(j.style("visibility","visible"),j.html(_.where(d.data,{iso2:a.properties.iso_a2})[0].tooltip),"moving"===d.tooltip_mode?j.style("top",function(){return d3.event.pageY-20+"px"}).style("left",function(){return d3.event.pageX+20+"px"}):"fixed"===d.tooltip_mode&&j.style("top",d.tooltip_position_top+"px").style("left",d.tooltip_position_left+"px")),d.bodColor(a)}).on("mouseout",function(a){PykCharts.boolean(d.tooltip_enable)&&j.style("visibility","hidden"),d.bodUncolor(a)}),d.group.exit().remove(),this},enableClick:function(a){return PykCharts.boolean(a)&&(d.chart_data.on("click",d.clicked),d.onhover1=d.onhover),this},axisContainer:function(a){return PykCharts.boolean(a)&&(d.gxaxis=d.svgContainer.append("g").attr("id","xaxis").attr("class","x axis").attr("transform","translate("+2*d.margin_left+","+d.redeced_height+")")),this}};return b},d.renderColor=function(a,b){if(!PykCharts.boolean(a))return!1;var c,e=_.where(d.data,{iso2:a.properties.iso_a2});if(e.length>0){if("color"===d.color_mode)return e.length>0&&""!==e[0].color?e[0].color:d.default_color[0];if("saturation"===d.color_mode){if(d.highlight===d.map_data.objects.geometries[b].properties.iso_a2)return d.highlight_color;if(""!==d.palette_color)for(c=e[0].size,b=0;b<d.current_palette.colors.length;b++)if(c>=d.extent_size[0]+b*(d.difference/d.current_palette.colors.length)&&c<=d.extent_size[0]+(b+1)*(d.difference/d.current_palette.colors.length))return 1===d.data.length?d.current_palette.colors[d.current_palette.colors.length-1]:d.current_palette.colors[b];return d.default_color[0]}return d.default_color[0]}return d.default_color[0]},d.renderOpacity=function(a){return""===d.palette_color&&"saturation"===d.color_mode?(d.oneninth=+d3.format(".2f")(d.difference/10),d.opacity=(d.extent_size[0]+_.where(d.data,{iso2:a.properties.iso_a2})[0].size+d.oneninth)/d.difference,d.opacity):1},d.renderLegend=function(){var a;if("saturation"===d.color_mode){if("vertical"===d.legends_display){var b=0,c=0;""===d.palette_color?(d.legendsContainer.attr("height",290),d.legendsGroup_height=290):(d.legendsContainer.attr("height",30*d.current_palette.number+20),d.legendsGroup_height=30*d.current_palette.number+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,g=function(){return d.width-d.width/12+18},h=function(){return d.width-d.width/12};var e=function(){return b++,24*b+12},f=function(){return c++,24*c+23}}else if("horizontal"===d.legends_display){var b=0,c=0;""===d.palette_color?(b=9,c=9):(b=d.current_palette.number,c=d.current_palette.number,d.legendsContainer.attr("height",30*d.current_palette.number+20),d.legendsGroup_height=30*d.current_palette.number+20),d.legendsContainer.attr("height",50),d.legendsGroup_height=50,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var g=function(){return c--,d.width-(60*c+40)};f=30,rect_parameter1value=13,rect_parameter2value=13;var h=function(){return b--,d.width-(60*b+60)};e=18}if(""===d.palette_color){var i=[1,2,3,4,5,6,7,8,9];a=d3.format(".1f")(d.extent_size[1]/9),d.leg=function(b,c){return"<"+d3.round(a*(c+1))};var j=d.legendsContainer.selectAll(".rect").data(i);j.enter().append("rect"),j.attr("class","rect").attr("x",h).attr("y",e).attr("width",rect_parameter1value).attr("height",rect_parameter2value).attr("fill",d.default_color[0]).attr("opacity",function(a,b){return(b+1)/9}),j.exit().remove(),d.legends_text=d.legendsContainer.selectAll(".text").data(i),d.legends_text.enter().append("text"),d.legends_text.attr("class","text").attr("x",g).attr("y",f).style("font-size",10).style("font","Arial").text(d.leg),d.legends_text.exit().remove()}else{d.leg=function(a,b){return"<"+d3.round(d.extent_size[0]+(b+1)*(d.difference/d.current_palette.number))};var j=d.legendsContainer.selectAll(".rect").data(d.current_palette.colors);j.enter().append("rect"),j.attr("class","rect").attr("x",h).attr("y",e).attr("width",rect_parameter1value).attr("height",rect_parameter2value).attr("fill",function(a){return a}),j.exit().remove(),d.legends_text=d.legendsContainer.selectAll(".text").data(d.current_palette.colors),d.legends_text.enter().append("text"),d.legends_text.attr("class","text").attr("x",g).attr("y",f).style("font-size",10).style("font","Arial").text(d.leg),d.legends_text.exit().remove()}}else $("#legend-container").remove()},d.renderLabel=function(){d.group.append("text").attr("x",function(a){return d.path.centroid(a)[0]}).attr("y",function(a){return d.path.centroid(a)[1]}).attr("text-anchor","middle").attr("font-size","10px").attr("pointer-events","none").text(function(a){return a.properties.NAME_1.replace("&#39;","'")})},d.bodColor=function(a){var b=_.where(d.data,{iso2:a.properties.iso_a2});"none"!==d.onhover1?"highlight_border"===d.onhover1?d3.select("path[area_name='"+a.properties.NAME_1+"']").style("stroke",d.border.color()).style("stroke-width",parseInt(d.border.width())+1.5+"px").style("stroke-dasharray",d.border.style()):"shadow"===d.onhover1?d3.select("path[area_name='"+a.properties.NAME_1+"']").attr("filter","url(#dropshadow)").attr("opacity",function(){return""===d.palette_color&&"saturation"===d.color_mode?(d.oneninth_dim=+d3.format(".2f")(d.difference/10),d.opacity_dim=(d.extent_size[0]+b[0].size+d.oneninth_dim)/d.difference,d.opacity_dim/2):.5}):"color_saturation"===d.onhover1&&d3.select("path[area_name='"+a.properties.NAME_1+"']").attr("opacity",function(){return""===d.palette_color&&"saturation"===d.color_mode?(d.oneninth_dim=+d3.format(".2f")(d.difference/10),d.opacity_dim=(d.extent_size[0]+b[0].size+d.oneninth_dim)/d.difference,d.opacity_dim/2):.5}):d.bodUncolor(a)},d.bodUncolor=function(a){d3.select("path[area_name='"+a.properties.NAME_1+"']").style("stroke",d.border.color()).style("stroke-width",d.border.width()).style("stroke-dasharray",d.border.style()).attr("filter",null).attr("opacity",function(){return""===d.palette_color&&"saturation"===d.color_mode?(d.oneninth_high=+d3.format(".2f")(d.difference/10),d.opacity_high=(d.extent_size[0]+_.where(d.data,{iso2:a.properties.iso_a2})[0].size+d.oneninth_high)/d.difference,d.opacity_high):1})},this.clicked=function(a){var b={};b.container=d3.event.target.ownerSVGElement.parentNode.id,b.area=a.properties,b.data=_.where(d.data,{iso2:a.properties.iso_a2})[0];try{customFunction(b)}catch(c){}},d.backgroundColor=function(){function b(a){return e=a,c=$(a).css("background-color"),"transparent"!==c&&"rgba(0, 0, 0, 0)"!==c?$(a).colourBrightness(c):void 0!==$(a)[0].parentNode.tagName&&"body"!==$(a)[0].parentNode.tagName.toLowerCase()?b($(a)[0].parentNode):void $(a).colourBrightness("rgb(255,255,255)")}var c;b(a.selector);var c,e;b(a.selector),$(e)[0].classList.contains("light")?(d.play_image_url="../img/play.png",d.pause_image_url="../img/pause.png",d.marker_image_url="../img/marker.png"):(d.play_image_url="../img/play-light.png",d.pause_image_url="../img/pause-light.png",d.marker_image_url="../img/marker-light.png")},d.renderDataForTimescale=function(){d.unique=[],x_extent=d3.extent(d.timeline_data,function(a){return a.timestamp}),x_range=[0,d.redeced_width],d.xScale=d.k.scaleIdentification("linear",x_extent,x_range),_.each(d.timeline_data,function(a){-1===d.unique.indexOf(a.timestamp)&&d.unique.push(a.timestamp)}),d.unique.sort(function(a,b){return a-b}),d.k.xAxis(d.svgContainer,d.gxaxis,d.xScale)},d.renderTimeline=function(){console.log("heyy");var a=interval1=d.interval_index=1;d.play.on("click",function(){b()}),d.timeline_status="";var b=function(){if("playing"===d.timeline_status)d.play.attr("xlink:href",d.play_image_url),clearInterval(d.play_interval),d.timeline_status="paused",d.interval_index=a,console.log(a,d.interval_index," ******** Paused");else{d.timeline_status="playing",d.play.attr("xlink:href",d.pause_image_url),a=d.interval_index,console.log(a,d.interval_index," >>> PLAY-START!!!!"),d.play_interval=setInterval(function(){d.marker.attr("x",2*d.margin_left+d.xScale(d.unique[a])-7),d.data=_.where(d.timeline_data,{timestamp:d.unique[a]}),d.data.sort(function(a,b){return a.timestamp-b.timestamp}),_.each(d.data,function(a){d3.select("path[iso2='"+a.iso2+"']").attr("fill",d.renderColor)}),a++,a===d.unique.length&&clearInterval(d.play_interval),console.log(a,d.interval_index," >>> PLAYING")},d.timeline_duration);var b=setTimeout(function(){var c=setInterval(function(){interval1++;interval1===a&&(clearInterval(c),clearTimeout(b)),interval1===d.unique.length&&(clearInterval(c),d.play.attr("xlink:href",d.play_image_url),d.marker.attr("x",2*d.margin_left+d.xScale(d.unique[0])-7),a=interval1=d.interval_index=1,d.timeline_status="",console.log(a,d.interval_index," >>> STOPPED-Playing"))},d.timeline_duration)},d.timeline_duration)}}},d.renderButtons=function(){function a(){if("playing"!==d.timeline_status){for(var a,b,c,e,f=d3.event.sourceEvent.pageX-2*d.margin_left,g=[],h=d.xScale.range(),i=d.unique.length,j=(h[1]-h[0])/i,k=0,l=0;i>l;l++)k+=j,g[l]=parseInt(k);for(var m=0;i>m;m++)f>=g[m]&&f<=g[m+1]?(a=g[m],b=g[m+1],c=f-a,e=b-f,c>=e&&i-2>=m&&(d.marker.attr("x",2*d.margin_left+d.xScale(d.unique[m])-7),d.data=_.where(d.timeline_data,{timestamp:d.unique[m]}),d.data.sort(function(a,b){return a.timestamp-b.timestamp}),_.each(d.data,function(a){d3.select("path[iso2='"+a.iso2+"']").attr("fill",d.renderColor)}),d.interval_index=m)):f>g[m]&&m>i-2&&(d.marker.attr("x",2*d.margin_left+d.xScale(d.unique[m])-7),d.data=_.where(d.timeline_data,{timestamp:d.unique[m]}),d.data.sort(function(a,b){return a.timestamp-b.timestamp}),_.each(d.data,function(a){d3.select("path[iso2='"+a.iso2+"']").attr("fill",d.renderColor)}),d.interval_index=m);console.log(d.interval_index," <<<<<<<<<<<<<<<<<<<<<<<<< DRAGGING")}}var b=d3.select(d.selector+" .axis").node().getBBox();drag=d3.behavior.drag().origin(Object).on("drag",a),d.play=d.svgContainer.append("image").attr("xlink:href",d.play_image_url).attr("x",d.margin_left/2).attr("y",d.redeced_height-d.margin_top-b.height/2).attr("width","24px").attr("height","21px").style("cursor","pointer"),d.marker=d.svgContainer.append("image").attr("xlink:href",d.marker_image_url).attr("x",2*d.margin_left+d.xScale(d.unique[0])-7).attr("y",d.redeced_height).attr("width","14px").attr("height","12px").style("cursor","pointer").call(drag)}},function(){function a(a){var b=document.createElement("script");b.type="text/javascript",b.async=!1,b.onload=b.onreadystatechange=function(){try{_&&d3&&($||jQuery)&&d3.customHive&&topojson&&$("body").colourBrightness&&(PykCharts.numberFormat=d3.format(","),window.PykChartsInit())}catch(a){}},b.src=a;var c=document.getElementsByTagName("link")[0];c.parentNode.insertBefore(b,c)}try{d3||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/d3.min.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/d3.min.js")}try{_||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/underscore-min.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/underscore-min.js")}try{$||jQuery||(console.log("jquery"),a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/jquery-1.11.1.min.js"))}catch(b){console.log("catch jquery"),a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/jquery-1.11.1.min.js")}try{topojson||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/topojson.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/topojson.js")}try{d3.customHive||a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/custom-hive.min.js")}catch(b){a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/custom-hive.min.js")}try{$("body").colourBrightness||a("../lib/jquery.colourbrightness.js")}catch(b){a("../lib/jquery.colourbrightness.js")}}();