var PykCharts={};Array.prototype.groupBy=function(a){for(var b,c,d=[],e={oned:["name"],line:["x","name"],area:["x","name"],bar:["y","group"],column:["x","group"],scatterplot:["x","name","group"],pulse:["x","name","group"],spiderweb:["x","name"]},f={oned:{dimension:"name",fact:"weight"},line:{dimension:"x",fact:"y",name:"name"},area:{dimension:"x",fact:"y",name:"name"},bar:{dimension:"y",fact:"x",name:"group"},column:{dimension:"x",fact:"y",name:"group"},scatterplot:{dimension:"x",fact:"y",weight:"weight",name:"name",group:"group"},pulse:{dimension:"x",fact:"y",weight:"weight",name:"name",group:"group"},spiderweb:{dimension:"x",fact:"y",name:"name",weight:"weight"}},g=e[a],h=this,i=[],b=0,j=h.length;j>b;b+=1){var c=h[b];if(0==i.length)i.push([c]);else{for(var k=!1,l=0,m=i.length;m>l;l+=1){var n=i[l],o=!0,p=n[0];g.forEach(function(a){p[a]!==c[a]&&(o=!1)}),o&&(k=n)}k?k.push(c):i.push([c])}}for(b in i)if($.isArray(i[b])){c={};var q=i[b],r=f[a];c[r.dimension]=q[0][r.dimension],c[r.fact]=d3.sum(q,function(b){return b[f[a].fact]}),r.name&&(c[r.name]=q[0][r.name]),r.weight&&(c[r.weight]=d3.sum(q,function(b){return b[f[a].weight]})),r.group&&(c[r.group]=q[0][r.group]);var s=_.extend(c,_.omit(q[0],_.values(f[a])));d.push(s)}return d},PykCharts.boolean=function(a){var b=["0","f","false","n","no",""],c=[void 0,null,0/0];return _.contains(c,a)?!1:(value=a.toLocaleString(),value=value.toLowerCase(),b.indexOf(value)>-1?!1:!0)},PykCharts.Configuration=function(a){var b=this,c={liveData:function(b){var c=a.realTimeCharts.refreshFrequency;return PykCharts.boolean(c)&&setInterval(b.refresh,1e3*c),this},emptyDiv:function(){d3.select(a.selector).append("div").style("clear","both")},scaleIdentification:function(a,b,c,d){var e;return"ordinal"===a?e=d3.scale.ordinal().domain(b).rangeRoundBands(c,d):"linear"===a?e=d3.scale.linear().domain(b).range(c):"time"===a?e=d3.time.scale().domain(b).range(c):void 0},appendUnits:function(b){var c,d,e;return a.units?(d=a.units.prefix,e=a.units.suffix,d&&""!==d?(c=d+" "+b,e&&(c+=" "+e)):c=e&&""!==e?b+" "+e:b):c=b,c},title:function(){return PykCharts.boolean(a.title.text)&&(b.titleDiv=d3.select(a.selector).append("div").attr("id","title").style("width",a.width+"px").style("text-align","left").html("<span style='pointer-events:none;font-size:"+a.title.size+";color:"+a.title.color+";font-weight:"+a.title.weight+";font-family:"+a.title.family+"'>"+a.title.text+"</span>")),this},subtitle:function(){return PykCharts.boolean(a.subtitle.text)&&(b.subtitleDiv=d3.select(a.selector).append("div").attr("id","sub-title").style("width",a.width+"px").style("text-align","left").html("</span><br><span style='pointer-events:none;font-size:"+a.subtitle.size+";color:"+a.subtitle.color+";font-family:"+a.subtitle.family+"'>"+a.subtitle.text+"</span>")),this},credits:function(){if(PykCharts.boolean(a.creditMySite.mySiteName)||PykCharts.boolean(a.creditMySite.mySiteUrl)){var b=a.creditMySite,c=!0;""===b.mySiteName&&(b.mySiteName=b.mySiteUrl),""===b.mySiteUrl&&(c=!1),d3.select(a.selector).append("table").attr("id","footer").style("background",a.bg).attr("width",a.width+"px").append("tr").attr("class","PykCharts-credits").append("td").style("text-align","left").html("<span style='pointer-events:none;'>Credits: </span><a href='"+b.mySiteUrl+"' target='_blank' onclick='return "+c+"'>"+b.mySiteName+"</a>")}return this},dataSource:function(){if(PykCharts.boolean(a.dataSource)&&(PykCharts.boolean(a.dataSource.text)||PykCharts.boolean(a.dataSource.url))){var b=!0,c=a.dataSource;""===c.text&&(c.text=c.url),""===c.url&&(b=!1),$(a.selector+" #footer").length?d3.select(a.selector+" table tr").style("background",a.bg).append("td").style("text-align","right").html("<span style='pointer-events:none;'>Source: </span><a href='"+c.url+"' target='_blank' onclick='return "+b+"'>"+c.text+"</a></tr>"):d3.select(a.selector).append("table").attr("id","footer").style("background",a.bg).attr("width",a.width+"px").append("tr").attr("class","PykCharts-credits").append("td").style("text-align","right").html("<span style='pointer-events:none;'>Source: </span><a href='"+c.url+"' target='_blank' onclick='return "+b+"'>"+c.text+"</a></tr>")}return this},makeMainDiv:function(b,c){var d=d3.select(b).append("div").attr("id","tooltip-svg-container-"+c).style("width",a.width);return PykCharts.boolean(a.multiple_containers)&&d.style("float","left").style("width","auto"),this},tooltip:function(b,c){return PykCharts.boolean(a.tooltip.enable)&&"default"===a.mode?PykCharts.Configuration.tooltipp=void 0!==c?d3.select(c).append("div").attr("id","pyk-tooltip").attr("class","pyk-line-tooltip"):d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("border","1px solid #CCCCCC").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("min-width","30px").style("z-index","10").style("visibility","hidden").style("box-shadow","0 5px 10px rgba(0,0,0,.2)"):PykCharts.boolean(a.tooltip.enable)&&(PykCharts.Configuration.tooltipp="fixed"===a.tooltip.mode?d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("min-width","30px").style("z-index","10").style("visibility","hidden"):d3.select("body").append("div").attr("id","pyk-tooltip").style("height","auto").style("padding","5px 6px").style("color","#4F4F4F").style("background","#fff").style("text-decoration","none").style("position","absolute").style("border-radius","5px").style("text-align","center").style("font-family","Arial, Helvetica, sans-serif").style("font-size","14px").style("min-width","30px").style("z-index","10").style("visibility","hidden")),this},crossHair:function(b){return PykCharts.boolean(a.enableCrossHair)&&"default"===a.mode&&(PykCharts.Configuration.cross_hair_v=b.append("g").attr("class","line-cursor").style("display","none"),PykCharts.Configuration.cross_hair_v.append("line").attr("class","cross-hair-v").attr("id","cross-hair-v"),PykCharts.Configuration.cross_hair_h=b.append("g").attr("class","line-cursor").style("display","none"),PykCharts.Configuration.cross_hair_h.append("line").attr("class","cross-hair-h").attr("id","cross-hair-h"),PykCharts.Configuration.focus_circle=b.append("g").attr("class","focus").style("display","none"),PykCharts.Configuration.focus_circle.append("circle").attr("id","focus-circle").attr("r",6)),this},fullScreen:function(c){return PykCharts.boolean(a.fullScreen)&&(b.fullScreenButton=d3.select(a.selector).append("input").attr("type","image").attr("id","btn-zoom").attr("src","../../PykCharts/img/apple_fullscreen.jpg").style("font-size","30px").style("left","800px").style("top","0px").style("position","absolute").style("height","4%").on("click",c.fullScreen)),this},loading:function(){return PykCharts.boolean(a.loading)&&($(a.selector).html("<div id='chart-loader'><img src="+a.loading+"></div>"),$(a.selector+" #chart-loader").css({visibility:"visible","padding-left":a.width/2+"px","padding-top":a.height/2+"px"})),this},positionContainers:function(b,c){return PykCharts.boolean(a.legends)&&!PykCharts.boolean(a.size.enable)?(("top"==b||"left"==b)&&c.optionalFeatures().legendsContainer().svgContainer(),("bottom"==b||"right"==b)&&c.optionalFeatures().svgContainer().legendsContainer()):c.optionalFeatures().svgContainer(),this},yGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid.yEnabled)){var e=PykCharts.Configuration.makeYGrid(a,d);c.selectAll(a.selector+" g.y.grid-line").style("stroke",function(){return a.grid.color}).call(e)}return this},xGrid:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.grid.xEnabled)){var e=PykCharts.Configuration.makeXGrid(a,d);c.selectAll(a.selector+" g.x.grid-line").style("stroke",function(){return a.grid.color}).call(e)}return this},xAxis:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.axis.x.enable)){d3.selectAll(a.selector+" .x.axis").attr("fill",function(){return a.axis.x.labelColor}),"bottom"===a.axis.x.position&&c.attr("transform","translate(0,"+(a.height-a.margin.top-a.margin.bottom)+")");var e=PykCharts.Configuration.makeXAxis(a,d);0!=a.axis.x.tickValues.length&&e.tickValues(a.axis.x.tickValues),c.style("stroke",function(){return a.axis.x.axisColor}).call(e),c.selectAll(a.selector+" g.x.axis text").attr("pointer-events","none")}return this},yAxis:function(b,c,d){a.width,a.height;if(PykCharts.boolean(a.axis.y.enable)){"right"===a.axis.y.position&&c.attr("transform","translate("+(a.width-a.margin.left-a.margin.right)+",0)"),d3.selectAll(a.selector+" .y.axis").attr("fill",function(){return a.axis.y.labelColor});var e=PykCharts.Configuration.makeYAxis(a,d);c.style("stroke",function(){return a.axis.y.axisColor}).call(e),c.selectAll(a.selector+" g.y.axis text").attr("pointer-events","none")}return this},isOrdinal:function(b,c,d){return".x.axis"===c?b.select(c).call(PykCharts.Configuration.makeXAxis(a,d)):".x.grid"===c?b.select(c).call(PykCharts.Configuration.makeXGrid(a,d)):".y.axis"===c?b.select(c).call(PykCharts.Configuration.makeYAxis(a,d)):".y.grid"===c&&b.select(c).call(PykCharts.Configuration.makeYGrid(a,d)),this},totalColors:function(a){var c=parseInt(a,10);return c>2&&10>c?(b.total_colors=c,this):(b.total_colors=9,this)},colorType:function(a){return"colors"===a&&(b.legends="no"),this},__proto__:{_domainBandwidth:function(a,b,c){return addFactor=0,padding=.1*(a[1]-a[0]),0===b?a[0]-=padding+addFactor:1===b?a[1]+=padding+addFactor:2===b&&(a[0]-=padding+addFactor,a[1]+=padding+addFactor),a},_radiusCalculation:function(b){var c=d3.min([a.width,a.height]);return c*b/200}}};return c};var configuration=PykCharts.Configuration;configuration.mouseEvent=function(a){var b=this;b.tooltip=configuration.tooltipp,b.cross_hair_v=configuration.cross_hair_v,b.cross_hair_h=configuration.cross_hair_h,b.focus_circle=configuration.focus_circle;var c={tooltipPosition:function(c,d,e,f,g,h){if(PykCharts.boolean(a.tooltip.enable)){if(void 0!==d){var i=parseFloat($(a.selector+" #tooltip-svg-container-"+h).next("#pyk-tooltip").css("width"));$(a.selector+" #tooltip-svg-container-"+h).next("#pyk-tooltip").css("visibility","visible").css("top",e+g+"px").css("left",d+a.margin.left+f-i+"px")}else b.tooltip.style("visibility","visible").style("top",d3.event.pageY-20+"px").style("left",d3.event.pageX+30+"px");return b.tooltip}},toolTextShow:function(c,d,e,f){return PykCharts.boolean(a.tooltip.enable)&&("yes"===d&&"multilineChart"===e?$(a.selector+" #tooltip-svg-container-"+f).next("#pyk-tooltip").html(c):b.tooltip.html(c)),this},tooltipHide:function(c,d,e){return PykCharts.boolean(a.tooltip.enable)?"yes"===d&&"multilineChart"===e?d3.selectAll(a.selector+" .pyk-line-tooltip").style("visibility","hidden"):b.tooltip.style("visibility","hidden"):void 0},crossHairPosition:function(b,c,d,e,f,g,h,i,j,k){if((PykCharts.boolean(a.enableCrossHair)||PykCharts.boolean(a.tooltip.enable)||PykCharts.boolean(a.onHoverHighlightenable))&&"default"===a.mode){var l,m,n,o,p,q,r,s,t=$(a.selector+" #"+f[0].attr("id")).offset().left,u=$(a.selector+" #"+f[0].attr("id")).offset().top,v=c.length,w=a.margin.left,x=(a.margin.right,a.margin.top),y=a.margin.bottom,z=(a.width,a.height),A=parseInt(d3.event.target.id.substr(d3.event.target.id.length-1,1)),B=d3.event.pageX-t,C=d3.event.pageY-u,D=d.range(),E=(e.range(),[]),F=[],G=D.length;for(l=0;G>l;l++){if(l+1>=G)return!1;if(q===D[l]&&r===D[l+1])return!1;if(B>=D[l]&&B<=D[l+1])if(r=D[l],q=D[l+1],n=r-B,o=B-q,n>=o?(m=b[l].x,E.push(b[l].y),tooltipText=b[l].tooltip,p=d(m)+g+w,F=e(b[l].y)+x):(m=b[l+1].x,E.push(b[l+1].y),tooltipText=b[l+1].tooltip,p=d(m)+g+w,F=e(b[l+1].y)+x),"multilineChart"===h){if("no"===k){d3.selectAll(a.selector+" #pyk-tooltip").classed({"pyk-line-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var H=c[0].data.length,I="";E=[];for(var J=0;v>J;J++)for(var K=0;H>K;K++)c[J].data[K].x===m&&(E.push(c[J].data[K].y),PykCharts.boolean(j)?PykCharts.boolean(j)&&(I+="<tr><td><div style='padding:2px;width:5px;height:5px;background-color:"+c[J].color+"'></div></td><td>"+c[J].name+"</td><td><b>"+c[J].data[K].tooltip+"</b></td></tr>",s=3):(I+="<tr><td>"+c[J].name+"</td><td><b>"+c[J].data[K].tooltip+"</b></td></tr>",s=2));p+=6,tooltipText="<table><thead><th colspan='"+s+"'>"+m+"</th></thead><tbody>"+I+"</tbody></table>",this.tooltipPosition(tooltipText,p,C,60,-15,A),this.toolTextShow(tooltipText),a.enableCrossHair?this.crossHairShow(p,x,p,z-y,p,F,h,E.length,k):null,this.axisHighlightShow(E,a.selector+" .y.axis"),this.axisHighlightShow(m,a.selector+" .x.axis")}else if("yes"===k){var L=$(a.selector+" #svg-0 #xaxis").offset().left,M=$(a.selector+" #svg-1 #xaxis").offset().left,N=M-L;p+=5;for(var H=c[0].data.length,J=0;v>J;J++)for(var K=0;H>K;K++)c[J].data[K].x===m&&(E.push(c[J].data[K].y),tooltipText=c[J].data[K].tooltip,F=e(c[J].data[K].y)+x,this.tooltipPosition(tooltipText,p+J*N,F,-15,-15,J),this.toolTextShow(tooltipText,k,h,J),a.enableCrossHair?this.crossHairShow(p,x,p,z-y,p,F,h,E.length,k,J):null)}}else("lineChart"===h||"areaChart"===h)&&("fixed"===a.tooltip.mode.toLowerCase()?this.tooltipPosition(tooltipText,0,F,-14,-15,A):"moving"===a.tooltip.mode.toLowerCase()&&this.tooltipPosition(tooltipText,p,F,5,-45,A),this.toolTextShow(tooltipText),a.enableCrossHair?this.crossHairShow(p,x,p,z-y,p,F,h,E.length,k):null,this.axisHighlightShow(E,a.selector+" .y.axis"),this.axisHighlightShow(m,a.selector+" .x.axis"))}}},crossHairShow:function(c,d,e,f,g,h,i,j,k,l){return PykCharts.boolean(a.enableCrossHair)&&void 0!==c&&("lineChart"===i||"areaChart"===i?(b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c).attr("y1",d).attr("x2",e).attr("y2",f),b.cross_hair_h.style("display","block"),b.cross_hair_h.select(a.selector+" #cross-hair-h").attr("x1",a.margin.left).attr("y1",h).attr("x2",a.width-a.margin.right).attr("y2",h),b.focus_circle.style("display","block").attr("transform","translate("+g+","+h+")")):"multilineChart"===i&&("no"===k?(b.cross_hair_v.style("display","block"),b.cross_hair_v.select(a.selector+" #cross-hair-v").attr("x1",c-5).attr("y1",d).attr("x2",e-5).attr("y2",f)):"yes"===k&&(d3.selectAll(a.selector+" .line-cursor").style("display","block"),d3.selectAll(a.selector+" .cross-hair-v").attr("x1",c-5).attr("y1",d).attr("x2",e-5).attr("y2",f),d3.select(a.selector+" #svg-"+l+" .cross-hair-h").attr("x1",a.margin.left).attr("y1",h).attr("x2",a.width-a.margin.right).attr("y2",h),d3.select(a.selector+" #svg-"+l+" .focus").style("display","block").attr("transform","translate("+(g-5)+","+h+")")))),this},crossHairHide:function(c){return PykCharts.boolean(a.enableCrossHair)&&(b.cross_hair_v.style("display","none"),"lineChart"===c||"areaChart"===c?(b.cross_hair_h.style("display","none"),b.focus_circle.style("display","none")):"multilineChart"===c&&(d3.selectAll(a.selector+" .line-cursor").style("display","none"),d3.selectAll(a.selector+" .focus").style("display","none"))),this},axisHighlightShow:function(b,c,d){var e,f,g,h,i;if(PykCharts.boolean(a.axis.onHoverHighlightenable))if(c===a.selector+" .y.axis"){h=c+" .tick text",g=a.axis.y.labelColor,i=d3.selectAll(h)[0].length,d3.selectAll(h).style("fill","#bbb").style("font-size","12px").style("font-weight","normal");for(var j=0;i>j;j++)for(var d=0;d<b.length;d++)d3.selectAll(h)[0][j].innerHTML==b[d]&&d3.select(d3.selectAll(h)[0][j]).style("fill",g).style("font-size","13px").style("font-weight","bold")}else{for(c===a.selector+" .x.axis"?(h=c+" .tick text",g=a.axis.x.labelColor):c===a.selector+" .axis-text"&&"column"===d?(h=c,g=a.axis.x.labelColor):c===a.selector+" .axis-text"&&"bar"===d&&(h=c,g=a.axis.y.labelColor),void 0!==f&&d3.select(d3.selectAll(h)[0][f]).style("fill",g).style("font-weight","normal"),e=0;d3.selectAll(h)[0][e].innerHTML!==b;e++);f=e,d3.selectAll(h).style("fill","#bbb").style("font-size","12px").style("font-weight","normal"),d3.select(d3.selectAll(h)[0][e]).style("fill",g).style("font-size","13px").style("font-weight","bold")}return this},axisHighlightHide:function(b,c){var d,e;return PykCharts.boolean(a.axis.onHoverHighlightenable)&&(b===a.selector+" .y.axis"?(e=b+" .tick text",d=a.axis.y.labelColor):b===a.selector+" .x.axis"?(e=b+" .tick text",d=a.axis.x.labelColor):b===a.selector+" .axis-text"&&"column"===c?(e=b,d=a.axis.x.labelColor):b===a.selector+" .axis-text"&&"bar"===c&&(e=b,d=a.axis.y.labelColor),d3.selectAll(e).style("fill",d).style("font-size","12px").style("font-weight","normal")),this}};return c},configuration.fillChart=function(a,b,c){var d={color:function(a){return a.color},saturation:function(){return"steelblue"},selectColor:function(b){return b.highlight===!0?a.highlightColor:a.chartColor},colorChart:function(a){return a.highlight===!0?b.stylesheet.colors.highlightColor:b.stylesheet.colors.chartColor},colorPieW:function(b){return PykCharts.boolean(a.size.enable)?PykCharts.boolean(a.size.enable)?b.color?b.color:a.chartColor:void 0:a.saturationColor},colorPieMS:function(b){return PykCharts.boolean(b.highlight)?a.highlightColor:PykCharts.boolean(a.saturationEnable)?a.saturationColor:c.optional&&c.optional.colors&&c.optional.colors.chartColor?a.chartColor:c.optional&&c.optional.colors&&b.color?b.color:a.chartColor}};return d},configuration.border=function(a){var b={width:function(){return a.borderBetweenChartElements.width},color:function(){return a.borderBetweenChartElements.color}};return b},configuration.makeXAxis=function(a,b){var c=PykCharts.Configuration(a.axis.x),d=d3.svg.axis().scale(b).ticks(a.axis.x.no_of_ticks).tickSize(a.axis.x.tickSize).outerTickSize(a.axis.x.outer_tick_size).tickFormat(function(b){return"yes"===a.multiple_containers&&"string"===a.xAxisDataFormat?b.substr(0,2):c.appendUnits(b)}).tickPadding(a.axis.x.ticksPadding).orient(a.axis.x.orient);return d},configuration.makeYAxis=function(a,b){var c=PykCharts.Configuration(a.axis.y),d=d3.svg.axis().scale(b).orient(a.axis.y.orient).ticks(a.axis.y.no_of_ticks).tickSize(a.axis.y.tickSize).outerTickSize(a.axis.y.outer_tick_size).tickPadding(a.axis.y.ticksPadding).tickFormat(function(a){return c.appendUnits(a)});return d},configuration.makeXGrid=function(a,b){var c=d3.svg.axis().scale(b).orient("bottom").ticks(a.axis.x.no_of_ticks).tickFormat("").tickSize(a.height-a.margin.top-a.margin.bottom).outerTickSize(0);return c},configuration.makeYGrid=function(a,b){var c=d3.svg.axis().scale(b).orient("left").ticks(a.axis.x.no_of_ticks).tickSize(-(a.width-a.margin.left-a.margin.right)).tickFormat("").outerTickSize(0);return c},configuration.transition=function(a){var b={duration:function(){return"default"===a.mode&&PykCharts.boolean(a.transition.duration)?a.transition.duration:0}};return b},configuration.Theme=function(){var a=this;return a.stylesheet={chart:{height:400,width:600,margin:{top:20,right:20,bottom:20,left:20},grid:{xEnabled:"yes",yEnabled:"yes",color:"#ddd"}},mode:"default",selector:"body",title:{size:"15px",color:"#1D1D1D",weight:"bold",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},overflowTicks:"no",subtitle:{size:"12px",color:"black",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},loading:{animationGifUrl:"https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/img/loader.gif"},buttons:{enableFullScreen:"no"},tooltip:{enable:"yes"},creditMySite:{mySiteName:"Pykih",mySiteUrl:"http://www.pykih.com"},colors:{backgroundColor:"transparent",chartColor:"steelblue",highlightColor:"#013F73",saturationColor:"steelblue"},borderBetweenChartElements:{width:1,color:"white",style:"solid"},legendsText:{size:"13",color:"white",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},label:{size:"13",color:"white",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},ticks:{strokeWidth:1,size:13,color:"#1D1D1D",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"}},a.functionality={realTimeCharts:{refreshFrequency:0,enableLastUpdatedAt:"yes"},transition:{duration:0}},a.oneDimensionalCharts={donut:{radiusPercent:70,innerRadiusPercent:40,showTotalAtTheCenter:"yes"},pie:{radiusPercent:70},clubData:{enable:"yes",text:"Others",maximumNodes:5},pictograph:{showActive:"yes",enableTotal:"yes",enableCurrent:"yes",imagePerLine:3,imageWidth:79,imageHeight:66,activeText:{size:64,color:"steelblue",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},inactiveText:{size:64,color:"grey",weight:"thin",family:"'Helvetica Neue',Helvetica,Arial,sans-serif"}},funnel:{rect_width:100,rect_height:100}},a.multiDimensionalCharts={axis:{onHoverHighlightenable:"no",x:{enable:"yes",position:"bottom",orient:"bottom",axisColor:"#1D1D1D",labelColor:"#1D1D1D",no_of_ticks:5,tickSize:5,tickFormat:"",ticksPadding:6,tickValues:[],outer_tick_size:0},y:{enable:"yes",position:"left",orient:"left",axisColor:"#1D1D1D",labelColor:"#1D1D1D",no_of_ticks:5,tickSize:5,tickFormat:"",ticksPadding:6,outer_tick_size:0}},yAxisDataFormat:"number",xAxisDataFormat:"string",curvy_lines:"no",enableCrossHair:"yes",zoom:{enable:"no"},size:{enable:"yes"},spiderweb:{outer_radius:200,radius:5,axisTitle:"yes",enableTicks:"yes"},multiple_containers:{enable:"no"},legends:{enable:"yes",display:"horizontal"},tooltip:{enable:"yes",mode:"fixed"},scatterplot:{radius:40},line:{color_from_data:"yes"}},a.treeCharts={zoom:{enable:"no"},nodeRadius:4.5},a.mapsTheme={map:{width:1e3,height:1e3},colors:{defaultColor:"#4682B4",total:3,type:"satuartion",palette:"Blue"},border:{color:"white",thickness:1},tooltip:{enable:"yes",mode:"moving",positionTop:0,positionLeft:0},timeline:{duration:1e3,margin:{top:5,right:25,bottom:25,left:45}},legends:{enable:"yes"},label:{enable:"no"},enableClick:"yes",onhover:"shadow",highlightArea:"no",axis:{onHoverHighlightenable:"no",x:{enable:"yes",orient:"top",axisColor:"#1D1D1D",labelColor:"#1D1D1D",no_of_ticks:10,tickSize:5,tickFormat:"",ticksPadding:6,tickValues:[],outer_tick_size:0}}},a},PykCharts.oneD={},PykCharts.oneD.fillChart=function(a){var b={chartColor:function(b){return b.highlight===!0?a.highlightColor:a.chartColor}};return b},PykCharts.oneD.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.oneD.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.oneDimensionalCharts,g=b.optional;return a.selector=b.selector?b.selector:d.selector,a.width=g&&g.chart&&_.isNumber(g.chart.width)?g.chart.width:d.chart.width,a.height=g&&g.chart&&_.isNumber(g.chart.height)?g.chart.height:d.chart.height,a.mode=b.mode?b.mode:d.mode,g&&g.title?(a.title=g.title,a.title.size=g.title.size?g.title.size:d.title.size,a.title.color=g.title.color?g.title.color:d.title.color,a.title.weight=g.title.weight?g.title.weight:d.title.weight,a.title.family=g.title.family?g.title.family:d.title.family):a.title=d.title,g&&g.subtitle?(a.subtitle=g.subtitle,a.subtitle.size=g.subtitle.size?g.subtitle.size:d.subtitle.size,a.subtitle.color=g.subtitle.color?g.subtitle.color:d.subtitle.color,a.subtitle.weight=g.subtitle.weight?g.subtitle.weight:d.subtitle.weight,a.subtitle.family=g.subtitle.family?g.subtitle.family:d.subtitle.family):a.subtitle=d.subtitle,a.realTimeCharts=g&&g.realTimeCharts?g.realTimeCharts:e.realTimeCharts,a.transition=g&&g.transition&&g.transition.duration?g.transition:e.transition,a.creditMySite=g&&g.creditMySite?g.creditMySite:d.creditMySite,a.dataSource=g&&g.dataSource?g.dataSource:"no",g&&g.clubData?(a.clubData=g.clubData,a.clubData.text=PykCharts.boolean(g.clubData.enable)&&g.clubData.text?g.clubData.text:f.clubData.text,a.clubData.maximumNodes=PykCharts.boolean(g.clubData.maximumNodes)&&g.clubData.maximumNodes?g.clubData.maximumNodes:f.clubData.maximumNodes,a.clubData.alwaysIncludeDataPoints=PykCharts.boolean(g.clubData.enable)&&g.clubData.alwaysIncludeDataPoints?g.clubData.alwaysIncludeDataPoints:[]):(a.clubData=f.clubData,a.clubData.alwaysIncludeDataPoints=[]),a.overflowTicks=g&&g.overflowTicks?g.overflowTicks:d.overflowTicks,a.bg=g&&g.colors&&g.colors.backgroundColor?g.colors.backgroundColor:d.colors.backgroundColor,a.chartColor=g&&g.colors&&g.colors.chartColor?g.colors.chartColor:d.colors.chartColor,a.highlightColor=g&&g.colors&&g.colors.highlightColor?g.colors.highlightColor:d.colors.highlightColor,a.fullscreen=g&&g.buttons&&g.buttons.enableFullScreen?g.buttons.enableFullScreen:d.buttons.enableFullScreen,a.loading=g&&g.loading&&g.loading.animationGifUrl?g.loading.animationGifUrl:d.loading.animationGifUrl,g&&g.tooltip?(a.tooltip=g.tooltip,a.tooltip.enable=g.tooltip.enable?g.tooltip.enable:d.tooltip.enable):a.tooltip=d.tooltip,g&&g.borderBetweenChartElements?(a.borderBetweenChartElements=g.borderBetweenChartElements,a.borderBetweenChartElements.width="width"in g.borderBetweenChartElements?g.borderBetweenChartElements.width:d.borderBetweenChartElements.width,a.borderBetweenChartElements.color=g.borderBetweenChartElements.color?g.borderBetweenChartElements.color:d.borderBetweenChartElements.color,a.borderBetweenChartElements.style=g.borderBetweenChartElements.style?g.borderBetweenChartElements.style:d.borderBetweenChartElements.style):a.borderBetweenChartElements=d.borderBetweenChartElements,g&&g.label?(a.label=g.label,a.label.size="size"in g.label?g.label.size:d.label.size,a.label.color=g.label.color?g.label.color:d.label.color,a.label.weight=g.label.weight?g.label.weight:d.label.weight,a.label.family=g.label.family?g.label.family:d.label.family):a.label=d.label,g&&g.ticks?(a.ticks=g.ticks,a.ticks.strokeWidth="strokeWidth"in g.ticks?g.ticks.strokeWidth:d.ticks.strokeWidth,a.ticks.size="size"in g.ticks?g.ticks.size:d.ticks.size,a.ticks.color=g.ticks.color?g.ticks.color:d.ticks.color,a.ticks.family=g.ticks.family?g.ticks.family:d.ticks.family):a.ticks=d.ticks,a.showTotalAtTheCenter=g&&g.donut&&g.donut.showTotalAtTheCenter?g.donut.showTotalAtTheCenter:f.donut.showTotalAtTheCenter,a.units=g&&g.units?g.units:!1,a.k=new PykCharts.Configuration(a),a},PykCharts.oneD.bubble=function(a){var b=this;this.execute=function(){b=PykCharts.oneD.processInputs(b,a),"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c,b.optionalFeatures().createBubble().label()})},this.render=function(){if(b.fillChart=new PykCharts.oneD.fillChart(b),b.mouseEvent1=new PykCharts.oneD.mouseEvent(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode){b.k.title(),b.k.subtitle(),b.b=b.optionalFeatures().clubData();{b.optionalFeatures().svgContainer().createBubble().label()}b.k.credits().dataSource().liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)}else"infographics"===b.mode&&(b.b={children:b.data},b.optionalFeatures().svgContainer().createBubble().label(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b))},this.optionalFeatures=function(){var c={svgContainer:function(){return $(b.selector).css("background-color",b.bg),b.svgContainer=d3.select(b.selector).append("svg").attr("class","svgcontainer").attr("id","svgcontainer").attr("width",b.width).attr("height",b.height),b.group=b.svgContainer.append("g").attr("id","bubgrp"),this},createBubble:function(){b.bubble=d3.layout.pack().sort(function(a,b){return b.weight-a.weight}).size([b.width,b.height]).value(function(a){return a.weight}).padding(20);var c=d3.sum(b.b.children,function(a){return a.weight}),d=b.b.children.length;return b.max=b.b.children[d-1].weight,b.node=b.bubble.nodes(b.b),b.bub_node=b.group.selectAll(".bubble-node").data(b.node),b.bub_node.enter().append("g").attr("class","bubble-node").append("circle"),b.bub_node.attr("class","bubble-node").select("circle").attr("class","bubble").attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("r",0).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("fill",function(a){return a.children?b.bg:b.fillChart.chartColor(a)}).on("mouseover",function(d){d.children||(b.mouseEvent1.highlight(a.selector+" .bubble",this),d.tooltip=d.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+d.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(d.weight)+"  <td class='tooltip-right-content'>(&nbsp;"+(100*d.weight/c).toFixed(2)+"%&nbsp;)</tr></table>",b.mouseEvent.tooltipPosition(d),b.mouseEvent.toolTextShow(d.tooltip))}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.mouseEvent1.highlightHide(a.selector+" .bubble")}).on("mousemove",function(a){a.children||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("r",function(a){return a.r}),b.bub_node.exit().remove(),this},label:function(){return b.bub_text=b.group.selectAll("text").data(b.node),b.bub_text.enter().append("text").style("pointer-events","none"),b.bub_text.attr("text-anchor","middle").attr("transform",function(a){return"translate("+a.x+","+(a.y+5)+")"}).text("").transition().delay(b.transitions.duration()),b.bub_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<2*a.r&&this.getBBox().height<2*a.r?a.children?" ":a.name:""}).style("font-weight",b.label.weight).style("font-size",function(a){return a.r>24?b.label.size:"10px"}).attr("fill",b.label.color).style("font-family",b.label.family),b.bub_text.exit().remove,this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){var a,c,d=[],e=0;if(b.data.length<=b.clubData.maximumNodes)return b.new_data1={children:b.data},this;if(0!==b.clubData.alwaysIncludeDataPoints.length){var f=b.clubData.alwaysIncludeDataPoints.length;for(c=0;f>c;c++)d[c]=b.clubData.alwaysIncludeDataPoints[c]}var g=[];for(c=0;c<d.length;c++)for(a=0;a<b.data.length;a++)d[c].toUpperCase()===b.data[a].name.toUpperCase()&&g.push(b.data[c]);for(b.data.sort(function(a,b){return b.weight-a.weight});g.length<b.clubData.maximumNodes-1;){for(c=0;c<d.length;c++)b.data[e].name.toUpperCase()===d[c].toUpperCase()&&e++;g.push(b.data[e]),e++}var h=0;for(a=e;a<b.data.length;a++){for(c=0;c<g.length&&c<b.data.length;c++)b.data[a].name.toUpperCase()===g[c].name.toUpperCase()&&(h+=0,a++,c=-1);a<b.data.length&&(h+=b.data[a].weight)}for(var i=function(a,b){return b.weight-a.weight};g.length>b.clubData.maximumNodes;){g.sort(i);{g.pop()}}var j={name:b.clubData.text,weight:h,color:b.clubData.color,tooltip:b.clubData.tooltipText,highlight:!1};g.length<b.clubData.maximumNodes&&g.push(j),g.sort(function(a,b){return a.weight-b.weight}),b.new_data1={children:g},b.map1=b.new_data1.children.map(function(a){return a.weight})}else b.data.sort(function(a,b){return a.weight-b.weight}),b.new_data1={children:b.data};return b.new_data1}};return c}},PykCharts.oneD.funnel=function(a){var b=this,c=new PykCharts.Configuration.Theme({});b.creditMySite=c.stylesheet.creditMySite,this.execute=function(){b=new PykCharts.oneD.processInputs(b,a);var d=a.optional,e=c.oneDimensionalCharts.funnel;b.rect_width=d&&d.funnel&&d.funnel.rect_width&&_.isNumber(d.funnel.rect_width)?d.funnel.rect_width:e.rect_width,b.rect_height=d&&d.funnel&&d.funnel.rect_height&&_.isNumber(d.funnel.rect_height)?d.funnel.rect_height:e.rect_height,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy(),b.optionalFeatures().clubData().createFunnel().label().ticks()
})},this.render=function(){var a=this;if(a.fillChart=new PykCharts.oneD.fillChart(a),a.mouseEvent1=new PykCharts.oneD.mouseEvent(a),a.transitions=new PykCharts.Configuration.transition(a),a.border=new PykCharts.Configuration.border(a),"default"===a.mode&&a.k.title().subtitle(),a.k.tooltip(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a),"infographics"===a.mode&&(a.newData1=a.data),"default"===a.mode){a.optionalFeatures().clubData()}a.optionalFeatures().svgContainer().createFunnel().label(),"default"===a.mode&&(a.optionalFeatures().ticks(),a.k.liveData(a).credits().dataSource())},this.funnelLayout=function(){var a,b,c,d=this,e={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},mouth:function(a){return 2!==a.length||(c=a),this},coordinates:function(){function e(a){return d3.sum(q,function(b,c){return c>=a?b:void 0})}for(var f=b[0],g=b[1],h=c[0],i=c[1],j=(f-h)/2,k=g-i,l=0,m=0,n=0,o=0,p=[],q=d.percentageValues(a),r=j/k,s=(f+h)/2*k,t=h*i,u=s+t,v=t/u*100,w=a.length-1;w>=0;w--){var x=e(w);if(v>=x)n=x/v*i,l=g-n,p[w]=w===a.length-1?{values:[{x:(f-h)/2,y:l},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:l}]}:{values:[{x:(f-h)/2,y:l},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:l}]};else{var y;y=0===o?(x-v)/100*s:x/100*s;var z=2*r,A=2*h,B=2*y;m=(-A+Math.sqrt(Math.pow(A,2)-4*z*-B))/(2*z),l=g-m-i;var C=2*r*m+h,D=(f-C)/2;if(0===o)p[w]=w===a.length-1?{values:[{x:D,y:l},{x:(f-h)/2,y:k},{x:(f-h)/2,y:g},{x:(f-h)/2+h,y:g},{x:(f-h)/2+h,y:k},{x:C+D,y:l}]}:{values:[{x:D,y:l},{x:(f-h)/2,y:k},p[w+1].values[0],p[w+1].values[3],{x:(f-h)/2+h,y:k},{x:C+D,y:l}]};else{var E;E=6===p[w+1].values.length?5:3,p[w]={values:[{x:D,y:l},p[w+1].values[0],p[w+1].values[E],{x:C+D,y:l}]}}o=1}}return p}};return e},this.percentageValues=function(a){var b=d3.sum(a,function(a){return a.weight}),c=a.map(function(a){return a.weight/b*100});return c.sort(function(a,b){return b-a}),c},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svg.append("g").attr("id","funnel"),this},createFunnel:function(){b.pervalue=b.percentageValues(b.newData1);var c=b.funnelLayout().data(b.newData1).size([b.width,b.height]).mouth([b.rect_width,b.rect_height]);b.coordinates=c.coordinates();var d=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});b.path=b.group.selectAll(".fun-path").data(b.coordinates);var e=[{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0},{x:0,y:0},{x:b.width,y:0}];return b.path.enter().append("path").attr("class","fun-path"),b.path.attr("class","fun-path").attr("d",function(){return d(e)}).attr("fill",function(a,c){return b.fillChart.chartColor(b.newData1[c])}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-opacity",1).on("mouseover",function(c,d){b.mouseEvent1.highlight(a.selector+" .fun-path",this),tooltip=b.newData1[d].tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.newData1[d].name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(b.newData1[d].weight)+"<td class='tooltip-right-content'>(&nbsp; "+b.pervalue[d].toFixed(2)+"%&nbsp) </tr></table>",b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(tooltip)}).on("mouseout",function(c){b.mouseEvent1.highlightHide(a.selector+" .fun-path"),b.mouseEvent.tooltipHide(c)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("d",function(a){return d(a.values)}),b.path.exit().remove(),this},label:function(){var a=b.group.selectAll("text").data(b.coordinates);return a.enter().append("text"),a.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+5:(a.values[0].y-a.values[2].y)/2+a.values[2].y+5}).attr("x",function(){return b.width/2}),a.text(function(a,c){return b.k.appendUnits(b.newData1[c].weight)}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text(function(a,c){return this.getBBox().width<a.values[3].x-a.values[1].x&&this.getBBox().height<a.values[2].y-a.values[0].y?b.k.appendUnits(b.newData1[c].weight):""}),a.exit().remove(),this},ticks:function(){PykCharts.boolean(b.overflowTicks)&&b.svg.style("overflow","visible");var a=b.group.selectAll(".funnel-ticks").data(b.coordinates);a.enter().append("line").attr("class","funnel-ticks"),a.attr("x1",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:(a.values[4].x+a.values[5].x+a.values[3].x)/3-5}).attr("y1",function(a){return(a.values[0].y+a.values[2].y)/2}).attr("x2",function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:(a.values[4].x+a.values[5].x+a.values[3].x)/3-5}).attr("y2",function(a){return(a.values[0].y+a.values[2].y)/2}).attr("stroke-width",b.ticks.strokeWidth).attr("stroke",b.ticks.color).transition().duration(b.transitions.duration()).attr("x2",function(a){return a.values[2].y-a.values[0].y>15?4===a.values.length?(a.values[3].x+a.values[2].x)/2+5:(a.values[4].x+a.values[5].x+a.values[3].x)/3:4===a.values.length?(a.values[3].x+a.values[2].x)/2:(a.values[4].x+a.values[5].x+a.values[3].x)/3-5}),a.exit().remove();var c=b.group.selectAll(".ticks_label").data(b.coordinates);c.attr("class","ticks_label"),c.enter().append("text").attr("x",0).attr("y",0);var d,e;return c.attr("transform",function(a){return d=4===a.values.length?(a.values[3].x+a.values[2].x)/2+10:(a.values[4].x+a.values[5].x+a.values[3].x)/3+5,e=(a.values[0].y+a.values[2].y)/2+5,"translate("+d+","+e+")"}),c.text("").transition().delay(b.transitions.duration()).text(function(a,c){return b.newData1[c].name}).text(function(a,c){return this.getBBox().height<a.values[2].y-a.values[0].y-15?b.newData1[c].name:""}).attr("font-size",b.ticks.size).attr("text-anchor","start").attr("fill",b.ticks.color).attr("pointer-events","none").attr("font-family",b.ticks.family),c.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){var a=[];if(0!==b.clubData.alwaysIncludeDataPoints.length){var c=b.clubData.alwaysIncludeDataPoints.length;for(i=0;c>i;i++)a[i]=b.clubData.alwaysIncludeDataPoints[i]}for(b.newData=[],i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&b.newData.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var d=0;b.newData.length<b.clubData.maximumNodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;b.newData.push(b.data[d]),d++}var e=0;for(j=d;j<b.data.length;j++){for(i=0;i<b.newData.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===b.newData[i].name.toUpperCase()&&(e+=0,j++,i=-1);j<b.data.length&&(e+=b.data[j].weight)}for(var f=function(a,b){return b.weight-a.weight};b.newData.length>b.clubData.maximumNodes;){b.newData.sort(f);{b.newData.pop()}}var g={name:b.clubData.text,weight:e,color:b.clubData.color,tooltip:b.clubData.tooltip};b.newData.length<b.clubData.maximumNodes&&b.newData.push(g),b.newData.sort(function(a,b){return b.weight-a.weight}),b.newData1=b.newData}else b.data.sort(function(a,b){return b.weight-a.weight}),b.newData1=b.data;return this}};return c}},PykCharts.oneD.percentageColumn=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){var b=this;b=new PykCharts.oneD.processInputs(b,a,"percentageColumn"),"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c,b.optionalFeatures().clubData().createChart().label().ticks()})},this.render=function(){var b=this;b.fillChart=new PykCharts.oneD.fillChart(b),b.mouseEvent1=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&b.k.title().subtitle(),"infographics"===b.mode&&(b.newData1=b.data),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"default"===b.mode&&(percent_column=b.optionalFeatures().clubData()),b.optionalFeatures().svgContainer().createChart().label(),"default"===b.mode&&(b.optionalFeatures().ticks(),b.k.liveData(b).credits().dataSource())},this.optionalFeatures=function(){var c={createChart:function(){var a=b.newData1.map(function(a){return a.weight});a.sum=function(){for(var a=0,b=0;b<this.length;++b)a+=this[b];return a};var c=a.sum();return b.newData1.forEach(function(a,b){this[b].percentValue=100*a.weight/c},b.newData1),b.newData1.sort(function(a,b){return b.weight-a.weight}),b.map1=_.map(b.newData1,function(a){return a.percentValue}),b.perColumn=b.group.selectAll(".per-rect").data(b.newData1),b.perColumn.enter().append("rect").attr("class","per-rect"),b.perColumn.attr("x",b.width/3).attr("y",function(a,c){if(0===c)return 0;var d=0,e=b.newData1.slice(0,c);return e.forEach(function(a,b){d+=this[b].percentValue},e),d*b.height/100}).attr("width",b.width/4).attr("height",0).attr("fill",function(a){return b.fillChart.chartColor(a)}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).on("mouseover",function(a){a.tooltip=a.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+a.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(a.weight)+"<td class='tooltip-right-content'>(&nbsp;"+a.percentValue.toFixed(2)+"%&nbsp)</tr></table>",b.mouseEvent1.highlight(".per-rect",this),b.mouseEvent.tooltipPosition(a),b.mouseEvent.toolTextShow(a.tooltip)}).on("mouseout",function(a){b.mouseEvent1.highlightHide(".per-rect"),b.mouseEvent.tooltipHide(a)}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.percentValue*b.height/100}),b.perColumn.exit().remove(),this},svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svg.append("g").attr("id","funnel"),this},label:function(){b.per_text=b.group.selectAll(".per-text").data(b.newData1);var a=0;return b.per_text.enter().append("text").attr("class","per-text"),b.per_text.attr("class","per-text").attr("x",b.width/3+b.width/8).attr("y",function(c,d){return a+=c.percentValue,0===d?(0+a*b.height/100)/2+5:((a-c.percentValue)*b.height/100+a*b.height/100)/2+5}),a=0,b.per_text.text("").transition().delay(b.transitions.duration()),b.per_text.text(function(a){return b.k.appendUnits(a.weight)}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text(function(a){return this.getBBox().width<b.width/4&&this.getBBox().height<a.percentValue*b.height/100?b.k.appendUnits(a.weight):""}),b.per_text.exit().remove(),this},ticks:function(){PykCharts.boolean(b.overflowTicks)&&b.svg.style("overflow","visible");var a=0,c=0,d=b.group.selectAll(".per-ticks").data(b.newData1);d.enter().append("line").attr("class","per-ticks"),d.attr("x1",function(){return b.width/3+b.width/4}).attr("y1",function(c,d){return a+=c.percentValue,0===d?(0+a*b.height/100)/2:((a-c.percentValue)*b.height/100+a*b.height/100)/2}).attr("x2",function(){return b.width/3+b.width/4}).attr("y2",function(a,d){return c+=a.percentValue,0===d?(0+c*b.height/100)/2:((c-a.percentValue)*b.height/100+c*b.height/100)/2}).attr("stroke-width",b.ticks.strokeWidth).attr("stroke",b.ticks.color).transition().duration(b.transitions.duration()).attr("x2",function(a){return a.percentValue*b.height/100>15?b.width/3+b.width/4+5:b.width/3+b.width/4}),d.exit().remove();var e,f;a=0;var g=b.group.selectAll(".ticks_label").data(b.newData1);return g.enter().append("text").attr("class","ticks_label"),g.attr("class","ticks_label").attr("transform",function(c){return a+=c.percentValue,e=b.width/3+b.width/4+10,f=((a-c.percentValue)*b.height/100+a*b.height/100)/2+5,"translate("+e+","+f+")"}),g.text("").transition().delay(b.transitions.duration()).text(function(a){return this.getBBox().height<a.percentValue*b.height/100-15?a.name:""}).attr("font-size",b.ticks.size).attr("text-anchor","start").attr("fill",b.ticks.color).attr("font-family",b.ticks.family).attr("pointer-events","none"),g.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){var a=[];if(0!==b.clubData.alwaysIncludeDataPoints.length){var c=b.clubData.alwaysIncludeDataPoints.length;for(i=0;c>i;i++)a[i]=b.clubData.alwaysIncludeDataPoints[i]}for(b.newData=[],i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&b.newData.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var d=0;b.newData.length<b.clubData.maximumNodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;b.newData.push(b.data[d]),d++}var e=0;for(j=d;j<b.data.length;j++){for(i=0;i<b.newData.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===b.newData[i].name.toUpperCase()&&(e+=0,j++,i=-1);j<b.data.length&&(e+=b.data[j].weight)}for(var f=function(a,b){return b.weight-a.weight};b.newData.length>b.clubData.maximumNodes;){b.newData.sort(f);{b.newData.pop()}}var g={name:b.clubData.text,weight:e,color:b.clubData.color,tooltip:b.clubData.tooltip};b.newData.length<b.clubData.maximumNodes&&b.newData.push(g),b.newData1=b.newData}else b.data.sort(function(a,b){return b.weight-a.weight}),b.newData1=b.data;return this}};return c}},PykCharts.oneD.pictograph=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a);var d=a.optional,e=c.oneDimensionalCharts;b.showActive=d&&d.pictograph&&d.pictograph.showActive?d.pictograph.showActive:e.pictograph.showActive,b.enableTotal=d&&d.pictograph&&d.pictograph.enableTotal?d.pictograph.enableTotal:e.pictograph.enableTotal,b.enableCurrent=d&&d.pictograph&&d.pictograph.enableCurrent?d.pictograph.enableCurrent:e.pictograph.enableCurrent,b.imgperline=d&&d.pictograph&&d.pictograph.imagePerLine?d.pictograph.imagePerLine:e.pictograph.imagePerLine,d&&d.pictograph&&d.pictograph.activeText?(b.activeText=d.pictograph.activeText,b.activeText.size=d.pictograph.activeText.size?d.pictograph.activeText.size:e.pictograph.activeText.size,b.activeText.color=d.pictograph.activeText.color?d.pictograph.activeText.color:e.pictograph.activeText.color,b.activeText.weight=d.pictograph.activeText.weight?d.pictograph.activeText.weight:e.pictograph.activeText.weight,b.activeText.family=d.pictograph.activeText.family?d.pictograph.activeText.family:e.pictograph.activeText.family):b.activeText=e.pictograph.activeText,d&&d.pictograph&&d.pictograph.inactiveText?(b.inactiveText=d.pictograph.inactiveText,b.inactiveText.size=d.pictograph.inactiveText.size?d.pictograph.inactiveText.size:e.pictograph.inactiveText.size,b.inactiveText.color=d.pictograph.inactiveText.color?d.pictograph.inactiveText.color:e.pictograph.inactiveText.color,b.inactiveText.weight=d.pictograph.inactiveText.weight?d.pictograph.inactiveText.weight:e.pictograph.inactiveText.weight,b.inactiveText.family=d.pictograph.inactiveText.family?d.pictograph.inactiveText.family:e.pictograph.inactiveText.family):b.inactiveText=e.pictograph.inactiveText,b.imageWidth=d&&d.pictograph&&d.pictograph.imageWidth?d.pictograph.imageWidth:e.pictograph.imageWidth,b.imageHeight=d&&d.pictograph&&d.pictograph.imageHeight?d.pictograph.imageHeight:e.pictograph.imageHeight,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d,$(a.selector+" #chart-loader").remove(),b.render()})},this.render=function(){b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode&&(b.k.title(),b.k.subtitle());b.optionalFeatures().svgContainer().createPictograph().labelText().enableLabel();"default"===b.mode&&b.k.credits().dataSource()},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(a.selector).append("svg").attr("width",b.width).attr("height",b.height),b.group=b.svg.append("g").attr("transform","translate("+b.imageWidth+",0)"),b.group1=b.svg.append("g").attr("transform","translate(0,"+b.imageHeight+")"),this},createPictograph:function(){var a=1,c=1;b.optionalFeatures().showActive();for(var d=0,e=1;e<=b.size;e++)e<=b.data[1].size?b.group.append("image").attr("xlink:href",b.data[1].img).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"):b.group.append("image").attr("xlink:href",b.data[0].img).attr("x",c*(b.imageWidth+1)).attr("y",a*(b.imageHeight+10)).attr("width",0).attr("height",b.imageHeight+"px").transition().duration(b.transitions.duration()).attr("width",b.imageWidth+"px"),d++,c++,d>=b.imgperline&&(a++,c=1,d=0,b.group.append("text").html("<br><br>"));return this},showActive:function(){return b.size=PykCharts.boolean(b.showActive)?b.data[0].size:b.data[1].size,this},enableLabel:function(){if(PykCharts.boolean(b.enableTotal)){var a;this.labelText(),b.group1.append("text").attr("font-family",b.inactiveText.family).attr("font-size",b.inactiveText.size).attr("fill",b.inactiveText.color).text("/"+b.data[0].size).text(function(){return a=this.getBBox().height,"/"+b.data[0].size}).attr("x",b.textWidth+5).attr("y",b.height/2-a)}return this},labelText:function(){if(PykCharts.boolean(b.enableCurrent)){var a;b.group1.append("text").attr("x",0).attr("font-family",b.activeText.family).attr("font-size",b.activeText.size).attr("fill",b.activeText.color).text(b.data[1].size).text(function(){return a=this.getBBox().height,b.textWidth=this.getBBox().width,b.data[1].size}).attr("y",b.height/2-a)}return this}};return c}},PykCharts.oneD.pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.optional&&a.optional.pie&&_.isNumber(a.optional.pie.radiusPercent)?a.optional.pie.radiusPercent:c.oneDimensionalCharts.pie.radiusPercent,b.innerRadiusPercent=0,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"pie");b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",e.render()})}},PykCharts.oneD.donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.optional&&a.optional.donut&&_.isNumber(a.optional.donut.radiusPercent)?a.optional.donut.radiusPercent:c.oneDimensionalCharts.donut.radiusPercent,b.innerRadiusPercent=a.optional&&a.optional.donut&&_.isNumber(a.optional.donut.innerRadiusPercent)&&a.optional.donut.innerRadiusPercent?a.optional.donut.innerRadiusPercent:c.oneDimensionalCharts.donut.innerRadiusPercent,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"donut");b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",e.render()})}},PykCharts.oneD.election_pie=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.optional&&a.optional.pie&&_.isNumber(a.optional.pie.radiusPercent)?a.optional.pie.radiusPercent:c.oneDimensionalCharts.pie.radiusPercent,b.innerRadiusPercent=0,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election pie");b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",e.render()})}},PykCharts.oneD.election_donut=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.oneD.processInputs(b,a,"pie"),b.radiusPercent=a.optional&&a.optional.donut&&_.isNumber(a.optional.donut.radiusPercent)?a.optional.donut.radiusPercent:c.oneDimensionalCharts.donut.radiusPercent,b.innerRadiusPercent=a.optional&&a.optional.donut&&_.isNumber(a.optional.donut.innerRadiusPercent)&&a.optional.donut.innerRadiusPercent?a.optional.donut.innerRadiusPercent:c.oneDimensionalCharts.donut.innerRadiusPercent,d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove();var e=new PykCharts.oneD.pieFunctions(a,b,"election donut");b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",e.render()})}},PykCharts.oneD.pieFunctions=function(a,b,c){var d=b;d.refresh=function(){d3.json(a.data,function(a,b){d.data=b.groupBy("oned"),d.optionalFeatures().createPie().label().ticks().centerLabel()})},this.render=function(){if(d.count=1,d.fillChart=new PykCharts.oneD.fillChart(d),d.onHoverEffect=new PykCharts.oneD.mouseEvent(a),d.border=new PykCharts.Configuration.border(d),d.transitions=new PykCharts.Configuration.transition(d),"default"==d.mode.toLowerCase()){d.k.title().subtitle(),d.optionalFeatures().svgContainer(),d.chartData=d.optionalFeatures().clubData(),d.k.credits().dataSource().tooltip(),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d);{d.optionalFeatures().set_start_end_angle().createPie().label().ticks().centerLabel()}d.k.liveData(d)}else"infographics"==d.mode.toLowerCase()&&(d.chartData=d.data,d.optionalFeatures().svgContainer().set_start_end_angle().createPie().label(),d.k.tooltip(),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d))},d.optionalFeatures=function(){var b={svgContainer:function(){return $(a.selector).css("background-color",d.bg),d.svgContainer=d3.select(d.selector).append("svg").attr("width",d.width).attr("height",d.height).attr("id","container").attr("class","svgcontainer"),d.group=d.svgContainer.append("g").attr("transform","translate("+d.width/2+","+(d.k._radiusCalculation(d.radiusPercent)+20)+")").attr("id","pieGroup"),this},createPie:function(){if(d3.select(a.selector+" #pieGroup").node().innerHTML="","pie"==c.toLowerCase()||"donut"==c.toLowerCase()){d.chartData.sort(function(a,b){return a.weight-b.weight});var b=d.chartData.pop();d.chartData.unshift(b)}else("election pie"==c.toLowerCase()||"election donut"==c.toLowerCase())&&d.chartData.sort(function(a,b){return b.weight-a.weight});d.sum=_.reduce(d.data,function(a,b){return a+b.weight},0),d.sorted_weight=_.map(d.chartData,function(a){return 100*a.weight/d.sum}),d.sorted_weight.sort(function(a,b){return a-b});_.map(d.chartData,function(a){return 100*a.weight/d.sum});d.innerRadius=d.k._radiusCalculation(d.innerRadiusPercent),d.radius=d.k._radiusCalculation(d.radiusPercent),d.arc=d3.svg.arc().innerRadius(d.innerRadius).outerRadius(d.radius),d.pie=d3.layout.pie().value(function(a){return a.weight}).sort(null).startAngle(d.startAngle).endAngle(d.endAngle);var e=d.group.selectAll("path").data(d.pie(d.chartData));return e.enter().append("path"),e.attr("class","pie"),e.attr("fill",function(a){return d.fillChart.chartColor(a.data)}).on("mouseover",function(b){b.data.tooltip=b.data.tooltip||"<table class='PykCharts'><tr><th colspan='3' class='tooltip-heading'>"+b.data.name+"</tr><tr><td class='tooltip-left-content'>"+d.k.appendUnits(b.data.weight)+"<td class='tooltip-right-content'>( "+(100*b.data.weight/d.sum).toFixed(2)+"% ) </tr></table>",d.onHoverEffect.highlight(a.selector+" .pie",this),d.mouseEvent.tooltipPosition(b),d.mouseEvent.toolTextShow(b.data.tooltip)}).on("mouseout",function(b){d.onHoverEffect.highlightHide(a.selector+" .pie"),d.mouseEvent.tooltipHide(b)}).on("mousemove",function(a){d.mouseEvent.tooltipPosition(a)}).attr("stroke",d.border.color()).attr("stroke-width",d.border.width()),e.transition().delay(function(a,b){return d.transition.duration&&"default"==d.mode?b*d.transition.duration/d.chartData.length:0}).duration(d.transitions.duration()/d.chartData.length).attrTween("d",function(a){var b=d3.interpolate(a.startAngle,a.endAngle);return function(c){return a.endAngle=b(c),d.arc(a)}}),e.exit().remove(),this},label:function(){var a=d.group.selectAll("text").data(d.pie(d.chartData));return a.enter().append("text").attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),a.attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),a.text("").transition().delay(function(a,b){return PykCharts.boolean(d.transition.duration)?b*d.transition.duration/d.chartData.length:0}),a.text(function(a){return d.k.appendUnits(a.data.weight)}).attr("text-anchor","middle").attr("pointer-events","none").text(function(a){return"pie"===c.toLowerCase()||"election pie"===c.toLowerCase()?this.getBBox().width<(a.endAngle-a.startAngle)*(d.radius/2)*.9?d.k.appendUnits(a.data.weight):"":this.getBBox().width<Math.abs(a.endAngle-a.startAngle)*d.radius*.9&&this.getBBox().height<.75*(d.radius-d.innerRadius)?d.k.appendUnits(a.data.weight):""}).attr("dy",5).style("font-weight",d.label.weight).style("font-size",d.label.size).attr("fill",d.label.color).style("font-family",d.label.family),a.exit().remove(),this},clubData:function(){if(PykCharts.boolean(d.clubData.enable)){d.displayData=[],d.maximum_weight=_.map(d.data,function(a){return a.weight}),d.maximum_weight.sort(function(a,b){return b-a}),d.checkDuplicate=[];var a,b,c={name:d.clubData.text,color:d.clubData.color,tooltip:d.clubData.tooltipText,highlight:!1};d.getIndexByName=function(a){for(b=0;b<d.data.length;b++)if(d.data[b].name==a)return b};var e=function(a){var b=_.reject(d.maximum_weight,function(b){return b==d.data[a].weight});return b};if(0!==d.clubData.alwaysIncludeDataPoints.length)for(var f=0;f<d.clubData.alwaysIncludeDataPoints.length;f++)a=d.getIndexByName(d.clubData.alwaysIncludeDataPoints[f]),void 0!=a&&(d.displayData.push(d.data[a]),d.maximum_weight=e(a));d.getIndexByWeight=function(a){for(var b=0;b<d.data.length;b++)if(d.data[b].weight!=a);else if(_.contains(d.checkDuplicate,b)===!1)return d.checkDuplicate.push(b),b};var g=d.clubData.maximumNodes-d.displayData.length,h=d3.sum(d.maximum_weight,function(a,b){return b>=g-1?a:void 0});if(c.weight=h,g>0)for(d.displayData.push(c),b=0;g-1>b;b++)a=d.getIndexByWeight(d.maximum_weight[b]),d.displayData.push(d.data[a])}else d.displayData=d.data;return d.displayData},ticks:function(){PykCharts.boolean(d.overflowTicks)&&d.svgContainer.style("overflow","visible");var a=d.group.selectAll("line").data(d.pie(d.chartData));a.enter().append("line").attr("class","ticks"),a.attr("x1",function(a){return 1*d.radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y1",function(a){return 1*d.radius*Math.sin((a.endAngle+a.startAngle)/2)}).attr("x2",function(a){return 1*d.radius*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*d.radius*Math.sin((a.endAngle+a.startAngle)/2)}).transition().delay(function(a,b){return PykCharts.boolean(d.transition.duration)?b*d.transition.duration/d.chartData.length:0}).duration(d.transitions.duration()/d.chartData.length).attr("x2",function(a){return 1*(d.radius/1+12)*Math.cos((a.startAngle+a.endAngle)/2)}).attr("y2",function(a){return 1*(d.radius/1+12)*Math.sin((a.endAngle+a.startAngle)/2)}).attr("transform","rotate(-90)").attr("stroke-width",d.ticks.strokeWidth).attr("stroke",d.ticks.color),a.exit().remove();var b=d.group.selectAll(".ticks_label").data(d.pie(d.chartData));b.attr("class","ticks_label"),b.enter().append("text").attr("x",0).attr("y",0);var c,e;return b.attr("transform",function(a){return a.endAngle-a.startAngle<.2?(c=1*(d.radius+30)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),e=1*(d.radius/1+20)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)):(c=1*(d.radius+22)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),e=1*(d.radius/1+24)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)),"translate("+c+","+e+")"}),b.text("").transition().delay(function(a,b){return PykCharts.boolean(d.transition.duration)?(b+1)*d.transition.duration/d.chartData.length:0}).text(function(a){return a.data.name}).attr("text-anchor",function(a){var b=(a.endAngle-a.startAngle)/2+a.startAngle;return b>0&&1.5>b?"start":b>=1.5&&3.5>b?"middle":b>=3.5&&6>b?"end":b>=6?"middle":0>b?"middle":void 0}).attr("dy",5).attr("pointer-events","none").style("fill",d.ticks.color).style("font-size",d.ticks.size).style("font-family",d.ticks.family),b.exit().remove(),this},centerLabel:function(){if(PykCharts.boolean(d.showTotalAtTheCenter)&&("donut"==c||"election donut"==c)){var b=d.group.selectAll(a.selector+" .centerLabel").data([d.sum]);b.enter().append("text"),b.attr("class","centerLabel").text("").transition().delay(function(){return PykCharts.boolean(d.transition.duration)?d.transition.duration:void 0}),b.text(function(){return d.k.appendUnits(d.sum)}).attr("pointer-events","none").attr("text-anchor","middle").attr("y",function(){return"donut"==c?.2*d.innerRadius:-.25*d.innerRadius}).attr("font-size",function(){return"donut"==c?.4*d.innerRadius:.2*d.innerRadius}).style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("fill","#484848"),b.exit().remove()}return this},set_start_end_angle:function(){return d.startAngle,d.endAngle,"pie"==c||"donut"==c?(d.startAngle=0*(Math.PI/180),d.endAngle=360*(Math.PI/180)):("election pie"==c||"election donut"==c)&&(d.startAngle=-90*(Math.PI/180),d.endAngle=90*(Math.PI/180)),this}};return b}},PykCharts.oneD.pyramid=function(a){{var c=this;new PykCharts.Configuration.Theme({})}this.execute=function(){c=new PykCharts.oneD.processInputs(c,a,"pyramid"),"default"===c.mode&&c.k.loading(),d3.json(a.data,function(b,d){c.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),c.clubData.enable=c.data.length>c.clubData.maximumNodes?c.clubData.enable:"no",c.render()})},this.refresh=function(){d3.json(a.data,function(a,b){c.data=b.groupBy(),c.optionalFeatures().createChart().label().ticks()})},this.render=function(){if(c.fillChart=new PykCharts.oneD.fillChart(c),c.mouseEvent1=new PykCharts.oneD.mouseEvent(a),c.transitions=new PykCharts.Configuration.transition(c),c.border=new PykCharts.Configuration.border(c),"default"===c.mode){c.k.title(),c.k.subtitle(),c.chartData=c.optionalFeatures().clubData();{c.optionalFeatures().svgContainer().createChart().label().ticks()}c.k.credits().dataSource().tooltip().liveData(c),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c)}else"infographics"===c.mode&&(c.chartData=c.data,c.optionalFeatures().svgContainer().createChart().label(),c.k.tooltip(),c.mouseEvent=new PykCharts.Configuration.mouseEvent(c))},this.percentageValues=function(a){var b=d3.sum(a,function(a){return a.weight}),c=a.map(function(a){return a.weight/b*100});return c.sort(function(a,b){return b-a}),c},this.pyramidLayout=function(){var a,b,d={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},coordinates:function(){function d(a){return d3.sum(h,function(b,c){return c>=a?b:void 0})}for(var e=b[0],f=b[1],g=e/2/f,h=c.percentageValues(a),i=[],j=e*f/2,k=0;k<a.length;k++){var l=d(k),m=l/100*j,n=Math.sqrt(m/g),o=2*g*n,p=(e-o)/2;i[k]=0===k?{values:[{x:e/2,y:0},{x:p,y:n},{x:o+p,y:n}]}:{values:[i[k-1].values[1],{x:p,y:n},{x:o+p,y:n},i[k-1].values[2]]}}return i}};return d},this.optionalFeatures=function(){var d={svgContainer:function(){return $(a.selector).css("background-color",c.bg),c.svg=d3.select(a.selector).append("svg").attr("width",c.width).attr("height",c.height).attr("id","svgcontainer").attr("class","svgcontainer"),c.group=c.svg.append("g").attr("id","pyrgrp"),this},createChart:function(){c.perValues=c.percentageValues(c.chartData);var d=c.pyramidLayout().data(c.chartData).size([c.width,c.height]),e=d3.sum(c.chartData,function(a){return a.weight});c.coordinates=d.coordinates(),c.coordinates[0].values[1]=c.coordinates[c.coordinates.length-1].values[1],c.coordinates[0].values[2]=c.coordinates[c.coordinates.length-1].values[2];
var f=c.chartData.length-1,g=(c.chartData.length-1,[]);for(i=0;i<c.chartData.length;i++)0==i?g[i]=c.chartData[i].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.chartData[i].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.chartData[i].weight)+"<td class='tooltip-right-content'>( "+(100*c.chartData[i].weight/e).toFixed(2)+"% ) </tr></table>":(g[i]=c.chartData[f].tooltip||"<table class='PykCharts'><tr><th colspan='3'  class='tooltip-heading'>"+c.chartData[f].name+"</tr><tr><td class='tooltip-left-content'>"+c.k.appendUnits(c.chartData[f].weight)+"<td class='tooltip-right-content'>( "+(100*c.chartData[f].weight/e).toFixed(2)+"% ) </tr></table>",f--);c.line=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});var h=[{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height},{x:0,y:c.height},{x:c.width,y:c.height}],f=c.chartData.length,j=c.group.selectAll(".pyr-path").data(c.coordinates);return j.enter().append("path"),j.attr("class","pyr-path").attr("d",function(){return c.line(h)}).attr("stroke",c.border.color()).attr("stroke-width",c.border.width()).attr("fill",function(a,d){return 0===d?b=c.chartData[d]:(f--,b=c.chartData[f]),c.fillChart.chartColor(b)}).on("mouseover",function(b,d){c.mouseEvent1.highlight(a.selector+" .pyr-path",this),c.mouseEvent.tooltipPosition(b),c.mouseEvent.toolTextShow(g[d])}).on("mouseout",function(b){c.mouseEvent1.highlightHide(a.selector+" .pyr-path"),c.mouseEvent.tooltipHide(b)}).on("mousemove",function(a){c.mouseEvent.tooltipPosition(a)}).transition().duration(c.transitions.duration()).attr("d",function(a){return c.line(a.values)}),j.exit().remove(),this},label:function(){var a=c.chartData.length,b=c.chartData.length,d=c.group.selectAll("text").data(c.coordinates);return d.enter().append("text"),d.attr("y",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2+10}).attr("x",function(){return c.width/2}).text("").transition().delay(c.transitions.duration()),d.text(function(b,d){return 0===d?c.k.appendUnits(c.chartData[d].weight):(a--,c.k.appendUnits(c.chartData[a].weight))}).text(function(a,d){return this.getBBox().width<a.values[2].x-a.values[1].x||this.getBBox().height<a.values[1].y-a.values[0].y?0===d?c.k.appendUnits(c.chartData[d].weight):(b--,c.k.appendUnits(c.chartData[b].weight)):""}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",c.label.weight).style("font-size",c.label.size).attr("fill",c.label.color).style("font-family",c.label.family),d.exit().remove(),this},ticks:function(){PykCharts.boolean(c.overflowTicks)&&c.svg.style("overflow","visible");var a=c.group.selectAll(".pyr-ticks").data(c.coordinates),b=c.chartData.length;a.enter().append("line").attr("class","pyr-ticks"),a.attr("x1",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y1",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("x2",function(a){return 3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}).attr("y2",function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2}).attr("stroke-width",c.ticks.strokeWidth).attr("stroke",c.ticks.color).transition().duration(c.transitions.duration()).attr("x2",function(a){return Math.abs(a.values[0].y-a.values[1].y)>15?3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+20:(a.values[2].x+a.values[3].x)/2+20:3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2}),a.exit().remove();var d=c.group.selectAll(".ticks_label").data(c.coordinates);d.enter().append("text").attr("x",0).attr("y",0).attr("class","ticks_label");var e,f,g=c.chartData.length;return d.attr("transform",function(a){return e=3===a.values.length?(a.values[0].x+c.coordinates[c.coordinates.length-1].values[2].x)/2+30:(a.values[2].x+a.values[3].x)/2+30,f=4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+c.coordinates[c.coordinates.length-1].values[1].y)/2,"translate("+e+","+(f+5)+")"}),d.text("").transition().delay(c.transitions.duration()),d.text(function(a,d){return 0===d?c.chartData[d].name:(b--,c.chartData[b].name)}).text(function(a,b){return 0===b?this.getBBox().height<a.values[1].y-a.values[0].y?c.chartData[b].name:"":this.getBBox().height<a.values[0].y-a.values[1].y?(g--,c.chartData[g].name):""}).style("fill",c.ticks.color).style("font-size",c.ticks.size).style("font-family",c.ticks.family).attr("text-anchor","start"),d.exit().remove(),this},clubData:function(){if(PykCharts.boolean(c.clubData.enable)){c.displayData=[],c.maximum_weight=_.map(c.data,function(a){return a.weight}),c.maximum_weight.sort(function(a,b){return b-a}),c.checkDuplicate=[];var a,b,d={name:c.clubData.text,color:c.clubData.color,tooltip:c.clubData.tooltipText,highlight:!1};c.getIndexByName=function(a){for(b=0;b<c.data.length;b++)if(c.data[b].name==a)return b};var e=function(a){var b=_.reject(c.maximum_weight,function(b){return b==c.data[a].weight});return b};if(0!==c.clubData.alwaysIncludeDataPoints.length)for(b=0;b<c.clubData.alwaysIncludeDataPoints.length;b++)a=c.getIndexByName(c.clubData.alwaysIncludeDataPoints[b]),c.displayData.push(c.data[a]),c.maximum_weight=e(a);c.getIndexByWeight=function(a){for(var b=0;b<c.data.length;b++)if(c.data[b].weight!=a);else if(_.contains(c.checkDuplicate,b)===!1)return c.checkDuplicate.push(b),b};var f=c.clubData.maximumNodes-c.displayData.length;if(f>0)for(c.displayData.push(d),b=0;f-1>b;b++)a=c.getIndexByWeight(c.maximum_weight[b]),c.displayData.push(c.data[a]);var g=d3.sum(c.maximum_weight,function(a,b){return b>=f-1?a:void 0});d.weight=g}else c.displayData=c.data;return c.displayData.sort(function(a,b){return a.weight-b.weight}),c.displayData}};return d}},PykCharts.oneD.treemap=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=new PykCharts.oneD.processInputs(b,a),optional=a.optional,b.selector=a.selector,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(c,d){b.data=d.groupBy("oned"),$(a.selector+" #chart-loader").remove(),b.clubData.enable=b.data.length>b.clubData.maximumNodes?b.clubData.enable:"no",b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy(),b.optionalFeatures().clubData().createChart().label()})},this.render=function(){if(b.fillChart=new PykCharts.oneD.fillChart(b),b.mouseEvent1=new PykCharts.oneD.mouseEvent(a),b.transitions=new PykCharts.Configuration.transition(b),b.border=new PykCharts.Configuration.border(b),"default"===b.mode&&(b.k.title(),b.k.subtitle()),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"infographics"===b.mode&&(b.new_data1={children:b.data}),"default"===b.mode){b.optionalFeatures().clubData()}b.optionalFeatures().svgContainer().createChart().label(),"default"===b.mode&&b.k.liveData(b).credits().dataSource()},this.optionalFeatures=function(){var c={svgContainer:function(){return $(a.selector).css("background-color",b.bg),b.svg=d3.select(b.selector).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer"),b.group=b.svg.append("g").attr("id","treemap"),this},createChart:function(){b.treemap=d3.layout.treemap().sort(function(a,b){return a.weight-b.weight}).size([b.width,b.height]).value(function(a){return a.weight}).sticky(!1);var c,d,e=d3.sum(b.new_data1.children,function(a){return a.weight});return b.node=b.treemap.nodes(b.new_data1),c=b.new_data1.children.length,b.max=b.new_data1.children[c-1].weight,b.map1=b.new_data1.children.map(function(a){return a.weight}),b.map1=jQuery.unique(b.map1),b.treemap_data=b.group.selectAll(".cell").data(b.node),d=b.treemap_data.enter().append("svg:g").attr("class","cell").append("svg:rect").attr("class","treemap-rect"),b.treemap_data.attr("class","cell").select("rect").attr("class","treemap-rect").attr("id",function(a,b){return b}).attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("width",function(a){return a.dx-1}).attr("height",0).attr("fill",function(a){return a.children?"white":b.fillChart.chartColor(a)}).on("mouseover",function(c){c.children||(c.tooltip=c.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+c.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(c.weight)+"<td class='tooltip-right-content'>(&nbsp;"+(100*c.weight/e).toFixed(2)+"%&nbsp;)</tr></table>",b.mouseEvent1.highlight(a.selector+" .treemap-rect",this),b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip))}).on("mouseout",function(c){c.weight/b.max;b.mouseEvent.tooltipHide(c),b.mouseEvent1.highlightHide(a.selector+" .treemap-rect")}).on("mousemove",function(a){a.children||b.mouseEvent.tooltipPosition(a)}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.dy-1}),b.treemap_data.exit().remove(),this},label:function(){return b.treemap_text=b.group.selectAll(".name").data(b.node),b.treemap_text1=b.group.selectAll(".weight").data(b.node),b.treemap_text.enter().append("svg:text").attr("class","name"),b.treemap_text1.enter().append("svg:text").attr("class","weight"),b.treemap_text.attr("class","name").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2}),b.treemap_text1.attr("class","weight").attr("x",function(a){return a.x+a.dx/2}).attr("y",function(a){return a.y+a.dy/2+15}),b.treemap_text.attr("text-anchor","middle").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text("").transition().delay(b.transitions.duration()),b.treemap_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":a.name:""}),b.treemap_text1.attr("text-anchor","middle").style("font-weight",b.label.weight).style("font-size",b.label.size).attr("fill",b.label.color).style("font-family",b.label.family).text("").attr("pointer-events","none").transition().delay(b.transitions.duration()),b.treemap_text1.text(function(a){return a.children?" ":b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":b.k.appendUnits(a.weight):""}),b.treemap_text.exit().remove(),b.treemap_text1.exit().remove(),this},clubData:function(){if(PykCharts.boolean(b.clubData.enable)){var a=[],c=0,d=0;if(b.data.length<=b.clubData.maximumNodes)return b.new_data1={children:b.data},this;if(0!==b.clubData.alwaysIncludeDataPoints.length){var e=b.clubData.alwaysIncludeDataPoints.length;for(i=0;e>i;i++)a[i]=b.clubData.alwaysIncludeDataPoints[i]}for(b.new_data=[],i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&b.new_data.push(b.data[j]);for(b.data.sort(function(a,b){return b.weight-a.weight});b.new_data.length<b.clubData.maximumNodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;b.new_data.push(b.data[d]),d++}for(j=d;j<b.data.length;j++){for(i=0;i<b.new_data.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===b.new_data[i].name.toUpperCase()&&(c+=0,j++,i=-1);j<b.data.length&&(c+=b.data[j].weight)}for(var f=function(a,b){return b.weight-a.weight};b.new_data.length>b.clubData.maximumNodes;){b.new_data.sort(f);{b.new_data.pop()}}var g={name:b.clubData.text,weight:c,color:b.clubData.color,tooltip:b.clubData.tooltip};b.new_data.length<b.clubData.maximumNodes&&b.new_data.push(g),b.new_data1={children:b.new_data}}else b.new_data1={children:b.data};return this}};return c}},PykCharts.multiD={};var theme=new PykCharts.Configuration.Theme({});PykCharts.multiD.configuration=function(a){var b=this,c=new PykCharts.Configuration.fillChart(a),d={magnify:function(a,b,c){b.on("mousemove",function(){var b=d3.mouse(this);c.focus(b[0]),a.attr("x",function(a){return c(a.x)}).attr("width",function(a){return c.rangeBand(a.x)})})},opacity:function(b,c,d){if(PykCharts.boolean(a.size.enable))return.6;var e=d3.scale.linear().domain(d3.extent(d,function(a){return a.weight})).range([.1,1]);return e(b?b:_.min(c))},legendsPosition:function(a){return status?a.optionalFeatures().legendsContainer().svgContainer():a.optionalFeatures().svgContainer(),this},legends:function(d,e,f,g){if(status){var h=0,i=0;if(h=d.length,i=d.length,"vertical"===a.optional.legends.display){g.attr("height",30*d.length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,l=function(){return a.optional.chart.width-75},m=function(){return a.optional.chart.width-100};var j=function(a,b){return 24*b+12},k=function(a,b){return 24*b+26}}if("horizontal"===a.optional.legends.display){g.attr("height",70),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var l=function(){return h--,a.optional.chart.width-(100*h+75)};k=30,rect_parameter1value=13,rect_parameter2value=13;var m=function(){return i--,a.optional.chart.width-(100*i+100)};j=18}b.legends_text=e.selectAll(".legends_text").data(d),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif"),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,l).attr(text_parameter2,k).text(function(a){return a}),b.legends_text.exit().remove(),b.legends_rect=e.selectAll(".legends_rect").data(d),b.legends_rect.enter().append("rect").attr("class","legends_rect"),b.legends_rect.attr("class","legends_rect").attr("fill",function(a,b){return c(f[b])}).attr("fill-opacity",function(b,c){return"yes"===a.optional.saturation.enable?(c+1)/d.length:1}).attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,m).attr(rect_parameter4,j),b.legends_rect.exit().remove()}return this},legendsGroupStacked:function(b,c,d,e){if(status){var f,g,h,k=0,l=[];for(i=0;i<d.length;i++)for(j=0;j<d[i].length;j++)l[k]=d[i][j],k++;g=l.length,f=l.length,h=-1,b.attr("height",90);var m=c.selectAll(".legends_g").data(d).enter().append("g").attr("class","legends_g").attr("fill",function(){return h++,e[h]});m.selectAll(".legends_rect").data(d[h]).enter().append("rect").attr("class","legends_rect").attr("x",function(){return f--,a.optional.chart.width-(80*f+75)}).attr("y",20).attr("height",13).attr("width",13).attr("fill-opacity",function(b,c){return"yes"===a.optional.saturation.enable?(d[c].length-c)/d[c].length:1}),c.selectAll(".legends_text").data(l).enter().append("text").attr("class","legends_text").attr("pointer-events","none").attr("x",function(){return g--,a.optional.chart.width-(80*g+55)}).attr("y",32).attr("fill","#1D1D1D").attr("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").text(function(a){return a})}return this},mapGroup:function(b){var c=[],d={},e=0,f=!0,g=!0;if(b.forEach(function(b){b.group?f=!0:(f=!1,b.color||(g=!1,b.color=a.colorPalette[0]))}),f){b.forEach(function(b){d[b.group]||(b.color||(b.color=a.colorPalette[e],e++),c.push(b),d[b.group]=b)});var h=[],i={};e=0,c.forEach(function(b){i[b.color]?(b.color=a.colorPalette[e],e++,h.push(b),i[b.color]=b):(h.push(b),i[b.color]=b)});for(var j=h.length,k=b.length,l=0;j>l;l++)for(var m=0;k>m;m++)b[m].group===h[l].group&&(b[m].color=h[l].color);return[h,f]}return[b,f]}};return d},PykCharts.multiD.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.multiD.bubbleSizeCalculation=function(a,b,c){var d=function(d){if(d&&PykCharts.boolean(a.size.enable)){var e=d3.scale.linear().domain(d3.extent(b,function(a){return a.weight})).range(c);return e(d)}return a.bubbleRadius};return d},PykCharts.multiD.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.multiDimensionalCharts,f=b.optional;if(a.yAxisDataFormat=b.yAxisDataFormat?b.yAxisDataFormat:e.yAxisDataFormat,a.xAxisDataFormat=b.xAxisDataFormat?b.xAxisDataFormat:e.xAxisDataFormat,a.selector=b.selector?b.selector:"body",a.width=f&&f.chart&&_.isNumber(f.chart.width)?f.chart.width:d.chart.width,a.height=f&&f.chart&&_.isNumber(f.chart.height)?f.chart.height:d.chart.height,a.margin=f&&f.chart&&f.chart.margin?f.chart.margin:d.chart.margin,a.margin.left=f&&f.chart&&f.chart.margin&&_.isNumber(f.chart.margin.left)?f.chart.margin.left:d.chart.margin.left,a.margin.right=f&&f.chart&&f.chart.margin&&_.isNumber(f.chart.margin.right)?f.chart.margin.right:d.chart.margin.right,a.margin.top=f&&f.chart&&f.chart.margin&&_.isNumber(f.chart.margin.top)?f.chart.margin.top:d.chart.margin.top,a.margin.bottom=f&&f.chart&&f.chart.margin&&_.isNumber(f.chart.margin.bottom)?f.chart.margin.bottom:d.chart.margin.bottom,a.grid=f&&f.chart&&f.chart.grid?f.chart.grid:d.chart.grid,a.grid.xEnabled=f&&f.chart&&f.chart.grid?f.chart.grid.xEnabled:d.chart.grid.xEnabled,a.grid.yEnabled=f&&f.chart&&f.chart.grid?f.chart.grid.yEnabled:d.chart.grid.yEnabled,a.grid.color=f&&f.chart&&f.chart.grid?f.chart.grid.color:d.chart.grid.color,a.mode=b.mode?b.mode:"default",f&&f.title?(a.title=f.title,a.title.size=f.title.size?f.title.size:d.title.size,a.title.color=f.title.color?f.title.color:d.title.color,a.title.weight=f.title.weight?f.title.weight:d.title.weight,a.title.family=f.title.family?f.title.family:d.title.family):a.title=d.title,f&&f.subtitle?(a.subtitle=f.subtitle,a.subtitle.size=f.subtitle.size?f.subtitle.size:d.subtitle.size,a.subtitle.color=f.subtitle.color?f.subtitle.color:d.subtitle.color,a.subtitle.weight=f.subtitle.weight?f.subtitle.weight:d.subtitle.weight,a.subtitle.family=f.subtitle.family?f.subtitle.family:d.subtitle.family):a.subtitle=d.subtitle,f&&f.axis?(a.axis=f.axis,a.axis.x=f.axis.x,a.axis.onHoverHighlightenable=PykCharts.boolean(f.axis.x.enable)&&f.axis.onHoverHighlightenable?f.axis.onHoverHighlightenable:e.axis.onHoverHighlightenable,a.axis.x.orient=PykCharts.boolean(f.axis.x.enable)&&f.axis.x.orient?f.axis.x.orient:e.axis.x.orient,a.axis.x.axisColor=PykCharts.boolean(f.axis.x.enable)&&f.axis.x.axisColor?f.axis.x.axisColor:e.axis.x.axisColor,a.axis.x.labelColor=PykCharts.boolean(f.axis.x.enable)&&f.axis.x.labelColor?f.axis.x.labelColor:e.axis.x.labelColor,a.axis.x.no_of_ticks=PykCharts.boolean(f.axis.x.enable)&&f.axis.x.no_of_ticks?f.axis.x.no_of_ticks:e.axis.x.no_of_ticks,a.axis.x.ticksPadding=PykCharts.boolean(f.axis.x.enable)&&f.axis.x.ticksPadding?f.axis.x.ticksPadding:e.axis.x.ticksPadding,a.axis.x.tickSize="tickSize"in f.axis.x&&PykCharts.boolean(f.axis.x.enable)?f.axis.x.tickSize:e.axis.x.tickSize,a.axis.x.tickFormat=PykCharts.boolean(f.axis.x.enable)&&f.axis.x.tickFormat?f.axis.x.tickFormat:e.axis.x.tickFormat,a.axis.x.tickValues=PykCharts.boolean(f.axis.x.enable)&&f.axis.x.tickValues?f.axis.x.tickValues:e.axis.x.tickValues,a.axis.x.outer_tick_size="outer_tick_size"in f.axis.x&&PykCharts.boolean(f.axis.x.enable)?f.axis.x.outer_tick_size:e.axis.x.outer_tick_size,a.axis.y=f.axis.y,a.axis.y.orient=PykCharts.boolean(f.axis.y.enable)&&f.axis.y.orient?f.axis.y.orient:e.axis.y.orient,a.axis.y.axisColor=PykCharts.boolean(f.axis.y.enable)&&f.axis.y.axisColor?f.axis.y.axisColor:e.axis.y.axisColor,a.axis.y.labelColor=PykCharts.boolean(f.axis.y.enable)&&f.axis.y.labelColor?f.axis.y.labelColor:e.axis.y.labelColor,a.axis.y.no_of_ticks=PykCharts.boolean(f.axis.y.enable)&&f.axis.y.no_of_ticks?f.axis.y.no_of_ticks:e.axis.y.no_of_ticks,a.axis.y.ticksPadding=PykCharts.boolean(f.axis.y.enable)&&f.axis.y.ticksPadding?f.axis.y.ticksPadding:e.axis.y.ticksPadding,a.axis.y.tickSize="tickSize"in f.axis.y&&PykCharts.boolean(f.axis.y.enable)?f.axis.y.tickSize:e.axis.y.tickSize,a.axis.y.tickFormat=PykCharts.boolean(f.axis.y.enable)&&f.axis.y.tickFormat?f.axis.y.tickFormat:e.axis.y.tickFormat,a.axis.y.outer_tick_size="outer_tick_size"in f.axis.y&&PykCharts.boolean(f.axis.y.enable)?f.axis.y.outer_tick_size:e.axis.y.outer_tick_size):a.axis=e.axis,f&&f.legends?(a.legends=f.legends,a.legends.enable=f.legends.enable&&f.legends.enable?f.legends.enable:e.legends.enable,a.legends.display=f.legends.display?f.legends.display:e.legends.display):a.legends=e.legends,a.saturationEnable=f&&f.saturation&&f.saturation.enable?f.saturation.enable:"no",a.saturationColor=f&&f.colors&&f.colors.saturationColor?f.colors.saturationColor:d.colors.saturationColor,a.realTimeCharts=f&&f.realTimeCharts?f.realTimeCharts:"no",a.transition=f&&f.transition?f.transition:"no",a.creditMySite=f&&f.creditMySite?f.creditMySite:d.creditMySite,a.dataSource=f&&f.dataSource?f.dataSource:d.dataSource,a.bg=f&&f.colors&&f.colors.backgroundColor?f.colors.backgroundColor:d.colors.backgroundColor,a.chartColor=f&&f.colors&&f.colors.chartColor?f.colors.chartColor:d.colors.chartColor,a.highlightColor=f&&f.colors&&f.colors.highlightColor?f.colors.highlightColor:d.colors.highlightColor,a.fullscreen=f&&f.buttons&&f.buttons.enableFullScreen?f.buttons.enableFullScreen:d.buttons.enableFullScreen,a.loading=f&&f.loading&&f.loading.animationGifUrl?f.loading.animationGifUrl:d.loading.animationGifUrl,f&&f.borderBetweenChartElements)switch(a.borderBetweenChartElements=f.borderBetweenChartElements,a.borderBetweenChartElements.width="width"in f.borderBetweenChartElements?f.borderBetweenChartElements.width:d.borderBetweenChartElements.width,a.borderBetweenChartElements.color=f.borderBetweenChartElements.color?f.borderBetweenChartElements.color:d.borderBetweenChartElements.color,a.borderBetweenChartElements.style=f.borderBetweenChartElements.style?f.borderBetweenChartElements.style:d.borderBetweenChartElements.style,a.borderBetweenChartElements.style){case"dotted":a.borderBetweenChartElements.style="1,3";break;case"dashed":a.borderBetweenChartElements.style="5,5";break;default:a.borderBetweenChartElements.style="0"}else a.borderBetweenChartElements=d.borderBetweenChartElements;return f&&f.ticks?(a.ticks=f.ticks,a.ticks.strokeWidth="strokeWidth"in f.ticks?f.ticks.strokeWidth:d.ticks.strokeWidth,a.ticks.weight=f.ticks.weight?f.ticks.weight:d.ticks.weight,a.ticks.size="size"in f.ticks?f.ticks.size:d.ticks.size,a.ticks.color=f.ticks.color?f.ticks.color:d.ticks.color,a.ticks.family=f.ticks.family?f.ticks.family:d.ticks.family):a.ticks=d.ticks,a.zoom=f&&f.zoom?f.zoom:e.zoom,a.zoom.enable=f&&f.zoom&&f.zoom.enable?f.zoom.enable:e.zoom.enable,f&&f.label?(a.label=f.label,a.label.size="size"in f.label?f.label.size:d.label.size,a.label.color=f.label.color?f.label.color:d.label.color,a.label.weight=f.label.weight?f.label.weight:d.label.weight,a.label.weight="thick"===a.label.weight?"bold":"normal",a.label.family=f.label.family?f.label.family:d.label.family):a.label=d.label,f&&f.legendsText?(a.legendsText=f.legendsText,a.legendsText.size=f.legendsText.size?f.legendsText.size:d.legendsText.size,a.legendsText.color=f.legendsText.color?f.legendsText.color:d.legendsText.color,a.legendsText.weight=f.legendsText.weight?f.legendsText.weight:d.legendsText.weight,a.legendsText.weight="thick"===a.legendsText.weight?"bold":"normal",a.legendsText.family=f.legendsText.family?f.legendsText.family:d.legendsText.family):a.legendsText=d.legendsText,a.units=f&&f.units?f.units:!1,a.size=f&&f.size?f.size:e.size,a.size.enable=f&&f.size&&f.size.enable?f.size.enable:e.size.enable,a.colorPalette=["#b2df8a","#1f78b4","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928","#a6cee3"],a.k=new PykCharts.Configuration(a),f&&f.tooltip?(a.tooltip=f.tooltip,a.tooltip.enable=f.tooltip.enable?f.tooltip.enable:e.tooltip.enable,a.tooltip.mode=f.tooltip.mode?f.tooltip.mode:e.tooltip.mode):a.tooltip=e.tooltip,a},PykCharts.multiD.lineChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"line"),"default"===b.mode&&b.k.loading();var d=c.multiDimensionalCharts,e=(c.stylesheet,a.optional);b.enableCrossHair=e&&e.enableCrossHair?e.enableCrossHair:d.enableCrossHair,b.curvy_lines=e&&e.curvy_lines?e.curvy_lines:d.curvy_lines,b.multiple_containers=e&&e.multiple_containers&&e.multiple_containers.enable?e.multiple_containers.enable:d.multiple_containers.enable,b.interpolate=PykCharts.boolean(b.curvy_lines)?"cardinal":"linear",b.color_from_data=e&&e.line&&e.line.color_from_data?e.line.color_from_data:d.line.color_from_data,d3.json(a.data,function(a,c){b.data=c.groupBy("line"),b.data_length=b.data.length,b.dataTransform(),$(b.selector+" #chart-loader").remove(),b.render()})},this.dataTransform=function(){for(b.group_arr=[],b.color_arr=[],b.new_data=[],b.dataLineGroup=[],b.dataTextGroup=[],b.dataLineGroupBorder=[],j=0;j<b.data_length;j++)b.group_arr[j]=b.data[j].name,b.color_arr[j]=b.data[j].color;b.uniq_group_arr=b.group_arr.slice(),b.uniq_color_arr=b.color_arr.slice(),$.unique(b.uniq_group_arr),$.unique(b.uniq_color_arr);var a=b.uniq_group_arr.length;if(PykCharts.boolean(b.group_arr[0]))for(k=0;a>k;k++)for(b.new_data[k]={name:b.uniq_group_arr[k],data:[],color:b.uniq_color_arr[k]},l=0;l<b.data_length;l++)b.uniq_group_arr[k]===b.data[l].name&&b.new_data[k].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip});else for(b.new_data[0]={name:b.data[0].name||"",data:[]},l=0;l<b.data_length;l++)b.new_data[0].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip});b.new_data_length=b.new_data.length},this.render=function(){if("default"===b.mode){if(b.transitions=new PykCharts.Configuration.transition(a),b.k.title().subtitle(),PykCharts.boolean(b.multiple_containers)){for(b.w=b.width/3,b.height=b.height/2,b.reducedWidth=b.w-b.margin.left-b.margin.right,b.reducedHeight=b.height-b.margin.top-b.margin.bottom,i=0;i<b.new_data_length;i++)b.k.liveData(b).makeMainDiv(b.selector,i).tooltip(!0,b.selector,i),b.new_data1=b.new_data[i],b.optionalFeature().chartType().svgContainer(i),b.k.crossHair(b.svg,i),b.optionalFeature().createLineChart(null,i).axisContainer(),b.k.xAxis(b.svg,b.gxaxis,b.xScale).yAxis(b.svg,b.gyaxis,b.yScale),(i+1)%4===0&&0!==i&&b.k.emptyDiv();b.k.emptyDiv()}else b.w=b.width,b.reducedWidth=b.w-b.margin.left-b.margin.right,b.reducedHeight=b.height-b.margin.top-b.margin.bottom,b.k.liveData(b).makeMainDiv(b.selector,1).tooltip(!0,b.selector,1),b.optionalFeature().chartType().svgContainer(1),b.k.crossHair(b.svg,1),b.optionalFeature().createLineChart().axisContainer(),b.k.xAxis(b.svg,b.gxaxis,b.xScale).yAxis(b.svg,b.gyaxis,b.yScale).yGrid(b.svg,b.group,b.yScale).xGrid(b.svg,b.group,b.xScale);b.k.credits().dataSource()}else"infographics"===b.mode&&(b.w=b.width,b.reducedWidth=b.w-b.margin.left-b.margin.right,b.reducedHeight=b.height-b.margin.top-b.margin.bottom,b.k.liveData(b).makeMainDiv(b.selector,1),b.optionalFeature().chartType().svgContainer(1).createLineChart().axisContainer(),b.k.xAxis(b.svg,b.gxaxis,b.xScale).yAxis(b.svg,b.gyaxis,b.yScale));b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("line"),b.data_length=b.data.length,b.dataTransform(),b.optionalFeature().createLineChart("livedata"),b.k.xAxis(b.svg,b.gxaxis,b.xScale).yAxis(b.svg,b.gyaxis,b.yScale).yGrid(b.svg,b.group,b.yScale).xGrid(b.svg,b.group,b.xScale)})},this.optionalFeature=function(){var c={chartType:function(){for(j=0;j<b.data_length;j++)for(k=j+1;k<b.data_length;k++)if(b.data[j].x===b.data[k].x){b.type="multilineChart";break}return b.type=b.type||"lineChart",this},svgContainer:function(a){return"multilineChart"===b.type?$(b.selector).attr("class","PykCharts-twoD PykCharts-line-chart PykCharts-multi-series2D"):"lineChart"===b.type&&$(b.selector).attr("class","PykCharts-twoD PykCharts-line-chart"),$(b.selector).css({"background-color":b.bg,position:"relative"}),b.svg=d3.select(b.selector+" #tooltip-svg-container-"+a).append("svg:svg").attr("id","svg-"+a).attr("width",b.w).attr("height",b.height),b.group=b.svg.append("g").attr("id","chartsvg").attr("transform","translate("+b.margin.left+","+b.margin.top+")"),PykCharts.boolean(b.grid.yEnabled)&&b.group.append("g").attr("id","ygrid").attr("class","y grid-line"),PykCharts.boolean(b.grid.xEnabled)&&b.group.append("g").attr("id","xgrid").attr("class","x grid-line"),b.clip=b.svg.append("svg:clipPath").attr("id","clip").append("svg:rect").attr("width",b.reducedWidth).attr("height",b.reducedHeight),b.chartBody=b.svg.append("g").attr("id","clipPath").attr("clip-path","url(#clip)").attr("transform","translate("+b.margin.left+","+b.margin.top+")"),this},axisContainer:function(){return PykCharts.boolean(b.axis.x.enable)&&(b.gxaxis=b.group.append("g").attr("id","xaxis").attr("class","x axis")),PykCharts.boolean(b.axis.y.enable)&&(b.gyaxis=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createLineChart:function(c,d){var e,f,g,h,i,j=[];if("number"===b.yAxisDataFormat?(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),i=[min,max],f=b.k._domainBandwidth(i,2),g=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("linear",f,g)):"string"===b.yAxisDataFormat?(b.new_data[0].data.forEach(function(a){f.push(a.y)}),g=[0,b.reducedHeight],b.yScale=b.k.scaleIdentification("ordinal",f,g,0)):"time"===b.yAxisDataFormat&&(f=d3.extent(b.data,function(a){return new Date(a.x)}),g=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("time",f,g)),"number"===b.xAxisDataFormat?(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),e=[min,max],j=b.k._domainBandwidth(e,2),h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("linear",j,h),b.lineMargin=0):"string"===b.xAxisDataFormat?(b.new_data[0].data.forEach(function(a){j.push(a.x)}),h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("ordinal",j,h,0),b.lineMargin=b.xScale.rangeBand()/2):"time"===b.xAxisDataFormat&&(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),j=[min,max],h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("time",j,h),b.new_data[0].data.forEach(function(a){a.x=new Date(a.x)}),b.lineMargin=0),b.chart_path=d3.svg.line().x(function(a){return b.xScale(a.x)}).y(function(a){return b.yScale(a.y)}).interpolate(b.interpolate),b.chartPathClass="lineChart"===b.type?"line":"multi-line","livedata"===c){if(PykCharts.boolean(b.multiple_containers))type=b.type+b.svg.attr("id"),b.svg.select(b.selector+" #"+type).datum(b.new_data1.data).transition().attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path),"multilineChart"===b.type;else for(var k=0;k<b.new_data_length;k++)type=b.type+"-svg-"+k,b.svg.select(b.selector+" #"+type).datum(b.new_data[k].data).transition().attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path),"multilineChart"===b.type;"lineChart"===b.type&&"default"===b.mode?b.svg.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")}).on("mousemove",function(){PykCharts.boolean(b.multiple_containers)?b.mouseEvent.crossHairPosition(b.data,b.xScale,b.yScale,b.dataLineGroup,b.lineMargin):b.mouseEvent.crossHairPosition(b.data,b.xScale,b.yScale,b.dataLineGroup[0],b.lineMargin)
}):"multilineChart"===b.type&&void 0!==b.selected_line_data&&(b.selected_line_data=b.selected_line.__data__,b.selected_line_data_len=b.selected_line_data.length,PykCharts.boolean(b.legends.enable)?b.updateSelectedLine(b.selected.id):null)}else{if(PykCharts.boolean(b.multiple_containers))type=b.type+b.svg.attr("id"),b.dataLineGroup[0]=b.chartBody.append("path"),b.dataLineGroup[0].datum(b.new_data1.data).attr("class",b.chartPathClass).attr("id",type).attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path),b.dataTextGroup[0]=b.svg.append("text").attr("id",type).attr("x",65).attr("y",20).style("font-size",b.legendsText.size).style("font-weight",b.legendsText.weight).style("font-family",b.legendsText.family).html(b.new_data1.name),"multilineChart"===b.type&&(PykCharts.boolean(b.color_from_data)?(b.dataTextGroup[0].style("fill",function(){return b.new_data[d].color}),b.dataLineGroup[0].style("stroke",function(){return b.new_data[d].color})):PykCharts.boolean(b.color_from_data)||(b.dataTextGroup[0].style("fill",function(){return b.legendsText.color}),b.dataLineGroup[0].style("stroke",b.chartColor)));else for(var k=0;k<b.new_data_length;k++)type=b.type+"-svg-"+k,b.dataLineGroup[k]=b.chartBody.append("path"),b.dataLineGroup[k].datum(b.new_data[k].data).attr("class",b.chartPathClass).attr("id",type).attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path),b.dataTextGroup[k]=b.svg.append("text").attr("id",type).attr("class","legend-heading").style("visibility","hidden").html(b.new_data[k].name),"multilineChart"===b.type&&(PykCharts.boolean(b.color_from_data)?(b.dataTextGroup[k].style("fill",function(){return b.new_data[k].color}),b.dataLineGroup[k].style("stroke",function(){return b.new_data[k].color}).on("click",function(){b.selected_line=d3.event.target,b.selected_line_data=b.selected_line.__data__,b.selected_line_data_len=b.selected_line_data.length,b.deselected=b.selected,d3.select(b.deselected).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.chartColor}),b.selected=this,b.color_before_selection=d3.select(b.selected).style("stroke"),d3.select(b.selected).classed({"multi-line-selected":!0,"multi-line":!1,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.highlightColor}).style("opacity",1),d3.selectAll(a.selector+" path.multi-line").style("opacity",.3),PykCharts.boolean(b.legends.enable)&&(void 0!==b.deselected?d3.select("text#"+b.deselected.id).style("visibility","hidden"):null,d3.select(b.selector+" text#"+b.selected.id).style("visibility","visible"),b.updateSelectedLine(b.selected.id))})):PykCharts.boolean(b.color_from_data)||(b.dataTextGroup[k].style("fill",function(){return b.legendsText.color}),b.dataLineGroup[k].style("stroke",b.chartColor).on("mouseover",function(){this!==b.selected&&d3.select(this).classed({"multi-line-hover":!0,"multi-line":!1}).style("stroke","orange")}).on("mouseout",function(){this!==b.selected&&d3.select(this).classed({"multi-line-hover":!1,"multi-line":!0}).style("stroke",b.chartColor)}).on("click",function(){b.selected_line=d3.event.target,b.selected_line_data=b.selected_line.__data__,b.selected_line_data_len=b.selected_line_data.length,b.deselected=b.selected,d3.select(b.deselected).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.chartColor}),b.selected=this,b.color_before_selection=d3.select(b.selected).style("stroke"),d3.select(b.selected).classed({"multi-line-selected":!0,"multi-line":!1,"multi-line-hover":!1}).style("stroke",function(){return PykCharts.boolean(b.color_from_data)?b.color_before_selection:b.highlightColor}),PykCharts.boolean(b.legends.enable)&&(void 0!==b.deselected?d3.select("text#"+b.deselected.id).style("visibility","hidden"):null,d3.select(b.selector+" text#"+b.selected.id).style("visibility","visible"),b.updateSelectedLine(b.selected.id))})));"lineChart"===b.type&&"default"===b.mode?b.svg.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis")}).on("mousemove",function(){b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.lineMargin,b.type,b.tooltipMode,b.color_from_data,null)}):"multilineChart"===b.type&&"default"===b.mode&&b.svg.on("mouseout",function(){b.mouseEvent.tooltipHide(null,b.multiple_containers,b.type),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis");for(var c=0;c<b.new_data_length;c++)$(a.selector+" #svg-"+c).trigger("mouseout")}).on("mousemove",function(){var c=[];c[0]=d3.select(a.selector+" #"+this.id+" .multi-line"),b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,c,b.lineMargin,b.type,b.tooltipMode,b.color_from_data,b.multiple_containers);for(var d=0;d<b.new_data_length;d++)$(a.selector+" #svg-"+d).trigger("mousemove")})}return this}};return c},this.updateSelectedLine=function(a){var c=parseFloat(d3.select(b.selector+" text#"+a).style("height"))/2,d=parseFloat(d3.select(b.selector+" text#"+a).style("width"))/2,e=(b.xScale(b.selected_line_data[0].x)+b.lineMargin+b.margin.left,b.yScale(b.selected_line_data[0].y)+b.margin.top,b.xScale(b.selected_line_data[b.selected_line_data_len-1].x)+b.lineMargin+b.margin.left),f=b.yScale(b.selected_line_data[b.selected_line_data_len-1].y)+b.margin.top;"vertical"===b.legends.display?(text_x=-b.margin.left+25,text_y=f-b.margin.top+20,text_rotate=-90):"horizontal"===b.legends.display&&(text_x=e-b.margin.left+d+30,text_y=f-b.margin.top-c+20,text_rotate=0),d3.select(b.selector+" text#"+a).attr("transform","translate("+text_x+","+text_y+") rotate("+text_rotate+")").style("font-size",b.legendsText.size).style("font-weight",b.legendsText.weight).style("font-family",b.legendsText.family)}},PykCharts.multiD.areaChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"area"),"default"===b.mode&&b.k.loading();var d=c.twoDimensionalCharts,e=(c.stylesheet,a.optional);b.enableCrossHair=e&&e.enableCrossHair?e.enableCrossHair:d.enableCrossHair,b.curvy_lines=e&&e.curvy_lines?e.curvy_lines:d.curvy_lines,b.interpolate=PykCharts.boolean(b.curvy_lines)?"cardinal":"linear",b.reducedWidth=b.width-b.margin.left-b.margin.right,b.reducedHeight=b.height-b.margin.top-b.margin.bottom,d3.json(a.data,function(a,c){b.data=c.groupBy("area"),b.data_length=c.length,$(b.selector+" #chart-loader").remove(),b.render()})},this.render=function(){"default"===b.mode?(b.transitions=new PykCharts.Configuration.transition(b),b.k.title().subtitle().liveData(b).makeMainDiv(a.selector,1).tooltip(!0,a.selector,1),b.optional_feature().chartType().createSvg(1).createChart().axisContainer(),b.k.crossHair(b.svg,b.type).credits(),b.k.xAxis(b.svg,b.gxaxis,b.xScale).yAxis(b.svg,b.gyaxis,b.yScale).yGrid(b.svg,b.group,b.yScale).xGrid(b.svg,b.group,b.xScale).dataSource()):"infographics"===b.mode&&(b.k.liveData(b).makeMainDiv(a.selector,1),b.optional_feature().chartType().createSvg(1).createChart().axisContainer(),b.k.xAxis(b.svg,b.gxaxis,b.xScale).yAxis(b.svg,b.gyaxis,b.yScale)),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)},this.refresh=function(){d3.json(a.data,function(c,d){b.data=d.groupBy("area"),b.data_length=d.length,b.optional_feature().createChart("liveData"),b.k.xAxis(b.svg,b.gxaxis,b.xScale).yAxis(b.svg,b.gyaxis,b.yScale).yGrid(b.svg,b.group,b.yScale).xGrid(b.svg,b.group,b.xScale).tooltip(!0,a.selector)})},this.optional_feature=function(){var c={chartType:function(){for(j=1;j<b.data_length;j++)if(b.data[0].x===b.data[j].x){b.type="stackedAreaChart";break}return b.type=b.type||"areaChart",this},createSvg:function(c){return $(b.selector).attr("class","PykCharts-twoD PykCharts-multi-series2D PykCharts-line-chart"),$(a.selector).css({"background-color":b.bg,position:"relative"}),b.svg=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("id","svg-"+c).attr("width",b.width).attr("height",b.height),b.group=b.svg.append("g").attr("id","chartsvg").attr("transform","translate("+b.margin.left+","+b.margin.top+")"),PykCharts.boolean(b.grid.yEnabled)&&b.group.append("g").attr("id","ygrid").attr("class","y grid-line"),PykCharts.boolean(b.grid.xEnabled)&&b.group.append("g").attr("id","xgrid").attr("class","x grid-line"),b.clip=b.svg.append("svg:clipPath").attr("id","clip").append("svg:rect").attr("width",b.reducedWidth).attr("height",b.reducedHeight),b.chartBody=b.svg.append("g").attr("id","clipPath").attr("clip-path","url(#clip)").attr("transform","translate("+b.margin.left+","+b.margin.top+")"),b.chart_path_stack=d3.layout.stack().values(function(a){return a.data}),this},axisContainer:function(){return PykCharts.boolean(b.axis.x.enable)&&(b.gxaxis=b.group.append("g").attr("id","xaxis").attr("class","x axis")),PykCharts.boolean(b.axis.y.enable)&&(b.gyaxis=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(c){if(b.group_arr=[],b.color_arr=[],b.new_data=[],b.dataLineGroup=[],b.dataTextGroup=[],b.dataLineGroupBorder=[],"areaChart"===b.type)for(b.new_data[0]={name:b.data[0].name||"",data:[]},j=0;j<b.data_length;j++)b.new_data[0].data.push({x:b.data[j].x,y:b.data[j].y,tooltip:b.data[j].tooltip,color:b.data[j].color||""});else if("stackedAreaChart"===b.type){for(j=0;j<b.data_length;j++)b.group_arr[j]=b.data[j].name,b.color_arr[j]=b.data[j].color;b.uniq_group_arr=b.group_arr.slice(),b.uniq_color_arr=b.color_arr.slice(),$.unique(b.uniq_group_arr),$.unique(b.uniq_color_arr);var d=b.uniq_group_arr.length;for(k=0;d>k;k++)for(b.new_data[k]={name:b.uniq_group_arr[k],data:[],color:b.uniq_color_arr[k]},l=0;l<b.data_length;l++)b.uniq_group_arr[k]===b.data[l].name&&b.new_data[k].data.push({x:b.data[l].x,y:b.data[l].y,tooltip:b.data[l].tooltip})}b.new_data_length=b.new_data.length,b.stacked_new_data=b.chart_path_stack(b.new_data);var e,f,g,h,i,m=[];if("number"===b.yAxisDataFormat?(max=d3.max(b.stacked_new_data,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,i=[min,max],f=b.k._domainBandwidth(i,1),g=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("linear",f,g)):"string"===b.yAxisDataFormat?(b.new_data[0].data.forEach(function(a){f.push(a.y)}),g=[0,b.reducedHeight],b.yScale=b.k.scaleIdentification("ordinal",f,g,0)):"time"===b.yAxisDataFormat&&(b.stacked_new_data.data.forEach(function(a){a.y0=new Date(a.y0),a.y=new Date(a.y)}),max=d3.max(b.stacked_new_data,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,f=[min,max],g=[b.reducedHeight,0],b.yScale=b.k.scaleIdentification("time",f,g)),"number"===b.xAxisDataFormat?(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),e=[min,max],m=b.k._domainBandwidth(e,2),h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("linear",m,h),b.lineMargin=0):"string"===b.xAxisDataFormat?(b.new_data[0].data.forEach(function(a){m.push(a.x)}),h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("ordinal",m,h,0),b.lineMargin=b.xScale.rangeBand()/2):"time"===b.xAxisDataFormat&&(max=d3.max(b.new_data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),min=d3.min(b.new_data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),m=[min,max],h=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("time",m,h),b.new_data[0].data.forEach(function(a){a.x=new Date(a.x)}),b.lineMargin=0),b.zoom_event=d3.behavior.zoom().y(b.yScale).scaleExtent([1,2]).on("zoom",b.zoomed),PykCharts.boolean(b.zoom.enable)&&b.svg.call(b.zoom_event),b.lineMargin=b.xScale.rangeBand()/2,b.chart_path=d3.svg.area().x(function(a){return b.xScale(a.x)}).y0(function(a){return b.yScale(a.y0)}).y1(function(a){return b.yScale(a.y0+a.y)}).interpolate(b.interpolate),b.chart_path_border=d3.svg.line().x(function(a){return b.xScale(a.x)}).y(function(a){return b.yScale(a.y0+a.y)}).interpolate(b.interpolate),b.chartPathClass="areaChart"===b.type?"area":"stacked-area","liveData"===c){for(var n=0;n<b.new_data_length;n++)type=b.chartPathClass+n,b.svg.select("#"+type).datum(b.stacked_new_data[n].data).transition().attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path),b.svg.select("#border-stacked-area"+n).datum(b.stacked_new_data[n].data).transition().ease("linear").duration(b.transitions.duration()).attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path_border);"areaChart"===b.type&&b.svg.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(type),b.mouseEvent.axisHighlightHide(a.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(a.selector+" .y.axis")}).on("mousemove",function(){b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.svg.select("#"+type),b.lineMargin,b.type,b.tooltip.mode)})}else{for(var n=0;n<b.new_data_length;n++)type=b.chartPathClass+n,b.dataLineGroup[n]=b.chartBody.append("path"),b.dataLineGroup[n].datum(b.stacked_new_data[n].data).attr("class",b.chartPathClass).attr("id",type).style("fill",function(){return""!==b.new_data[n].color?b.new_data[n].color:b.chartColor}).attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path),b.dataLineGroupBorder[n]=b.chartBody.append("path"),b.dataLineGroupBorder[n].datum(b.stacked_new_data[n].data).attr("class","area-border").attr("id","border-stacked-area"+n).style("stroke",b.borderBetweenChartElements.color).style("stroke-width",b.borderBetweenChartElements.width).style("stroke-dasharray",b.borderBetweenChartElements.style).attr("transform","translate("+b.lineMargin+",0)").attr("d",b.chart_path_border);"areaChart"===b.type?b.svg.on("mouseout",function(){b.mouseEvent.tooltipHide(),b.mouseEvent.crossHairHide(b.type),b.mouseEvent.axisHighlightHide(a.selector+" .x.axis"),b.mouseEvent.axisHighlightHide(a.selector+" .y.axis")}).on("mousemove",function(){b.mouseEvent.crossHairPosition(b.data,b.new_data,b.xScale,b.yScale,b.dataLineGroup,b.lineMargin,b.type,b.tooltip.mode)}):"stackedAreaChart"===b.type}return this}};return c},this.zoomed=function(){for(b.k.isOrdinal(b.svg,".x.axis",b.xScale),b.k.isOrdinal(b.svg,".x.grid",b.xScale),b.k.isOrdinal(b.svg,".y.axis",b.yScale),b.k.isOrdinal(b.svg,".y.grid",b.yScale),i=0;i<b.new_data_length;i++)type=b.chartPathClass+i,b.svg.select(b.selector+" #"+type).attr("class",b.chartPathClass).attr("d",b.chart_path),b.svg.select(b.selector+" #border-stacked-area"+i).attr("class","area-border").attr("d",b.chart_path_border)}},PykCharts.multiD.barChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});return this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"column"),b.grid=a.chart&&a.chart.grid?a.chart.grid:c.stylesheet.chart.grid,b.grid.yEnabled=a.chart&&a.chart.grid&&a.chart.grid.yEnabled?a.chart.grid.yEnabled:c.stylesheet.chart.grid.yEnabled,b.grid.color=a.chart&&a.chart.grid&&a.chart.grid.color?a.chart.grid.color:c.stylesheet.chart.grid.color,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(a,c){b.data=c.groupBy("bar"),$(b.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("bar"),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var d=b.flattenData();b.the_bars=d[0],b.the_keys=d[1],b.the_layers=b.buildLayers(b.the_bars),1===b.max_length&&(b.legends.enable="no"),b.optionalFeatures().createColumnChart().legends().ticks(),b.k.xAxis(b.svg,b.xgroup,b.xScale)})},this.render=function(){var b=this;b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var c=b.flattenData();b.the_bars=c[0],b.the_keys=c[1],b.the_layers=b.buildLayers(b.the_bars),b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.multiD.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),b.border=new PykCharts.Configuration.border(b),1===b.max_length&&(b.legends.enable="no"),"default"===b.mode?(b.k.title().subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().legendsContainer(1).svgContainer(1),b.k.credits().dataSource().liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createColumnChart().legends().axisContainer().ticks(),b.k.xAxis(b.svg,b.xgroup,b.xScale)):"infographics"===b.mode&&(b.k.makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).createColumnChart().axisContainer(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.k.xAxis(b.svg,b.xgroup,b.xScale))},this.optionalFeatures=function(){var b=this,c={svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD"),b.svg=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer").style("background-color",b.bg),b.group=b.svg.append("g").attr("id","svggroup").attr("class","svggroup").attr("transform","translate("+b.margin.left+","+b.margin.top+")"),this},legendsContainer:function(c){return PykCharts.boolean(b.legends.enable)&&(b.legend_svg=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",50).attr("class","legendscontainer").attr("id","legendscontainer"),b.legends_group=b.legend_svg.append("g").attr("id","legends").attr("class","legends").attr("transform","translate(0,10)")),this},axisContainer:function(){if(PykCharts.boolean(b.axis.y.enable)){var a=b.group.selectAll(".axis-line").data(["line"]);a.enter().append("line"),a.attr("class","axis-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",b.height-b.margin.top-b.margin.bottom).attr("stroke",b.axis.x.axisColor),a.exit().remove(),b.xgroup=b.group.append("g").attr("id","xaxis").attr("class","x axis"),"right"===b.axis.y.position&&a.attr("x1",b.width-b.margin.left-b.margin.right).attr("x2",b.width-b.margin.left-b.margin.right)}return PykCharts.boolean(b.axis.x.enable)&&(b.ygroup=b.group.append("g").attr("id","xaxis").attr("class","x axis")),this},createColumnChart:function(){{var c=b.width-b.margin.left-b.margin.right,d=b.max_length+1,e=b.height-b.margin.top-b.margin.bottom,f=b.the_bars;b.the_keys}b.layers=b.the_layers;{var g=b.getGroups();d3.layout.stack().values(function(a){return a.values})(b.layers)}b.layers=b.layers.map(function(a){return{name:a.name,values:a.values.map(function(a){return{x:a.y,y:a.x,x0:a.y0,tooltip:a.tooltip?a.tooltip:a.y,color:a.color,group:a.group,name:a.name,highlight:a.highlight}})}});var h=[];b.layers.map(function(a,b){for(b in a.values){var c=a.values[b];h.push(c.x+c.x0)}}),b.yScale=d3.scale.ordinal().domain(f.map(function(a,b){return a.id||b})).rangeBands([0,e]);var i=[0,d3.max(h)];b.xScale=d3.scale.linear().domain(b.k._domainBandwidth(i,1)).range([0,c]);var j=(d3.scale.category10(),[]);for(var k in g){var l=g[k],m=b.yScale(l[0]),n=b.yScale.rangeBand()*l.length;m+=n/2,j.push({y:m,name:k})}b.y0=d3.scale.ordinal().domain(j.map(function(a){return a.name})).rangeRoundBands([0,e],.1),b.y1=d3.scale.ordinal().domain(b.barName.map(function(a){return a})).rangeRoundBands([0,b.y0.rangeBand()]),b.y_factor=0,b.height_factor=0,1===b.max_length&&(b.y_factor=b.yScale.rangeBand()/4,b.height_factor=b.yScale.rangeBand()/(2*b.max_length)),b.bars=b.group.selectAll(".bars").data(b.layers),b.bars.enter().append("g").attr("class","bars");var o=b.bars.selectAll("rect").data(function(a){return a.values});o.enter().append("svg:rect").attr("class","rect"),o.attr("width",0).attr("x",0).attr("fill",function(a){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a){return PykCharts.boolean(b.saturationEnable)?a.highlight?(d--,1):d>1?(d--,d/b.max_length):(d=b.max_length+1,d--,d/b.max_length):void 0}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-opacity",1).on("mouseover",function(c){b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip?c.tooltip:c.y),b.mouseEvent.axisHighlightShow(c.name,a.selector+" .axis-text","bar")}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.mouseEvent.axisHighlightHide(a.selector+" .axis-text","bar")}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}),o.transition().duration(b.transitions.duration()).attr("x",function(a){return b.xScale(a.x0)}).attr("width",function(a){return b.xScale(a.x)}).attr("height",function(){return b.yScale.rangeBand()+b.height_factor}).attr("y",function(a){return b.yScale(a.y)-b.y_factor}),b.bars.exit().remove();var p=b.group.selectAll("text.axis-text").data(j);return p.enter().append("text"),p.attr("class","axis-text").attr("y",function(a){return a.y}).attr("x",function(){return-10}).attr("fill",b.axis.y.labelColor).text(function(a){return a.name}),"right"===b.axis.y.position&&p.attr("x",function(){return b.width-b.margin.left-b.margin.right+10}),"left"===b.axis.y.position&&"right"===b.axis.y.orient&&p.attr("x",function(){return 10}),"right"===b.axis.y.position&&"left"===b.axis.y.orient&&p.attr("x",function(){return b.width-b.margin.left-b.margin.right-10}),"right"===b.axis.y.orient?p.attr("text-anchor","start"):"left"===b.axis.y.orient&&p.attr("text-anchor","end"),p.exit().remove(),this},ticks:function(){if(b.ticks.size){b.txt_width,b.txt_height;var a=(b.bars.selectAll("g").data(b.layers),b.bars.selectAll(".ticksText").data(function(a){return a.values}));a.enter().append("text").attr("class","ticksText"),a.attr("class","ticksText").text(function(a){return a.x?a.x:void 0}).style("font-weight",b.ticks.weight).style("font-size",b.ticks.size).attr("fill",b.ticks.color).style("font-weight",b.ticks.weight).style("font-family",b.ticks.family).text(function(a){return a.x&&(b.txt_width=this.getBBox().width,b.txt_height=this.getBBox().height,a.x&&b.txt_width<b.xScale(a.x)&&b.txt_height<b.yScale.rangeBand()+b.height_factor)?a.x:void 0}).attr("x",function(a){b.xScale(a.x);return b.xScale(a.x0)+b.xScale(a.x)+5}).attr("y",function(a){return b.yScale(a.y)-b.y_factor+b.yScale.rangeBand()/2}).attr("dy",function(){return 1===b.max_length?b.yScale.rangeBand()/2:b.yScale.rangeBand()/4}).style("font-size",function(){return b.ticks.size}),a.exit().remove()}return this},legends:function(){if(PykCharts.boolean(b.legends.enable)){var a,c=b.getParameters();a=c[0].color,c=c.map(function(a){return a.name}),c=jQuery.unique(c);var d=0,e=0;if(d=c.length,e=c.length,"vertical"===b.legends.display){b.legend_svg.attr("height",30*c.length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,h=function(){return b.width-b.width/4+16},i=function(){return b.width-b.width/4};var f=function(a,b){return 24*b+12},g=function(a,b){return 24*b+23}}else if("horizontal"===b.legends.display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var h=function(){return d--,b.width-(100*d+75)};g=30,rect_parameter1value=13,rect_parameter2value=13;var i=function(){return e--,b.width-(100*e+100)};f=18}var j=b.legends_group.selectAll("rect").data(c);j.enter().append("rect"),j.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,i).attr(rect_parameter4,f).attr("fill",function(){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a,c){return PykCharts.boolean(b.saturationEnable)?(b.max_length-c)/b.max_length:void 0}),j.exit().remove(),b.legends_text=b.legends_group.selectAll(".legends_text").data(c),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("font-size",12),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,h).attr(text_parameter2,g).text(function(a){return a}),b.legends_text.exit().remove()}return this}};return c},this.getGroups=function(){var a={};for(var c in b.the_bars){var d=b.the_bars[c];d.id&&(a[d.group]?a[d.group].push(d.id):a[d.group]=[d.id])}return a},this.buildLayers=function(a){function c(a){for(var b in e){var c=e[b];if(c.name==a)return c}return d(a)}function d(a){var b={name:a,values:[]};return e.push(b),b}var e=[];for(var f in a){var g=a[f];if(g.id){var h=g.id;for(var i in g)if("id"!==i){var j=g[i];for(var k in j){var l=j[k];if(l.name){var m=c(l.name);m.values.push({x:h,y:l.val,color:l.color,tooltip:l.tooltip,highlight:l.highlight,group:b.keys[h],name:g.group})}}}}}return e},this.flattenData=function(){var a=[-1];b.keys={};for(var c in b.data){var d=b.data[c];for(var e in d){for(var f in d[e]){var g="i"+c+"j"+f;if("object"==typeof d[e][f]){var h=Object.keys(d[e][f])[0];b.keys[g]=h,d[e][f].id=g,d[e][f].group=e,a.push(d[e][f])}}a.push(c)}}return[a,b.keys]},this.getParameters=function(){var c=[];for(var d in b.the_layers)if(b.the_layers[d].name){var e,f=b.the_layers[d].name;for(var g in b.the_layers[d].values)if(PykCharts.boolean(b.the_layers[d].values[g].y)){var e,f=b.the_layers[d].values[g].group;a.optional&&a.optional.colors?a.optional.colors.chartColor?e=b.chartColor:b.the_layers[d].values[0].color&&(e=b.the_layers[d].values[0].color):e=b.chartColor,c.push({name:f,color:e})}}return c},this.emptygroups=function(a){b.max_length=d3.max(a,function(a){var b=_.values(a);return b[0].length});_.map(a,function(c,d){for(var e=_.values(c);e[0].length<b.max_length;){var f=_.keys(c),g={name:"stack",tooltip:"null",color:"white",val:0,highlight:!1},h={group3:[g]};a[d][f[0]].push(h),e=_.values(c)}});return a},this.dataTransformation=function(){var a=[];b.barName=[];var c=b.data.length;b.data.sort(function(a,b){return b.x-a.x});for(var d=0;c>d;d++){var e,f={},g={};if(b.data[d].group||(b.data[d].group="group"+d),b.data[d].stack||(b.data[d].stack="stack"),b.barName[d]=b.data[d].group,f[b.data[d].y]=[],g[b.data[d].group]=[],e={name:b.data[d].stack,tooltip:b.data[d].tooltip,color:b.data[d].color,val:b.data[d].x,highlight:b.data[d].highlight},0===d)a.push(f),a[d][b.data[d].y].push(g),a[d][b.data[d].y][d][b.data[d].group].push(e);else{var h=a.length,i=0;for(i=0;h>i;i++)if(_.has(a[i],b.data[d].y)){var j=a[i][b.data[d].y],k=j.length,l=0;for(l=0;k>l&&!_.has(a[i][b.data[d].y][l],b.data[d].group);l++);k>l?a[i][b.data[d].y][l][b.data[d].group].push(e):(a[i][b.data[d].y].push(g),a[i][b.data[d].y][l][b.data[d].group].push(e));break}i===h&&(a.push(f),a[i][b.data[d].y].push(g),a[i][b.data[d].y][0][b.data[d].group].push(e))}}return b.barName=_.unique(b.barName),a},this},PykCharts.multiD.columnChart=function(a){var b=this,c=new PykCharts.Configuration.Theme({});return this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"column"),b.grid=a.chart&&a.chart.grid?a.chart.grid:c.stylesheet.chart.grid,b.grid.yEnabled=a.chart&&a.chart.grid&&a.chart.grid.yEnabled?a.chart.grid.yEnabled:c.stylesheet.chart.grid.yEnabled,b.grid.color=a.chart&&a.chart.grid&&a.chart.grid.color?a.chart.grid.color:c.stylesheet.chart.grid.color,"default"===b.mode&&b.k.loading(),d3.json(a.data,function(a,c){b.data=c.groupBy("column"),$(b.selector+" #chart-loader").remove(),b.render()})},this.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("column"),b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var d=b.flattenData();b.the_bars=d[0],b.the_keys=d[1],b.the_layers=b.layers(b.the_bars),1===b.max_length&&(b.legends.enable="no"),b.optionalFeatures().createColumnChart().legends(),b.k.yAxis(b.svg,b.ygroup,b.yScaleInvert).yGrid(b.svg,b.group,b.yScaleInvert)})},this.render=function(){var b=this;b.data=b.dataTransformation(),b.data=b.emptygroups(b.data);var c=b.flattenData();b.the_bars=c[0],b.the_keys=c[1],b.the_layers=b.layers(b.the_bars),b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.multiD.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),1===b.max_length&&(b.legends.enable="no"),"default"===b.mode?(b.k.title().subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().legendsContainer(1).svgContainer(1),b.k.credits().dataSource().liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createColumnChart().legends().axisContainer(),b.k.yAxis(b.svg,b.ygroup,b.yScaleInvert).yGrid(b.svg,b.group,b.yScaleInvert)):"infographics"===b.mode&&(b.k.makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(1).createColumnChart().axisContainer(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.k.yAxis(b.svg,b.ygroup,b.yScaleInvert))},this.optionalFeatures=function(){var b=this,c={svgContainer:function(c){return $(b.selector).attr("class","PykCharts-twoD"),b.svg=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",b.height).attr("id","svgcontainer").attr("class","svgcontainer").style("background-color",b.bg),b.group=b.svg.append("g").attr("id","svggroup").attr("class","svggroup").attr("transform","translate("+b.margin.left+","+b.margin.top+")"),PykCharts.boolean(b.grid.yEnabled)&&b.group.append("g").attr("id","ygrid").style("stroke",b.grid.color).attr("class","y grid-line"),this},legendsContainer:function(c){return PykCharts.boolean(b.legends.enable)&&(b.legend_svg=d3.select(a.selector+" #tooltip-svg-container-"+c).append("svg:svg").attr("width",b.width).attr("height",50).attr("class","legendscontainer").attr("id","legendscontainer"),b.legends_group=b.legend_svg.append("g").attr("id","legends").attr("class","legends").attr("transform","translate(0,10)")),this},axisContainer:function(){if(PykCharts.boolean(b.axis.x.enable)){var a=b.group.selectAll(".axis-line").data(["line"]);a.enter().append("line"),a.attr("class","axis-line").attr("x1",0).attr("y1",b.height-b.margin.top-b.margin.bottom).attr("x2",b.width-b.margin.left-b.margin.right).attr("y2",b.height-b.margin.top-b.margin.bottom).attr("stroke",b.axis.x.axisColor),"top"===b.axis.x.position&&a.attr("y1",0).attr("y2",0),a.exit().remove(),b.xgroup=b.group.append("g").attr("id","xaxis").attr("class","x axis").style("stroke","none")}return PykCharts.boolean(b.axis.y.enable)&&(b.ygroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createColumnChart:function(){var c=b.width-b.margin.left-b.margin.right,d=b.height-b.margin.top-b.margin.bottom,e=b.max_length+1,f=b.the_bars,g=(b.the_keys,b.the_layers),h=b.getGroups(),i=(d3.layout.stack().values(function(a){return a.values})(g),[]);g.map(function(a,b){for(b in a.values){var c=a.values[b];i.push(c.y+c.y0)}}),b.xScale=d3.scale.ordinal().domain(f.map(function(a,b){return a.id||b})).rangeBands([0,c],.1),y_domain=[0,d3.max(i)],y_domain=b.k._domainBandwidth(y_domain,1),b.yScale=d3.scale.linear().domain(y_domain).range([0,d]),b.yScaleInvert=d3.scale.linear().domain([y_domain[1],y_domain[0]]).range([0,d]);var j,k,l,m,n=(d3.scale.category10(),[]),o=0,p=0;1===b.max_length&&(o=b.xScale.rangeBand()/4,p=b.xScale.rangeBand()/(2*b.max_length));for(m in h)j=h[m],k=b.xScale(j[0]),l=b.xScale.rangeBand()*j.length,k+=l/2,n.push({x:k,name:m});var q=b.group.selectAll(".bars").data(g);q.attr("class","bars"),q.enter().append("g").attr("class","bars");var r=q.selectAll("rect").data(function(a){return a.values});r.enter().append("svg:rect").attr("class","rect"),r.attr("height",0).attr("y",d).attr("fill",function(a){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a){return PykCharts.boolean(b.saturationEnable)?a.highlight?(e--,1):e>1?(e--,e/b.max_length):(e=b.max_length+1,e--,e/b.max_length):void 0}).attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-opacity",1).on("mouseover",function(c){b.mouseEvent.tooltipPosition(c),b.mouseEvent.toolTextShow(c.tooltip?c.tooltip:c.y),b.mouseEvent.axisHighlightShow(c.name,a.selector+" .axis-text","column")
}).on("mouseout",function(c){b.mouseEvent.tooltipHide(c),b.mouseEvent.axisHighlightHide(a.selector+" .axis-text","column")}).on("mousemove",function(a){b.mouseEvent.tooltipPosition(a)}),r.transition().duration(b.transitions.duration()).attr("x",function(a){return b.xScale(a.x)-o}).attr("width",function(){return b.xScale.rangeBand()+p}).attr("height",function(a){return b.yScale(a.y)}).attr("y",function(a){return d-b.yScale(a.y0+a.y)}),q.exit().remove();var s=b.group.selectAll("text.axis-text").data(n);return s.enter().append("text"),s.attr("class","axis-text").attr("x",function(a){return a.x}).attr("text-anchor","middle").attr("fill",b.axis.x.labelColor).text(function(a){return a.name}),s.exit().remove(),"top"===b.axis.x.position&&("top"===b.axis.x.orient?s.attr("y",function(){return-15}):"bottom"===b.axis.x.orient&&s.attr("y",function(){return 15})),"top"===b.axis.x.orient?s.attr("y",function(){return d-15}):"bottom"===b.axis.x.orient&&s.attr("y",function(){return d+15}),this},legends:function(){if(PykCharts.boolean(b.legends.enable)){var a,c=b.getParameters();a=c[0].color,c=c.map(function(a){return a.name}),c=jQuery.unique(c);var d=0,e=0;if(d=c.length,e=c.length,"vertical"===b.legends.display){b.legend_svg.attr("height",30*c.length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,h=function(){return b.width-b.width/4+16},i=function(){return b.width-b.width/4};var f=function(a,b){return 24*b+12},g=function(a,b){return 24*b+23}}else if("horizontal"===b.legends.display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var h=function(){return d--,b.width-(100*d+75)};g=30,rect_parameter1value=13,rect_parameter2value=13;var i=function(){return e--,b.width-(100*e+100)};f=18}var j=b.legends_group.selectAll("rect").data(c);j.enter().append("rect"),j.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,i).attr(rect_parameter4,f).attr("fill",function(){return b.fillColor.colorPieMS(a)}).attr("fill-opacity",function(a,c){return PykCharts.boolean(b.saturationEnable)?(b.max_length-c)/b.max_length:void 0}),j.exit().remove(),b.legends_text=b.legends_group.selectAll(".legends_text").data(c),b.legends_text.enter().append("text").attr("class","legends_text").attr("fill","#1D1D1D").attr("pointer-events","none").style("font-family","'Helvetica Neue',Helvetica,Arial,sans-serif").attr("font-size",12),b.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,h).attr(text_parameter2,g).text(function(a){return a}),b.legends_text.exit().remove()}return this}};return c},this.getGroups=function(){var a={};for(var c in b.the_bars){var d=b.the_bars[c];d.id&&(a[d.group]?a[d.group].push(d.id):a[d.group]=[d.id])}return a},this.layers=function(a){function c(a){for(var b in e){var c=e[b];if(c.name==a)return c}return d(a)}function d(a){var b={name:a,values:[]};return e.push(b),b}var e=[];for(var f in a){var g=a[f];if(g.id){var h=g.id;for(var i in g)if("id"!==i){var j=g[i];for(var k in j){var l=j[k];if(l.name){var m=c(l.name);m.values.push({x:h,y:l.val,color:l.color,tooltip:l.tooltip,group:b.keys[h],name:g.group,highlight:l.highlight})}}}}}return e},this.flattenData=function(){var a=[-1];b.keys={};for(var c in b.data){var d=b.data[c];for(var e in d){for(var f in d[e]){var g="i"+c+"j"+f;if("object"==typeof d[e][f]){var h=Object.keys(d[e][f])[0];b.keys[g]=h,d[e][f].id=g,d[e][f].group=e,a.push(d[e][f])}}a.push(c)}}return[a,b.keys]},this.getParameters=function(){var c=[];for(var d in b.the_layers)if(b.the_layers[d].name)for(var e in b.the_layers[d].values)if(PykCharts.boolean(b.the_layers[d].values[e].y)){var f,g=b.the_layers[d].values[e].group;a.optional&&a.optional.colors?a.optional.colors.chartColor?f=b.chartColor:b.the_layers[d].values[0].color&&(f=b.the_layers[d].values[0].color):f=b.chartColor,c.push({name:g,color:f})}return c},this.emptygroups=function(a){b.max_length=d3.max(a,function(a){var b=_.values(a);return b[0].length});_.map(a,function(c,d){for(var e=_.values(c);e[0].length<b.max_length;){var f=_.keys(c),g={name:"stack",tooltip:"null",color:"white",val:0,highlight:!1},h={group3:[g]};a[d][f[0]].push(h),e=_.values(c)}});return a},this.dataTransformation=function(){var a=[];b.barName=[];var c=b.data.length;b.data.sort(function(a,b){return b.y-a.y});for(var d=0;c>d;d++){var e,f={},g={};if(b.data[d].group||(b.data[d].group="group"+d),b.data[d].stack||(b.data[d].stack="stack"),b.barName[d]=b.data[d].group,f[b.data[d].x]=[],g[b.data[d].group]=[],e={name:b.data[d].stack,tooltip:b.data[d].tooltip,color:b.data[d].color,val:b.data[d].y,highlight:b.data[d].highlight},0===d)a.push(f),a[d][b.data[d].x].push(g),a[d][b.data[d].x][d][b.data[d].group].push(e);else{var h=a.length,i=0;for(i=0;h>i;i++)if(_.has(a[i],b.data[d].x)){var j=a[i][b.data[d].x],k=j.length,l=0;for(l=0;k>l&&!_.has(a[i][b.data[d].x][l],b.data[d].group);l++);k>l?a[i][b.data[d].x][l][b.data[d].group].push(e):(a[i][b.data[d].x].push(g),a[i][b.data[d].x][l][b.data[d].group].push(e));break}i===h&&(a.push(f),a[i][b.data[d].x].push(g),a[i][b.data[d].x][0][b.data[d].group].push(e))}}return b.barName=_.unique(b.barName),a},this},PykCharts.multiD.scatterPlot=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"scatterplot"),"default"===b.mode&&b.k.loading();var d=c.multiDimensionalCharts,e=(c.stylesheet,a.optional);b.multiD=new PykCharts.multiD.configuration(b),b.multiple_containers=e&&e.multiple_containers&&e.multiple_containers.enable?e.multiple_containers.enable:d.multiple_containers.enable,b.bubbleRadius=a.scatterplot&&_.isNumber(a.scatterplot.radius)?a.scatterplot.radius:d.scatterplot.radius,b.zoomedOut=!0,b.radius_range=PykCharts.boolean(b.multiple_containers)?[5,12]:[20,50],d3.json(a.data,function(c,d){b.data=d.groupBy("scatterplot"),$(b.selector+" #chart-loader").remove();var e=new PykCharts.multiD.scatterplotFunction(a,b,"scatterplot");e.render()})}},PykCharts.multiD.pulse=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.multiD.processInputs(b,a,"pulse"),"default"===b.mode&&b.k.loading();var d=c.multiDimensionalCharts,e=(c.stylesheet,a.optional);b.multiD=new PykCharts.multiD.configuration(b),b.multiple_containers=e&&e.multiple_containers&&e.multiple_containers.enable?e.multiple_containers.enable:d.multiple_containers.enable,b.bubbleRadius=e&&e.scatterplot&&_.isNumber(e.scatterplot.radius)?e.scatterplot.radius:d.scatterplot.radius,b.zoomedOut=!0,b.radius_range=[4,14],d3.json(a.data,function(c,d){b.data=d.groupBy("pulse"),$(b.selector+" #chart-loader").remove();var e=new PykCharts.multiD.scatterplotFunction(a,b,"pulse");e.render()})}},PykCharts.multiD.scatterplotFunction=function(a,b,c){function d(){e.zoomedOut=!1,e.optionalFeatures().plotCircle().label(),d3.select(e.selector+" #"+this.id).selectAll(".dot").attr("r",function(a){return e.sizes(a.weight)*d3.event.scale})}var e=b;e.refresh=function(){d3.json(a.data,function(a,b){e.data=b.groupBy("scatterplot"),e.mapGroupData=e.multiD.mapGroup(e.data),e.optionalFeatures().createScatterPlot().legends().label().ticks()})},this.render=function(){if(e.mapGroupData=e.multiD.mapGroup(e.data),e.fillChart=new PykCharts.Configuration.fillChart(e),e.border=new PykCharts.Configuration.border(e),"default"===e.mode){if(e.k.title().subtitle(),e.data_group=jQuery.unique(e.data.map(function(a){return a.group})),e.no_of_groups=1,PykCharts.boolean(e.multiple_containers)&&"scatterplot"===c){for(e.no_of_groups=e.data_group.length,e.w=e.width/4,e.height=e.height/2,e.margin.left=e.margin.left,e.margin.right=e.margin.right,i=0;i<e.no_of_groups;i++){for(e.new_data=[],j=0;j<e.data.length;j++)e.data[j].group===e.data_group[i]&&e.new_data.push(e.data[j]);e.k.positionContainers(e.legends,e),e.k.makeMainDiv(e.selector,i),e.optionalFeatures().legendsContainer(i).svgContainer(i),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().createScatterPlot().legends(i).label().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x).yAxis(e.svgContainer,e.yGroup,e.y),(i+1)%4===0&&0!==i&&e.k.emptyDiv()}e.k.emptyDiv()}else e.w=e.width,e.new_data=e.data,e.k.makeMainDiv(e.selector,1),e.optionalFeatures().legendsContainer(1).svgContainer(1),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().createScatterPlot().legends().label().zoom().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x).yAxis(e.svgContainer,e.yGroup,e.y);e.k.credits().dataSource(),e.optionalFeatures().zoom()}else"infographics"===e.mode&&(e.radius_range=[7,18],e.new_data=e.data,e.w=e.width,e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.k.tooltip().makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(1),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().createScatterPlot(),e.k.xAxis(e.svgContainer,e.xGroup,e.x).yAxis(e.svgContainer,e.yGroup,e.y))},e.optionalFeatures=function(){var b={svgContainer:function(b){return $(a.selector+" #tooltip-svg-container-"+b).css("width",e.w),$(a.selector).attr("class","PykCharts-weighted"),e.svgContainer=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("width",e.w).attr("height",e.height).attr("id","svgcontainer"+b).attr("class","svgcontainer").style("background-color",e.bg),e.group=e.svgContainer.append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")").attr("id","main"),e.group1=e.svgContainer.append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")").attr("id","main2"),PykCharts.boolean(e.axis.x.enable)&&(e.xGroup=e.group.append("g").attr("class","x axis").style("stroke","black")),PykCharts.boolean(e.axis.y.enable)&&(e.yGroup=e.group.append("g").attr("class","y axis").style("stroke","blue")),e.clip=e.group.append("svg:clipPath").attr("id","clip").append("svg:rect").attr("width",e.w-e.margin.left-e.margin.right).attr("height",e.height-e.margin.top-e.margin.bottom),e.chartBody=e.group.append("g").attr("clip-path","url(#clip)"),this},legendsContainer:function(a){return PykCharts.boolean(e.legends.enable)&&PykCharts.boolean(e.size.enable)&&e.mapGroupData[1]&&(e.legendsContainer=d3.select(e.selector+" #tooltip-svg-container-"+a).append("svg").attr("width",e.w).attr("height",50).attr("class","legends").attr("id","legendscontainer"),e.legendsGroup=e.legendsContainer.append("g").attr("id","legends").attr("transform","translate(0,20)")),this},createScatterPlot:function(){if(e.weight=_.map(e.new_data,function(a){return a.weight}),e.weight=_.reject(e.weight,function(a){return 0==a}),e.max_radius=e.sizes(d3.max(e.weight)),e.sorted_weight=e.weight.slice(0),e.sorted_weight.sort(function(a,b){return a-b}),e.group.append("text").attr("fill","black").attr("text-anchor","end").attr("x",e.w-70).attr("y",e.height+40).text(e.axis.x.label),e.zoomedOut===!0){var a,b,c,f,g,h,a,f=d3.extent(e.data,function(a){return a.x}),a=d3.extent(e.data,function(a){return a.y}),f=[],i=[],j=[];"number"===e.yAxisDataFormat?(a=d3.extent(e.data,function(a){return a.y}),j=e.k._domainBandwidth(a,2,function(){var b=d3.scale.linear().range([e.height-e.margin.top-e.margin.bottom,0]).domain(a);return yinvert=b.invert(e.radius_range[1]),yinvert=a[1]-yinvert}),g=[e.height-e.margin.top-e.margin.bottom,0],e.y=e.k.scaleIdentification("linear",j,g),e.top_margin=0):"string"===e.yAxisDataFormat?(e.data.forEach(function(a){j.push(a.y)}),g=[0,e.height-e.margin.top-e.margin.bottom],e.y=e.k.scaleIdentification("ordinal",j,g,0),e.top_margin=e.y.rangeBand()/2):"time"===e.yAxisDataFormat&&(j=d3.extent(e.data,function(a){return new Date(a.x)}),g=[e.height-e.margin.top-e.margin.bottom,0],e.y=e.k.scaleIdentification("time",j,g),e.top_margin=0),"number"===e.xAxisDataFormat?(f=d3.extent(e.data,function(a){return a.x}),i=e.k._domainBandwidth(f,2,function(){var a=d3.scale.linear().range([0,e.w-e.margin.left-e.margin.right]).domain(f);return xinvert=a.invert(e.radius_range[1]),xinvert=f[1]-xinvert}),h=[0,e.w-e.margin.left-e.margin.right],e.x=e.k.scaleIdentification("linear",i,h),e.left_margin=0):"string"===e.xAxisDataFormat?(e.data.forEach(function(a){i.push(a.x)}),h=[0,e.w-e.margin.left-e.margin.right],e.x=e.k.scaleIdentification("ordinal",i,h,0),e.left_margin=e.x.rangeBand()/2):"time"===e.xAxisDataFormat&&(b=d3.max(e.data,function(a){return d3.max(a.data,function(a){return new Date(a.x)})}),c=d3.min(e.data,function(a){return d3.min(a.data,function(a){return new Date(a.x)})}),i=[c,b],h=[0,e.w-e.margin.left-e.margin.right],e.x=e.k.scaleIdentification("time",i,h),e.new_data[0].data.forEach(function(a){a.x=new Date(a.x)}),e.left_margin=0),PykCharts.boolean(e.zoom.enable)&&"string"!==e.yAxisDataFormat&&"string"!==e.xAxisDataFormat&&"default"===e.mode&&e.svgContainer.call(d3.behavior.zoom().x(e.x).y(e.y).scaleExtent([1,10]).on("zoom",d)),e.optionalFeatures().plotCircle()}return this},legends:function(b){if(PykCharts.boolean(e.legends.enable)&&PykCharts.boolean(e.size.enable)&&e.mapGroupData[1]){var c=(_.uniq(e.sorted_weight),0),d=0;if("vertical"===a.optional.legends.display){e.legendsContainer.attr("height",30*e.mapGroupData[0].length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,h=function(){return e.w-e.w/4+16},i=function(){return e.w-e.w/4};var f=function(a,b){return 24*b+12},g=function(a,b){return 24*b+23}}else if("horizontal"===a.optional.legends.display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",c=0,d=0;var h=function(a,b){return 0===b&&(d=0),e.w-(100*b+75)>0?e.w-(100*b+75):e.w-(100*d+75)<e.w?(d++,e.w-(100*(d-1)+75)):(d=0,d++,e.w-(100*(d-1)+75))};g=function(a,b){return 0===b&&(c=0,d=0),e.w-(100*b+75)>0||(e.w-(100*d+75)<e.w?(0===d&&c++,d++):(d=0,d++,c++)),24*c+23},rect_parameter1value=13,rect_parameter2value=13;var i=function(a,b){return 0===b&&(c=0,d=0),e.w-(100*b+100)>=0?e.w-(100*b+100):e.w-(100*b+100)<e.w?(c++,0===d&&e.legendsContainer.attr("height",50*(c+1)),d++,e.w-(100*(d-1)+100)):(d=0,d++,c++,e.w-(100*(d-1)+100))};f=function(a,b){return 0===b&&(c=0,d=0),e.w-(100*b+75)>0||(e.w-(100*d+75)<e.w?(0==d&&c++,d++):(d=0,d++,c++)),24*c+12}}var j;if(PykCharts.boolean(e.multiple_containers)){var k=[];k.push(e.mapGroupData[0][b]),j=e.legendsGroup.selectAll("rect").data(k),e.legends_text=e.legendsGroup.selectAll(".legends_text").data(k)}else j=e.legendsGroup.selectAll("rect").data(e.mapGroupData[0]),e.legends_text=e.legendsGroup.selectAll(".legends_text").data(e.mapGroupData[0]);j.enter().append("rect"),j.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,i).attr(rect_parameter4,f).attr("fill",function(a){return e.fillChart.colorPieW(a)}).attr("opacity",function(){return.6}),j.exit().remove(),e.legends_text.enter().append("text").attr("class","legends_text").attr("fill",e.legendsText.color).attr("pointer-events","none").style("font-family",e.legendsText.family).attr("font-size",e.legendsText.size),e.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,h).attr(text_parameter2,g).text(function(a){return a.group}),e.legends_text.exit().remove()}return this},ticks:function(){if(PykCharts.boolean(e.enableTicks)){var a=e.group1.selectAll("text").data(e.new_data);a.enter().append("text"),a.attr("transform",function(a){return"translate("+e.x(a.x)+","+e.y(a.y)+")"}).style("text-anchor","middle").style("font-family",e.label.family).style("font-size",e.label.size).attr("pointer-events","none").attr("dx",-1).attr("dy",-12),a.text(function(a){return a.name}),a.exit().remove()}return this},zoom:function(){return this},plotCircle:function(){return e.circlePlot=e.chartBody.selectAll(".dot").data(e.new_data),e.circlePlot.enter().append("circle").attr("class","dot"),e.circlePlot.attr("r",function(a){return e.sizes(a.weight)}).attr("cx",function(a){return e.x(a.x)+e.left_margin}).attr("cy",function(a){return e.y(a.y)+e.top_margin}).style("fill",function(a){return e.fillChart.colorPieW(a)}).style("fill-opacity",function(a){return e.multiD.opacity(a.weight,e.weight,e.data)}).attr("stroke",e.border.color()).attr("stroke-width",e.border.width()).attr("stroke-opacity",1).on("mouseover",function(a){tooltipText=a.tooltip?a.tooltip:"<table class='PykCharts'><tr><th colspan='2'>"+a.name+"</th></tr><tr><td>X</td><td>"+a.x+"</td></tr><tr><td>Y</td><td>"+a.y+"</td></tr><tr><td>Weight</td><td>"+a.weight+"</td></tr></table>",e.mouseEvent.tooltipPosition(a),e.mouseEvent.toolTextShow(tooltipText),PykCharts.boolean(e.size.enable)&&d3.select(this).style("fill-opacity",1)}).on("mouseout",function(a){e.mouseEvent.tooltipHide(a),PykCharts.boolean(e.size.enable)&&d3.selectAll(".dot").style("fill-opacity",.5)}).on("mousemove",function(a){e.mouseEvent.tooltipPosition(a)}),e.circlePlot.exit().remove(),this},label:function(){return PykCharts.boolean(e.label.size)&&(e.circleLabel=e.chartBody.selectAll(".text").data(e.new_data),e.circleLabel.enter().append("text").attr("class","text"),e.circleLabel.attr("x",function(a){return e.x(a.x)+e.left_margin}).attr("y",function(a){return e.y(a.y)+e.top_margin+5}).attr("text-anchor","middle").attr("pointer-events","none").style("font-weight",e.label.weight).style("font-size",e.label.size).attr("fill",e.label.color).style("font-family",e.label.family).text(function(a){return a.weight}).text(function(a){return this.getBBox().width<2*e.sizes(a.weight)&&this.getBBox().height<2*e.sizes(a.weight)?a.weight:""}),e.circleLabel.exit().remove()),this}};return b}},PykCharts.multiD.spiderWeb=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(){"default"===b.mode&&b.k.loading(),b=new PykCharts.multiD.processInputs(b,a,"spiderweb"),b.multiD=new PykCharts.multiD.configuration(b),b.axisTitle=a.optional&&a.optional.axisTitle?a.optional.axisTitle:c.multiDimensionalCharts.spiderweb.axisTitle,b.bubbleRadius=a.spiderweb&&_.isNumber(a.spiderweb.radius)?a.spiderweb.radius:c.multiDimensionalCharts.spiderweb.radius,b.outerRadius=a.spiderweb&&_.isNumber(a.spiderweb.outer_radius)?a.spiderweb.outer_radius:c.multiDimensionalCharts.spiderweb.radius,b.innerRadius=0,b.enableTicks=a.optional&&a.optional.enableTicks?a.optional.enableTicks:c.multiDimensionalCharts.spiderweb.enableTicks,console.log(b.outerRadius,"outerRadius"),d3.json(a.data,function(a,c){b.data=c.groupBy("spiderweb"),$(b.selector+" #chart-loader").remove(),b.render()})},b.refresh=function(){d3.json(a.data,function(a,c){b.data=c.groupBy("spiderweb"),b.mapGroupData=b.multiD.mapGroup(b.data),b.optionalFeatures().createSpiderWeb().legends().axisTicks().axisTitle()})},this.render=function(){b.radius_range=[7,18],b.fillChart=new PykCharts.Configuration.fillChart(b),b.sizes=new PykCharts.multiD.bubbleSizeCalculation(b,b.data,b.radius_range),b.border=new PykCharts.Configuration.border(b),b.mapGroupData=b.multiD.mapGroup(b.data),"default"===b.mode?(b.k.title(),b.k.subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().legendsContainer(1).svgContainer(1),b.k.liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createSpiderWeb().axisTicks().axisTitle().legends(),b.k.credits().dataSource()):"infographics"===b.mode&&(b.optionalFeatures().svgContainer().createSpiderWeb().axisTicks().axisTitle(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b))},this.degrees=function(a){return a/Math.PI*180-90},this.optionalFeatures=function(){var a=this,b={svgContainer:function(b){return $(a.selector).attr("class","PykCharts-spider-web"),a.svg=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("class","svgcontainer").attr("id","svgcontainer").attr("width",a.width).attr("height",a.height).style("background-color",a.bg),a.group=a.svg.append("g").attr("id","spidergrp").attr("transform","translate("+a.width/2+","+a.height/2+")"),this},legendsContainer:function(b){return PykCharts.boolean(a.legends.enable)&&PykCharts.boolean(a.size.enable)&&a.mapGroupData[1]&&(a.legendSvg=d3.select(a.selector+" #tooltip-svg-container-"+b).append("svg").attr("class","legendsvg").attr("id","legendsvg").attr("width",a.width).attr("height",50),a.legendsgrp=a.legendSvg.append("g").attr("class","legendgrp").attr("id","legendgrp")),this},createSpiderWeb:function(){var b;for(a.group_arr=[],a.unique_arr=[],j=0;j<a.data.length;j++)a.group_arr[j]=a.data[j].name;a.uniq_arr=_.uniq(a.group_arr);var c=a.uniq_arr.length;for(a.new_data=[],k=0;c>k;k++)for(a.new_data[k]={name:a.uniq_arr[k],data:[]},l=0;l<a.data.length;l++)a.uniq_arr[k]===a.data[l].name&&a.new_data[k].data.push({x:a.data[l].x,y:a.data[l].y,weight:a.data[l].weight,color:a.data[l].color,tooltip:a.data[l].tooltip});var d=a.new_data[0].data;for(a.max=d3.max(a.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),a.min=d3.min(a.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),a.yScale=d3.scale.linear().domain([a.min,a.max]).range([a.innerRadius,a.outerRadius]),a.yDomain=[],a.nodes=[],b=0;b<a.new_data.length;b++){var e=[];for(j=0;j<a.new_data[b].data.length;j++)e[j]=a.yScale(a.new_data[b].data[j].y);a.yDomain[b]=e}for(b=0;b<a.new_data.length;b++){a.y=d3.scale.linear().domain(d3.extent(a.yDomain[b],function(a){return a})).range([.1,.9]);var f=[];for(j=0;j<d.length;j++)f[j]={x:j,y:a.y(a.yDomain[b][j])};a.nodes[b]=f}for(m=0;m<a.new_data.length;m++){var g=[];for(j=0;j<a.new_data[m].data.length;j++)g[j]=a.new_data[m].data[j].tooltip;for(a.angle=d3.scale.ordinal().domain(d3.range(a.new_data[m].data.length+1)).rangePoints([0,2*Math.PI]),a.radius=d3.scale.linear().range([a.innerRadius,a.outerRadius]),a.yAxis=[],b=0;b<a.new_data[m].data.length;b++)a.yAxis.push({x:b,y:.25},{x:b,y:.5},{x:b,y:.75},{x:b,y:1});var h,i=[];for(b=0;b<a.yAxis.length;b++)h=b<a.yAxis.length-4?a.yAxis[b+4]:a.yAxis[b-a.yAxis.length+4],i.push({source:a.yAxis[b],target:h});var n,o=[];for(b=0;b<a.nodes[m].length;b++)b<a.nodes[m].length-1?(h=a.nodes[m][b+1],n=a.fillChart.colorPieW(a.new_data[m].data[b])):(h=a.nodes[m][0],n=a.fillChart.colorPieW(a.new_data[m].data[b])),o.push({source:a.nodes[m][b],target:h,color:n});var p=a.group.selectAll("#link"+m).data(o);p.enter().append("path").attr("class","link"),p.attr("class","link").attr("stroke",function(a){return a.color}).attr("stroke-opacity",1).attr("id","link"+m).attr("d",d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})),p.exit().remove(),a.weight=_.map(a.new_data[m].data,function(a){return a.weight}),a.weight=_.reject(a.weight,function(a){return 0==a}),a.sorted_weight=a.weight.slice(0),a.sorted_weight.sort(function(a,b){return a-b});var q=a.group.selectAll(".node"+m).data(a.nodes[m]);q.enter().append("circle").attr("class","node"+m).attr("transform",function(b){return"rotate("+a.degrees(a.angle(b.x))+")"}),q.attr("class","node"+m).attr("cx",function(b){return a.radius(b.y)}).attr("r",function(b,c){return a.sizes(a.new_data[m].data[c].weight)}).style("fill",function(b,c){return a.fillChart.colorPieW(a.new_data[m].data[c])}).style("opacity",function(b,c){return a.multiD.opacity(a.new_data[m].data[c].weight,a.weight,a.data)}).attr("stroke",a.border.color()).attr("stroke-width",a.border.width()).on("mouseover",function(b,c){a.mouseEvent.tooltipPosition(b),a.mouseEvent.toolTextShow(g[c])}).on("mouseout",function(b){a.mouseEvent.tooltipHide(b)}).on("mousemove",function(b){a.mouseEvent.tooltipPosition(b)}),q.exit().remove()}return a.group.selectAll(".axis").data(d3.range(a.new_data[0].data.length)).enter().append("line").attr("class","axis").attr("transform",function(b){return"rotate("+a.degrees(a.angle(b))+")"}).attr("x1",a.radius.range()[0]).attr("x2",a.radius.range()[1]),a.group.selectAll(".grid").data(i).enter().append("path").attr("class","grid").attr("d",d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})),this},legends:function(){if(PykCharts.boolean(a.legends.enable)&&PykCharts.boolean(a.size.enable)&&a.mapGroupData[1]){var b=(_.uniq(a.sorted_weight),0),c=0;if("vertical"===a.legends.display){a.legendSvg.attr("height",30*a.mapGroupData[0].length+20),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,f=function(){return a.width-a.width/4+16},g=function(){return a.width-a.width/4};var d=function(a,b){return 24*b+12},e=function(a,b){return 24*b+23}}else if("horizontal"===a.legends.display){text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",b=0,c=0;var f=function(b,d){return 0===d&&(c=0),a.w-(100*d+75)>0?a.width-(100*d+75):a.width-(100*c+75)<a.width?(c++,a.width-(100*(c-1)+75)):(c=0,c++,a.width-(100*(c-1)+75))};e=function(d,e){return 0===e&&(b=0,c=0),a.width-(100*e+75)>0||(a.width-(100*c+75)<a.width?(0===c&&b++,c++):(c=0,c++,b++)),24*b+23},rect_parameter1value=13,rect_parameter2value=13;var g=function(d,e){return 0===e&&(b=0,c=0),a.w-(100*e+100)>=0?a.width-(100*e+100):a.width-(100*e+100)<a.width?(b++,0===c&&a.legendSvg.attr("height",50*(c+1)),c++,a.width-(100*(c-1)+100)):(c=0,c++,b++,a.width-(100*(c-1)+100))};d=function(d,e){return 0===e&&(b=0,c=0),a.width-(100*e+75)>0||(a.width-(100*c+75)<a.width?(0==c&&b++,c++):(c=0,c++,b++)),24*b+12}}var h=a.legendsgrp.selectAll("rect").data(a.mapGroupData[0]);h.enter().append("rect"),h.attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,g).attr(rect_parameter4,d).attr("fill",function(b){return a.fillChart.colorPieW(b)}).attr("opacity",function(){return.6}),h.exit().remove(),a.legends_text=a.legendsgrp.selectAll(".legends_text").data(a.mapGroupData[0]),a.legends_text.enter().append("text").attr("class","legends_text").attr("fill",a.legendsText.color).attr("pointer-events","none").style("font-family",a.legendsText.family).attr("font-size",a.legendsText.size),a.legends_text.attr("class","legends_text").attr("fill","black").attr(text_parameter1,f).attr(text_parameter2,e).text(function(a){return a.name}),a.legends_text.exit().remove()}return this},axisTitle:function(){if(PykCharts.boolean(a.axisTitle)){a.length=a.new_data[0].data.length;var b=a.group.selectAll("text.axisTitle").data(a.nodes[0]);b.enter().append("text").attr("class","axisTitle"),b.attr("transform",function(){return"translate("+-a.width/2+","+-a.height/2+")"}).style("text-anchor","middle").attr("x",function(b,c){return a.width/2*(1-.2*Math.sin(2*c*Math.PI/a.length))+245*Math.sin(2*c*Math.PI/a.length)}).attr("y",function(b,c){return a.height/2*(1-.6*Math.cos(2*c*Math.PI/a.length))-75*Math.cos(2*c*Math.PI/a.length)}).style("font-size",a.label.size).style("font-family",a.label.family),b.text(function(b,c){return a.new_data[0].data[c].x}),b.exit().remove()}return this},axisTicks:function(){if(PykCharts.boolean(a.enableTicks)){var b=a.yScale.domain();a.textGroup=a.svg.append("g").attr("transform","translate("+a.width/2+","+a.height/2+")"),console.log(b,"domain",a.outerRadius/5);var c=b[1]/4,d=[];for(i=4,j=0;i>=0;i--,j++)d[j]=i*c;var e=a.textGroup.selectAll("text.ticks").data(d);e.enter().append("text").attr("class","ticks"),e.style("text-anchor","start").attr("transform","translate(5,"+-a.outerRadius+")").attr("x",0).attr("y",function(b,c){return c*(a.outerRadius/4)}).attr("dy",-2),e.text(function(a){return a}).style("font-size",a.label.size).style("font-family",a.label.family)}return this}};return b}},PykCharts.maps={},PykCharts.maps.mouseEvent=function(){var a={highlight:function(a,b){var c=d3.select(b);return d3.selectAll(a).attr("opacity",.5),c.attr("opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("opacity",1),this}};return a},PykCharts.maps.processInputs=function(a,b){var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=c.functionality,f=c.mapsTheme,g=b.optional;return a.selector=b.selector?b.selector:d.selector,a.width=g.map&&_.isNumber(parseInt(g.map.width,10))?g.map.width:f.map.width,a.height=g.map&&_.isNumber(parseInt(g.map.height,10))?g.map.height:f.map.height,a.mapCode=b.mapCode?b.mapCode:f.mapCode,a.enableClick=b.enableClick?b.enableClick:f.enableClick,a.bg=g&&g.colors&&g.colors.backgroundColor?g.colors.backgroundColor:d.colors.backgroundColor,g&&g.timeline?(a.timeline=g.timeline,a.timeline.duration=g.timeline.duration?g.timeline.duration:f.timeline.duration,a.timeline.margin=g.timeline.margin,a.timeline.margin.left=g.timeline.margin.left?g.timeline.margin.left:f.timeline.margin.left,a.timeline.margin.right=g.timeline.margin.right?g.timeline.margin.right:f.timeline.margin.right,a.timeline.margin.top=g.timeline.margin.top?g.timeline.margin.top:f.timeline.margin.top,a.timeline.margin.bottom=g.timeline.margin.bottom?g.timeline.margin.bottom:f.timeline.margin.bottom):a.timeline=f.timeline,g&&g.tooltip?(a.tooltip=g.tooltip,a.tooltip.enable=g.tooltip.enable?g.tooltip.enable:f.tooltip.enable,a.tooltip.mode=g.tooltip.mode?g.tooltip.mode:f.tooltip.mode,a.tooltip.positionTop=g.tooltip.positionTop?g.tooltip.positionTop:f.tooltip.positionTop,a.tooltip.positionLeft=g.tooltip.positionLeft?g.tooltip.positionLeft:f.tooltip.positionLeft,a.tooltipTopCorrection=d3.select(a.selector).style("top"),a.tooltipLeftCorrection=d3.select(a.selector).style("left")):a.tooltip=f.tooltip,g&&g.colors?(a.colors=g.colors,a.colors.defaultColor=g.colors.defaultColor?g.colors.defaultColor:f.colors.defaultColor,a.colors.total=g.colors.total&&_.isNumber(parseInt(g.colors.total,10))?parseInt(g.colors.total,10):f.colors.total,a.colors.type=g.colors.type?g.colors.type:f.colors.type,a.colors.palette=g.colors.palette?g.colors.palette:f.colors.palette):a.colors=f.colors,g&&g.axis?(a.axis=g.axis,a.axis.onHoverHighlightenable=g.axis.onHoverHighlightenable?g.axis.onHoverHighlightenable:f.axis.onHoverHighlightenable,a.axis.x=g.axis.x,a.axis.x.orient=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.orient?g.axis.x.orient:f.axis.x.orient,a.axis.x.axisColor=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.axisColor?g.axis.x.axisColor:f.axis.x.axisColor,a.axis.x.labelColor=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.labelColor?g.axis.x.labelColor:f.axis.x.labelColor,a.axis.x.no_of_ticks=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.no_of_ticks?g.axis.x.no_of_ticks:f.axis.x.no_of_ticks,a.axis.x.ticksPadding=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.ticksPadding?g.axis.x.ticksPadding:f.axis.x.ticksPadding,a.axis.x.tickSize=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.tickSize?g.axis.x.tickSize:f.axis.x.tickSize,a.axis.x.tickFormat=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.tickFormat?g.axis.x.tickFormat:f.axis.x.tickFormat,a.axis.x.tickValues=PykCharts.boolean(g.axis.x.enable)&&g.axis.x.tickValues?g.axis.x.tickValues:f.axis.x.tickValues,a.axis.y=g.axis.y,a.axis.y.orient=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.orient?g.axis.y.orient:f.axis.y.orient,a.axis.y.axisColor=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.axisColor?g.axis.y.axisColor:f.axis.y.axisColor,a.axis.y.labelColor=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.labelColor?g.axis.y.labelColor:f.axis.y.labelColor,a.axis.y.no_of_ticks=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.no_of_ticks?g.axis.y.no_of_ticks:f.axis.y.no_of_ticks,a.axis.y.ticksPadding=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.ticksPadding?g.axis.y.ticksPadding:f.axis.y.ticksPadding,a.axis.y.tickSize=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.tickSize?g.axis.y.tickSize:f.axis.y.tickSize,a.axis.y.tickFormat=PykCharts.boolean(g.axis.y.enable)&&g.axis.y.tickFormat?g.axis.y.tickFormat:f.axis.y.tickFormat):a.axis=f.axis,g&&g.label?(a.label=g.label,a.label.enable=g.label.enable&&g.label.enable?g.label.enable:f.label.enable):a.label=f.label,g&&g.legends?(a.legends=g.legends,a.legends.enable=g.legends.enable&&g.legends.enable?g.legends.enable:f.legends.enable):a.legends=f.legends,g&&g.border?(a.border=g.border,a.border.color=g.border.color?g.border.color:f.border.color,a.border.thickness=g.border.thickness?g.border.thickness:f.border.thickness):a.border=f.border,a.onhover=g&&g.onhover?g.onhover:f.onhover,a.defaultZoomLevel=g&&g.defaultZoomLevel?g.defaultZoomLevel:80,a.loading=g&&g.loading&&g.loading.animationGifUrl?g.loading.animationGifUrl:d.loading.animationGifUrl,a.highlightArea=g&&g.highlightArea?g.highlightArea:f.highlightArea,g&&g.title?(a.title=g.title,a.title.size=g.title.size?g.title.size:d.title.size,a.title.color=g.title.color?g.title.color:d.title.color,a.title.weight=g.title.weight?g.title.weight:d.title.weight,a.title.family=g.title.family?g.title.family:d.title.family):a.title=d.title,g&&g.subtitle?(a.subtitle=g.subtitle,a.subtitle.size=g.subtitle.size?g.subtitle.size:d.subtitle.size,a.subtitle.color=g.subtitle.color?g.subtitle.color:d.subtitle.color,a.subtitle.family=g.subtitle.family?g.subtitle.family:d.subtitle.family):a.subtitle=d.subtitle,a.realTimeCharts=g&&g.realTimeCharts?g.realTimeCharts:e.realTimeCharts,a.transition=g&&g.transition?g.transition:e.transition,a.creditMySite=g&&g.creditMySite?g.creditMySite:d.creditMySite,a.dataSource=g&&g.dataSource?g.dataSource:"no",a.k=new PykCharts.Configuration(a),a
},PykCharts.maps.oneLayer=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=PykCharts.maps.processInputs(b,a),b.data=a.data,b.k.totalColors(b.colors.total).colorType(b.colors.type).loading(b.loading).tooltip(b.tooltip.enable),d3.json("../data/maps/"+b.mapCode+".json",function(a){b.map_data=a,d3.json("../data/maps/colorPalette.json",function(a){b.colorPalette_data=a,$(b.selector).html(""),b.render(),b.simulateLiveData(b.data)})}),b.max_size=d3.max(b.data,function(a){return parseInt(a.size,10)}),b.min_size=d3.min(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.max_size-b.min_size},this.optionalFeatures=function(){var a={enableLegend:function(a){return PykCharts.boolean(a)&&b.renderLegend(),this},enableLabel:function(a){return PykCharts.boolean(a)&&b.renderLabel(),this},enableClick:function(a){return console.log(a),PykCharts.boolean(a)&&(b.areas.on("click",b.clicked),b.onhover1=b.onhover),this}};return a},this.render=function(){var a=this,a=this,b=10,c=[a.width/2,a.height/2];a.current_palette=_.where(a.colorPalette_data,{name:a.colors.palette,number:a.colors.total})[0],a.optionalFeatures().enableLegend(a.legends.enable),a.svg=d3.select(a.selector).append("svg").attr("width",a.width).attr("height",a.height).attr("style","border:1px solid lightgrey").style("border-radius","5px");var d=a.svg.append("g").attr("id","map_group"),e=d.append("defs"),f=e.append("filter").attr("id","dropshadow");f.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1).attr("result","blur"),f.append("feOffset").attr("in","blur").attr("dx",1).attr("dy",1).attr("result","offsetBlur");var g=f.append("feMerge");g.append("feMergeNode").attr('in", "offsetBlur'),g.append("feMergeNode").attr("in","SourceGraphic"),a.group=d.selectAll("g").data(topojson.feature(a.map_data,a.map_data.objects).features).enter().append("g");var h=d3.geo.centroid(topojson.feature(a.map_data,a.map_data.objects)),i=d3.geo.mercator().center(h).scale(b).translate(c);a.path=d3.geo.path().projection(i);var j=a.path.bounds(topojson.feature(a.map_data,a.map_data.objects)),k=b*a.width/(j[1][0]-j[0][0]),l=b*a.height/(j[1][1]-j[0][1]),b=l>k?k:l,c=[a.width-(j[0][0]+j[1][0])/2,a.height-(j[0][1]+j[1][1])/2];i=d3.geo.mercator().center(h).scale(a.defaultZoomLevel/100*b).translate(c),a.path=a.path.projection(i);var m=d3.select("#pyk-tooltip");a.areas=a.group.append("path").attr("d",a.path).attr("class","area").attr("state_name",function(a){return a.properties.NAME_1}).attr("fill",a.renderColor).attr("opacity",a.renderOpacity).attr("stroke",a.border.color).attr("stroke-width",a.border.thickness+"px").on("mouseover",function(b){PykCharts.boolean(a.tooltip.enable)&&(m.style("visibility","visible"),m.html(_.where(a.data,{iso2:b.properties.iso_a2})[0].tooltip)),a.bodColor(b)}).on("mousemove",function(){PykCharts.boolean(a.tooltip.enable)&&("moving"===a.tooltip.mode?m.style("top",function(){return d3.event.clientY+10+"px"}).style("left",function(){return d3.event.clientX+10+"px"}):"fixed"===a.tooltip.mode&&m.style("top",a.tooltip.positionTop+"px").style("left",a.tooltip.positionLeft+"px"))}).on("mouseout",function(b){PykCharts.boolean(a.tooltip.enable)&&m.style("visibility","hidden"),a.bodUncolor(b)}),this.optionalFeatures().enableLabel(a.label.enable).enableClick(a.enableClick),PykCharts.boolean(a.creditMySite.enable)&&a.k.credits(),PykCharts.boolean(a.dataSource.enable)&&(console.log("dataSource"),a.k.dataSource())},this.renderColor=function(a,c){var d,e;if(e=_.where(b.data,{iso2:a.properties.iso_a2}),_.where(b.data,{iso2:a.properties.iso_a2}).length>0){if("colors"===b.colors.type)return e.length>0&&""!==e[0].color?e[0].color:b.colors.defaultColor;if("saturation"===b.colors.type){if("yes"===b.highlightArea&&"true"==e[0].highlight)return e[0].highlight_color;if(""!==b.colors.palette)for(d=_.where(b.data,{iso2:a.properties.iso_a2})[0].size,c=0;c<b.current_palette.colors.length;c++)if(d>=b.min_size+c*(b.difference/b.current_palette.colors.length)&&d<=b.min_size+(c+1)*(b.difference/b.current_palette.colors.length))return b.current_palette.colors[c];return b.colors.defaultColor}return b.colors.defaultColor}return b.colors.defaultColor},this.renderOpacity=function(a){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth=+d3.format(".2f")(b.difference/10),b.opacity=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth)/b.difference,b.opacity):1},this.renderLegend=function(){var a,b,c=this;if("saturation"===c.colors.type)if(c.legs=d3.select(c.selector).append("svg").attr("id","legend-container").attr("width",c.width).attr("height",50),""===c.colors.palette)for(a=1;9>=a;a++)b=d3.format(".1f")(c.max_size/9),c.leg=d3.round(b*a),c.legs.append("rect").attr("x",a*(c.width/11)).attr("y",20).attr("width",c.width/11).attr("height",5).attr("fill",c.defaultColor).attr("opacity",a/9),c.legs.append("text").attr("x",(a+1)*(c.width/11)-5).attr("y",34).style("font-size",10).style("font","Arial").text("< "+c.leg);else for(a=1;a<=c.current_palette.number;a++)c.leg=d3.round(c.min_size+a*(c.difference/c.current_palette.number)),c.legs.append("rect").attr("x",a*c.width/(c.current_palette.number+2)).attr("y",20).attr("width",c.width/(c.current_palette.number+2)).attr("height",5).attr("fill",c.current_palette.colors[a-1]),c.legs.append("text").attr("x",(a+1)*c.width/(c.current_palette.number+2)-5).attr("y",34).style("font-size",10).style("font","Arial").text("< "+c.leg);else $("#legend-container").remove()},this.renderLabel=function(){b.group.append("text").attr("x",function(a){return b.path.centroid(a)[0]}).attr("y",function(a){return b.path.centroid(a)[1]}).attr("text-anchor","middle").attr("font-size","10").attr("pointer-events","none").text(function(a){return a.properties.NAME_1})},this.bodColor=function(a){"none"!==b.onhover1?"highlight_border"===b.onhover1?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",b.border.color).attr("stroke-width",b.border.thickness+.5):"shadow"===b.onhover1?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("filter","url(#dropshadow)").attr("opacity",function(){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth_dim=+d3.format(".2f")(b.difference/10),b.opacity_dim=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth_dim)/b.difference,b.opacity_dim/2):.5}):"color_saturation"===b.onhover1&&d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("opacity",function(){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth_dim=+d3.format(".2f")(b.difference/10),b.opacity_dim=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth_dim)/b.difference,b.opacity_dim/2):.5}):(console.log("none"),b.bodUncolor(a))},this.bodUncolor=function(a){d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",b.border.color).attr("stroke-width",b.border.thickness).attr("filter",null).attr("opacity",function(){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth_high=+d3.format(".2f")(b.difference/10),b.opacity_high=(b.min_size+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth_high)/b.difference,b.opacity_high):1})},this.clicked=function(a){var c={};c.container=d3.event.target.ownerSVGElement.parentNode.id,c.area=a.properties,c.data=_.where(b.data,{iso2:a.properties.iso_a2})[0];try{customFunction(c)}catch(d){}},this.simulateLiveData=function(){var a=$("#live-data").val();batSplit=a.split("\n");var c=[];b.live_json=[];for(var d=0;d<batSplit.length-1;d++)c[d]=batSplit[d].split(",");for(var d=1;d<batSplit.length-1;d++){for(var e={},f=0;f<c[d].length;f++)e[c[0][f]]=c[d][f];b.live_json.push(e)}b.data=b.live_json,d3.selectAll("path").attr("fill",b.renderColor).attr("opacity",b.renderOpacity)}},PykCharts.maps.timelineMap=function(a){{var b=this;new PykCharts.Configuration.Theme({})}this.execute=function(){b=PykCharts.maps.processInputs(b,a),b.timeline_data=a.data;var c=d3.extent(a.data,function(a){return a.timestamp});b.data=_.where(a.data,{timestamp:c[0]}),b.reducedWidth=b.width-2*b.timeline.margin.left-b.timeline.margin.right,b.reducedHeight=b.height-b.timeline.margin.top-b.timeline.margin.bottom,b.k.totalColors(b.colors.total).colorType(b.colors.type).loading(b.loading).tooltip(b.tooltip.enable),d3.json("../data/maps/"+b.mapCode+".json",function(a){b.map_data=a,d3.json("../data/maps/colorPalette.json",function(a){b.colorPalette_data=a;var c=d3.extent(b.timeline_data,function(a){return a.timestamp});b.data=_.where(b.timeline_data,{timestamp:c[0]}),b.data.sort(function(a,b){return a.timestamp-b.timestamp}),$(b.selector).html(""),b.render(),b.simulateLiveData(b.timeline_data)})}),b.extent_size=d3.extent(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.extent_size[1]-b.extent_size[0]},this.optionalFeatures=function(){var a={enableLegend:function(a){return PykCharts.boolean(a)&&b.renderLegend(),this},enableLabel:function(a){return PykCharts.boolean(a)&&b.renderLabel(),this},enableClick:function(a){return PykCharts.boolean(a)&&(b.areas.on("click",b.clicked),b.onhover1=b.onhover),this},axisContainer:function(a){return PykCharts.boolean(a)&&(b.gxaxis=b.svg.append("g").attr("id","xaxis").attr("class","x axis").attr("transform","translate("+2*b.timeline.margin.left+","+b.reducedHeight+")")),this}};return a},this.render=function(){var a=this,a=this,b=150,c=[a.width/2,a.height/2];console.log(a.legends,"legends"),a.current_palette=_.where(a.colorPalette_data,{name:a.colors.palette,number:a.colors.total})[0],a.optionalFeatures().enableLegend(a.legends.enable),a.svg=d3.select(a.selector).append("svg").attr("width",a.width).attr("height",a.height).attr("style","border:1px solid lightgrey").style("border-radius","5px");var d=a.svg.append("g").attr("id","map_group"),e=d.append("defs"),f=e.append("filter").attr("id","dropshadow");f.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1).attr("result","blur"),f.append("feOffset").attr("in","blur").attr("dx",1).attr("dy",1).attr("result","offsetBlur");var g=f.append("feMerge");g.append("feMergeNode").attr('in", "offsetBlur'),g.append("feMergeNode").attr("in","SourceGraphic"),a.group=d.selectAll("g").data(topojson.feature(a.map_data,a.map_data.objects).features).enter().append("g");var h=d3.geo.centroid(topojson.feature(a.map_data,a.map_data.objects)),i=d3.geo.mercator().center(h).scale(b).translate(c);a.path=d3.geo.path().projection(i);var j=a.path.bounds(topojson.feature(a.map_data,a.map_data.objects)),k=b*a.width/(j[1][0]-j[0][0]),l=b*a.height/(j[1][1]-j[0][1]),b=l>k?k:l,c=[a.width-(j[0][0]+j[1][0])/2,a.height-(j[0][1]+j[1][1])/2];i=d3.geo.mercator().center(h).scale(a.defaultZoomLevel/100*b).translate(c),a.path=a.path.projection(i);var m=d3.select("#pyk-tooltip");a.areas=a.group.append("path").attr("d",a.path).attr("class","area").attr("iso2",function(a){return a.properties.iso_a2}).attr("state_name",function(a){return a.properties.NAME_1}).attr("fill",a.renderColor).attr("prev_fill",function(){return d3.select(this).attr("fill")}).attr("opacity",a.renderOpacity).attr("stroke",a.border.color).attr("stroke-width",a.border.thickness+"px").on("mouseover",function(b){PykCharts.boolean(a.tooltip.enable)&&(m.style("visibility","visible"),m.html(_.where(a.data,{iso2:b.properties.iso_a2})[0].tooltip)),a.bodColor(b)}).on("mousemove",function(){PykCharts.boolean(a.tooltip.enable)&&("moving"===a.tooltip.mode?m.style("top",function(){return d3.event.clientY+10+"px"}).style("left",function(){return d3.event.clientX+10+"px"}):"fixed"===a.tooltip.mode&&m.style("top",a.tooltip.positionTop+"px").style("left",a.tooltip.positionLeft+"px"))}).on("mouseout",function(b){PykCharts.boolean(a.tooltip.enable)&&m.style("visibility","hidden"),a.bodUncolor(b)}),a.optionalFeatures().enableLabel(a.label.enable).enableClick(a.enableClick),a.k.dataSource(a.dataSource).credits(a.creditMySite),a.renderTimeline()},this.renderColor=function(a,c){if(!PykCharts.boolean(a))return!1;var d,e=_.where(b.data,{iso2:a.properties.iso_a2});if(e.length>0){if("colors"===b.colors.type)return e.length>0&&""!==e[0].color?e[0].color:b.colors.defaultColor;if("saturation"===b.colors.type){if("yes"===b.highlightArea&&"true"==e[0].highlight)return e[0].highlight_color;if(""!==b.colors.palette)for(d=e[0].size,c=0;c<b.current_palette.colors.length;c++)if(d>=b.extent_size[0]+c*(b.difference/b.current_palette.colors.length)&&d<=b.extent_size[0]+(c+1)*(b.difference/b.current_palette.colors.length))return b.current_palette.colors[c];return b.colors.defaultColor}return b.colors.defaultColor}return b.colors.defaultColor},this.renderOpacity=function(a){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth=+d3.format(".2f")(b.difference/10),b.opacity=(b.extent_size[0]+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth)/b.difference,b.opacity):1},this.renderLegend=function(){var a,b,c=this;if("saturation"===c.colors.type){if(c.legs=d3.select(c.selector).append("svg").attr("id","legend-container").attr("width",c.width).attr("height",50),""===c.colors.palette)for(a=1;9>=a;a++)b=d3.format(".1f")(c.extent_size[1]/9),c.leg=d3.round(b*a),c.legs.append("rect").attr("x",a*(c.width/11)).attr("y",20).attr("width",c.width/11).attr("height",5).attr("fill",c.defaultColor).attr("opacity",a/9),c.legs.append("text").attr("x",(a+1)*(c.width/11)-5).attr("y",34).style("font-size",10).style("font","Arial").text("< "+c.leg);else for(a=1;a<=c.current_palette.number;a++)c.leg=d3.round(c.extent_size[0]+a*(c.difference/c.current_palette.number)),c.legs.append("rect").attr("x",a*c.width/(c.current_palette.number+2)).attr("y",20).attr("width",c.width/(c.current_palette.number+2)).attr("height",5).attr("fill",c.current_palette.colors[a-1]),c.legs.append("text").attr("x",(a+1)*c.width/(c.current_palette.number+2)-5).attr("y",34).style("font-size",10).style("font","Arial").text("< "+c.leg);$("#legend-container").after("</br>")}else $("#legend-container").remove()},this.renderLabel=function(){b.group.append("text").attr("x",function(a){return b.path.centroid(a)[0]}).attr("y",function(a){return b.path.centroid(a)[1]}).attr("text-anchor","middle").attr("font-size","10").attr("pointer-events","none").text(function(a){return a.properties.NAME_1})},this.bodColor=function(a){var c=_.where(b.data,{iso2:a.properties.iso_a2});"none"!==b.onhover1?"highlight_border"===b.onhover1?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",b.border.color).attr("stroke-width",b.border.thickness+.5):"shadow"===b.onhover1?d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("filter","url(#dropshadow)").attr("opacity",function(){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth_dim=+d3.format(".2f")(b.difference/10),b.opacity_dim=(b.extent_size[0]+c[0].size+b.oneninth_dim)/b.difference,b.opacity_dim/2):.5}):"color_saturation"===b.onhover1&&d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("opacity",function(){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth_dim=+d3.format(".2f")(b.difference/10),b.opacity_dim=(b.extent_size[0]+c[0].size+b.oneninth_dim)/b.difference,b.opacity_dim/2):.5}):b.bodUncolor(a)},this.bodUncolor=function(a){d3.select("path[state_name='"+a.properties.NAME_1+"']").attr("stroke",b.border.color).attr("stroke-width",b.border.thickness).attr("filter",null).attr("opacity",function(){return""===b.colors.palette&&"saturation"===b.colors.type?(b.oneninth_high=+d3.format(".2f")(b.difference/10),b.opacity_high=(b.extent_size[0]+_.where(b.data,{iso2:a.properties.iso_a2})[0].size+b.oneninth_high)/b.difference,b.opacity_high):1})},this.clicked=function(a){var c={};c.container=d3.event.target.ownerSVGElement.parentNode.id,c.area=a.properties,c.data=_.where(b.data,{iso2:a.properties.iso_a2})[0];try{customFunction(c)}catch(d){}},this.simulateLiveData=function(){var a=$("#live-data").val();batSplit=a.split("\n");var c=[];b.live_json=[];for(var d=0;d<batSplit.length-1;d++)c[d]=batSplit[d].split(",");for(var d=1;d<batSplit.length-1;d++){for(var e={},f=0;f<c[d].length;f++)e[c[0][f]]=c[d][f];b.live_json.push(e)}b.data=b.live_json,d3.selectAll("path").attr("fill",b.renderColor).attr("opacity",b.renderOpacity)},this.renderTimeline=function(){var a,c,d=[],e=interval1=1;b.optionalFeatures().axisContainer(!0),a=d3.extent(b.timeline_data,function(a){return a.timestamp}),c=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("linear",a,c),b.k.xAxis(b.svg,b.gxaxis,b.xScale),_.each(b.timeline_data,function(a){-1===d.indexOf(a.timestamp)&&d.push(a.timestamp)});var f,g=d3.select(b.selector+" .axis").node().getBBox(),h=function(){if("playing"===f)i.attr("xlink:href","../img/play.gif"),clearInterval(b.playInterval),f="paused";else{f="playing",i.attr("xlink:href","../img/pause.gif"),b.playInterval=setInterval(function(){j.transition().duration(b.timeline.duration/2).attr("x",2*b.timeline.margin.left+b.xScale(d[e])-7),b.data=_.where(b.timeline_data,{timestamp:d[e]}),b.data.sort(function(a,b){return a.timestamp-b.timestamp}),_.each(b.data,function(a){d3.select("path[iso2='"+a.iso2+"']").transition().duration(b.timeline.duration/4).attr("fill",b.renderColor)}),e++,e===d.length&&clearInterval(b.playInterval)},b.timeline.duration);var a=setTimeout(function(){var c=setInterval(function(){interval1++,interval1===e&&(clearInterval(c),clearTimeout(a)),interval1===d.length&&(clearInterval(c),i.attr("xlink:href","../img/play.gif"),j.attr("x",2*b.timeline.margin.left+b.xScale(d[0])-7),e=interval1=1,f="")},b.timeline.duration)},b.timeline.duration)}},i=b.svg.append("image").attr("xlink:href","../img/play.gif").attr("x",b.timeline.margin.left/2).attr("y",b.reducedHeight-b.timeline.margin.top-g.height/2).attr("width","24px").attr("height","21px").style("cursor","pointer").on("click",h),j=b.svg.append("image").attr("xlink:href","../img/marker.png").attr("x",2*b.timeline.margin.left+b.xScale(d[0])-7).attr("y",b.reducedHeight).attr("width","14px").attr("height","12px")}},function(){function a(a){var c=document.createElement("script");c.type="text/javascript",c.async=!0,c.onload=c.onreadystatechange=function(){b++,3===b&&window.PykChartsInit()},c.src=a;var d=document.getElementsByTagName("link")[0];d.parentNode.insertBefore(c,d)}var b=0;a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/underscore-min.js"),a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/d3.min.js"),a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/jquery-1.11.1.min.js"),a("https://s3-ap-southeast-1.amazonaws.com/ap-southeast-1.datahub.pykih/distribution/js/custom-hive.min.js")}();